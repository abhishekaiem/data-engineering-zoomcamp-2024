

============================== 2024-02-09 17:13:58.245286 | ed368564-4fb4-4cb9-869b-9de6d2ddb1dd ==============================
17:13:58.245286 [info ] [MainThread]: Running with dbt=1.0.9
17:13:58.247483 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, project_name=None, skip_profile_setup=False, defer=None, state=None, cls=<class 'dbt.task.init.InitTask'>, which='init', rpc_method=None)
17:13:58.247844 [debug] [MainThread]: Tracking: tracking
17:13:58.264773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b1ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b1f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b1f10>]}
17:14:25.179808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b17c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b1ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b1730>]}


============================== 2024-02-09 17:14:35.196381 | 4fb50cc8-bc97-4858-81c5-cc68f747f375 ==============================
17:14:35.196381 [info ] [MainThread]: Running with dbt=1.0.9
17:14:35.198474 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, project_name=None, skip_profile_setup=False, defer=None, state=None, cls=<class 'dbt.task.init.InitTask'>, which='init', rpc_method=None)
17:14:35.198789 [debug] [MainThread]: Tracking: tracking
17:14:35.216020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b1ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b1f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b1f10>]}
17:14:58.494831 [debug] [MainThread]: Starter project path: /usr/local/lib/python3.9/site-packages/dbt/include/starter_project
17:15:39.315166 [info ] [MainThread]: Profile taxi_rides_ny written to /root/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
17:15:39.316545 [info ] [MainThread]: 
Your new dbt project "taxi_rides_ny" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

17:15:39.317586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c19310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c19730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c19940>]}


============================== 2024-02-10 06:45:47.754346 | cbd860ce-2d81-4aae-a0eb-a406e3e4a043 ==============================
06:45:47.754346 [info ] [MainThread]: Running with dbt=1.0.9
06:45:47.756761 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
06:45:47.757182 [debug] [MainThread]: Tracking: tracking
06:45:47.781619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b1070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b1f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b1f10>]}
06:45:48.137347 [debug] [MainThread]: Executing "git --help"
06:45:48.167734 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
06:45:48.168642 [debug] [MainThread]: STDERR: "b''"
06:45:48.169266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c46640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c467f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c46f70>]}


============================== 2024-02-10 06:46:14.816526 | 5686d8d9-c70b-4563-8303-098fbe0b046c ==============================
06:46:14.816526 [info ] [MainThread]: Running with dbt=1.0.9
06:46:14.818603 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
06:46:14.819093 [debug] [MainThread]: Tracking: tracking
06:46:14.838006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b1e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b1f40>]}
06:46:15.091508 [debug] [MainThread]: Executing "git --help"
06:46:15.114386 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
06:46:15.115262 [debug] [MainThread]: STDERR: "b''"
06:46:15.115871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c348b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c340a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c34cd0>]}


============================== 2024-02-10 06:48:03.835188 | 1ddcf476-dbb2-4b2f-b268-2f30040af7a7 ==============================
06:48:03.835188 [info ] [MainThread]: Running with dbt=1.0.9
06:48:03.837193 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
06:48:03.837546 [debug] [MainThread]: Tracking: tracking
06:48:03.854221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b1e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b1f40>]}
06:48:04.108998 [debug] [MainThread]: Executing "git --help"
06:48:04.130638 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
06:48:04.131464 [debug] [MainThread]: STDERR: "b''"
06:48:04.132105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c460a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c46580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c46820>]}


============================== 2024-02-10 06:48:44.697870 | 55053430-6859-4e82-af29-b1add1605d6f ==============================
06:48:44.697870 [info ] [MainThread]: Running with dbt=1.0.9
06:48:44.699913 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
06:48:44.700352 [debug] [MainThread]: Tracking: tracking
06:48:44.717118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b1040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b1f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b1f10>]}
06:48:44.977882 [debug] [MainThread]: Executing "git --help"
06:48:44.998762 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
06:48:44.999622 [debug] [MainThread]: STDERR: "b''"
06:48:45.007801 [debug] [MainThread]: Acquiring new bigquery connection "debug"
06:48:45.008604 [debug] [MainThread]: Opening a new connection, currently in state init
06:48:45.013377 [debug] [MainThread]: On debug: select 1 as id
06:48:46.471024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bff100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bfff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bffeb0>]}
06:48:47.744205 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-02-10 07:17:49.034621 | 9817e47d-10d8-4d84-9bc3-55d8a782c49d ==============================
07:17:49.034621 [info ] [MainThread]: Running with dbt=1.0.9
07:17:49.035925 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', resource_types=[], select=None, exclude=None, selector_name=None, state=None, threads=None, defer=None, full_refresh=False, cls=<class 'dbt.task.build.BuildTask'>, which='build', rpc_method='build')
07:17:49.036334 [debug] [MainThread]: Tracking: tracking
07:17:49.054355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c03760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c03640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c036a0>]}
07:17:49.071787 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
07:17:49.072240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9817e47d-10d8-4d84-9bc3-55d8a782c49d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c381c0>]}
07:17:49.091088 [debug] [MainThread]: Parsing macros/catalog.sql
07:17:49.100968 [debug] [MainThread]: Parsing macros/adapters.sql
07:17:49.123739 [debug] [MainThread]: Parsing macros/etc.sql
07:17:49.125709 [debug] [MainThread]: Parsing macros/materializations/table.sql
07:17:49.129681 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
07:17:49.144972 [debug] [MainThread]: Parsing macros/materializations/copy.sql
07:17:49.148027 [debug] [MainThread]: Parsing macros/materializations/seed.sql
07:17:49.150687 [debug] [MainThread]: Parsing macros/materializations/view.sql
07:17:49.153349 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
07:17:49.155118 [debug] [MainThread]: Parsing macros/etc/statement.sql
07:17:49.159529 [debug] [MainThread]: Parsing macros/etc/datetime.sql
07:17:49.167305 [debug] [MainThread]: Parsing macros/materializations/configs.sql
07:17:49.169487 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
07:17:49.174034 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
07:17:49.177101 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
07:17:49.184412 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
07:17:49.186594 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
07:17:49.187905 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
07:17:49.190436 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
07:17:49.197109 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
07:17:49.207458 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
07:17:49.216942 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
07:17:49.231523 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
07:17:49.235808 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
07:17:49.237310 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
07:17:49.253995 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
07:17:49.264777 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
07:17:49.266432 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
07:17:49.277556 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
07:17:49.279340 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
07:17:49.281168 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
07:17:49.285321 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
07:17:49.290913 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
07:17:49.305789 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
07:17:49.306572 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
07:17:49.307922 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
07:17:49.308829 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
07:17:49.309458 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
07:17:49.313537 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
07:17:49.320018 [debug] [MainThread]: Parsing macros/adapters/relation.sql
07:17:49.328449 [debug] [MainThread]: Parsing macros/adapters/schema.sql
07:17:49.330479 [debug] [MainThread]: Parsing macros/adapters/columns.sql
07:17:49.339432 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
07:17:49.342113 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
07:17:49.344635 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
07:17:49.346994 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
07:17:49.348504 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
07:17:49.350025 [debug] [MainThread]: Parsing tests/generic/builtin.sql
07:17:49.534783 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxi_rides_ny.example

07:17:49.539682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9817e47d-10d8-4d84-9bc3-55d8a782c49d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b340d0>]}
07:17:49.547099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9817e47d-10d8-4d84-9bc3-55d8a782c49d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b344f0>]}
07:17:49.547841 [info ] [MainThread]: Found 0 models, 0 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:17:49.549698 [info ] [MainThread]: 
07:17:49.550194 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
07:17:49.555126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c4a6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c384c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b46700>]}


============================== 2024-02-10 07:18:06.631220 | 4bbc72f4-a7be-47f0-ae19-7b29b6f455e2 ==============================
07:18:06.631220 [info ] [MainThread]: Running with dbt=1.0.9
07:18:06.632153 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', resource_types=[], select=None, exclude=None, selector_name=None, state=None, threads=None, defer=None, full_refresh=False, cls=<class 'dbt.task.build.BuildTask'>, which='build', rpc_method='build')
07:18:06.632796 [debug] [MainThread]: Tracking: tracking
07:18:06.651920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c10730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c10640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c106a0>]}
07:18:06.684613 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
07:18:06.685056 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
07:18:06.685401 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxi_rides_ny.example

07:18:06.692317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bbc72f4-a7be-47f0-ae19-7b29b6f455e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ade0d0>]}
07:18:06.700503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4bbc72f4-a7be-47f0-ae19-7b29b6f455e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b2fd90>]}
07:18:06.700966 [info ] [MainThread]: Found 0 models, 0 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:18:06.702157 [info ] [MainThread]: 
07:18:06.702588 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
07:18:06.707330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b2fc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b2fd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b2fcd0>]}


============================== 2024-02-10 07:18:59.617576 | 72e51bb6-b520-4606-b98f-0d07fab4a757 ==============================
07:18:59.617576 [info ] [MainThread]: Running with dbt=1.0.9
07:18:59.618581 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
07:18:59.619147 [debug] [MainThread]: Tracking: tracking
07:18:59.636927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c04670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c046d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c04610>]}
07:18:59.669780 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
07:18:59.670225 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
07:18:59.670581 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxi_rides_ny.example

07:18:59.677417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72e51bb6-b520-4606-b98f-0d07fab4a757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ade0d0>]}
07:18:59.685558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72e51bb6-b520-4606-b98f-0d07fab4a757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b2ffd0>]}
07:18:59.686069 [info ] [MainThread]: Found 0 models, 0 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:18:59.687422 [info ] [MainThread]: 
07:18:59.687848 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
07:18:59.692642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b2ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b2ffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6e430>]}


============================== 2024-02-10 07:19:19.702192 | c4fa437a-14b1-4d13-bfc4-3c397ee584f8 ==============================
07:19:19.702192 [info ] [MainThread]: Running with dbt=1.0.9
07:19:19.703253 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
07:19:19.703777 [debug] [MainThread]: Tracking: tracking
07:19:19.723223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c058e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c057f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c05850>]}
07:19:19.760328 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
07:19:19.760768 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
07:19:19.761142 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxi_rides_ny.example

07:19:19.768583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4fa437a-14b1-4d13-bfc4-3c397ee584f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c1fd90>]}
07:19:19.776485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4fa437a-14b1-4d13-bfc4-3c397ee584f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b72a00>]}
07:19:19.776916 [info ] [MainThread]: Found 0 models, 0 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:19:19.778098 [info ] [MainThread]: 
07:19:19.778608 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
07:19:19.783330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b56040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b56070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b72640>]}


============================== 2024-02-10 07:19:41.820836 | 8da5af24-7868-4d60-9905-09dc59878b03 ==============================
07:19:41.820836 [info ] [MainThread]: Running with dbt=1.0.9
07:19:41.822804 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
07:19:41.823235 [debug] [MainThread]: Tracking: tracking
07:19:41.841226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b2e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b2fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b2f40>]}
07:19:42.104269 [debug] [MainThread]: Executing "git --help"
07:19:42.128253 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
07:19:42.129160 [debug] [MainThread]: STDERR: "b''"
07:19:42.135223 [debug] [MainThread]: Acquiring new bigquery connection "debug"
07:19:42.136049 [debug] [MainThread]: Opening a new connection, currently in state init
07:19:42.141374 [debug] [MainThread]: On debug: select 1 as id
07:19:43.562916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bff100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bff2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bff370>]}
07:19:44.736344 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-02-10 07:22:20.037218 | 941a4644-2548-4097-8522-32cb5bd8a8d6 ==============================
07:22:20.037218 [info ] [MainThread]: Running with dbt=1.0.9
07:22:20.038512 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', resource_types=[], select=None, exclude=None, selector_name=None, state=None, threads=None, defer=None, full_refresh=False, cls=<class 'dbt.task.build.BuildTask'>, which='build', rpc_method='build')
07:22:20.038904 [debug] [MainThread]: Tracking: tracking
07:22:20.056846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c06fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c06eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c06f40>]}
07:22:20.093277 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
07:22:20.093726 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
07:22:20.094080 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxi_rides_ny.example

07:22:20.101585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '941a4644-2548-4097-8522-32cb5bd8a8d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c06970>]}
07:22:20.110206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '941a4644-2548-4097-8522-32cb5bd8a8d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b31ca0>]}
07:22:20.110777 [info ] [MainThread]: Found 0 models, 0 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:22:20.112261 [info ] [MainThread]: 
07:22:20.112727 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
07:22:20.118528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b31790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b31d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b31eb0>]}


============================== 2024-02-10 07:27:27.849481 | af36f4e2-d32a-42ea-b6b1-dd94f83e347e ==============================
07:27:27.849481 [info ] [MainThread]: Running with dbt=1.0.9
07:27:27.850501 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', resource_types=[], select=['stg_yellow_trip_data'], exclude=None, selector_name=None, state=None, threads=None, defer=None, full_refresh=False, cls=<class 'dbt.task.build.BuildTask'>, which='build', rpc_method='build')
07:27:27.851010 [debug] [MainThread]: Tracking: tracking
07:27:27.871355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c087c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c08820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c08790>]}
07:27:27.909216 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
07:27:27.909643 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
07:27:27.910023 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxi_rides_ny.example

07:27:27.917576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af36f4e2-d32a-42ea-b6b1-dd94f83e347e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9adf0d0>]}
07:27:27.927258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af36f4e2-d32a-42ea-b6b1-dd94f83e347e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b30b20>]}
07:27:27.927736 [info ] [MainThread]: Found 0 models, 0 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:27:27.928380 [warn ] [MainThread]: The selection criterion 'stg_yellow_trip_data' does not match any nodes
07:27:27.929314 [info ] [MainThread]: 
07:27:27.929694 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
07:27:27.935029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b30fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b30ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b6c520>]}


============================== 2024-02-10 07:27:38.293870 | 79bdff38-a827-48ac-b9f0-65d073519b94 ==============================
07:27:38.293870 [info ] [MainThread]: Running with dbt=1.0.9
07:27:38.294901 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', resource_types=[], select=None, exclude=None, selector_name=None, state=None, threads=None, defer=None, full_refresh=False, cls=<class 'dbt.task.build.BuildTask'>, which='build', rpc_method='build')
07:27:38.295313 [debug] [MainThread]: Tracking: tracking
07:27:38.313048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c13730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c13640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c136a0>]}
07:27:38.344259 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
07:27:38.344837 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
07:27:38.345237 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxi_rides_ny.example

07:27:38.352096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79bdff38-a827-48ac-b9f0-65d073519b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c13250>]}
07:27:38.362003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79bdff38-a827-48ac-b9f0-65d073519b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b30d30>]}
07:27:38.362544 [info ] [MainThread]: Found 0 models, 0 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:27:38.363904 [info ] [MainThread]: 
07:27:38.364337 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
07:27:38.369251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b30790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b30c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b30c70>]}


============================== 2024-02-10 07:36:55.665281 | 88c431fd-72ba-4980-a5fd-4c389c657fb8 ==============================
07:36:55.665281 [info ] [MainThread]: Running with dbt=1.0.9
07:36:55.666462 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=True, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
07:36:55.667018 [debug] [MainThread]: Tracking: tracking
07:36:55.684785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c06820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c06730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c06790>]}
07:36:55.719083 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
07:36:55.719499 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
07:36:55.719934 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxi_rides_ny.example

07:36:55.727818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88c431fd-72ba-4980-a5fd-4c389c657fb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c198e0>]}
07:36:55.737256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88c431fd-72ba-4980-a5fd-4c389c657fb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b72940>]}
07:36:55.737802 [info ] [MainThread]: Found 0 models, 0 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:36:55.739122 [info ] [MainThread]: 
07:36:55.739486 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
07:36:55.744490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b725b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b72670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b72790>]}


============================== 2024-02-10 07:41:04.183266 | 193a1630-1d8b-41a4-9934-e8a665d0a15c ==============================
07:41:04.183266 [info ] [MainThread]: Running with dbt=1.0.9
07:41:04.184202 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', resource_types=[], select=None, exclude=None, selector_name=None, state=None, threads=None, defer=None, full_refresh=False, cls=<class 'dbt.task.build.BuildTask'>, which='build', rpc_method='build')
07:41:04.184627 [debug] [MainThread]: Tracking: tracking
07:41:04.204730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c10730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c10640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c106a0>]}
07:41:04.227505 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
07:41:04.228119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '193a1630-1d8b-41a4-9934-e8a665d0a15c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c34340>]}
07:41:04.251146 [debug] [MainThread]: Parsing macros/catalog.sql
07:41:04.260274 [debug] [MainThread]: Parsing macros/adapters.sql
07:41:04.282380 [debug] [MainThread]: Parsing macros/etc.sql
07:41:04.284492 [debug] [MainThread]: Parsing macros/materializations/table.sql
07:41:04.288375 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
07:41:04.302365 [debug] [MainThread]: Parsing macros/materializations/copy.sql
07:41:04.304876 [debug] [MainThread]: Parsing macros/materializations/seed.sql
07:41:04.307221 [debug] [MainThread]: Parsing macros/materializations/view.sql
07:41:04.309619 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
07:41:04.311174 [debug] [MainThread]: Parsing macros/etc/statement.sql
07:41:04.315342 [debug] [MainThread]: Parsing macros/etc/datetime.sql
07:41:04.323015 [debug] [MainThread]: Parsing macros/materializations/configs.sql
07:41:04.325344 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
07:41:04.328895 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
07:41:04.331512 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
07:41:04.338499 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
07:41:04.340650 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
07:41:04.341941 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
07:41:04.344508 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
07:41:04.351083 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
07:41:04.361347 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
07:41:04.370793 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
07:41:04.385491 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
07:41:04.389987 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
07:41:04.391615 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
07:41:04.406947 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
07:41:04.417325 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
07:41:04.418921 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
07:41:04.429851 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
07:41:04.431620 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
07:41:04.433368 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
07:41:04.437564 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
07:41:04.443149 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
07:41:04.457980 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
07:41:04.458750 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
07:41:04.460119 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
07:41:04.461048 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
07:41:04.461681 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
07:41:04.465637 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
07:41:04.472079 [debug] [MainThread]: Parsing macros/adapters/relation.sql
07:41:04.480352 [debug] [MainThread]: Parsing macros/adapters/schema.sql
07:41:04.482360 [debug] [MainThread]: Parsing macros/adapters/columns.sql
07:41:04.491225 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
07:41:04.493889 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
07:41:04.496380 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
07:41:04.498666 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
07:41:04.500201 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
07:41:04.501759 [debug] [MainThread]: Parsing tests/generic/builtin.sql
07:41:04.680542 [debug] [MainThread]: 1603: static parser failed on staging/stg_yellow_trip_data.sql
07:41:04.691387 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_yellow_trip_data.sql
07:41:04.720731 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
07:41:04.723468 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
07:41:04.769642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '193a1630-1d8b-41a4-9934-e8a665d0a15c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff86820d0>]}
07:41:04.778173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '193a1630-1d8b-41a4-9934-e8a665d0a15c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff86821f0>]}
07:41:04.778614 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 188 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:41:04.780250 [info ] [MainThread]: 
07:41:04.780892 [debug] [MainThread]: Acquiring new bigquery connection "master"
07:41:04.782711 [debug] [ThreadPool]: Acquiring new bigquery connection "list_de-zoomcamp-413815"
07:41:04.783172 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:41:05.812109 [debug] [ThreadPool]: Acquiring new bigquery connection "list_de-zoomcamp-413815_trips_all_data"
07:41:05.814298 [debug] [ThreadPool]: Opening a new connection, currently in state closed
07:41:06.431573 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
07:41:06.432599 [info ] [MainThread]: 
07:41:06.464691 [debug] [Thread-1  ]: Began running node model.taxi_rides_ny.my_first_dbt_model
07:41:06.465010 [debug] [Thread-2  ]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
07:41:06.465600 [info ] [Thread-1  ]: 1 of 7 START table model trips_all_data.my_first_dbt_model...................... [RUN]
07:41:06.466345 [info ] [Thread-2  ]: 2 of 7 START view model trips_all_data.stg_yellow_trip_data..................... [RUN]
07:41:06.467125 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.taxi_rides_ny.my_first_dbt_model"
07:41:06.467917 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.taxi_rides_ny.stg_yellow_trip_data"
07:41:06.468364 [debug] [Thread-1  ]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
07:41:06.468794 [debug] [Thread-2  ]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
07:41:06.469222 [debug] [Thread-1  ]: Compiling model.taxi_rides_ny.my_first_dbt_model
07:41:06.469650 [debug] [Thread-2  ]: Compiling model.taxi_rides_ny.stg_yellow_trip_data
07:41:06.472812 [debug] [Thread-1  ]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
07:41:06.475161 [debug] [Thread-2  ]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
07:41:06.479018 [debug] [Thread-1  ]: finished collecting timing info
07:41:06.479245 [debug] [Thread-2  ]: finished collecting timing info
07:41:06.479561 [debug] [Thread-1  ]: Began executing node model.taxi_rides_ny.my_first_dbt_model
07:41:06.479834 [debug] [Thread-2  ]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
07:41:06.530330 [debug] [Thread-1  ]: Writing runtime SQL for node "model.taxi_rides_ny.my_first_dbt_model"
07:41:06.531578 [debug] [Thread-2  ]: Writing runtime SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
07:41:06.534593 [debug] [Thread-2  ]: Opening a new connection, currently in state init
07:41:06.534900 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:41:06.536382 [debug] [Thread-2  ]: On model.taxi_rides_ny.stg_yellow_trip_data: /* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`trips_all_data`.`stg_yellow_trip_data`
  OPTIONS()
  as with

sources as(
    select * from ('staging', 'yellow_trip_data')
)

select * from sources;


07:41:06.566513 [debug] [Thread-1  ]: On model.taxi_rides_ny.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_first_dbt_model"} */


  create or replace table `de-zoomcamp-413815`.`trips_all_data`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
07:41:07.441543 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Syntax error: Unexpected string literal 'staging' at [9:20]")
07:41:08.620549 [debug] [Thread-2  ]: finished collecting timing info
07:41:08.625477 [debug] [Thread-2  ]: Database Error in model stg_yellow_trip_data (taxi_rides_ny/models/staging/stg_yellow_trip_data.sql)
  Syntax error: Unexpected string literal 'staging' at [9:20]
  compiled SQL at target/run/taxi_rides_ny/taxi_rides_ny/models/staging/stg_yellow_trip_data.sql
07:41:08.628079 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '193a1630-1d8b-41a4-9934-e8a665d0a15c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8526e50>]}
07:41:08.630462 [error] [Thread-2  ]: 2 of 7 ERROR creating view model trips_all_data.stg_yellow_trip_data............ [[31mERROR[0m in 2.16s]
07:41:08.633394 [debug] [Thread-2  ]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
07:41:10.747178 [debug] [Thread-1  ]: finished collecting timing info
07:41:10.749842 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '193a1630-1d8b-41a4-9934-e8a665d0a15c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff858ebb0>]}
07:41:10.751220 [info ] [Thread-1  ]: 1 of 7 OK created table model trips_all_data.my_first_dbt_model................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 4.28s]
07:41:10.752401 [debug] [Thread-1  ]: Finished running node model.taxi_rides_ny.my_first_dbt_model
07:41:10.756779 [debug] [Thread-4  ]: Began running node test.taxi_rides_ny.not_null_my_first_dbt_model_id.5fb22c2710
07:41:10.757166 [debug] [Thread-3  ]: Began running node test.taxi_rides_ny.unique_my_first_dbt_model_id.16e066b321
07:41:10.757948 [info ] [Thread-4  ]: 3 of 7 START test not_null_my_first_dbt_model_id................................ [RUN]
07:41:10.758708 [info ] [Thread-3  ]: 4 of 7 START test unique_my_first_dbt_model_id.................................. [RUN]
07:41:10.760022 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.taxi_rides_ny.not_null_my_first_dbt_model_id.5fb22c2710"
07:41:10.761257 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.taxi_rides_ny.unique_my_first_dbt_model_id.16e066b321"
07:41:10.761785 [debug] [Thread-4  ]: Began compiling node test.taxi_rides_ny.not_null_my_first_dbt_model_id.5fb22c2710
07:41:10.762371 [debug] [Thread-3  ]: Began compiling node test.taxi_rides_ny.unique_my_first_dbt_model_id.16e066b321
07:41:10.763088 [debug] [Thread-4  ]: Compiling test.taxi_rides_ny.not_null_my_first_dbt_model_id.5fb22c2710
07:41:10.763657 [debug] [Thread-3  ]: Compiling test.taxi_rides_ny.unique_my_first_dbt_model_id.16e066b321
07:41:10.784978 [debug] [Thread-4  ]: Writing injected SQL for node "test.taxi_rides_ny.not_null_my_first_dbt_model_id.5fb22c2710"
07:41:10.799918 [debug] [Thread-3  ]: Writing injected SQL for node "test.taxi_rides_ny.unique_my_first_dbt_model_id.16e066b321"
07:41:10.801514 [debug] [Thread-4  ]: finished collecting timing info
07:41:10.801801 [debug] [Thread-3  ]: finished collecting timing info
07:41:10.801975 [debug] [Thread-4  ]: Began executing node test.taxi_rides_ny.not_null_my_first_dbt_model_id.5fb22c2710
07:41:10.802353 [debug] [Thread-3  ]: Began executing node test.taxi_rides_ny.unique_my_first_dbt_model_id.16e066b321
07:41:10.848894 [debug] [Thread-4  ]: Writing runtime SQL for node "test.taxi_rides_ny.not_null_my_first_dbt_model_id.5fb22c2710"
07:41:10.850290 [debug] [Thread-3  ]: Writing runtime SQL for node "test.taxi_rides_ny.unique_my_first_dbt_model_id.16e066b321"
07:41:10.852285 [debug] [Thread-4  ]: Opening a new connection, currently in state init
07:41:10.852447 [debug] [Thread-3  ]: Opening a new connection, currently in state init
07:41:10.854163 [debug] [Thread-4  ]: On test.taxi_rides_ny.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `de-zoomcamp-413815`.`trips_all_data`.`my_first_dbt_model`
where id is null



      
    ) dbt_internal_test
07:41:10.883324 [debug] [Thread-3  ]: On test.taxi_rides_ny.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select id as unique_field
  from `de-zoomcamp-413815`.`trips_all_data`.`my_first_dbt_model`
  where id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
07:41:12.085526 [debug] [Thread-3  ]: finished collecting timing info
07:41:12.087871 [info ] [Thread-3  ]: 4 of 7 PASS unique_my_first_dbt_model_id........................................ [[32mPASS[0m in 1.33s]
07:41:12.089597 [debug] [Thread-3  ]: Finished running node test.taxi_rides_ny.unique_my_first_dbt_model_id.16e066b321
07:41:12.200670 [debug] [Thread-4  ]: finished collecting timing info
07:41:12.204535 [error] [Thread-4  ]: 3 of 7 FAIL 1 not_null_my_first_dbt_model_id.................................... [[31mFAIL 1[0m in 1.44s]
07:41:12.206708 [debug] [Thread-4  ]: Finished running node test.taxi_rides_ny.not_null_my_first_dbt_model_id.5fb22c2710
07:41:12.209017 [debug] [Thread-1  ]: Began running node model.taxi_rides_ny.my_second_dbt_model
07:41:12.210321 [info ] [Thread-1  ]: 5 of 7 SKIP relation trips_all_data.my_second_dbt_model......................... [[33mSKIP[0m]
07:41:12.211502 [debug] [Thread-1  ]: Finished running node model.taxi_rides_ny.my_second_dbt_model
07:41:12.213582 [debug] [Thread-3  ]: Began running node test.taxi_rides_ny.not_null_my_second_dbt_model_id.151b76d778
07:41:12.213950 [debug] [Thread-4  ]: Began running node test.taxi_rides_ny.unique_my_second_dbt_model_id.57a0f8c493
07:41:12.214746 [info ] [Thread-3  ]: 6 of 7 SKIP test not_null_my_second_dbt_model_id................................ [[33mSKIP[0m]
07:41:12.215712 [info ] [Thread-4  ]: 7 of 7 SKIP test unique_my_second_dbt_model_id.................................. [[33mSKIP[0m]
07:41:12.216751 [debug] [Thread-3  ]: Finished running node test.taxi_rides_ny.not_null_my_second_dbt_model_id.151b76d778
07:41:12.217737 [debug] [Thread-4  ]: Finished running node test.taxi_rides_ny.unique_my_second_dbt_model_id.57a0f8c493
07:41:12.222797 [debug] [MainThread]: Acquiring new bigquery connection "master"
07:41:12.224610 [info ] [MainThread]: 
07:41:12.225845 [info ] [MainThread]: Finished running 2 view models, 1 table model, 4 tests in 7.44s.
07:41:12.226728 [debug] [MainThread]: Connection 'master' was properly closed.
07:41:12.227380 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_first_dbt_model' was properly closed.
07:41:12.228019 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_yellow_trip_data' was properly closed.
07:41:12.228574 [debug] [MainThread]: Connection 'test.taxi_rides_ny.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
07:41:12.229080 [debug] [MainThread]: Connection 'test.taxi_rides_ny.unique_my_first_dbt_model_id.16e066b321' was properly closed.
07:41:12.240886 [info ] [MainThread]: 
07:41:12.241931 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
07:41:12.243094 [info ] [MainThread]: 
07:41:12.243892 [error] [MainThread]: [33mDatabase Error in model stg_yellow_trip_data (taxi_rides_ny/models/staging/stg_yellow_trip_data.sql)[0m
07:41:12.244542 [error] [MainThread]:   Syntax error: Unexpected string literal 'staging' at [9:20]
07:41:12.245102 [error] [MainThread]:   compiled SQL at target/run/taxi_rides_ny/taxi_rides_ny/models/staging/stg_yellow_trip_data.sql
07:41:12.245684 [info ] [MainThread]: 
07:41:12.246225 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (taxi_rides_ny/models/staging/schema.yml)[0m
07:41:12.246798 [error] [MainThread]:   Got 1 result, configured to fail if != 0
07:41:12.247460 [info ] [MainThread]: 
07:41:12.248051 [info ] [MainThread]:   compiled SQL at target/compiled/taxi_rides_ny/taxi_rides_ny/models/staging/schema.yml/not_null_my_first_dbt_model_id.sql
07:41:12.248736 [info ] [MainThread]: 
07:41:12.249393 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=3 TOTAL=7
07:41:12.250114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb95d8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb95d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffef0a0a0>]}


============================== 2024-02-10 07:45:29.845056 | fe095d9a-5f1c-4f2f-97fe-1eba85ff1be7 ==============================
07:45:29.845056 [info ] [MainThread]: Running with dbt=1.0.9
07:45:29.846139 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', resource_types=[], select=None, exclude=None, selector_name=None, state=None, threads=None, defer=None, full_refresh=False, cls=<class 'dbt.task.build.BuildTask'>, which='build', rpc_method='build')
07:45:29.846581 [debug] [MainThread]: Tracking: tracking
07:45:29.866210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c05760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c05850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c057f0>]}
07:45:29.889106 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
07:45:29.889702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fe095d9a-5f1c-4f2f-97fe-1eba85ff1be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c38d30>]}
07:45:29.914944 [debug] [MainThread]: Parsing taxi_rides_ny/macros/generate_schema_name.sql
07:45:29.916827 [debug] [MainThread]: Parsing macros/catalog.sql
07:45:29.924180 [debug] [MainThread]: Parsing macros/adapters.sql
07:45:29.945666 [debug] [MainThread]: Parsing macros/etc.sql
07:45:29.947670 [debug] [MainThread]: Parsing macros/materializations/table.sql
07:45:29.951577 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
07:45:29.965512 [debug] [MainThread]: Parsing macros/materializations/copy.sql
07:45:29.968033 [debug] [MainThread]: Parsing macros/materializations/seed.sql
07:45:29.970386 [debug] [MainThread]: Parsing macros/materializations/view.sql
07:45:29.972789 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
07:45:29.974348 [debug] [MainThread]: Parsing macros/etc/statement.sql
07:45:29.978436 [debug] [MainThread]: Parsing macros/etc/datetime.sql
07:45:29.986074 [debug] [MainThread]: Parsing macros/materializations/configs.sql
07:45:29.988241 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
07:45:29.991746 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
07:45:29.994448 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
07:45:30.001784 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
07:45:30.004191 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
07:45:30.005542 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
07:45:30.008081 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
07:45:30.014681 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
07:45:30.025065 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
07:45:30.034512 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
07:45:30.048884 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
07:45:30.053001 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
07:45:30.054519 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
07:45:30.069611 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
07:45:30.079909 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
07:45:30.081526 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
07:45:30.092489 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
07:45:30.094197 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
07:45:30.095963 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
07:45:30.100401 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
07:45:30.106369 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
07:45:30.122295 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
07:45:30.123407 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
07:45:30.124890 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
07:45:30.125907 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
07:45:30.126623 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
07:45:30.130994 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
07:45:30.138014 [debug] [MainThread]: Parsing macros/adapters/relation.sql
07:45:30.146642 [debug] [MainThread]: Parsing macros/adapters/schema.sql
07:45:30.148679 [debug] [MainThread]: Parsing macros/adapters/columns.sql
07:45:30.157798 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
07:45:30.160504 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
07:45:30.163005 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
07:45:30.165302 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
07:45:30.166795 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
07:45:30.168333 [debug] [MainThread]: Parsing tests/generic/builtin.sql
07:45:30.346659 [debug] [MainThread]: 1603: static parser failed on staging/stg_yellow_trip_data.sql
07:45:30.356009 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_yellow_trip_data.sql
07:45:30.385941 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
07:45:30.388755 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
07:45:30.436070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe095d9a-5f1c-4f2f-97fe-1eba85ff1be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff866cf10>]}
07:45:30.444309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe095d9a-5f1c-4f2f-97fe-1eba85ff1be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8686730>]}
07:45:30.444766 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 189 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:45:30.446344 [info ] [MainThread]: 
07:45:30.447000 [debug] [MainThread]: Acquiring new bigquery connection "master"
07:45:30.448733 [debug] [ThreadPool]: Acquiring new bigquery connection "list_de-zoomcamp-413815"
07:45:30.449211 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:45:31.503701 [debug] [ThreadPool]: Acquiring new bigquery connection "list_de-zoomcamp-413815_trips_all_data"
07:45:31.505374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
07:45:32.113749 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
07:45:32.117345 [info ] [MainThread]: 
07:45:32.156640 [debug] [Thread-1  ]: Began running node model.taxi_rides_ny.my_first_dbt_model
07:45:32.157021 [debug] [Thread-2  ]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
07:45:32.157706 [info ] [Thread-1  ]: 1 of 7 START table model trips_all_data.my_first_dbt_model...................... [RUN]
07:45:32.158609 [info ] [Thread-2  ]: 2 of 7 START view model trips_all_data.stg_yellow_trip_data..................... [RUN]
07:45:32.159835 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.taxi_rides_ny.my_first_dbt_model"
07:45:32.160739 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.taxi_rides_ny.stg_yellow_trip_data"
07:45:32.161325 [debug] [Thread-1  ]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
07:45:32.161901 [debug] [Thread-2  ]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
07:45:32.162464 [debug] [Thread-1  ]: Compiling model.taxi_rides_ny.my_first_dbt_model
07:45:32.162886 [debug] [Thread-2  ]: Compiling model.taxi_rides_ny.stg_yellow_trip_data
07:45:32.166526 [debug] [Thread-1  ]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
07:45:32.169323 [debug] [Thread-2  ]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
07:45:32.171735 [debug] [Thread-2  ]: finished collecting timing info
07:45:32.171893 [debug] [Thread-1  ]: finished collecting timing info
07:45:32.172271 [debug] [Thread-2  ]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
07:45:32.172645 [debug] [Thread-1  ]: Began executing node model.taxi_rides_ny.my_first_dbt_model
07:45:32.210292 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:45:32.211712 [debug] [Thread-2  ]: Writing runtime SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
07:45:32.242297 [debug] [Thread-2  ]: Opening a new connection, currently in state init
07:45:32.244065 [debug] [Thread-2  ]: On model.taxi_rides_ny.stg_yellow_trip_data: /* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`trips_all_data`.`stg_yellow_trip_data`
  OPTIONS()
  as with

sources as(
    select * from ('staging', 'yellow_trip_data')
)

select * from sources;


07:45:32.869411 [debug] [Thread-1  ]: Writing runtime SQL for node "model.taxi_rides_ny.my_first_dbt_model"
07:45:32.872612 [debug] [Thread-1  ]: On model.taxi_rides_ny.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_first_dbt_model"} */


  create or replace table `de-zoomcamp-413815`.`trips_all_data`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
07:45:33.080463 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Syntax error: Unexpected string literal 'staging' at [9:20]")
07:45:33.881906 [debug] [Thread-2  ]: finished collecting timing info
07:45:33.890027 [debug] [Thread-2  ]: Database Error in model stg_yellow_trip_data (taxi_rides_ny/models/staging/stg_yellow_trip_data.sql)
  Syntax error: Unexpected string literal 'staging' at [9:20]
  compiled SQL at target/run/taxi_rides_ny/taxi_rides_ny/models/staging/stg_yellow_trip_data.sql
07:45:33.892262 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe095d9a-5f1c-4f2f-97fe-1eba85ff1be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff857bd00>]}
07:45:33.893956 [error] [Thread-2  ]: 2 of 7 ERROR creating view model trips_all_data.stg_yellow_trip_data............ [[31mERROR[0m in 1.73s]
07:45:33.896034 [debug] [Thread-2  ]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
07:45:34.983416 [debug] [Thread-1  ]: finished collecting timing info
07:45:34.985695 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe095d9a-5f1c-4f2f-97fe-1eba85ff1be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9afe070>]}
07:45:34.986812 [info ] [Thread-1  ]: 1 of 7 OK created table model trips_all_data.my_first_dbt_model................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.83s]
07:45:34.987814 [debug] [Thread-1  ]: Finished running node model.taxi_rides_ny.my_first_dbt_model
07:45:34.990726 [debug] [Thread-4  ]: Began running node test.taxi_rides_ny.not_null_my_first_dbt_model_id.5fb22c2710
07:45:34.991005 [debug] [Thread-3  ]: Began running node test.taxi_rides_ny.unique_my_first_dbt_model_id.16e066b321
07:45:34.991607 [info ] [Thread-4  ]: 3 of 7 START test not_null_my_first_dbt_model_id................................ [RUN]
07:45:34.992183 [info ] [Thread-3  ]: 4 of 7 START test unique_my_first_dbt_model_id.................................. [RUN]
07:45:34.993259 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.taxi_rides_ny.not_null_my_first_dbt_model_id.5fb22c2710"
07:45:34.994243 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.taxi_rides_ny.unique_my_first_dbt_model_id.16e066b321"
07:45:34.995054 [debug] [Thread-4  ]: Began compiling node test.taxi_rides_ny.not_null_my_first_dbt_model_id.5fb22c2710
07:45:34.995882 [debug] [Thread-3  ]: Began compiling node test.taxi_rides_ny.unique_my_first_dbt_model_id.16e066b321
07:45:34.996532 [debug] [Thread-4  ]: Compiling test.taxi_rides_ny.not_null_my_first_dbt_model_id.5fb22c2710
07:45:34.997129 [debug] [Thread-3  ]: Compiling test.taxi_rides_ny.unique_my_first_dbt_model_id.16e066b321
07:45:35.050999 [debug] [Thread-4  ]: Writing injected SQL for node "test.taxi_rides_ny.not_null_my_first_dbt_model_id.5fb22c2710"
07:45:35.056044 [debug] [Thread-3  ]: Writing injected SQL for node "test.taxi_rides_ny.unique_my_first_dbt_model_id.16e066b321"
07:45:35.058540 [debug] [Thread-4  ]: finished collecting timing info
07:45:35.058695 [debug] [Thread-3  ]: finished collecting timing info
07:45:35.058969 [debug] [Thread-4  ]: Began executing node test.taxi_rides_ny.not_null_my_first_dbt_model_id.5fb22c2710
07:45:35.059241 [debug] [Thread-3  ]: Began executing node test.taxi_rides_ny.unique_my_first_dbt_model_id.16e066b321
07:45:35.075211 [debug] [Thread-4  ]: Writing runtime SQL for node "test.taxi_rides_ny.not_null_my_first_dbt_model_id.5fb22c2710"
07:45:35.077194 [debug] [Thread-3  ]: Writing runtime SQL for node "test.taxi_rides_ny.unique_my_first_dbt_model_id.16e066b321"
07:45:35.079365 [debug] [Thread-4  ]: Opening a new connection, currently in state init
07:45:35.079534 [debug] [Thread-3  ]: Opening a new connection, currently in state init
07:45:35.081271 [debug] [Thread-4  ]: On test.taxi_rides_ny.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `de-zoomcamp-413815`.`trips_all_data`.`my_first_dbt_model`
where id is null



      
    ) dbt_internal_test
07:45:35.110983 [debug] [Thread-3  ]: On test.taxi_rides_ny.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select id as unique_field
  from `de-zoomcamp-413815`.`trips_all_data`.`my_first_dbt_model`
  where id is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
07:45:36.285900 [debug] [Thread-3  ]: finished collecting timing info
07:45:36.288419 [info ] [Thread-3  ]: 4 of 7 PASS unique_my_first_dbt_model_id........................................ [[32mPASS[0m in 1.29s]
07:45:36.289603 [debug] [Thread-3  ]: Finished running node test.taxi_rides_ny.unique_my_first_dbt_model_id.16e066b321
07:45:36.438755 [debug] [Thread-4  ]: finished collecting timing info
07:45:36.440222 [error] [Thread-4  ]: 3 of 7 FAIL 1 not_null_my_first_dbt_model_id.................................... [[31mFAIL 1[0m in 1.45s]
07:45:36.440965 [debug] [Thread-4  ]: Finished running node test.taxi_rides_ny.not_null_my_first_dbt_model_id.5fb22c2710
07:45:36.442221 [debug] [Thread-1  ]: Began running node model.taxi_rides_ny.my_second_dbt_model
07:45:36.442721 [info ] [Thread-1  ]: 5 of 7 SKIP relation trips_all_data.my_second_dbt_model......................... [[33mSKIP[0m]
07:45:36.443355 [debug] [Thread-1  ]: Finished running node model.taxi_rides_ny.my_second_dbt_model
07:45:36.444303 [debug] [Thread-3  ]: Began running node test.taxi_rides_ny.not_null_my_second_dbt_model_id.151b76d778
07:45:36.444662 [debug] [Thread-4  ]: Began running node test.taxi_rides_ny.unique_my_second_dbt_model_id.57a0f8c493
07:45:36.445051 [info ] [Thread-3  ]: 6 of 7 SKIP test not_null_my_second_dbt_model_id................................ [[33mSKIP[0m]
07:45:36.445492 [info ] [Thread-4  ]: 7 of 7 SKIP test unique_my_second_dbt_model_id.................................. [[33mSKIP[0m]
07:45:36.446061 [debug] [Thread-3  ]: Finished running node test.taxi_rides_ny.not_null_my_second_dbt_model_id.151b76d778
07:45:36.446645 [debug] [Thread-4  ]: Finished running node test.taxi_rides_ny.unique_my_second_dbt_model_id.57a0f8c493
07:45:36.449114 [debug] [MainThread]: Acquiring new bigquery connection "master"
07:45:36.449969 [info ] [MainThread]: 
07:45:36.450531 [info ] [MainThread]: Finished running 2 view models, 1 table model, 4 tests in 6.00s.
07:45:36.451312 [debug] [MainThread]: Connection 'master' was properly closed.
07:45:36.451782 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_first_dbt_model' was properly closed.
07:45:36.452291 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_yellow_trip_data' was properly closed.
07:45:36.452764 [debug] [MainThread]: Connection 'test.taxi_rides_ny.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
07:45:36.453137 [debug] [MainThread]: Connection 'test.taxi_rides_ny.unique_my_first_dbt_model_id.16e066b321' was properly closed.
07:45:36.460700 [info ] [MainThread]: 
07:45:36.461203 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
07:45:36.461719 [info ] [MainThread]: 
07:45:36.462109 [error] [MainThread]: [33mDatabase Error in model stg_yellow_trip_data (taxi_rides_ny/models/staging/stg_yellow_trip_data.sql)[0m
07:45:36.462552 [error] [MainThread]:   Syntax error: Unexpected string literal 'staging' at [9:20]
07:45:36.462986 [error] [MainThread]:   compiled SQL at target/run/taxi_rides_ny/taxi_rides_ny/models/staging/stg_yellow_trip_data.sql
07:45:36.463372 [info ] [MainThread]: 
07:45:36.463777 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (taxi_rides_ny/models/staging/schema.yml)[0m
07:45:36.464219 [error] [MainThread]:   Got 1 result, configured to fail if != 0
07:45:36.464669 [info ] [MainThread]: 
07:45:36.465073 [info ] [MainThread]:   compiled SQL at target/compiled/taxi_rides_ny/taxi_rides_ny/models/staging/schema.yml/not_null_my_first_dbt_model_id.sql
07:45:36.465586 [info ] [MainThread]: 
07:45:36.466082 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=3 TOTAL=7
07:45:36.466953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9af9d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9af9e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8562f40>]}


============================== 2024-02-10 07:47:04.417172 | 83525b4e-ddf5-4bd8-b17b-dd3c4dfd7b04 ==============================
07:47:04.417172 [info ] [MainThread]: Running with dbt=1.0.9
07:47:04.418160 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', resource_types=[], select=None, exclude=None, selector_name=None, state=None, threads=None, defer=None, full_refresh=False, cls=<class 'dbt.task.build.BuildTask'>, which='build', rpc_method='build')
07:47:04.418748 [debug] [MainThread]: Tracking: tracking
07:47:04.436705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c06ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c069d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c06a30>]}
07:47:04.480978 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
07:47:04.481786 [debug] [MainThread]: Partial parsing: update schema file: taxi_rides_ny://taxi_rides_ny/models/staging/schema.yml
07:47:04.527449 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
07:47:04.538663 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
07:47:04.561337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83525b4e-ddf5-4bd8-b17b-dd3c4dfd7b04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff86670d0>]}
07:47:04.570522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83525b4e-ddf5-4bd8-b17b-dd3c4dfd7b04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff86a7d60>]}
07:47:04.570964 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 189 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
07:47:04.572502 [info ] [MainThread]: 
07:47:04.573166 [debug] [MainThread]: Acquiring new bigquery connection "master"
07:47:04.574727 [debug] [ThreadPool]: Acquiring new bigquery connection "list_de-zoomcamp-413815"
07:47:04.575162 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:47:05.431334 [debug] [ThreadPool]: Acquiring new bigquery connection "list_de-zoomcamp-413815_trips_all_data"
07:47:05.432350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
07:47:06.021931 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
07:47:06.023868 [info ] [MainThread]: 
07:47:06.049791 [debug] [Thread-1  ]: Began running node model.taxi_rides_ny.my_first_dbt_model
07:47:06.050086 [debug] [Thread-2  ]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
07:47:06.050665 [info ] [Thread-1  ]: 1 of 3 START table model trips_all_data.my_first_dbt_model...................... [RUN]
07:47:06.051101 [info ] [Thread-2  ]: 2 of 3 START view model trips_all_data.stg_yellow_trip_data..................... [RUN]
07:47:06.051907 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.taxi_rides_ny.my_first_dbt_model"
07:47:06.052646 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.taxi_rides_ny.stg_yellow_trip_data"
07:47:06.052974 [debug] [Thread-1  ]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
07:47:06.053314 [debug] [Thread-2  ]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
07:47:06.053917 [debug] [Thread-1  ]: Compiling model.taxi_rides_ny.my_first_dbt_model
07:47:06.054268 [debug] [Thread-2  ]: Compiling model.taxi_rides_ny.stg_yellow_trip_data
07:47:06.056984 [debug] [Thread-1  ]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
07:47:06.059269 [debug] [Thread-2  ]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
07:47:06.061478 [debug] [Thread-1  ]: finished collecting timing info
07:47:06.061751 [debug] [Thread-2  ]: finished collecting timing info
07:47:06.062209 [debug] [Thread-1  ]: Began executing node model.taxi_rides_ny.my_first_dbt_model
07:47:06.062599 [debug] [Thread-2  ]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
07:47:06.079178 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:47:06.106053 [debug] [Thread-2  ]: Writing runtime SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
07:47:06.137399 [debug] [Thread-2  ]: Opening a new connection, currently in state init
07:47:06.139199 [debug] [Thread-2  ]: On model.taxi_rides_ny.stg_yellow_trip_data: /* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`trips_all_data`.`stg_yellow_trip_data`
  OPTIONS()
  as with

sources as(
    select * from ('staging', 'yellow_trip_data')
)

select * from sources;


07:47:06.772830 [debug] [Thread-1  ]: Writing runtime SQL for node "model.taxi_rides_ny.my_first_dbt_model"
07:47:06.775904 [debug] [Thread-1  ]: On model.taxi_rides_ny.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_first_dbt_model"} */


  create or replace table `de-zoomcamp-413815`.`trips_all_data`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
07:47:06.846609 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Syntax error: Unexpected string literal 'staging' at [9:20]")
07:47:07.527396 [debug] [Thread-2  ]: finished collecting timing info
07:47:07.529617 [debug] [Thread-2  ]: Database Error in model stg_yellow_trip_data (taxi_rides_ny/models/staging/stg_yellow_trip_data.sql)
  Syntax error: Unexpected string literal 'staging' at [9:20]
  compiled SQL at target/run/taxi_rides_ny/taxi_rides_ny/models/staging/stg_yellow_trip_data.sql
07:47:07.530570 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83525b4e-ddf5-4bd8-b17b-dd3c4dfd7b04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff85844c0>]}
07:47:07.531956 [error] [Thread-2  ]: 2 of 3 ERROR creating view model trips_all_data.stg_yellow_trip_data............ [[31mERROR[0m in 1.48s]
07:47:07.532858 [debug] [Thread-2  ]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
07:47:08.542151 [debug] [Thread-1  ]: finished collecting timing info
07:47:08.543429 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83525b4e-ddf5-4bd8-b17b-dd3c4dfd7b04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8562fa0>]}
07:47:08.544090 [info ] [Thread-1  ]: 1 of 3 OK created table model trips_all_data.my_first_dbt_model................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.49s]
07:47:08.544680 [debug] [Thread-1  ]: Finished running node model.taxi_rides_ny.my_first_dbt_model
07:47:08.546817 [debug] [Thread-4  ]: Began running node model.taxi_rides_ny.my_second_dbt_model
07:47:08.547339 [info ] [Thread-4  ]: 3 of 3 START view model trips_all_data.my_second_dbt_model...................... [RUN]
07:47:08.548006 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.taxi_rides_ny.my_second_dbt_model"
07:47:08.548425 [debug] [Thread-4  ]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
07:47:08.548778 [debug] [Thread-4  ]: Compiling model.taxi_rides_ny.my_second_dbt_model
07:47:08.557266 [debug] [Thread-4  ]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
07:47:08.558996 [debug] [Thread-4  ]: finished collecting timing info
07:47:08.559439 [debug] [Thread-4  ]: Began executing node model.taxi_rides_ny.my_second_dbt_model
07:47:08.562500 [debug] [Thread-4  ]: Writing runtime SQL for node "model.taxi_rides_ny.my_second_dbt_model"
07:47:08.563633 [debug] [Thread-4  ]: Opening a new connection, currently in state init
07:47:08.565693 [debug] [Thread-4  ]: On model.taxi_rides_ny.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_second_dbt_model"} */


  create or replace view `de-zoomcamp-413815`.`trips_all_data`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `de-zoomcamp-413815`.`trips_all_data`.`my_first_dbt_model`
where id = 1;


07:47:09.670140 [debug] [Thread-4  ]: finished collecting timing info
07:47:09.675048 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83525b4e-ddf5-4bd8-b17b-dd3c4dfd7b04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b05490>]}
07:47:09.677213 [info ] [Thread-4  ]: 3 of 3 OK created view model trips_all_data.my_second_dbt_model................. [[32mOK[0m in 1.13s]
07:47:09.681583 [debug] [Thread-4  ]: Finished running node model.taxi_rides_ny.my_second_dbt_model
07:47:09.686167 [debug] [MainThread]: Acquiring new bigquery connection "master"
07:47:09.687707 [info ] [MainThread]: 
07:47:09.688627 [info ] [MainThread]: Finished running 2 view models, 1 table model in 5.11s.
07:47:09.689660 [debug] [MainThread]: Connection 'master' was properly closed.
07:47:09.690453 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_first_dbt_model' was properly closed.
07:47:09.691141 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_yellow_trip_data' was properly closed.
07:47:09.691813 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_second_dbt_model' was properly closed.
07:47:09.709647 [info ] [MainThread]: 
07:47:09.710770 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
07:47:09.711714 [info ] [MainThread]: 
07:47:09.712457 [error] [MainThread]: [33mDatabase Error in model stg_yellow_trip_data (taxi_rides_ny/models/staging/stg_yellow_trip_data.sql)[0m
07:47:09.713441 [error] [MainThread]:   Syntax error: Unexpected string literal 'staging' at [9:20]
07:47:09.714581 [error] [MainThread]:   compiled SQL at target/run/taxi_rides_ny/taxi_rides_ny/models/staging/stg_yellow_trip_data.sql
07:47:09.715494 [info ] [MainThread]: 
07:47:09.716154 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
07:47:09.716950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c37790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c37cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff867d520>]}


============================== 2024-02-10 07:48:10.685185 | 7876de32-06d5-4f0b-bfda-3325afb6eced ==============================
07:48:10.685185 [info ] [MainThread]: Running with dbt=1.0.9
07:48:10.686154 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', resource_types=[], select=None, exclude=None, selector_name=None, state=None, threads=None, defer=None, full_refresh=False, cls=<class 'dbt.task.build.BuildTask'>, which='build', rpc_method='build')
07:48:10.686636 [debug] [MainThread]: Tracking: tracking
07:48:10.706958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c058e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c057f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c05850>]}
07:48:10.754069 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
07:48:10.754760 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://taxi_rides_ny/models/staging/stg_yellow_trip_data.sql
07:48:10.801339 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_yellow_trip_data.sql
07:48:10.812136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9adb700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9aec7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9aec790>]}


============================== 2024-02-10 07:48:44.685038 | c93d2244-7d7f-4d0c-894a-98e27ca13b4e ==============================
07:48:44.685038 [info ] [MainThread]: Running with dbt=1.0.9
07:48:44.686019 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', resource_types=[], select=None, exclude=None, selector_name=None, state=None, threads=None, defer=None, full_refresh=False, cls=<class 'dbt.task.build.BuildTask'>, which='build', rpc_method='build')
07:48:44.686508 [debug] [MainThread]: Tracking: tracking
07:48:44.704241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c057c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c056d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c05730>]}
07:48:44.748997 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
07:48:44.749737 [debug] [MainThread]: Partial parsing: deleted source source.taxi_rides_ny.staging.fhv_tripdata
07:48:44.750031 [debug] [MainThread]: Partial parsing: deleted source source.taxi_rides_ny.staging.yellow_tripdata
07:48:44.750337 [debug] [MainThread]: Partial parsing: deleted source source.taxi_rides_ny.staging.green_tripdata
07:48:44.750644 [debug] [MainThread]: Partial parsing: update schema file: taxi_rides_ny://taxi_rides_ny/models/staging/schema.yml
07:48:44.751052 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://taxi_rides_ny/models/staging/stg_yellow_trip_data.sql
07:48:44.795736 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_yellow_trip_data.sql
07:48:44.827777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c93d2244-7d7f-4d0c-894a-98e27ca13b4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff86610d0>]}
07:48:44.836389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c93d2244-7d7f-4d0c-894a-98e27ca13b4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b47c70>]}
07:48:44.836844 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 189 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
07:48:44.838355 [info ] [MainThread]: 
07:48:44.839004 [debug] [MainThread]: Acquiring new bigquery connection "master"
07:48:44.840531 [debug] [ThreadPool]: Acquiring new bigquery connection "list_de-zoomcamp-413815"
07:48:44.840988 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:48:45.723553 [debug] [ThreadPool]: Acquiring new bigquery connection "list_de-zoomcamp-413815_trips_all_data"
07:48:45.726209 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:48:46.365186 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
07:48:46.368150 [info ] [MainThread]: 
07:48:46.410631 [debug] [Thread-1  ]: Began running node model.taxi_rides_ny.my_first_dbt_model
07:48:46.411006 [debug] [Thread-2  ]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
07:48:46.411695 [info ] [Thread-1  ]: 1 of 3 START table model trips_all_data.my_first_dbt_model...................... [RUN]
07:48:46.412269 [info ] [Thread-2  ]: 2 of 3 START view model trips_all_data.stg_yellow_trip_data..................... [RUN]
07:48:46.413170 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.taxi_rides_ny.my_first_dbt_model"
07:48:46.414164 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.taxi_rides_ny.stg_yellow_trip_data"
07:48:46.414758 [debug] [Thread-1  ]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
07:48:46.415239 [debug] [Thread-2  ]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
07:48:46.416115 [debug] [Thread-1  ]: Compiling model.taxi_rides_ny.my_first_dbt_model
07:48:46.416726 [debug] [Thread-2  ]: Compiling model.taxi_rides_ny.stg_yellow_trip_data
07:48:46.420395 [debug] [Thread-1  ]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
07:48:46.423502 [debug] [Thread-2  ]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
07:48:46.425957 [debug] [Thread-1  ]: finished collecting timing info
07:48:46.426122 [debug] [Thread-2  ]: finished collecting timing info
07:48:46.426442 [debug] [Thread-1  ]: Began executing node model.taxi_rides_ny.my_first_dbt_model
07:48:46.426760 [debug] [Thread-2  ]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
07:48:46.443699 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:48:46.467166 [debug] [Thread-2  ]: Writing runtime SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
07:48:46.498361 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
07:48:46.500188 [debug] [Thread-2  ]: On model.taxi_rides_ny.stg_yellow_trip_data: /* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`trips_all_data`.`stg_yellow_trip_data`
  OPTIONS()
  as with

sources as(
    select * from `de-zoomcamp-413815`.`trips_all_data`.`yellow_trip_data` limit 20
)

select * from sources;


07:48:47.127521 [debug] [Thread-1  ]: Writing runtime SQL for node "model.taxi_rides_ny.my_first_dbt_model"
07:48:47.130560 [debug] [Thread-1  ]: On model.taxi_rides_ny.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_first_dbt_model"} */


  create or replace table `de-zoomcamp-413815`.`trips_all_data`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
07:48:47.273661 [debug] [Thread-2  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`trips_all_data`.`stg_yellow_trip_data`
  OPTIONS()
  as with

sources as(
    select * from `de-zoomcamp-413815`.`trips_all_data`.`yellow_trip_data` limit 20
)

select * from sources;


07:48:47.276553 [debug] [Thread-2  ]: BigQuery adapter: 404 Not found: Table de-zoomcamp-413815:trips_all_data.yellow_trip_data was not found in location asia-south1

Location: asia-south1
Job ID: ec46d603-5624-43ac-bbb9-520db3da8a5e

07:48:47.278368 [debug] [Thread-2  ]: finished collecting timing info
07:48:47.279827 [debug] [Thread-2  ]: Runtime Error in model stg_yellow_trip_data (taxi_rides_ny/models/staging/stg_yellow_trip_data.sql)
  404 Not found: Table de-zoomcamp-413815:trips_all_data.yellow_trip_data was not found in location asia-south1
  
  Location: asia-south1
  Job ID: ec46d603-5624-43ac-bbb9-520db3da8a5e
  
07:48:47.281082 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c93d2244-7d7f-4d0c-894a-98e27ca13b4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff857aa00>]}
07:48:47.282437 [error] [Thread-2  ]: 2 of 3 ERROR creating view model trips_all_data.stg_yellow_trip_data............ [[31mERROR[0m in 0.87s]
07:48:47.284557 [debug] [Thread-2  ]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
07:48:48.920409 [debug] [Thread-1  ]: finished collecting timing info
07:48:48.922650 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c93d2244-7d7f-4d0c-894a-98e27ca13b4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8553dc0>]}
07:48:48.923822 [info ] [Thread-1  ]: 1 of 3 OK created table model trips_all_data.my_first_dbt_model................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.51s]
07:48:48.924797 [debug] [Thread-1  ]: Finished running node model.taxi_rides_ny.my_first_dbt_model
07:48:48.927867 [debug] [Thread-4  ]: Began running node model.taxi_rides_ny.my_second_dbt_model
07:48:48.929391 [info ] [Thread-4  ]: 3 of 3 START view model trips_all_data.my_second_dbt_model...................... [RUN]
07:48:48.930455 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.taxi_rides_ny.my_second_dbt_model"
07:48:48.931103 [debug] [Thread-4  ]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
07:48:48.931705 [debug] [Thread-4  ]: Compiling model.taxi_rides_ny.my_second_dbt_model
07:48:48.935776 [debug] [Thread-4  ]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
07:48:48.938650 [debug] [Thread-4  ]: finished collecting timing info
07:48:48.939358 [debug] [Thread-4  ]: Began executing node model.taxi_rides_ny.my_second_dbt_model
07:48:48.948673 [debug] [Thread-4  ]: Writing runtime SQL for node "model.taxi_rides_ny.my_second_dbt_model"
07:48:48.951123 [debug] [Thread-4  ]: Opening a new connection, currently in state init
07:48:48.954750 [debug] [Thread-4  ]: On model.taxi_rides_ny.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_second_dbt_model"} */


  create or replace view `de-zoomcamp-413815`.`trips_all_data`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `de-zoomcamp-413815`.`trips_all_data`.`my_first_dbt_model`
where id = 1;


07:48:49.947131 [debug] [Thread-4  ]: finished collecting timing info
07:48:49.948827 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c93d2244-7d7f-4d0c-894a-98e27ca13b4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8523820>]}
07:48:49.949782 [info ] [Thread-4  ]: 3 of 3 OK created view model trips_all_data.my_second_dbt_model................. [[32mOK[0m in 1.02s]
07:48:49.950464 [debug] [Thread-4  ]: Finished running node model.taxi_rides_ny.my_second_dbt_model
07:48:49.953091 [debug] [MainThread]: Acquiring new bigquery connection "master"
07:48:49.953921 [info ] [MainThread]: 
07:48:49.954497 [info ] [MainThread]: Finished running 2 view models, 1 table model in 5.12s.
07:48:49.955208 [debug] [MainThread]: Connection 'master' was properly closed.
07:48:49.955824 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_yellow_trip_data' was properly closed.
07:48:49.956421 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_first_dbt_model' was properly closed.
07:48:49.956806 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_second_dbt_model' was properly closed.
07:48:49.967477 [info ] [MainThread]: 
07:48:49.968063 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
07:48:49.968579 [info ] [MainThread]: 
07:48:49.969067 [error] [MainThread]: [33mRuntime Error in model stg_yellow_trip_data (taxi_rides_ny/models/staging/stg_yellow_trip_data.sql)[0m
07:48:49.969513 [error] [MainThread]:   404 Not found: Table de-zoomcamp-413815:trips_all_data.yellow_trip_data was not found in location asia-south1
07:48:49.970072 [error] [MainThread]:   
07:48:49.970642 [error] [MainThread]:   Location: asia-south1
07:48:49.971096 [error] [MainThread]:   Job ID: ec46d603-5624-43ac-bbb9-520db3da8a5e
07:48:49.971634 [error] [MainThread]:   
07:48:49.972190 [info ] [MainThread]: 
07:48:49.972714 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
07:48:49.973332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8523d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8523c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8523310>]}


============================== 2024-02-10 07:49:41.125817 | 81ed6b17-89f9-49ed-9b3d-2136d082e99c ==============================
07:49:41.125817 [info ] [MainThread]: Running with dbt=1.0.9
07:49:41.126780 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', resource_types=[], select=None, exclude=None, selector_name=None, state=None, threads=None, defer=None, full_refresh=False, cls=<class 'dbt.task.build.BuildTask'>, which='build', rpc_method='build')
07:49:41.127308 [debug] [MainThread]: Tracking: tracking
07:49:41.145093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c06700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c067f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c06790>]}
07:49:41.188957 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
07:49:41.189647 [debug] [MainThread]: Partial parsing: deleted source source.taxi_rides_ny.staging.fhv_trip_data
07:49:41.190029 [debug] [MainThread]: Partial parsing: deleted source source.taxi_rides_ny.staging.yellow_trip_data
07:49:41.190283 [debug] [MainThread]: Partial parsing: deleted source source.taxi_rides_ny.staging.green_trip_data
07:49:41.190550 [debug] [MainThread]: Partial parsing: update schema file: taxi_rides_ny://taxi_rides_ny/models/staging/schema.yml
07:49:41.190900 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://taxi_rides_ny/models/staging/stg_yellow_trip_data.sql
07:49:41.235613 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_yellow_trip_data.sql
07:49:41.269417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81ed6b17-89f9-49ed-9b3d-2136d082e99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff86630d0>]}
07:49:41.278665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81ed6b17-89f9-49ed-9b3d-2136d082e99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b79e20>]}
07:49:41.279149 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 189 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
07:49:41.280663 [info ] [MainThread]: 
07:49:41.281341 [debug] [MainThread]: Acquiring new bigquery connection "master"
07:49:41.282920 [debug] [ThreadPool]: Acquiring new bigquery connection "list_de-zoomcamp-413815"
07:49:41.283381 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:49:42.135827 [debug] [ThreadPool]: Acquiring new bigquery connection "list_de-zoomcamp-413815_trips_all_data"
07:49:42.138058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
07:49:42.717956 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
07:49:42.720939 [info ] [MainThread]: 
07:49:42.766525 [debug] [Thread-1  ]: Began running node model.taxi_rides_ny.my_first_dbt_model
07:49:42.766956 [debug] [Thread-2  ]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
07:49:42.767699 [info ] [Thread-1  ]: 1 of 3 START table model trips_all_data.my_first_dbt_model...................... [RUN]
07:49:42.768162 [info ] [Thread-2  ]: 2 of 3 START view model trips_all_data.stg_yellow_trip_data..................... [RUN]
07:49:42.768893 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.taxi_rides_ny.my_first_dbt_model"
07:49:42.769881 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.taxi_rides_ny.stg_yellow_trip_data"
07:49:42.770466 [debug] [Thread-1  ]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
07:49:42.770965 [debug] [Thread-2  ]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
07:49:42.771819 [debug] [Thread-1  ]: Compiling model.taxi_rides_ny.my_first_dbt_model
07:49:42.772427 [debug] [Thread-2  ]: Compiling model.taxi_rides_ny.stg_yellow_trip_data
07:49:42.776335 [debug] [Thread-1  ]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
07:49:42.779859 [debug] [Thread-2  ]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
07:49:42.782228 [debug] [Thread-1  ]: finished collecting timing info
07:49:42.782444 [debug] [Thread-2  ]: finished collecting timing info
07:49:42.782828 [debug] [Thread-1  ]: Began executing node model.taxi_rides_ny.my_first_dbt_model
07:49:42.783225 [debug] [Thread-2  ]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
07:49:42.800730 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:49:42.825383 [debug] [Thread-2  ]: Writing runtime SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
07:49:42.857090 [debug] [Thread-2  ]: Opening a new connection, currently in state init
07:49:42.858951 [debug] [Thread-2  ]: On model.taxi_rides_ny.stg_yellow_trip_data: /* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`trips_all_data`.`stg_yellow_trip_data`
  OPTIONS()
  as with

sources as(
    select * from `de-zoomcamp-413815`.`trips_all_data`.`yello_trip_data` limit 20
)

select * from sources;


07:49:43.476687 [debug] [Thread-1  ]: Writing runtime SQL for node "model.taxi_rides_ny.my_first_dbt_model"
07:49:43.478915 [debug] [Thread-1  ]: On model.taxi_rides_ny.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_first_dbt_model"} */


  create or replace table `de-zoomcamp-413815`.`trips_all_data`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
07:49:43.822713 [debug] [Thread-2  ]: finished collecting timing info
07:49:43.823507 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81ed6b17-89f9-49ed-9b3d-2136d082e99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff85acc40>]}
07:49:43.823968 [info ] [Thread-2  ]: 2 of 3 OK created view model trips_all_data.stg_yellow_trip_data................ [[32mOK[0m in 1.05s]
07:49:43.824693 [debug] [Thread-2  ]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
07:49:46.748629 [debug] [Thread-1  ]: finished collecting timing info
07:49:46.753170 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81ed6b17-89f9-49ed-9b3d-2136d082e99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff857e8e0>]}
07:49:46.755774 [info ] [Thread-1  ]: 1 of 3 OK created table model trips_all_data.my_first_dbt_model................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.98s]
07:49:46.758629 [debug] [Thread-1  ]: Finished running node model.taxi_rides_ny.my_first_dbt_model
07:49:46.765544 [debug] [Thread-4  ]: Began running node model.taxi_rides_ny.my_second_dbt_model
07:49:46.767003 [info ] [Thread-4  ]: 3 of 3 START view model trips_all_data.my_second_dbt_model...................... [RUN]
07:49:46.768606 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.taxi_rides_ny.my_second_dbt_model"
07:49:46.769586 [debug] [Thread-4  ]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
07:49:46.770415 [debug] [Thread-4  ]: Compiling model.taxi_rides_ny.my_second_dbt_model
07:49:46.776498 [debug] [Thread-4  ]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
07:49:46.780748 [debug] [Thread-4  ]: finished collecting timing info
07:49:46.781584 [debug] [Thread-4  ]: Began executing node model.taxi_rides_ny.my_second_dbt_model
07:49:46.795725 [debug] [Thread-4  ]: Writing runtime SQL for node "model.taxi_rides_ny.my_second_dbt_model"
07:49:46.798257 [debug] [Thread-4  ]: Opening a new connection, currently in state init
07:49:46.801606 [debug] [Thread-4  ]: On model.taxi_rides_ny.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_second_dbt_model"} */


  create or replace view `de-zoomcamp-413815`.`trips_all_data`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `de-zoomcamp-413815`.`trips_all_data`.`my_first_dbt_model`
where id = 1;


07:49:47.850351 [debug] [Thread-4  ]: finished collecting timing info
07:49:47.854410 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81ed6b17-89f9-49ed-9b3d-2136d082e99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff855dbe0>]}
07:49:47.856582 [info ] [Thread-4  ]: 3 of 3 OK created view model trips_all_data.my_second_dbt_model................. [[32mOK[0m in 1.09s]
07:49:47.857908 [debug] [Thread-4  ]: Finished running node model.taxi_rides_ny.my_second_dbt_model
07:49:47.861895 [debug] [MainThread]: Acquiring new bigquery connection "master"
07:49:47.863447 [info ] [MainThread]: 
07:49:47.864334 [info ] [MainThread]: Finished running 2 view models, 1 table model in 6.58s.
07:49:47.865462 [debug] [MainThread]: Connection 'master' was properly closed.
07:49:47.866318 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_first_dbt_model' was properly closed.
07:49:47.866921 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_yellow_trip_data' was properly closed.
07:49:47.867531 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_second_dbt_model' was properly closed.
07:49:47.884766 [info ] [MainThread]: 
07:49:47.885783 [info ] [MainThread]: [32mCompleted successfully[0m
07:49:47.887081 [info ] [MainThread]: 
07:49:47.887932 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
07:49:47.888829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9aef4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9aef1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9aef5e0>]}


============================== 2024-02-10 10:04:23.706652 | 21a80c20-2949-42b7-aebf-5a332faaf7ef ==============================
10:04:23.706652 [info ] [MainThread]: Running with dbt=1.0.9
10:04:23.707858 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', resource_types=[], select=None, exclude=None, selector_name=None, state=None, threads=None, defer=None, full_refresh=False, cls=<class 'dbt.task.build.BuildTask'>, which='build', rpc_method='build')
10:04:23.708300 [debug] [MainThread]: Tracking: tracking
10:04:23.730531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c02730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c02610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c02670>]}
10:04:23.782568 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
10:04:23.783183 [debug] [MainThread]: Partial parsing: added file: taxi_rides_ny://taxi_rides_ny/models/staging/stg_green_trip_data.sql
10:04:23.783571 [debug] [MainThread]: Partial parsing: added file: taxi_rides_ny://taxi_rides_ny/macros/get_payment_type_desc.sql
10:04:23.784021 [debug] [MainThread]: Partial parsing: deleted source source.taxi_rides_ny.staging.fhv_trip_data
10:04:23.784476 [debug] [MainThread]: Partial parsing: deleted source source.taxi_rides_ny.staging.yello_trip_data
10:04:23.784717 [debug] [MainThread]: Partial parsing: deleted source source.taxi_rides_ny.staging.green_trip_data
10:04:23.784958 [debug] [MainThread]: Partial parsing: update schema file: taxi_rides_ny://taxi_rides_ny/models/staging/schema.yml
10:04:23.785236 [debug] [MainThread]: Parsing taxi_rides_ny/macros/get_payment_type_desc.sql
10:04:23.804595 [debug] [MainThread]: 1603: static parser failed on staging/stg_green_trip_data.sql
10:04:23.817925 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_green_trip_data.sql
10:04:23.848752 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_yellow_trip_data.sql
10:04:23.873630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21a80c20-2949-42b7-aebf-5a332faaf7ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff866a0d0>]}
10:04:23.884214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21a80c20-2949-42b7-aebf-5a332faaf7ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9aca3a0>]}
10:04:23.884659 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 190 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
10:04:23.886231 [info ] [MainThread]: 
10:04:23.886908 [debug] [MainThread]: Acquiring new bigquery connection "master"
10:04:23.889219 [debug] [ThreadPool]: Acquiring new bigquery connection "list_de-zoomcamp-413815"
10:04:23.889818 [debug] [ThreadPool]: Opening a new connection, currently in state init
10:04:25.004773 [debug] [ThreadPool]: Acquiring new bigquery connection "list_de-zoomcamp-413815_trips_all_data"
10:04:25.007552 [debug] [ThreadPool]: Opening a new connection, currently in state closed
10:04:25.657099 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
10:04:25.662253 [info ] [MainThread]: 
10:04:25.690305 [debug] [Thread-1  ]: Began running node model.taxi_rides_ny.my_first_dbt_model
10:04:25.690741 [debug] [Thread-2  ]: Began running node model.taxi_rides_ny.stg_green_trip_data
10:04:25.691139 [debug] [Thread-3  ]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
10:04:25.692373 [info ] [Thread-1  ]: 1 of 4 START table model trips_all_data.my_first_dbt_model...................... [RUN]
10:04:25.693221 [info ] [Thread-2  ]: 2 of 4 START view model trips_all_data.stg_green_trip_data...................... [RUN]
10:04:25.693892 [info ] [Thread-3  ]: 3 of 4 START view model trips_all_data.stg_yellow_trip_data..................... [RUN]
10:04:25.695001 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.taxi_rides_ny.my_first_dbt_model"
10:04:25.695978 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.taxi_rides_ny.stg_green_trip_data"
10:04:25.696799 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.taxi_rides_ny.stg_yellow_trip_data"
10:04:25.697401 [debug] [Thread-1  ]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
10:04:25.697913 [debug] [Thread-2  ]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
10:04:25.698398 [debug] [Thread-3  ]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
10:04:25.699091 [debug] [Thread-1  ]: Compiling model.taxi_rides_ny.my_first_dbt_model
10:04:25.699722 [debug] [Thread-2  ]: Compiling model.taxi_rides_ny.stg_green_trip_data
10:04:25.700240 [debug] [Thread-3  ]: Compiling model.taxi_rides_ny.stg_yellow_trip_data
10:04:25.704186 [debug] [Thread-1  ]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
10:04:25.708594 [debug] [Thread-2  ]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
10:04:25.711751 [debug] [Thread-3  ]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
10:04:25.715104 [debug] [Thread-2  ]: finished collecting timing info
10:04:25.715286 [debug] [Thread-1  ]: finished collecting timing info
10:04:25.715700 [debug] [Thread-3  ]: finished collecting timing info
10:04:25.715978 [debug] [Thread-2  ]: Began executing node model.taxi_rides_ny.stg_green_trip_data
10:04:25.716420 [debug] [Thread-1  ]: Began executing node model.taxi_rides_ny.my_first_dbt_model
10:04:25.716773 [debug] [Thread-3  ]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
10:04:25.751076 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:04:25.756399 [debug] [Thread-2  ]: Writing runtime SQL for node "model.taxi_rides_ny.stg_green_trip_data"
10:04:25.758527 [debug] [Thread-3  ]: Writing runtime SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
10:04:25.790267 [debug] [Thread-3  ]: Opening a new connection, currently in state init
10:04:25.790499 [debug] [Thread-2  ]: Opening a new connection, currently in state init
10:04:25.792212 [debug] [Thread-3  ]: On model.taxi_rides_ny.stg_yellow_trip_data: /* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`trips_all_data`.`stg_yellow_trip_data`
  OPTIONS()
  as with

sources as(
    select * from `de-zoomcamp-413815`.`trips_all_data`.`yello_trip_data` limit 20
)

select * from sources;


10:04:25.821630 [debug] [Thread-2  ]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`trips_all_data`.`stg_green_trip_data`
  OPTIONS()
  as with source as
(select * 
    from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
    ),
SELECT
  VendorID,
  lpep_pickup_datetime,
  lpep_dropoff_datetime,
  store_and_fwd_flag,
  RatecodeID,
  PULocationID,
  DOLocationID,
  passenger_count,
  trip_distance,
  fare_amount,
  extra,
  mta_tax,
  tip_amount,
  tolls_amount,
  ehail_fee,
  improvement_surcharge,
  total_amount,
  case cast(  as integer )
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Empty'
end as payment_type_desc,
  trip_type,
  congestion_surcharge
FROM source;


10:04:26.472939 [debug] [Thread-1  ]: Writing runtime SQL for node "model.taxi_rides_ny.my_first_dbt_model"
10:04:26.476445 [debug] [Thread-1  ]: On model.taxi_rides_ny.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_first_dbt_model"} */


  create or replace table `de-zoomcamp-413815`.`trips_all_data`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
10:04:26.637672 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [10:1]')
10:04:27.577089 [debug] [Thread-2  ]: finished collecting timing info
10:04:27.585343 [debug] [Thread-3  ]: finished collecting timing info
10:04:27.586957 [debug] [Thread-2  ]: Database Error in model stg_green_trip_data (taxi_rides_ny/models/staging/stg_green_trip_data.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [10:1]
  compiled SQL at target/run/taxi_rides_ny/taxi_rides_ny/models/staging/stg_green_trip_data.sql
10:04:27.588556 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21a80c20-2949-42b7-aebf-5a332faaf7ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff85d8280>]}
10:04:27.589493 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21a80c20-2949-42b7-aebf-5a332faaf7ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9aca1f0>]}
10:04:27.590781 [info ] [Thread-3  ]: 3 of 4 OK created view model trips_all_data.stg_yellow_trip_data................ [[32mOK[0m in 1.89s]
10:04:27.592018 [error] [Thread-2  ]: 2 of 4 ERROR creating view model trips_all_data.stg_green_trip_data............. [[31mERROR[0m in 1.89s]
10:04:27.593043 [debug] [Thread-3  ]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
10:04:27.594174 [debug] [Thread-2  ]: Finished running node model.taxi_rides_ny.stg_green_trip_data
10:04:29.755487 [debug] [Thread-1  ]: finished collecting timing info
10:04:29.757961 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21a80c20-2949-42b7-aebf-5a332faaf7ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff852cdc0>]}
10:04:29.761618 [info ] [Thread-1  ]: 1 of 4 OK created table model trips_all_data.my_first_dbt_model................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 4.06s]
10:04:29.762939 [debug] [Thread-1  ]: Finished running node model.taxi_rides_ny.my_first_dbt_model
10:04:29.767370 [debug] [Thread-4  ]: Began running node model.taxi_rides_ny.my_second_dbt_model
10:04:29.768303 [info ] [Thread-4  ]: 4 of 4 START view model trips_all_data.my_second_dbt_model...................... [RUN]
10:04:29.769453 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.taxi_rides_ny.my_second_dbt_model"
10:04:29.770197 [debug] [Thread-4  ]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
10:04:29.770691 [debug] [Thread-4  ]: Compiling model.taxi_rides_ny.my_second_dbt_model
10:04:29.774597 [debug] [Thread-4  ]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
10:04:29.778115 [debug] [Thread-4  ]: finished collecting timing info
10:04:29.778674 [debug] [Thread-4  ]: Began executing node model.taxi_rides_ny.my_second_dbt_model
10:04:29.782113 [debug] [Thread-4  ]: Writing runtime SQL for node "model.taxi_rides_ny.my_second_dbt_model"
10:04:29.784085 [debug] [Thread-4  ]: Opening a new connection, currently in state init
10:04:29.786774 [debug] [Thread-4  ]: On model.taxi_rides_ny.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_second_dbt_model"} */


  create or replace view `de-zoomcamp-413815`.`trips_all_data`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `de-zoomcamp-413815`.`trips_all_data`.`my_first_dbt_model`
where id = 1;


10:04:31.065229 [debug] [Thread-4  ]: finished collecting timing info
10:04:31.070031 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21a80c20-2949-42b7-aebf-5a332faaf7ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c38370>]}
10:04:31.071497 [info ] [Thread-4  ]: 4 of 4 OK created view model trips_all_data.my_second_dbt_model................. [[32mOK[0m in 1.30s]
10:04:31.072590 [debug] [Thread-4  ]: Finished running node model.taxi_rides_ny.my_second_dbt_model
10:04:31.076184 [debug] [MainThread]: Acquiring new bigquery connection "master"
10:04:31.077591 [info ] [MainThread]: 
10:04:31.078931 [info ] [MainThread]: Finished running 3 view models, 1 table model in 7.19s.
10:04:31.080276 [debug] [MainThread]: Connection 'master' was properly closed.
10:04:31.081239 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_first_dbt_model' was properly closed.
10:04:31.081961 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_green_trip_data' was properly closed.
10:04:31.082763 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_yellow_trip_data' was properly closed.
10:04:31.083806 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_second_dbt_model' was properly closed.
10:04:31.097479 [info ] [MainThread]: 
10:04:31.098656 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
10:04:31.099638 [info ] [MainThread]: 
10:04:31.100433 [error] [MainThread]: [33mDatabase Error in model stg_green_trip_data (taxi_rides_ny/models/staging/stg_green_trip_data.sql)[0m
10:04:31.101398 [error] [MainThread]:   Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [10:1]
10:04:31.102112 [error] [MainThread]:   compiled SQL at target/run/taxi_rides_ny/taxi_rides_ny/models/staging/stg_green_trip_data.sql
10:04:31.102796 [info ] [MainThread]: 
10:04:31.103437 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
10:04:31.104361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff867e610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9acaa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff84d42b0>]}


============================== 2024-02-10 10:04:50.461327 | 2e0ec2cb-8c3b-4515-8767-a31f5cecda94 ==============================
10:04:50.461327 [info ] [MainThread]: Running with dbt=1.0.9
10:04:50.462456 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', resource_types=[], select=None, exclude=None, selector_name=None, state=None, threads=None, defer=None, full_refresh=False, cls=<class 'dbt.task.build.BuildTask'>, which='build', rpc_method='build')
10:04:50.463019 [debug] [MainThread]: Tracking: tracking
10:04:50.481775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c11730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c11640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c116a0>]}
10:04:50.529413 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
10:04:50.530074 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://taxi_rides_ny/models/staging/stg_green_trip_data.sql
10:04:50.547912 [debug] [MainThread]: 1603: static parser failed on staging/stg_green_trip_data.sql
10:04:50.562318 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_green_trip_data.sql
10:04:50.572695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e0ec2cb-8c3b-4515-8767-a31f5cecda94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9a63f10>]}
10:04:50.582827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e0ec2cb-8c3b-4515-8767-a31f5cecda94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b613a0>]}
10:04:50.583293 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 190 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
10:04:50.585012 [info ] [MainThread]: 
10:04:50.585693 [debug] [MainThread]: Acquiring new bigquery connection "master"
10:04:50.588150 [debug] [ThreadPool]: Acquiring new bigquery connection "list_de-zoomcamp-413815"
10:04:50.588807 [debug] [ThreadPool]: Opening a new connection, currently in state init
10:04:51.464948 [debug] [ThreadPool]: Acquiring new bigquery connection "list_de-zoomcamp-413815_trips_all_data"
10:04:51.473242 [debug] [ThreadPool]: Opening a new connection, currently in state closed
10:04:52.120646 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
10:04:52.124544 [info ] [MainThread]: 
10:04:52.169050 [debug] [Thread-1  ]: Began running node model.taxi_rides_ny.my_first_dbt_model
10:04:52.169497 [debug] [Thread-2  ]: Began running node model.taxi_rides_ny.stg_green_trip_data
10:04:52.169976 [debug] [Thread-3  ]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
10:04:52.170846 [info ] [Thread-1  ]: 1 of 4 START table model trips_all_data.my_first_dbt_model...................... [RUN]
10:04:52.171527 [info ] [Thread-2  ]: 2 of 4 START view model trips_all_data.stg_green_trip_data...................... [RUN]
10:04:52.172119 [info ] [Thread-3  ]: 3 of 4 START view model trips_all_data.stg_yellow_trip_data..................... [RUN]
10:04:52.173021 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.taxi_rides_ny.my_first_dbt_model"
10:04:52.173912 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.taxi_rides_ny.stg_green_trip_data"
10:04:52.175049 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.taxi_rides_ny.stg_yellow_trip_data"
10:04:52.175630 [debug] [Thread-1  ]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
10:04:52.176159 [debug] [Thread-2  ]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
10:04:52.176747 [debug] [Thread-3  ]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
10:04:52.177188 [debug] [Thread-1  ]: Compiling model.taxi_rides_ny.my_first_dbt_model
10:04:52.177563 [debug] [Thread-2  ]: Compiling model.taxi_rides_ny.stg_green_trip_data
10:04:52.177991 [debug] [Thread-3  ]: Compiling model.taxi_rides_ny.stg_yellow_trip_data
10:04:52.181350 [debug] [Thread-1  ]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
10:04:52.184548 [debug] [Thread-2  ]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
10:04:52.187526 [debug] [Thread-3  ]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
10:04:52.189576 [debug] [Thread-1  ]: finished collecting timing info
10:04:52.189842 [debug] [Thread-2  ]: finished collecting timing info
10:04:52.190008 [debug] [Thread-1  ]: Began executing node model.taxi_rides_ny.my_first_dbt_model
10:04:52.190137 [debug] [Thread-3  ]: finished collecting timing info
10:04:52.190361 [debug] [Thread-2  ]: Began executing node model.taxi_rides_ny.stg_green_trip_data
10:04:52.205498 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:04:52.206032 [debug] [Thread-3  ]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
10:04:52.229570 [debug] [Thread-2  ]: Writing runtime SQL for node "model.taxi_rides_ny.stg_green_trip_data"
10:04:52.232824 [debug] [Thread-3  ]: Writing runtime SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
10:04:52.263034 [debug] [Thread-2  ]: Opening a new connection, currently in state init
10:04:52.263373 [debug] [Thread-3  ]: Opening a new connection, currently in state init
10:04:52.264970 [debug] [Thread-2  ]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`trips_all_data`.`stg_green_trip_data`
  OPTIONS()
  as with source as
(select * 
    from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
    )
SELECT
  VendorID,
  lpep_pickup_datetime,
  lpep_dropoff_datetime,
  store_and_fwd_flag,
  RatecodeID,
  PULocationID,
  DOLocationID,
  passenger_count,
  trip_distance,
  fare_amount,
  extra,
  mta_tax,
  tip_amount,
  tolls_amount,
  ehail_fee,
  improvement_surcharge,
  total_amount,
  case cast(  as integer )
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Empty'
end as payment_type_desc,
  trip_type,
  congestion_surcharge
FROM source;


10:04:52.266413 [debug] [Thread-3  ]: On model.taxi_rides_ny.stg_yellow_trip_data: /* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`trips_all_data`.`stg_yellow_trip_data`
  OPTIONS()
  as with

sources as(
    select * from `de-zoomcamp-413815`.`trips_all_data`.`yello_trip_data` limit 20
)

select * from sources;


10:04:52.944480 [debug] [Thread-1  ]: Writing runtime SQL for node "model.taxi_rides_ny.my_first_dbt_model"
10:04:52.946106 [debug] [Thread-1  ]: On model.taxi_rides_ny.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_first_dbt_model"} */


  create or replace table `de-zoomcamp-413815`.`trips_all_data`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
10:04:53.379074 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword AS at [28:15]')
10:04:53.644782 [debug] [Thread-3  ]: finished collecting timing info
10:04:53.647066 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e0ec2cb-8c3b-4515-8767-a31f5cecda94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9af75b0>]}
10:04:53.648475 [info ] [Thread-3  ]: 3 of 4 OK created view model trips_all_data.stg_yellow_trip_data................ [[32mOK[0m in 1.47s]
10:04:53.649674 [debug] [Thread-3  ]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
10:04:54.089728 [debug] [Thread-2  ]: finished collecting timing info
10:04:54.098866 [debug] [Thread-2  ]: Database Error in model stg_green_trip_data (taxi_rides_ny/models/staging/stg_green_trip_data.sql)
  Syntax error: Unexpected keyword AS at [28:15]
  compiled SQL at target/run/taxi_rides_ny/taxi_rides_ny/models/staging/stg_green_trip_data.sql
10:04:54.103409 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e0ec2cb-8c3b-4515-8767-a31f5cecda94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8148550>]}
10:04:54.106337 [error] [Thread-2  ]: 2 of 4 ERROR creating view model trips_all_data.stg_green_trip_data............. [[31mERROR[0m in 1.93s]
10:04:54.108426 [debug] [Thread-2  ]: Finished running node model.taxi_rides_ny.stg_green_trip_data
10:04:54.602104 [debug] [Thread-1  ]: finished collecting timing info
10:04:54.603927 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e0ec2cb-8c3b-4515-8767-a31f5cecda94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff916abb0>]}
10:04:54.604978 [info ] [Thread-1  ]: 1 of 4 OK created table model trips_all_data.my_first_dbt_model................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.43s]
10:04:54.605837 [debug] [Thread-1  ]: Finished running node model.taxi_rides_ny.my_first_dbt_model
10:04:54.608678 [debug] [Thread-4  ]: Began running node model.taxi_rides_ny.my_second_dbt_model
10:04:54.609224 [info ] [Thread-4  ]: 4 of 4 START view model trips_all_data.my_second_dbt_model...................... [RUN]
10:04:54.609910 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.taxi_rides_ny.my_second_dbt_model"
10:04:54.610570 [debug] [Thread-4  ]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
10:04:54.610922 [debug] [Thread-4  ]: Compiling model.taxi_rides_ny.my_second_dbt_model
10:04:54.615177 [debug] [Thread-4  ]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
10:04:54.617378 [debug] [Thread-4  ]: finished collecting timing info
10:04:54.617919 [debug] [Thread-4  ]: Began executing node model.taxi_rides_ny.my_second_dbt_model
10:04:54.624157 [debug] [Thread-4  ]: Writing runtime SQL for node "model.taxi_rides_ny.my_second_dbt_model"
10:04:54.627108 [debug] [Thread-4  ]: Opening a new connection, currently in state init
10:04:54.631077 [debug] [Thread-4  ]: On model.taxi_rides_ny.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_second_dbt_model"} */


  create or replace view `de-zoomcamp-413815`.`trips_all_data`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `de-zoomcamp-413815`.`trips_all_data`.`my_first_dbt_model`
where id = 1;


10:04:56.201491 [debug] [Thread-4  ]: finished collecting timing info
10:04:56.208594 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e0ec2cb-8c3b-4515-8767-a31f5cecda94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff814ee50>]}
10:04:56.210383 [info ] [Thread-4  ]: 4 of 4 OK created view model trips_all_data.my_second_dbt_model................. [[32mOK[0m in 1.60s]
10:04:56.212011 [debug] [Thread-4  ]: Finished running node model.taxi_rides_ny.my_second_dbt_model
10:04:56.216229 [debug] [MainThread]: Acquiring new bigquery connection "master"
10:04:56.217670 [info ] [MainThread]: 
10:04:56.218545 [info ] [MainThread]: Finished running 3 view models, 1 table model in 5.63s.
10:04:56.219664 [debug] [MainThread]: Connection 'master' was properly closed.
10:04:56.220759 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_first_dbt_model' was properly closed.
10:04:56.221516 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_green_trip_data' was properly closed.
10:04:56.222266 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_yellow_trip_data' was properly closed.
10:04:56.222973 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_second_dbt_model' was properly closed.
10:04:56.241429 [info ] [MainThread]: 
10:04:56.242695 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
10:04:56.243764 [info ] [MainThread]: 
10:04:56.244731 [error] [MainThread]: [33mDatabase Error in model stg_green_trip_data (taxi_rides_ny/models/staging/stg_green_trip_data.sql)[0m
10:04:56.245430 [error] [MainThread]:   Syntax error: Unexpected keyword AS at [28:15]
10:04:56.246107 [error] [MainThread]:   compiled SQL at target/run/taxi_rides_ny/taxi_rides_ny/models/staging/stg_green_trip_data.sql
10:04:56.246801 [info ] [MainThread]: 
10:04:56.247280 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
10:04:56.248067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c376d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c37d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9193430>]}


============================== 2024-02-10 10:05:34.464546 | d9f1465d-f9c6-4233-b097-952429310346 ==============================
10:05:34.464546 [info ] [MainThread]: Running with dbt=1.0.9
10:05:34.465561 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
10:05:34.465984 [debug] [MainThread]: Tracking: tracking
10:05:34.484021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c04760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c04850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c047f0>]}
10:05:34.528234 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
10:05:34.528643 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
10:05:34.535530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9f1465d-f9c6-4233-b097-952429310346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9afb0d0>]}
10:05:34.544728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9f1465d-f9c6-4233-b097-952429310346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b5a190>]}
10:05:34.545197 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 190 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
10:05:34.546858 [info ] [MainThread]: 
10:05:34.547590 [debug] [MainThread]: Acquiring new bigquery connection "master"
10:05:34.550042 [debug] [ThreadPool]: Acquiring new bigquery connection "list_de-zoomcamp-413815_trips_all_data"
10:05:34.550597 [debug] [ThreadPool]: Opening a new connection, currently in state init
10:05:35.248143 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
10:05:35.249817 [info ] [MainThread]: 
10:05:35.277999 [debug] [Thread-1  ]: Began running node model.taxi_rides_ny.my_first_dbt_model
10:05:35.278337 [debug] [Thread-2  ]: Began running node model.taxi_rides_ny.stg_green_trip_data
10:05:35.278542 [debug] [Thread-3  ]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
10:05:35.279374 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.taxi_rides_ny.my_first_dbt_model"
10:05:35.280070 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.taxi_rides_ny.stg_green_trip_data"
10:05:35.280676 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.taxi_rides_ny.stg_yellow_trip_data"
10:05:35.281030 [debug] [Thread-1  ]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
10:05:35.281394 [debug] [Thread-2  ]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
10:05:35.281729 [debug] [Thread-3  ]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
10:05:35.282114 [debug] [Thread-1  ]: Compiling model.taxi_rides_ny.my_first_dbt_model
10:05:35.282447 [debug] [Thread-2  ]: Compiling model.taxi_rides_ny.stg_green_trip_data
10:05:35.282801 [debug] [Thread-3  ]: Compiling model.taxi_rides_ny.stg_yellow_trip_data
10:05:35.286183 [debug] [Thread-1  ]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
10:05:35.290236 [debug] [Thread-2  ]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
10:05:35.292718 [debug] [Thread-3  ]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
10:05:35.294544 [debug] [Thread-2  ]: finished collecting timing info
10:05:35.294687 [debug] [Thread-1  ]: finished collecting timing info
10:05:35.294907 [debug] [Thread-3  ]: finished collecting timing info
10:05:35.295046 [debug] [Thread-2  ]: Began executing node model.taxi_rides_ny.stg_green_trip_data
10:05:35.295358 [debug] [Thread-1  ]: Began executing node model.taxi_rides_ny.my_first_dbt_model
10:05:35.295670 [debug] [Thread-3  ]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
10:05:35.295994 [debug] [Thread-2  ]: finished collecting timing info
10:05:35.296293 [debug] [Thread-1  ]: finished collecting timing info
10:05:35.296598 [debug] [Thread-3  ]: finished collecting timing info
10:05:35.297067 [debug] [Thread-2  ]: Finished running node model.taxi_rides_ny.stg_green_trip_data
10:05:35.297540 [debug] [Thread-1  ]: Finished running node model.taxi_rides_ny.my_first_dbt_model
10:05:35.297989 [debug] [Thread-3  ]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
10:05:35.298849 [debug] [Thread-4  ]: Began running node model.taxi_rides_ny.my_second_dbt_model
10:05:35.299633 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.taxi_rides_ny.my_second_dbt_model"
10:05:35.299949 [debug] [Thread-4  ]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
10:05:35.300233 [debug] [Thread-4  ]: Compiling model.taxi_rides_ny.my_second_dbt_model
10:05:35.302462 [debug] [Thread-4  ]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
10:05:35.303393 [debug] [Thread-4  ]: finished collecting timing info
10:05:35.303665 [debug] [Thread-4  ]: Began executing node model.taxi_rides_ny.my_second_dbt_model
10:05:35.303928 [debug] [Thread-4  ]: finished collecting timing info
10:05:35.304324 [debug] [Thread-4  ]: Finished running node model.taxi_rides_ny.my_second_dbt_model
10:05:35.306243 [debug] [MainThread]: Connection 'master' was properly closed.
10:05:35.306561 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_first_dbt_model' was properly closed.
10:05:35.306788 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_green_trip_data' was properly closed.
10:05:35.307037 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_yellow_trip_data' was properly closed.
10:05:35.307260 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_second_dbt_model' was properly closed.
10:05:35.312379 [info ] [MainThread]: Done.
10:05:35.312839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9235f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9235070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9235220>]}


============================== 2024-02-10 10:05:48.529373 | d3bbb0f5-6d26-4b90-a2ee-994d39169a2f ==============================
10:05:48.529373 [info ] [MainThread]: Running with dbt=1.0.9
10:05:48.530555 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', resource_types=[], select=None, exclude=None, selector_name=None, state=None, threads=None, defer=None, full_refresh=False, cls=<class 'dbt.task.build.BuildTask'>, which='build', rpc_method='build')
10:05:48.531116 [debug] [MainThread]: Tracking: tracking
10:05:48.549324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c069d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c068e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c06940>]}
10:05:48.591771 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
10:05:48.592195 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
10:05:48.599174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3bbb0f5-6d26-4b90-a2ee-994d39169a2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9afb0d0>]}
10:05:48.607985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3bbb0f5-6d26-4b90-a2ee-994d39169a2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b606d0>]}
10:05:48.608453 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 190 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
10:05:48.610065 [info ] [MainThread]: 
10:05:48.610794 [debug] [MainThread]: Acquiring new bigquery connection "master"
10:05:48.613250 [debug] [ThreadPool]: Acquiring new bigquery connection "list_de-zoomcamp-413815"
10:05:48.614000 [debug] [ThreadPool]: Opening a new connection, currently in state init
10:05:49.590850 [debug] [ThreadPool]: Acquiring new bigquery connection "list_de-zoomcamp-413815_trips_all_data"
10:05:49.594887 [debug] [ThreadPool]: Opening a new connection, currently in state closed
10:05:50.290374 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
10:05:50.291255 [info ] [MainThread]: 
10:05:50.309025 [debug] [Thread-1  ]: Began running node model.taxi_rides_ny.my_first_dbt_model
10:05:50.309419 [debug] [Thread-2  ]: Began running node model.taxi_rides_ny.stg_green_trip_data
10:05:50.309805 [debug] [Thread-3  ]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
10:05:50.310321 [info ] [Thread-1  ]: 1 of 4 START table model trips_all_data.my_first_dbt_model...................... [RUN]
10:05:50.310762 [info ] [Thread-2  ]: 2 of 4 START view model trips_all_data.stg_green_trip_data...................... [RUN]
10:05:50.311153 [info ] [Thread-3  ]: 3 of 4 START view model trips_all_data.stg_yellow_trip_data..................... [RUN]
10:05:50.311807 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.taxi_rides_ny.my_first_dbt_model"
10:05:50.312348 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.taxi_rides_ny.stg_green_trip_data"
10:05:50.312908 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.taxi_rides_ny.stg_yellow_trip_data"
10:05:50.313285 [debug] [Thread-1  ]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
10:05:50.313647 [debug] [Thread-2  ]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
10:05:50.314025 [debug] [Thread-3  ]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
10:05:50.314322 [debug] [Thread-1  ]: Compiling model.taxi_rides_ny.my_first_dbt_model
10:05:50.314647 [debug] [Thread-2  ]: Compiling model.taxi_rides_ny.stg_green_trip_data
10:05:50.314988 [debug] [Thread-3  ]: Compiling model.taxi_rides_ny.stg_yellow_trip_data
10:05:50.317718 [debug] [Thread-1  ]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
10:05:50.321390 [debug] [Thread-2  ]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
10:05:50.323492 [debug] [Thread-3  ]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
10:05:50.325182 [debug] [Thread-1  ]: finished collecting timing info
10:05:50.325625 [debug] [Thread-2  ]: finished collecting timing info
10:05:50.325799 [debug] [Thread-3  ]: finished collecting timing info
10:05:50.325939 [debug] [Thread-1  ]: Began executing node model.taxi_rides_ny.my_first_dbt_model
10:05:50.326260 [debug] [Thread-2  ]: Began executing node model.taxi_rides_ny.stg_green_trip_data
10:05:50.326554 [debug] [Thread-3  ]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
10:05:50.342407 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:05:50.376580 [debug] [Thread-2  ]: Writing runtime SQL for node "model.taxi_rides_ny.stg_green_trip_data"
10:05:50.375012 [debug] [Thread-3  ]: Writing runtime SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
10:05:50.409790 [debug] [Thread-3  ]: Opening a new connection, currently in state init
10:05:50.410007 [debug] [Thread-2  ]: Opening a new connection, currently in state init
10:05:50.411773 [debug] [Thread-3  ]: On model.taxi_rides_ny.stg_yellow_trip_data: /* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`trips_all_data`.`stg_yellow_trip_data`
  OPTIONS()
  as with

sources as(
    select * from `de-zoomcamp-413815`.`trips_all_data`.`yello_trip_data` limit 20
)

select * from sources;


10:05:50.441901 [debug] [Thread-2  ]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`trips_all_data`.`stg_green_trip_data`
  OPTIONS()
  as with source as
(select * 
    from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
    )
SELECT
  VendorID,
  lpep_pickup_datetime,
  lpep_dropoff_datetime,
  store_and_fwd_flag,
  RatecodeID,
  PULocationID,
  DOLocationID,
  passenger_count,
  trip_distance,
  fare_amount,
  extra,
  mta_tax,
  tip_amount,
  tolls_amount,
  ehail_fee,
  improvement_surcharge,
  total_amount,
  case cast(  as integer )
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Empty'
end as payment_type_desc,
  trip_type,
  congestion_surcharge
FROM source;


10:05:50.933877 [debug] [Thread-1  ]: Writing runtime SQL for node "model.taxi_rides_ny.my_first_dbt_model"
10:05:50.936643 [debug] [Thread-1  ]: On model.taxi_rides_ny.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_first_dbt_model"} */


  create or replace table `de-zoomcamp-413815`.`trips_all_data`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
10:05:51.096192 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword AS at [28:15]')
10:05:51.611234 [debug] [Thread-2  ]: finished collecting timing info
10:05:51.616256 [debug] [Thread-2  ]: Database Error in model stg_green_trip_data (taxi_rides_ny/models/staging/stg_green_trip_data.sql)
  Syntax error: Unexpected keyword AS at [28:15]
  compiled SQL at target/run/taxi_rides_ny/taxi_rides_ny/models/staging/stg_green_trip_data.sql
10:05:51.621701 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3bbb0f5-6d26-4b90-a2ee-994d39169a2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91e8850>]}
10:05:51.624801 [error] [Thread-2  ]: 2 of 4 ERROR creating view model trips_all_data.stg_green_trip_data............. [[31mERROR[0m in 1.31s]
10:05:51.626936 [debug] [Thread-2  ]: Finished running node model.taxi_rides_ny.stg_green_trip_data
10:05:51.652468 [debug] [Thread-3  ]: finished collecting timing info
10:05:51.654441 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3bbb0f5-6d26-4b90-a2ee-994d39169a2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91f61f0>]}
10:05:51.655676 [info ] [Thread-3  ]: 3 of 4 OK created view model trips_all_data.stg_yellow_trip_data................ [[32mOK[0m in 1.34s]
10:05:51.656654 [debug] [Thread-3  ]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
10:05:52.735446 [debug] [Thread-1  ]: finished collecting timing info
10:05:52.739784 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3bbb0f5-6d26-4b90-a2ee-994d39169a2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9adff40>]}
10:05:52.741829 [info ] [Thread-1  ]: 1 of 4 OK created table model trips_all_data.my_first_dbt_model................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.43s]
10:05:52.744175 [debug] [Thread-1  ]: Finished running node model.taxi_rides_ny.my_first_dbt_model
10:05:52.748722 [debug] [Thread-4  ]: Began running node model.taxi_rides_ny.my_second_dbt_model
10:05:52.749925 [info ] [Thread-4  ]: 4 of 4 START view model trips_all_data.my_second_dbt_model...................... [RUN]
10:05:52.751205 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.taxi_rides_ny.my_second_dbt_model"
10:05:52.752167 [debug] [Thread-4  ]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
10:05:52.752995 [debug] [Thread-4  ]: Compiling model.taxi_rides_ny.my_second_dbt_model
10:05:52.759594 [debug] [Thread-4  ]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
10:05:52.763459 [debug] [Thread-4  ]: finished collecting timing info
10:05:52.764339 [debug] [Thread-4  ]: Began executing node model.taxi_rides_ny.my_second_dbt_model
10:05:52.769324 [debug] [Thread-4  ]: Writing runtime SQL for node "model.taxi_rides_ny.my_second_dbt_model"
10:05:52.772191 [debug] [Thread-4  ]: Opening a new connection, currently in state init
10:05:52.775109 [debug] [Thread-4  ]: On model.taxi_rides_ny.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_second_dbt_model"} */


  create or replace view `de-zoomcamp-413815`.`trips_all_data`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `de-zoomcamp-413815`.`trips_all_data`.`my_first_dbt_model`
where id = 1;


10:05:53.952599 [debug] [Thread-4  ]: finished collecting timing info
10:05:53.954683 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3bbb0f5-6d26-4b90-a2ee-994d39169a2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8110400>]}
10:05:53.956099 [info ] [Thread-4  ]: 4 of 4 OK created view model trips_all_data.my_second_dbt_model................. [[32mOK[0m in 1.20s]
10:05:53.957408 [debug] [Thread-4  ]: Finished running node model.taxi_rides_ny.my_second_dbt_model
10:05:53.963542 [debug] [MainThread]: Acquiring new bigquery connection "master"
10:05:53.964754 [info ] [MainThread]: 
10:05:53.965407 [info ] [MainThread]: Finished running 3 view models, 1 table model in 5.35s.
10:05:53.966034 [debug] [MainThread]: Connection 'master' was properly closed.
10:05:53.966499 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_first_dbt_model' was properly closed.
10:05:53.966956 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_green_trip_data' was properly closed.
10:05:53.967325 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_yellow_trip_data' was properly closed.
10:05:53.967721 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_second_dbt_model' was properly closed.
10:05:53.977547 [info ] [MainThread]: 
10:05:53.978177 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
10:05:53.978776 [info ] [MainThread]: 
10:05:53.979343 [error] [MainThread]: [33mDatabase Error in model stg_green_trip_data (taxi_rides_ny/models/staging/stg_green_trip_data.sql)[0m
10:05:53.979806 [error] [MainThread]:   Syntax error: Unexpected keyword AS at [28:15]
10:05:53.980301 [error] [MainThread]:   compiled SQL at target/run/taxi_rides_ny/taxi_rides_ny/models/staging/stg_green_trip_data.sql
10:05:53.980783 [info ] [MainThread]: 
10:05:53.981313 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
10:05:53.982038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ae7fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b60820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff810d790>]}


============================== 2024-02-10 10:06:19.469034 | 40bf77e7-527f-4250-a842-863da89b9ada ==============================
10:06:19.469034 [info ] [MainThread]: Running with dbt=1.0.9
10:06:19.470102 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', resource_types=[], select=None, exclude=None, selector_name=None, state=None, threads=None, defer=None, full_refresh=False, cls=<class 'dbt.task.build.BuildTask'>, which='build', rpc_method='build')
10:06:19.470581 [debug] [MainThread]: Tracking: tracking
10:06:19.488283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c04760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c04850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c047f0>]}
10:06:19.533238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
10:06:19.533907 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://taxi_rides_ny/models/staging/stg_green_trip_data.sql
10:06:19.576411 [debug] [MainThread]: 1603: static parser failed on staging/stg_green_trip_data.sql
10:06:19.588823 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_green_trip_data.sql
10:06:19.598966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40bf77e7-527f-4250-a842-863da89b9ada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff86aefd0>]}
10:06:19.607670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40bf77e7-527f-4250-a842-863da89b9ada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b43fa0>]}
10:06:19.608128 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 190 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
10:06:19.609729 [info ] [MainThread]: 
10:06:19.610398 [debug] [MainThread]: Acquiring new bigquery connection "master"
10:06:19.612234 [debug] [ThreadPool]: Acquiring new bigquery connection "list_de-zoomcamp-413815"
10:06:19.612753 [debug] [ThreadPool]: Opening a new connection, currently in state init
10:06:20.512826 [debug] [ThreadPool]: Acquiring new bigquery connection "list_de-zoomcamp-413815_trips_all_data"
10:06:20.516348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
10:06:21.214848 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
10:06:21.216225 [info ] [MainThread]: 
10:06:21.244735 [debug] [Thread-1  ]: Began running node model.taxi_rides_ny.my_first_dbt_model
10:06:21.245080 [debug] [Thread-2  ]: Began running node model.taxi_rides_ny.stg_green_trip_data
10:06:21.245461 [debug] [Thread-3  ]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
10:06:21.246004 [info ] [Thread-1  ]: 1 of 4 START table model trips_all_data.my_first_dbt_model...................... [RUN]
10:06:21.246407 [info ] [Thread-2  ]: 2 of 4 START view model trips_all_data.stg_green_trip_data...................... [RUN]
10:06:21.246747 [info ] [Thread-3  ]: 3 of 4 START view model trips_all_data.stg_yellow_trip_data..................... [RUN]
10:06:21.247386 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.taxi_rides_ny.my_first_dbt_model"
10:06:21.248271 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.taxi_rides_ny.stg_green_trip_data"
10:06:21.249042 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.taxi_rides_ny.stg_yellow_trip_data"
10:06:21.249540 [debug] [Thread-1  ]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
10:06:21.250000 [debug] [Thread-2  ]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
10:06:21.250426 [debug] [Thread-3  ]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
10:06:21.250890 [debug] [Thread-1  ]: Compiling model.taxi_rides_ny.my_first_dbt_model
10:06:21.251237 [debug] [Thread-2  ]: Compiling model.taxi_rides_ny.stg_green_trip_data
10:06:21.251614 [debug] [Thread-3  ]: Compiling model.taxi_rides_ny.stg_yellow_trip_data
10:06:21.254574 [debug] [Thread-1  ]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
10:06:21.257915 [debug] [Thread-2  ]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
10:06:21.260629 [debug] [Thread-3  ]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
10:06:21.262721 [debug] [Thread-1  ]: finished collecting timing info
10:06:21.262921 [debug] [Thread-2  ]: finished collecting timing info
10:06:21.263298 [debug] [Thread-1  ]: Began executing node model.taxi_rides_ny.my_first_dbt_model
10:06:21.263433 [debug] [Thread-3  ]: finished collecting timing info
10:06:21.263701 [debug] [Thread-2  ]: Began executing node model.taxi_rides_ny.stg_green_trip_data
10:06:21.278508 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:06:21.278765 [debug] [Thread-3  ]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
10:06:21.301876 [debug] [Thread-2  ]: Writing runtime SQL for node "model.taxi_rides_ny.stg_green_trip_data"
10:06:21.305455 [debug] [Thread-3  ]: Writing runtime SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
10:06:21.335773 [debug] [Thread-2  ]: Opening a new connection, currently in state init
10:06:21.336312 [debug] [Thread-3  ]: Opening a new connection, currently in state init
10:06:21.337818 [debug] [Thread-2  ]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`trips_all_data`.`stg_green_trip_data`
  OPTIONS()
  as with source as
(select * 
    from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
    )
SELECT
  VendorID,
  lpep_pickup_datetime,
  lpep_dropoff_datetime,
  store_and_fwd_flag,
  RatecodeID,
  PULocationID,
  DOLocationID,
  passenger_count,
  trip_distance,
  fare_amount,
  extra,
  mta_tax,
  tip_amount,
  tolls_amount,
  ehail_fee,
  improvement_surcharge,
  total_amount,
  case cast( payment_type as integer )
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Empty'
end as payment_type_desc,
  trip_type,
  congestion_surcharge
FROM source;


10:06:21.367276 [debug] [Thread-3  ]: On model.taxi_rides_ny.stg_yellow_trip_data: /* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`trips_all_data`.`stg_yellow_trip_data`
  OPTIONS()
  as with

sources as(
    select * from `de-zoomcamp-413815`.`trips_all_data`.`yello_trip_data` limit 20
)

select * from sources;


10:06:22.006553 [debug] [Thread-1  ]: Writing runtime SQL for node "model.taxi_rides_ny.my_first_dbt_model"
10:06:22.009646 [debug] [Thread-1  ]: On model.taxi_rides_ny.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_first_dbt_model"} */


  create or replace table `de-zoomcamp-413815`.`trips_all_data`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
10:06:22.400714 [debug] [Thread-3  ]: finished collecting timing info
10:06:22.402785 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40bf77e7-527f-4250-a842-863da89b9ada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9aee280>]}
10:06:22.403787 [info ] [Thread-3  ]: 3 of 4 OK created view model trips_all_data.stg_yellow_trip_data................ [[32mOK[0m in 1.15s]
10:06:22.405309 [debug] [Thread-3  ]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
10:06:22.462992 [debug] [Thread-2  ]: finished collecting timing info
10:06:22.463823 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40bf77e7-527f-4250-a842-863da89b9ada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9aee880>]}
10:06:22.464322 [info ] [Thread-2  ]: 2 of 4 OK created view model trips_all_data.stg_green_trip_data................. [[32mOK[0m in 1.22s]
10:06:22.464720 [debug] [Thread-2  ]: Finished running node model.taxi_rides_ny.stg_green_trip_data
10:06:23.763786 [debug] [Thread-1  ]: finished collecting timing info
10:06:23.769717 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40bf77e7-527f-4250-a842-863da89b9ada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9aeed00>]}
10:06:23.773244 [info ] [Thread-1  ]: 1 of 4 OK created table model trips_all_data.my_first_dbt_model................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.52s]
10:06:23.775370 [debug] [Thread-1  ]: Finished running node model.taxi_rides_ny.my_first_dbt_model
10:06:23.781074 [debug] [Thread-4  ]: Began running node model.taxi_rides_ny.my_second_dbt_model
10:06:23.782663 [info ] [Thread-4  ]: 4 of 4 START view model trips_all_data.my_second_dbt_model...................... [RUN]
10:06:23.784386 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.taxi_rides_ny.my_second_dbt_model"
10:06:23.785484 [debug] [Thread-4  ]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
10:06:23.786353 [debug] [Thread-4  ]: Compiling model.taxi_rides_ny.my_second_dbt_model
10:06:23.793475 [debug] [Thread-4  ]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
10:06:23.797578 [debug] [Thread-4  ]: finished collecting timing info
10:06:23.798392 [debug] [Thread-4  ]: Began executing node model.taxi_rides_ny.my_second_dbt_model
10:06:23.805822 [debug] [Thread-4  ]: Writing runtime SQL for node "model.taxi_rides_ny.my_second_dbt_model"
10:06:23.809575 [debug] [Thread-4  ]: Opening a new connection, currently in state init
10:06:23.813000 [debug] [Thread-4  ]: On model.taxi_rides_ny.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.9", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_second_dbt_model"} */


  create or replace view `de-zoomcamp-413815`.`trips_all_data`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `de-zoomcamp-413815`.`trips_all_data`.`my_first_dbt_model`
where id = 1;


10:06:24.962220 [debug] [Thread-4  ]: finished collecting timing info
10:06:24.967474 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40bf77e7-527f-4250-a842-863da89b9ada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8534130>]}
10:06:24.969400 [info ] [Thread-4  ]: 4 of 4 OK created view model trips_all_data.my_second_dbt_model................. [[32mOK[0m in 1.18s]
10:06:24.970637 [debug] [Thread-4  ]: Finished running node model.taxi_rides_ny.my_second_dbt_model
10:06:24.974945 [debug] [MainThread]: Acquiring new bigquery connection "master"
10:06:24.976358 [info ] [MainThread]: 
10:06:24.977281 [info ] [MainThread]: Finished running 3 view models, 1 table model in 5.37s.
10:06:24.978250 [debug] [MainThread]: Connection 'master' was properly closed.
10:06:24.978927 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_first_dbt_model' was properly closed.
10:06:24.979591 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_green_trip_data' was properly closed.
10:06:24.980226 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_yellow_trip_data' was properly closed.
10:06:24.980807 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_second_dbt_model' was properly closed.
10:06:24.998012 [info ] [MainThread]: 
10:06:24.999228 [info ] [MainThread]: [32mCompleted successfully[0m
10:06:25.000213 [info ] [MainThread]: 
10:06:25.001364 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
10:06:25.002534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9af7f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9af7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b4ad60>]}


============================== 2024-02-10 10:06:37.384409 | 7a9bd97d-e4c3-4c34-988a-f9e886444ffb ==============================
10:06:37.384409 [info ] [MainThread]: Running with dbt=1.0.9
10:06:37.385346 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
10:06:37.385959 [debug] [MainThread]: Tracking: tracking
10:06:37.404134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c059d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c058e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c05940>]}
10:06:37.447506 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
10:06:37.447944 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
10:06:37.455179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a9bd97d-e4c3-4c34-988a-f9e886444ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9afb0d0>]}
10:06:37.464211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a9bd97d-e4c3-4c34-988a-f9e886444ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b5a6d0>]}
10:06:37.464713 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 190 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
10:06:37.466325 [info ] [MainThread]: 
10:06:37.467133 [debug] [MainThread]: Acquiring new bigquery connection "master"
10:06:37.469603 [debug] [ThreadPool]: Acquiring new bigquery connection "list_de-zoomcamp-413815_trips_all_data"
10:06:37.470136 [debug] [ThreadPool]: Opening a new connection, currently in state init
10:06:38.230620 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
10:06:38.233523 [info ] [MainThread]: 
10:06:38.270839 [debug] [Thread-1  ]: Began running node model.taxi_rides_ny.my_first_dbt_model
10:06:38.271249 [debug] [Thread-2  ]: Began running node model.taxi_rides_ny.stg_green_trip_data
10:06:38.271489 [debug] [Thread-3  ]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
10:06:38.272350 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.taxi_rides_ny.my_first_dbt_model"
10:06:38.273316 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.taxi_rides_ny.stg_green_trip_data"
10:06:38.274167 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.taxi_rides_ny.stg_yellow_trip_data"
10:06:38.274726 [debug] [Thread-1  ]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
10:06:38.275238 [debug] [Thread-2  ]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
10:06:38.275727 [debug] [Thread-3  ]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
10:06:38.276240 [debug] [Thread-1  ]: Compiling model.taxi_rides_ny.my_first_dbt_model
10:06:38.276754 [debug] [Thread-2  ]: Compiling model.taxi_rides_ny.stg_green_trip_data
10:06:38.277217 [debug] [Thread-3  ]: Compiling model.taxi_rides_ny.stg_yellow_trip_data
10:06:38.281266 [debug] [Thread-1  ]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
10:06:38.286101 [debug] [Thread-2  ]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
10:06:38.288736 [debug] [Thread-3  ]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
10:06:38.290699 [debug] [Thread-1  ]: finished collecting timing info
10:06:38.290850 [debug] [Thread-2  ]: finished collecting timing info
10:06:38.291288 [debug] [Thread-3  ]: finished collecting timing info
10:06:38.291447 [debug] [Thread-1  ]: Began executing node model.taxi_rides_ny.my_first_dbt_model
10:06:38.291825 [debug] [Thread-2  ]: Began executing node model.taxi_rides_ny.stg_green_trip_data
10:06:38.292175 [debug] [Thread-3  ]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
10:06:38.292554 [debug] [Thread-1  ]: finished collecting timing info
10:06:38.292898 [debug] [Thread-2  ]: finished collecting timing info
10:06:38.293239 [debug] [Thread-3  ]: finished collecting timing info
10:06:38.293770 [debug] [Thread-1  ]: Finished running node model.taxi_rides_ny.my_first_dbt_model
10:06:38.294237 [debug] [Thread-2  ]: Finished running node model.taxi_rides_ny.stg_green_trip_data
10:06:38.294751 [debug] [Thread-3  ]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
10:06:38.295489 [debug] [Thread-4  ]: Began running node model.taxi_rides_ny.my_second_dbt_model
10:06:38.296375 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.taxi_rides_ny.my_second_dbt_model"
10:06:38.296616 [debug] [Thread-4  ]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
10:06:38.296846 [debug] [Thread-4  ]: Compiling model.taxi_rides_ny.my_second_dbt_model
10:06:38.299175 [debug] [Thread-4  ]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
10:06:38.300064 [debug] [Thread-4  ]: finished collecting timing info
10:06:38.300371 [debug] [Thread-4  ]: Began executing node model.taxi_rides_ny.my_second_dbt_model
10:06:38.300609 [debug] [Thread-4  ]: finished collecting timing info
10:06:38.301007 [debug] [Thread-4  ]: Finished running node model.taxi_rides_ny.my_second_dbt_model
10:06:38.302994 [debug] [MainThread]: Connection 'master' was properly closed.
10:06:38.303453 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_first_dbt_model' was properly closed.
10:06:38.303805 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_green_trip_data' was properly closed.
10:06:38.304136 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_yellow_trip_data' was properly closed.
10:06:38.304395 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_second_dbt_model' was properly closed.
10:06:38.309209 [info ] [MainThread]: Done.
10:06:38.309647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91d19d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91d1a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b5a5e0>]}


============================== 2024-02-10 10:07:32.282238 | 6a9ef88a-d40b-41da-bd3c-ad278640011f ==============================
10:07:32.282238 [info ] [MainThread]: Running with dbt=1.0.9
10:07:32.283304 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
10:07:32.283791 [debug] [MainThread]: Tracking: tracking
10:07:32.302689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c03730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c03610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c03670>]}
10:07:32.346974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
10:07:32.347766 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://taxi_rides_ny/macros/get_payment_type_desc.sql
10:07:32.348107 [debug] [MainThread]: Parsing taxi_rides_ny/macros/get_payment_type_desc.sql
10:07:32.391879 [debug] [MainThread]: 1603: static parser failed on staging/stg_green_trip_data.sql
10:07:32.404431 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_green_trip_data.sql
10:07:32.413698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a9ef88a-d40b-41da-bd3c-ad278640011f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff86610d0>]}
10:07:32.423685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a9ef88a-d40b-41da-bd3c-ad278640011f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b5f5e0>]}
10:07:32.424201 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 190 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
10:07:32.425850 [info ] [MainThread]: 
10:07:32.426507 [debug] [MainThread]: Acquiring new bigquery connection "master"
10:07:32.428099 [debug] [ThreadPool]: Acquiring new bigquery connection "list_de-zoomcamp-413815_trips_all_data"
10:07:32.428437 [debug] [ThreadPool]: Opening a new connection, currently in state init
10:07:33.071546 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
10:07:33.073606 [info ] [MainThread]: 
10:07:33.110739 [debug] [Thread-1  ]: Began running node model.taxi_rides_ny.my_first_dbt_model
10:07:33.111185 [debug] [Thread-2  ]: Began running node model.taxi_rides_ny.stg_green_trip_data
10:07:33.111413 [debug] [Thread-3  ]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
10:07:33.112424 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.taxi_rides_ny.my_first_dbt_model"
10:07:33.113249 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.taxi_rides_ny.stg_green_trip_data"
10:07:33.113892 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.taxi_rides_ny.stg_yellow_trip_data"
10:07:33.114362 [debug] [Thread-1  ]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
10:07:33.114792 [debug] [Thread-2  ]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
10:07:33.115162 [debug] [Thread-3  ]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
10:07:33.115594 [debug] [Thread-1  ]: Compiling model.taxi_rides_ny.my_first_dbt_model
10:07:33.116054 [debug] [Thread-2  ]: Compiling model.taxi_rides_ny.stg_green_trip_data
10:07:33.116428 [debug] [Thread-3  ]: Compiling model.taxi_rides_ny.stg_yellow_trip_data
10:07:33.119998 [debug] [Thread-1  ]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
10:07:33.123363 [debug] [Thread-2  ]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
10:07:33.126375 [debug] [Thread-3  ]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
10:07:33.128348 [debug] [Thread-1  ]: finished collecting timing info
10:07:33.128519 [debug] [Thread-2  ]: finished collecting timing info
10:07:33.128828 [debug] [Thread-3  ]: finished collecting timing info
10:07:33.128984 [debug] [Thread-1  ]: Began executing node model.taxi_rides_ny.my_first_dbt_model
10:07:33.129318 [debug] [Thread-2  ]: Began executing node model.taxi_rides_ny.stg_green_trip_data
10:07:33.129675 [debug] [Thread-3  ]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
10:07:33.130032 [debug] [Thread-1  ]: finished collecting timing info
10:07:33.130334 [debug] [Thread-2  ]: finished collecting timing info
10:07:33.130646 [debug] [Thread-3  ]: finished collecting timing info
10:07:33.131199 [debug] [Thread-1  ]: Finished running node model.taxi_rides_ny.my_first_dbt_model
10:07:33.131689 [debug] [Thread-2  ]: Finished running node model.taxi_rides_ny.stg_green_trip_data
10:07:33.132139 [debug] [Thread-3  ]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
10:07:33.132797 [debug] [Thread-4  ]: Began running node model.taxi_rides_ny.my_second_dbt_model
10:07:33.133617 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.taxi_rides_ny.my_second_dbt_model"
10:07:33.133904 [debug] [Thread-4  ]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
10:07:33.134158 [debug] [Thread-4  ]: Compiling model.taxi_rides_ny.my_second_dbt_model
10:07:33.136553 [debug] [Thread-4  ]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
10:07:33.137646 [debug] [Thread-4  ]: finished collecting timing info
10:07:33.138054 [debug] [Thread-4  ]: Began executing node model.taxi_rides_ny.my_second_dbt_model
10:07:33.138422 [debug] [Thread-4  ]: finished collecting timing info
10:07:33.138976 [debug] [Thread-4  ]: Finished running node model.taxi_rides_ny.my_second_dbt_model
10:07:33.141023 [debug] [MainThread]: Connection 'master' was properly closed.
10:07:33.141363 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_first_dbt_model' was properly closed.
10:07:33.141606 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_green_trip_data' was properly closed.
10:07:33.141854 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_yellow_trip_data' was properly closed.
10:07:33.142090 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_second_dbt_model' was properly closed.
10:07:33.147144 [info ] [MainThread]: Done.
10:07:33.147600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9af3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9af3520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b5f640>]}


============================== 2024-02-10 10:08:05.122188 | afbac3d9-4a81-45e0-8401-2822fa17c09e ==============================
10:08:05.122188 [info ] [MainThread]: Running with dbt=1.0.9
10:08:05.123210 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
10:08:05.123713 [debug] [MainThread]: Tracking: tracking
10:08:05.141974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c08850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c08760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c087c0>]}
10:08:05.187444 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
10:08:05.188240 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://taxi_rides_ny/macros/get_payment_type_desc.sql
10:08:05.188582 [debug] [MainThread]: Parsing taxi_rides_ny/macros/get_payment_type_desc.sql
10:08:05.231319 [debug] [MainThread]: 1603: static parser failed on staging/stg_green_trip_data.sql
10:08:05.243629 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_green_trip_data.sql
10:08:05.252987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afbac3d9-4a81-45e0-8401-2822fa17c09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff865e0d0>]}
10:08:05.262199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afbac3d9-4a81-45e0-8401-2822fa17c09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c4a6a0>]}
10:08:05.262683 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 190 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
10:08:05.264359 [info ] [MainThread]: 
10:08:05.265062 [debug] [MainThread]: Acquiring new bigquery connection "master"
10:08:05.266711 [debug] [ThreadPool]: Acquiring new bigquery connection "list_de-zoomcamp-413815_trips_all_data"
10:08:05.267053 [debug] [ThreadPool]: Opening a new connection, currently in state init
10:08:05.914280 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
10:08:05.920119 [info ] [MainThread]: 
10:08:05.956841 [debug] [Thread-1  ]: Began running node model.taxi_rides_ny.my_first_dbt_model
10:08:05.957227 [debug] [Thread-2  ]: Began running node model.taxi_rides_ny.stg_green_trip_data
10:08:05.957437 [debug] [Thread-3  ]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
10:08:05.958444 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.taxi_rides_ny.my_first_dbt_model"
10:08:05.959329 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.taxi_rides_ny.stg_green_trip_data"
10:08:05.960032 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.taxi_rides_ny.stg_yellow_trip_data"
10:08:05.960508 [debug] [Thread-1  ]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
10:08:05.960900 [debug] [Thread-2  ]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
10:08:05.961357 [debug] [Thread-3  ]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
10:08:05.961779 [debug] [Thread-1  ]: Compiling model.taxi_rides_ny.my_first_dbt_model
10:08:05.962163 [debug] [Thread-2  ]: Compiling model.taxi_rides_ny.stg_green_trip_data
10:08:05.962588 [debug] [Thread-3  ]: Compiling model.taxi_rides_ny.stg_yellow_trip_data
10:08:05.966172 [debug] [Thread-1  ]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
10:08:05.969434 [debug] [Thread-2  ]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
10:08:05.972096 [debug] [Thread-3  ]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
10:08:05.975028 [debug] [Thread-1  ]: finished collecting timing info
10:08:05.975180 [debug] [Thread-2  ]: finished collecting timing info
10:08:05.975436 [debug] [Thread-3  ]: finished collecting timing info
10:08:05.975598 [debug] [Thread-1  ]: Began executing node model.taxi_rides_ny.my_first_dbt_model
10:08:05.975953 [debug] [Thread-2  ]: Began executing node model.taxi_rides_ny.stg_green_trip_data
10:08:05.976281 [debug] [Thread-3  ]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
10:08:05.976576 [debug] [Thread-1  ]: finished collecting timing info
10:08:05.976850 [debug] [Thread-2  ]: finished collecting timing info
10:08:05.977128 [debug] [Thread-3  ]: finished collecting timing info
10:08:05.977594 [debug] [Thread-1  ]: Finished running node model.taxi_rides_ny.my_first_dbt_model
10:08:05.978022 [debug] [Thread-2  ]: Finished running node model.taxi_rides_ny.stg_green_trip_data
10:08:05.978434 [debug] [Thread-3  ]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
10:08:05.979048 [debug] [Thread-4  ]: Began running node model.taxi_rides_ny.my_second_dbt_model
10:08:05.979861 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.taxi_rides_ny.my_second_dbt_model"
10:08:05.980139 [debug] [Thread-4  ]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
10:08:05.980410 [debug] [Thread-4  ]: Compiling model.taxi_rides_ny.my_second_dbt_model
10:08:05.982725 [debug] [Thread-4  ]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
10:08:05.983871 [debug] [Thread-4  ]: finished collecting timing info
10:08:05.984171 [debug] [Thread-4  ]: Began executing node model.taxi_rides_ny.my_second_dbt_model
10:08:05.984428 [debug] [Thread-4  ]: finished collecting timing info
10:08:05.984832 [debug] [Thread-4  ]: Finished running node model.taxi_rides_ny.my_second_dbt_model
10:08:05.986842 [debug] [MainThread]: Connection 'master' was properly closed.
10:08:05.987195 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_first_dbt_model' was properly closed.
10:08:05.987457 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_green_trip_data' was properly closed.
10:08:05.987721 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_yellow_trip_data' was properly closed.
10:08:05.987982 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_second_dbt_model' was properly closed.
10:08:05.993030 [info ] [MainThread]: Done.
10:08:05.993564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9af34f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9af3460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9b5f1f0>]}


============================== 2024-02-10 10:19:51.824490 | 1c62bd17-c84e-4478-b1b0-b282f1e7b585 ==============================
10:19:51.824490 [info ] [MainThread]: Running with dbt=1.0.9
10:19:51.826925 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, defer=None, state=None, cls=<class 'dbt.task.deps.DepsTask'>, which='deps', rpc_method='deps')
10:19:51.827406 [debug] [MainThread]: Tracking: tracking
10:19:51.846964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b1b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b1940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b1970>]}
10:19:51.849603 [info ] [MainThread]: Warning: No packages were found in packages.yml
10:19:51.850428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b1b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb989a60>]}


============================== 2024-02-10 10:21:04.129464 | 47ef5b05-3372-4469-ac38-91570df6568f ==============================
10:21:04.129464 [info ] [MainThread]: Running with dbt=1.0.9
10:21:04.131571 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, defer=None, state=None, cls=<class 'dbt.task.deps.DepsTask'>, which='deps', rpc_method='deps')
10:21:04.131926 [debug] [MainThread]: Tracking: tracking
10:21:04.153278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b1e20>]}
10:21:04.158252 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_9psic7j'
10:21:04.159001 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
10:21:04.357252 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
10:21:04.359168 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
10:21:04.501002 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
10:21:04.560184 [info ] [MainThread]: Installing dbt-labs/dbt_utils
10:21:05.516783 [info ] [MainThread]:   Installed from version 1.1.1
10:21:05.517537 [info ] [MainThread]:   Up to date!
10:21:05.518378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '47ef5b05-3372-4469-ac38-91570df6568f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9dc910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9dc790>]}
10:21:05.520285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb989400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b3a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b1e20>]}


============================== 2024-02-10 10:23:25.382031 | f86ed6a1-fc44-407e-8e2d-954f407351b2 ==============================
10:23:25.382031 [info ] [MainThread]: Running with dbt=1.0.9
10:23:25.383113 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
10:23:25.383637 [debug] [MainThread]: Tracking: tracking
10:23:25.403404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c0dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c0d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c0da30>]}
10:23:25.425859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9bdfa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c38a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c38730>]}


============================== 2024-02-10 10:26:23.776761 | 6945511f-b130-43fd-aa04-261bf12babac ==============================
10:26:23.776761 [info ] [MainThread]: Running with dbt=1.0.9
10:26:23.777724 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
10:26:23.778132 [debug] [MainThread]: Tracking: tracking
10:26:23.795861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c0a790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c0a880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c0a820>]}
10:26:23.814880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c2dd00>]}


============================== 2024-02-10 10:26:45.730224 | 6735780a-71c6-4118-8fe0-2e4e13a0240e ==============================
10:26:45.730224 [info ] [MainThread]: Running with dbt=1.0.9
10:26:45.731260 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
10:26:45.731793 [debug] [MainThread]: Tracking: tracking
10:26:45.749494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c0ca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c0c970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c0c9d0>]}
10:26:45.768841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9be0b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c38a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c38640>]}


============================== 2024-02-10 10:32:01.084735 | 52e5120e-7e20-4794-9347-9f21c13483d1 ==============================
10:32:01.084735 [info ] [MainThread]: Running with dbt=1.0.9
10:32:01.086002 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
10:32:01.086484 [debug] [MainThread]: Tracking: tracking
10:32:01.104317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c0b790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c0b880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c0b820>]}
10:32:01.123941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c4a580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c4a550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c4adc0>]}


============================== 2024-02-10 10:32:25.979571 | bc10a0b4-172e-4d29-b723-a1a8f5200b65 ==============================
10:32:25.979571 [info ] [MainThread]: Running with dbt=1.0.9
10:32:25.981549 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, project_name=None, skip_profile_setup=False, defer=None, state=None, cls=<class 'dbt.task.init.InitTask'>, which='init', rpc_method=None)
10:32:25.982031 [debug] [MainThread]: Tracking: tracking
10:32:26.002146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b2ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b2f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9b2f10>]}
10:32:26.004572 [info ] [MainThread]: Setting up your profile.
10:32:32.432967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb95aa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb95a880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb95a8e0>]}


============================== 2024-02-10 10:33:17.159169 | 62afbab1-d1ad-4143-b390-87e59151ea34 ==============================
10:33:17.159169 [info ] [MainThread]: Running with dbt=1.0.9
10:33:17.160190 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
10:33:17.160603 [debug] [MainThread]: Tracking: tracking
10:33:17.178830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c0dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c0d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c0da30>]}
10:33:17.197532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9be0a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c38a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c38730>]}


============================== 2024-02-10 10:34:20.840119 | 460c8034-ed31-42fc-a7f2-9d136f1220ba ==============================
10:34:20.840119 [info ] [MainThread]: Running with dbt=1.0.9
10:34:20.842025 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, defer=None, state=None, cls=<class 'dbt.task.deps.DepsTask'>, which='deps', rpc_method='deps')
10:34:20.842514 [debug] [MainThread]: Tracking: tracking
10:34:20.862483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9aff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9af7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9afeb0>]}
10:34:20.865404 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-18crckoq'
10:34:20.866066 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
10:34:21.016800 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
10:34:21.019042 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
10:34:21.132374 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
10:34:21.189313 [info ] [MainThread]: Installing dbt-labs/dbt_utils
10:34:22.018229 [info ] [MainThread]:   Installed from version 1.0.0
10:34:22.018931 [info ] [MainThread]:   Updated version available: 1.1.1
10:34:22.019678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '460c8034-ed31-42fc-a7f2-9d136f1220ba', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9dcfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9dce20>]}
10:34:22.020233 [info ] [MainThread]: 
10:34:22.020725 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
10:34:22.021428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb989730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb976190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9760d0>]}


============================== 2024-02-10 10:34:29.141957 | 5055425d-2c76-42db-a27f-e7947cf633c8 ==============================
10:34:29.141957 [info ] [MainThread]: Running with dbt=1.0.9
10:34:29.143029 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, parse_only=False, threads=None, select=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
10:34:29.143574 [debug] [MainThread]: Tracking: tracking
10:34:29.162178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c0a790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c0a880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c0a820>]}
10:34:29.182125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c4a700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c4a8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9c4a460>]}
[0m11:02:02.135814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00e6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d210>]}


============================== 11:02:02.148334 | ecd42764-af20-4970-82e7-70af0e818e4d ==============================
[0m11:02:02.148334 [info ] [MainThread]: Running with dbt=1.7.7
[0m11:02:02.149300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:02:02.228503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecd42764-af20-4970-82e7-70af0e818e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf952d0>]}
[0m11:02:02.230407 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-l4aygbc4'
[0m11:02:02.231005 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:02:02.599326 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:02:02.603541 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:02:02.794264 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:02:02.825076 [info ] [MainThread]: Updating lock file in file path: /usr/app/dbt/package-lock.yml
[0m11:02:02.895056 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-47b8nmwc'
[0m11:02:02.899165 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m11:02:03.721234 [info ] [MainThread]: Installed from version 1.0.0
[0m11:02:03.722326 [info ] [MainThread]: Updated version available: 1.1.1
[0m11:02:03.723238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ecd42764-af20-4970-82e7-70af0e818e4d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaff4190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffadfabf0>]}
[0m11:02:03.724156 [info ] [MainThread]: 
[0m11:02:03.725474 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m11:02:03.728822 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.6496327, "process_user_time": 1.928404, "process_kernel_time": 0.152665, "process_mem_max_rss": "109188", "process_in_blocks": "4440", "process_out_blocks": "808"}
[0m11:02:03.730117 [debug] [MainThread]: Command `dbt deps` succeeded at 11:02:03.729795 after 1.65 seconds
[0m11:02:03.730946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00ea70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d4b0>]}
[0m11:02:03.731845 [debug] [MainThread]: Flushing usage events
[0m11:02:13.026051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f8b0>]}


============================== 11:02:13.038159 | 09fa0167-c74d-4e9a-a6f9-e91d81aed36c ==============================
[0m11:02:13.038159 [info ] [MainThread]: Running with dbt=1.7.7
[0m11:02:13.039178 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt compile', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:02:13.408075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09fa0167-c74d-4e9a-a6f9-e91d81aed36c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc30e2f0>]}
[0m11:02:13.480324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09fa0167-c74d-4e9a-a6f9-e91d81aed36c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9418820>]}
[0m11:02:13.481282 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m11:02:13.495801 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m11:02:13.504694 [debug] [MainThread]: Failed to load parsed file from disk at /usr/app/dbt/target/partial_parse.msgpack: Field "nodes" of type MutableMapping[str, Union[AnalysisNode, SingularTestNode, HookNode, ModelNode, RPCNode, SqlNode, GenericTestNode, SnapshotNode, SeedNode]] in Manifest has invalid value {'model.taxi_rides_ny.my_first_dbt_model': {'raw_sql': '/*\n    Welcome to your first dbt model!\n    Did you know that you can also configure models directly within SQL files?\n    This will override configurations stated in dbt_project.yml\n\n    Try changing "table" to "view" below\n*/\n\n{{ config(materialized=\'table\') }}\n\nwith source_data as (\n\n    select 1 as id\n    union all\n    select null as id\n\n)\n\nselect *\nfrom source_data\n\n/*\n    Uncomment the line below to remove records with null `id` values\n*/\n\n-- where id is not null', 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': []}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'table', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'on_schema_change': 'ignore', 'post-hook': [], 'pre-hook': []}, 'database': 'de-zoomcamp-413815', 'schema': 'trips_all_data', 'fqn': ['taxi_rides_ny', 'example', 'my_first_dbt_model'], 'unique_id': 'model.taxi_rides_ny.my_first_dbt_model', 'package_name': 'taxi_rides_ny', 'root_path': '/usr/app/dbt', 'path': 'example/my_first_dbt_model.sql', 'original_file_path': 'taxi_rides_ny/models/example/my_first_dbt_model.sql', 'name': 'my_first_dbt_model', 'alias': 'my_first_dbt_model', 'checksum': {'name': 'sha256', 'checksum': '842251f5ed1d97920d3748d9686b8c05a3a0071ec7990f948f36796491788aed'}, 'tags': [], 'refs': [], 'sources': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'table'}, 'created_at': 1707551224.4932497}, 'model.taxi_rides_ny.my_second_dbt_model': {'raw_sql': "-- Use the `ref` function to select from other models\n\nselect *\nfrom {{ ref('my_first_dbt_model') }}\nwhere id = 1", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['model.taxi_rides_ny.my_first_dbt_model']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'view', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'on_schema_change': 'ignore', 'post-hook': [], 'pre-hook': []}, 'database': 'de-zoomcamp-413815', 'schema': 'trips_all_data', 'fqn': ['taxi_rides_ny', 'example', 'my_second_dbt_model'], 'unique_id': 'model.taxi_rides_ny.my_second_dbt_model', 'package_name': 'taxi_rides_ny', 'root_path': '/usr/app/dbt', 'path': 'example/my_second_dbt_model.sql', 'original_file_path': 'taxi_rides_ny/models/example/my_second_dbt_model.sql', 'name': 'my_second_dbt_model', 'alias': 'my_second_dbt_model', 'checksum': {'name': 'sha256', 'checksum': 'b3aa346f283f3c9c9a75936f3b80d2572ca9ab39aee4c02b30553d3fe2ba5692'}, 'tags': [], 'refs': [['my_first_dbt_model']], 'sources': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {'materialized': 'view'}, 'created_at': 1707551224.5383298}, 'model.taxi_rides_ny.stg_yellow_trip_data': {'raw_sql': "with\n\nsources as(\n    select * from {{ source('staging', 'yello_trip_data') }} limit 20\n)\n\nselect * from sources", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['source.taxi_rides_ny.staging.yello_trip_data']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'view', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'on_schema_change': 'ignore', 'post-hook': [], 'pre-hook': []}, 'database': 'de-zoomcamp-413815', 'schema': 'trips_all_data', 'fqn': ['taxi_rides_ny', 'staging', 'stg_yellow_trip_data'], 'unique_id': 'model.taxi_rides_ny.stg_yellow_trip_data', 'package_name': 'taxi_rides_ny', 'root_path': '/usr/app/dbt', 'path': 'staging/stg_yellow_trip_data.sql', 'original_file_path': 'taxi_rides_ny/models/staging/stg_yellow_trip_data.sql', 'name': 'stg_yellow_trip_data', 'alias': 'stg_yellow_trip_data', 'checksum': {'name': 'sha256', 'checksum': 'fe10f9269f3c63b3203138bfdfdf1b533639fcc246b71878a1bf72b4d74cc68b'}, 'tags': [], 'refs': [], 'sources': [['staging', 'yello_trip_data']], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1707559463.8190799}, 'model.taxi_rides_ny.stg_green_trip_data': {'raw_sql': "with source as\n(select * \n    from {{ source('staging', 'green_taxi_data_internal') }}\n    )\nSELECT\n  VendorID,\n  lpep_pickup_datetime,\n  lpep_dropoff_datetime,\n  store_and_fwd_flag,\n  RatecodeID,\n  PULocationID,\n  DOLocationID,\n  passenger_count,\n  trip_distance,\n  fare_amount,\n  extra,\n  mta_tax,\n  tip_amount,\n  tolls_amount,\n  ehail_fee,\n  improvement_surcharge,\n  total_amount,\n  {{ get_payment_type_desc('payment_type') }} as payment_type_desc,\n  trip_type,\n  congestion_surcharge\nFROM source", 'resource_type': 'model', 'depends_on': {'macros': ['macro.taxi_rides_ny.get_payment_type_desc'], 'nodes': ['source.taxi_rides_ny.staging.green_taxi_data_internal']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'view', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'on_schema_change': 'ignore', 'post-hook': [], 'pre-hook': []}, 'database': 'de-zoomcamp-413815', 'schema': 'trips_all_data', 'fqn': ['taxi_rides_ny', 'staging', 'stg_green_trip_data'], 'unique_id': 'model.taxi_rides_ny.stg_green_trip_data', 'package_name': 'taxi_rides_ny', 'root_path': '/usr/app/dbt', 'path': 'staging/stg_green_trip_data.sql', 'original_file_path': 'taxi_rides_ny/models/staging/stg_green_trip_data.sql', 'name': 'stg_green_trip_data', 'alias': 'stg_green_trip_data', 'checksum': {'name': 'sha256', 'checksum': '5d2ffc23a4a4ca85e1f931b86871c29b9e7209021aa5b9784678ae12e2dbbd52'}, 'tags': [], 'refs': [], 'sources': [['staging', 'green_taxi_data_internal']], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1707559685.2001524}}
[0m11:02:13.505939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '09fa0167-c74d-4e9a-a6f9-e91d81aed36c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff96398d0>]}
[0m11:02:14.634239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09fa0167-c74d-4e9a-a6f9-e91d81aed36c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7b600d0>]}
[0m11:02:14.648015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09fa0167-c74d-4e9a-a6f9-e91d81aed36c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95a7340>]}
[0m11:02:14.648680 [info ] [MainThread]: Found 4 models, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m11:02:14.649335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09fa0167-c74d-4e9a-a6f9-e91d81aed36c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91b2d70>]}
[0m11:02:14.651395 [info ] [MainThread]: 
[0m11:02:14.652481 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:02:14.654505 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_trips_all_data'
[0m11:02:14.655449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:15.455823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09fa0167-c74d-4e9a-a6f9-e91d81aed36c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7caa200>]}
[0m11:02:15.458098 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:02:15.459419 [info ] [MainThread]: 
[0m11:02:15.471017 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.my_first_dbt_model
[0m11:02:15.471653 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m11:02:15.472120 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
[0m11:02:15.473316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_trips_all_data, now model.taxi_rides_ny.my_first_dbt_model)
[0m11:02:15.474668 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.stg_green_trip_data'
[0m11:02:15.475799 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.stg_yellow_trip_data'
[0m11:02:15.476570 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
[0m11:02:15.477299 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m11:02:15.478071 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
[0m11:02:15.487610 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
[0m11:02:15.494215 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m11:02:15.497973 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m11:02:15.501125 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (compile): 11:02:15.478663 => 11:02:15.500680
[0m11:02:15.501691 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (compile): 11:02:15.494842 => 11:02:15.501398
[0m11:02:15.502212 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 11:02:15.488392 => 11:02:15.501947
[0m11:02:15.502814 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.my_first_dbt_model
[0m11:02:15.503444 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
[0m11:02:15.503993 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m11:02:15.504625 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (execute): 11:02:15.504386 => 11:02:15.504402
[0m11:02:15.505258 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (execute): 11:02:15.505035 => 11:02:15.505043
[0m11:02:15.505849 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 11:02:15.505628 => 11:02:15.505636
[0m11:02:15.507192 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.my_first_dbt_model
[0m11:02:15.508439 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
[0m11:02:15.509535 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m11:02:15.510427 [debug] [Thread-4 (]: Began running node model.taxi_rides_ny.my_second_dbt_model
[0m11:02:15.511778 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.my_second_dbt_model'
[0m11:02:15.512483 [debug] [Thread-4 (]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
[0m11:02:15.519130 [debug] [Thread-4 (]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
[0m11:02:15.520971 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (compile): 11:02:15.512964 => 11:02:15.520712
[0m11:02:15.521468 [debug] [Thread-4 (]: Began executing node model.taxi_rides_ny.my_second_dbt_model
[0m11:02:15.522046 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (execute): 11:02:15.521819 => 11:02:15.521829
[0m11:02:15.523041 [debug] [Thread-4 (]: Finished running node model.taxi_rides_ny.my_second_dbt_model
[0m11:02:15.525203 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:02:15.525635 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_first_dbt_model' was properly closed.
[0m11:02:15.526033 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_green_trip_data' was properly closed.
[0m11:02:15.526399 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_yellow_trip_data' was properly closed.
[0m11:02:15.526730 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_second_dbt_model' was properly closed.
[0m11:02:15.527690 [debug] [MainThread]: Command end result
[0m11:02:15.538325 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.567148, "process_user_time": 3.354417, "process_kernel_time": 0.131329, "process_mem_max_rss": "151256", "process_in_blocks": "400", "process_out_blocks": "704"}
[0m11:02:15.539235 [debug] [MainThread]: Command `dbt compile` succeeded at 11:02:15.539052 after 2.57 seconds
[0m11:02:15.539725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7ca9330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91bb7c0>]}
[0m11:02:15.540195 [debug] [MainThread]: Flushing usage events
[0m13:42:59.517946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00dc30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00e8f0>]}


============================== 13:42:59.532977 | f9892c62-763d-44fd-92ab-604b4ccfda3f ==============================
[0m13:42:59.532977 [info ] [MainThread]: Running with dbt=1.7.7
[0m13:42:59.534108 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt compile', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:43:00.036420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9892c62-763d-44fd-92ab-604b4ccfda3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc6fc160>]}
[0m13:43:00.112420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9892c62-763d-44fd-92ab-604b4ccfda3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95e5e70>]}
[0m13:43:00.113544 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m13:43:00.129744 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m13:43:00.204807 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:43:00.205415 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:43:00.211834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9892c62-763d-44fd-92ab-604b4ccfda3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92980d0>]}
[0m13:43:00.228613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9892c62-763d-44fd-92ab-604b4ccfda3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9264bb0>]}
[0m13:43:00.229341 [info ] [MainThread]: Found 4 models, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m13:43:00.229954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9892c62-763d-44fd-92ab-604b4ccfda3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9266710>]}
[0m13:43:00.231989 [info ] [MainThread]: 
[0m13:43:00.233295 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:43:00.236323 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_trips_all_data'
[0m13:43:00.237359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:01.037341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9892c62-763d-44fd-92ab-604b4ccfda3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9264af0>]}
[0m13:43:01.040913 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:43:01.042468 [info ] [MainThread]: 
[0m13:43:01.063489 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.my_first_dbt_model
[0m13:43:01.064640 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m13:43:01.065377 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
[0m13:43:01.067701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_trips_all_data, now model.taxi_rides_ny.my_first_dbt_model)
[0m13:43:01.070183 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.stg_green_trip_data'
[0m13:43:01.071901 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.stg_yellow_trip_data'
[0m13:43:01.072822 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
[0m13:43:01.073722 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m13:43:01.074599 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
[0m13:43:01.088398 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
[0m13:43:01.107266 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m13:43:01.110309 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m13:43:01.113189 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (compile): 13:43:01.075322 => 13:43:01.112949
[0m13:43:01.114033 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 13:43:01.089070 => 13:43:01.113798
[0m13:43:01.114390 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.my_first_dbt_model
[0m13:43:01.114806 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (compile): 13:43:01.107569 => 13:43:01.114579
[0m13:43:01.115235 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m13:43:01.115847 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (execute): 13:43:01.115622 => 13:43:01.115638
[0m13:43:01.116302 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
[0m13:43:01.116823 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 13:43:01.116616 => 13:43:01.116622
[0m13:43:01.117961 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.my_first_dbt_model
[0m13:43:01.118479 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (execute): 13:43:01.118295 => 13:43:01.118301
[0m13:43:01.119420 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m13:43:01.120190 [debug] [Thread-4 (]: Began running node model.taxi_rides_ny.my_second_dbt_model
[0m13:43:01.121099 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
[0m13:43:01.122208 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.my_second_dbt_model'
[0m13:43:01.122881 [debug] [Thread-4 (]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
[0m13:43:01.129215 [debug] [Thread-4 (]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
[0m13:43:01.130914 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (compile): 13:43:01.123220 => 13:43:01.130684
[0m13:43:01.131358 [debug] [Thread-4 (]: Began executing node model.taxi_rides_ny.my_second_dbt_model
[0m13:43:01.131885 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (execute): 13:43:01.131679 => 13:43:01.131695
[0m13:43:01.132823 [debug] [Thread-4 (]: Finished running node model.taxi_rides_ny.my_second_dbt_model
[0m13:43:01.135016 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:01.135423 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_first_dbt_model' was properly closed.
[0m13:43:01.135773 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_green_trip_data' was properly closed.
[0m13:43:01.136119 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_yellow_trip_data' was properly closed.
[0m13:43:01.136463 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_second_dbt_model' was properly closed.
[0m13:43:01.137439 [debug] [MainThread]: Command end result
[0m13:43:01.150855 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.6964151, "process_user_time": 2.603249, "process_kernel_time": 0.407604, "process_mem_max_rss": "141692", "process_in_blocks": "98952", "process_out_blocks": "704"}
[0m13:43:01.151687 [debug] [MainThread]: Command `dbt compile` succeeded at 13:43:01.151503 after 1.70 seconds
[0m13:43:01.152179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff914d750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff914e890>]}
[0m13:43:01.152644 [debug] [MainThread]: Flushing usage events
[0m13:52:32.069507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00ef80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f940>]}


============================== 13:52:32.084411 | ca348149-fb49-40e9-aa67-cbbfb711bff3 ==============================
[0m13:52:32.084411 [info ] [MainThread]: Running with dbt=1.7.7
[0m13:52:32.085721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt compile', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:52:32.517708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca348149-fb49-40e9-aa67-cbbfb711bff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc6dcee0>]}
[0m13:52:32.602552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca348149-fb49-40e9-aa67-cbbfb711bff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9418820>]}
[0m13:52:32.603797 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m13:52:32.623152 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m13:52:32.697278 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:52:32.698054 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://taxi_rides_ny/models/staging/stg_green_trip_data.sql
[0m13:52:32.818418 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_green_trip_data (taxi_rides_ny/models/staging/stg_green_trip_data.sql)
  
  Warning: `dbt_utils.surrogate_key` has been replaced by `dbt_utils.generate_surrogate_key`. The new macro treats null values differently to empty strings. To restore the behaviour of the original macro, add a global variable in dbt_project.yml called `surrogate_key_treat_nulls_as_empty_strings` to your dbt_project.yml file with a value of True. The taxi_rides_ny.stg_green_trip_data model triggered this warning. 
  
  > in macro default__surrogate_key (macros/sql/surrogate_key.sql)
  > called by macro surrogate_key (macros/sql/surrogate_key.sql)
  > called by model stg_green_trip_data (taxi_rides_ny/models/staging/stg_green_trip_data.sql)
[0m13:52:32.821049 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.8106782, "process_user_time": 2.413798, "process_kernel_time": 0.250563, "process_mem_max_rss": "133552", "process_in_blocks": "1752", "process_out_blocks": "648", "command_success": false}
[0m13:52:32.821856 [debug] [MainThread]: Command `dbt compile` failed at 13:52:32.821680 after 0.81 seconds
[0m13:52:32.822474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff919e050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff919dab0>]}
[0m13:52:32.822933 [debug] [MainThread]: Flushing usage events
[0m13:53:00.170838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00e710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d1e0>]}


============================== 13:53:00.182879 | f1c44a3f-0be2-4fcd-9ce6-bd2896f4f1dd ==============================
[0m13:53:00.182879 [info ] [MainThread]: Running with dbt=1.7.7
[0m13:53:00.183822 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:53:00.601175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1c44a3f-0be2-4fcd-9ce6-bd2896f4f1dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc57afb0>]}
[0m13:53:00.679706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1c44a3f-0be2-4fcd-9ce6-bd2896f4f1dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc35e290>]}
[0m13:53:00.680871 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m13:53:00.696018 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m13:53:00.764068 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:53:00.764950 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://taxi_rides_ny/models/staging/stg_green_trip_data.sql
[0m13:53:00.897580 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_green_trip_data (taxi_rides_ny/models/staging/stg_green_trip_data.sql)
  
  Warning: `dbt_utils.surrogate_key` has been replaced by `dbt_utils.generate_surrogate_key`. The new macro treats null values differently to empty strings. To restore the behaviour of the original macro, add a global variable in dbt_project.yml called `surrogate_key_treat_nulls_as_empty_strings` to your dbt_project.yml file with a value of True. The taxi_rides_ny.stg_green_trip_data model triggered this warning. 
  
  > in macro default__surrogate_key (macros/sql/surrogate_key.sql)
  > called by macro surrogate_key (macros/sql/surrogate_key.sql)
  > called by model stg_green_trip_data (taxi_rides_ny/models/staging/stg_green_trip_data.sql)
[0m13:53:00.900358 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.78347576, "process_user_time": 2.362776, "process_kernel_time": 0.132379, "process_mem_max_rss": "133424", "process_in_blocks": "208", "process_out_blocks": "648", "command_success": false}
[0m13:53:00.901208 [debug] [MainThread]: Command `dbt compile` failed at 13:53:00.901037 after 0.79 seconds
[0m13:53:00.901929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff919e2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff919f790>]}
[0m13:53:00.902497 [debug] [MainThread]: Flushing usage events
[0m13:53:41.399956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00dc30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00e8f0>]}


============================== 13:53:41.412088 | da681ae1-6928-48de-bb4f-8f3a353ff80a ==============================
[0m13:53:41.412088 [info ] [MainThread]: Running with dbt=1.7.7
[0m13:53:41.413008 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:53:41.776817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da681ae1-6928-48de-bb4f-8f3a353ff80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc6fc160>]}
[0m13:53:41.850521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da681ae1-6928-48de-bb4f-8f3a353ff80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf098a0>]}
[0m13:53:41.851608 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m13:53:41.865982 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m13:53:41.928858 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:53:41.929734 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://taxi_rides_ny/models/staging/stg_green_trip_data.sql
[0m13:53:42.069248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da681ae1-6928-48de-bb4f-8f3a353ff80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91e4dc0>]}
[0m13:53:42.084863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da681ae1-6928-48de-bb4f-8f3a353ff80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9264c70>]}
[0m13:53:42.085494 [info ] [MainThread]: Found 4 models, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m13:53:42.086116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da681ae1-6928-48de-bb4f-8f3a353ff80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9264d60>]}
[0m13:53:42.088039 [info ] [MainThread]: 
[0m13:53:42.089261 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:53:42.092055 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_trips_all_data'
[0m13:53:42.092868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:42.903844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da681ae1-6928-48de-bb4f-8f3a353ff80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9264bb0>]}
[0m13:53:42.908529 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:53:42.910447 [info ] [MainThread]: 
[0m13:53:42.927893 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.my_first_dbt_model
[0m13:53:42.928942 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m13:53:42.929836 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
[0m13:53:42.931853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_trips_all_data, now model.taxi_rides_ny.my_first_dbt_model)
[0m13:53:42.934154 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.stg_green_trip_data'
[0m13:53:42.935964 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.stg_yellow_trip_data'
[0m13:53:42.936825 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
[0m13:53:42.937645 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m13:53:42.938237 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
[0m13:53:42.949601 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
[0m13:53:42.959666 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 13:53:42.950325 => 13:53:42.959309
[0m13:53:42.962992 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m13:53:42.965866 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (compile): 13:53:42.938826 => 13:53:42.965556
[0m13:53:42.966603 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.my_first_dbt_model
[0m13:53:42.967353 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (execute): 13:53:42.967087 => 13:53:42.967101
[0m13:53:42.967767 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (compile): 13:53:42.959946 => 13:53:42.967536
[0m13:53:42.968980 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.my_first_dbt_model
[0m13:53:42.969557 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
[0m13:53:42.970713 [debug] [Thread-4 (]: Began running node model.taxi_rides_ny.my_second_dbt_model
[0m13:53:42.971146 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (execute): 13:53:42.970940 => 13:53:42.970947
[0m13:53:42.972067 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.my_second_dbt_model'
[0m13:53:42.973359 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
[0m13:53:42.974060 [debug] [Thread-2 (]: Compilation Error in model stg_green_trip_data (taxi_rides_ny/models/staging/stg_green_trip_data.sql)
  'get_payment_type_description' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:53:42.974382 [debug] [Thread-4 (]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
[0m13:53:42.975253 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m13:53:42.981349 [debug] [Thread-4 (]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
[0m13:53:42.983099 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (compile): 13:53:42.975587 => 13:53:42.982873
[0m13:53:42.983553 [debug] [Thread-4 (]: Began executing node model.taxi_rides_ny.my_second_dbt_model
[0m13:53:42.984099 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (execute): 13:53:42.983876 => 13:53:42.983886
[0m13:53:42.985020 [debug] [Thread-4 (]: Finished running node model.taxi_rides_ny.my_second_dbt_model
[0m13:53:42.985971 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:53:42.986695 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_first_dbt_model' was properly closed.
[0m13:53:42.987056 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_green_trip_data' was properly closed.
[0m13:53:42.987427 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_yellow_trip_data' was properly closed.
[0m13:53:42.987766 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_second_dbt_model' was properly closed.
[0m13:53:42.988279 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in model stg_green_trip_data (taxi_rides_ny/models/staging/stg_green_trip_data.sql)
    'get_payment_type_description' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:53:42.989987 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 1.6448123, "process_user_time": 2.49391, "process_kernel_time": 0.151602, "process_mem_max_rss": "144468", "process_in_blocks": "1104", "process_out_blocks": "704", "command_success": false}
[0m13:53:42.990695 [debug] [MainThread]: Command `dbt compile` failed at 13:53:42.990525 after 1.65 seconds
[0m13:53:42.991123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95a34c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95a31f0>]}
[0m13:53:42.991639 [debug] [MainThread]: Flushing usage events
[0m13:54:02.026473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f8b0>]}


============================== 13:54:02.038640 | 18abadde-58e7-42ef-acbe-951e0d2b05f4 ==============================
[0m13:54:02.038640 [info ] [MainThread]: Running with dbt=1.7.7
[0m13:54:02.039593 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:54:02.398938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18abadde-58e7-42ef-acbe-951e0d2b05f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc30e2f0>]}
[0m13:54:02.470361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18abadde-58e7-42ef-acbe-951e0d2b05f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95e4490>]}
[0m13:54:02.471195 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m13:54:02.484957 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m13:54:02.546382 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:54:02.547124 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://taxi_rides_ny/models/staging/stg_green_trip_data.sql
[0m13:54:02.682874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18abadde-58e7-42ef-acbe-951e0d2b05f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91e8a00>]}
[0m13:54:02.696525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18abadde-58e7-42ef-acbe-951e0d2b05f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92624d0>]}
[0m13:54:02.697095 [info ] [MainThread]: Found 4 models, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m13:54:02.697628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18abadde-58e7-42ef-acbe-951e0d2b05f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9260910>]}
[0m13:54:02.699325 [info ] [MainThread]: 
[0m13:54:02.700371 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:54:02.702910 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_trips_all_data'
[0m13:54:02.703846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:03.356392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18abadde-58e7-42ef-acbe-951e0d2b05f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92623b0>]}
[0m13:54:03.361162 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:54:03.362804 [info ] [MainThread]: 
[0m13:54:03.381084 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.my_first_dbt_model
[0m13:54:03.382202 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m13:54:03.382959 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
[0m13:54:03.384636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_trips_all_data, now model.taxi_rides_ny.my_first_dbt_model)
[0m13:54:03.386606 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.stg_green_trip_data'
[0m13:54:03.388732 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.stg_yellow_trip_data'
[0m13:54:03.389995 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
[0m13:54:03.390977 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m13:54:03.391809 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
[0m13:54:03.403891 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
[0m13:54:03.412787 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m13:54:03.416532 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m13:54:03.421744 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (compile): 13:54:03.392456 => 13:54:03.421334
[0m13:54:03.422418 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 13:54:03.404574 => 13:54:03.422150
[0m13:54:03.422821 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.my_first_dbt_model
[0m13:54:03.423430 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (compile): 13:54:03.413281 => 13:54:03.423197
[0m13:54:03.423751 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m13:54:03.424383 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (execute): 13:54:03.424142 => 13:54:03.424161
[0m13:54:03.424872 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
[0m13:54:03.425466 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 13:54:03.425246 => 13:54:03.425253
[0m13:54:03.426703 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.my_first_dbt_model
[0m13:54:03.427334 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (execute): 13:54:03.427106 => 13:54:03.427113
[0m13:54:03.428359 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m13:54:03.429246 [debug] [Thread-4 (]: Began running node model.taxi_rides_ny.my_second_dbt_model
[0m13:54:03.430152 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
[0m13:54:03.431243 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.my_second_dbt_model'
[0m13:54:03.432227 [debug] [Thread-4 (]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
[0m13:54:03.438136 [debug] [Thread-4 (]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
[0m13:54:03.439660 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (compile): 13:54:03.432666 => 13:54:03.439348
[0m13:54:03.440223 [debug] [Thread-4 (]: Began executing node model.taxi_rides_ny.my_second_dbt_model
[0m13:54:03.440833 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (execute): 13:54:03.440603 => 13:54:03.440617
[0m13:54:03.441893 [debug] [Thread-4 (]: Finished running node model.taxi_rides_ny.my_second_dbt_model
[0m13:54:03.444209 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:03.444809 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_first_dbt_model' was properly closed.
[0m13:54:03.445367 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_green_trip_data' was properly closed.
[0m13:54:03.445777 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_yellow_trip_data' was properly closed.
[0m13:54:03.446146 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_second_dbt_model' was properly closed.
[0m13:54:03.447180 [debug] [MainThread]: Command end result
[0m13:54:03.458092 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.4864454, "process_user_time": 2.507736, "process_kernel_time": 0.137875, "process_mem_max_rss": "145140", "process_in_blocks": "176", "process_out_blocks": "704"}
[0m13:54:03.458883 [debug] [MainThread]: Command `dbt compile` succeeded at 13:54:03.458711 after 1.49 seconds
[0m13:54:03.459372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9523100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9520160>]}
[0m13:54:03.459832 [debug] [MainThread]: Flushing usage events
[0m13:55:50.925018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00ef20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f8e0>]}


============================== 13:55:50.937215 | 03074be3-8aa4-44ef-9e5f-224f61cb73f7 ==============================
[0m13:55:50.937215 [info ] [MainThread]: Running with dbt=1.7.7
[0m13:55:50.938260 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt compile --select stg_greent_trip_data --vars {is_test_run: false}', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:55:51.295546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03074be3-8aa4-44ef-9e5f-224f61cb73f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc6ee560>]}
[0m13:55:51.367827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03074be3-8aa4-44ef-9e5f-224f61cb73f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95e71f0>]}
[0m13:55:51.368795 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m13:55:51.382306 [debug] [MainThread]: checksum: 7c46c391780f5adbba4aeed1bb0cabed7e089d22e9df17dd41bd89837fdfafae, vars: {'is_test_run': False}, profile: , target: , version: 1.7.7
[0m13:55:51.396081 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:55:51.396833 [debug] [MainThread]: previous checksum: 7c46c391780f5adbba4aeed1bb0cabed7e089d22e9df17dd41bd89837fdfafae, current checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4
[0m13:55:51.397266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '03074be3-8aa4-44ef-9e5f-224f61cb73f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff963c2b0>]}
[0m13:55:52.530699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03074be3-8aa4-44ef-9e5f-224f61cb73f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7cddc30>]}
[0m13:55:52.544501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03074be3-8aa4-44ef-9e5f-224f61cb73f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7c415d0>]}
[0m13:55:52.545084 [info ] [MainThread]: Found 4 models, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m13:55:52.545600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03074be3-8aa4-44ef-9e5f-224f61cb73f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92987c0>]}
[0m13:55:52.546338 [warn ] [MainThread]: The selection criterion 'stg_greent_trip_data' does not match any nodes
[0m13:55:52.547431 [info ] [MainThread]: 
[0m13:55:52.547915 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:55:52.548798 [debug] [MainThread]: Command end result
[0m13:55:52.559710 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.6895542, "process_user_time": 3.194823, "process_kernel_time": 0.125953, "process_mem_max_rss": "139360", "process_in_blocks": "312", "process_out_blocks": "648"}
[0m13:55:52.560603 [debug] [MainThread]: Command `dbt compile` succeeded at 13:55:52.560390 after 1.69 seconds
[0m13:55:52.561220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9643d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff93dbfa0>]}
[0m13:55:52.561682 [debug] [MainThread]: Flushing usage events
[0m13:56:44.206891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb011bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb011c00>]}


============================== 13:56:44.218609 | 668fc8f4-cc8c-4929-8826-fcb05c80bc6c ==============================
[0m13:56:44.218609 [info ] [MainThread]: Running with dbt=1.7.7
[0m13:56:44.219509 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile --select stg_greent_trip_data --vars {is_test_run: false}', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:56:44.570346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '668fc8f4-cc8c-4929-8826-fcb05c80bc6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff963a950>]}
[0m13:56:44.641017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '668fc8f4-cc8c-4929-8826-fcb05c80bc6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff961d720>]}
[0m13:56:44.641920 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m13:56:44.656223 [debug] [MainThread]: checksum: 7c46c391780f5adbba4aeed1bb0cabed7e089d22e9df17dd41bd89837fdfafae, vars: {'is_test_run': False}, profile: , target: , version: 1.7.7
[0m13:56:44.713471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:56:44.714001 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:56:44.719723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '668fc8f4-cc8c-4929-8826-fcb05c80bc6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92a00d0>]}
[0m13:56:44.732410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '668fc8f4-cc8c-4929-8826-fcb05c80bc6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9268610>]}
[0m13:56:44.732970 [info ] [MainThread]: Found 4 models, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m13:56:44.733523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '668fc8f4-cc8c-4929-8826-fcb05c80bc6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff926a170>]}
[0m13:56:44.734232 [warn ] [MainThread]: The selection criterion 'stg_greent_trip_data' does not match any nodes
[0m13:56:44.735232 [info ] [MainThread]: 
[0m13:56:44.735806 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:56:44.736512 [debug] [MainThread]: Command end result
[0m13:56:44.747549 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.594233, "process_user_time": 2.097064, "process_kernel_time": 0.112217, "process_mem_max_rss": "133864", "process_in_blocks": "1744", "process_out_blocks": "648"}
[0m13:56:44.748451 [debug] [MainThread]: Command `dbt compile` succeeded at 13:56:44.748247 after 0.60 seconds
[0m13:56:44.749057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92686d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9269c60>]}
[0m13:56:44.749531 [debug] [MainThread]: Flushing usage events
[0m13:56:58.834787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb013c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb013850>]}


============================== 13:56:58.847222 | 335dcb4b-9a3d-4d83-8f95-174ff8bb0cea ==============================
[0m13:56:58.847222 [info ] [MainThread]: Running with dbt=1.7.7
[0m13:56:58.848242 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt compile --select stg_green_trip_data --vars {is_test_run: false}', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:56:59.202998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '335dcb4b-9a3d-4d83-8f95-174ff8bb0cea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc63db70>]}
[0m13:56:59.273523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '335dcb4b-9a3d-4d83-8f95-174ff8bb0cea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff94184c0>]}
[0m13:56:59.274413 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m13:56:59.288063 [debug] [MainThread]: checksum: 7c46c391780f5adbba4aeed1bb0cabed7e089d22e9df17dd41bd89837fdfafae, vars: {'is_test_run': False}, profile: , target: , version: 1.7.7
[0m13:56:59.347712 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:56:59.348285 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:56:59.354154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '335dcb4b-9a3d-4d83-8f95-174ff8bb0cea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92a00d0>]}
[0m13:56:59.367442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '335dcb4b-9a3d-4d83-8f95-174ff8bb0cea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9264580>]}
[0m13:56:59.367999 [info ] [MainThread]: Found 4 models, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m13:56:59.368576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '335dcb4b-9a3d-4d83-8f95-174ff8bb0cea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92660e0>]}
[0m13:56:59.370058 [info ] [MainThread]: 
[0m13:56:59.371083 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:56:59.373470 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_trips_all_data'
[0m13:56:59.374129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:59.979403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '335dcb4b-9a3d-4d83-8f95-174ff8bb0cea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9265ae0>]}
[0m13:56:59.983027 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:56:59.984546 [info ] [MainThread]: 
[0m13:57:00.002593 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m13:57:00.004978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_trips_all_data, now model.taxi_rides_ny.stg_green_trip_data)
[0m13:57:00.005910 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m13:57:00.034980 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m13:57:00.036980 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 13:57:00.006593 => 13:57:00.036709
[0m13:57:00.037516 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m13:57:00.038141 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 13:57:00.037909 => 13:57:00.037923
[0m13:57:00.039409 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m13:57:00.041627 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:57:00.042123 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_green_trip_data' was properly closed.
[0m13:57:00.043084 [debug] [MainThread]: Command end result
[0m13:57:00.055773 [info ] [MainThread]: Compiled node 'stg_green_trip_data' is:
-- with source as
-- (select * 
--     from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
--     )
-- SELECT
--   
    
to_hex(md5(cast(coalesce(cast(VendorID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as trip_id,
--   VendorID,
--   lpep_pickup_datetime,
--   lpep_dropoff_datetime,
--   store_and_fwd_flag,
--   RatecodeID,
--   PULocationID,
--   DOLocationID,
--   passenger_count,
--   trip_distance,
--   fare_amount,
--   extra,
--   mta_tax,
--   tip_amount,
--   tolls_amount,
--   ehail_fee,
--   improvement_surcharge,
--   total_amount,
--   case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_desc,
--   trip_type,
--   congestion_surcharge
-- FROM source

select
-- identifiers

    
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
cast(trip_type as integer) as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(ehail_fee as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), lpep_pickup_datetime)=1
-- dbt-bq run --select stg_green_tripdata  --vars {'is_test_run: false'}

[0m13:57:00.057945 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.2770879, "process_user_time": 2.34584, "process_kernel_time": 0.140409, "process_mem_max_rss": "141760", "process_out_blocks": "704", "process_in_blocks": "0"}
[0m13:57:00.058755 [debug] [MainThread]: Command `dbt compile` succeeded at 13:57:00.058557 after 1.28 seconds
[0m13:57:00.059253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb013df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff96e2650>]}
[0m13:57:00.059741 [debug] [MainThread]: Flushing usage events
[0m13:57:35.090660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00dcf0>]}


============================== 13:57:35.106074 | b8dbeec9-3173-4f99-943d-760dc4dce6e2 ==============================
[0m13:57:35.106074 [info ] [MainThread]: Running with dbt=1.7.7
[0m13:57:35.107357 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile --select stg_green_trip_data --vars {is_test_run: false}', 'send_anonymous_usage_stats': 'True'}
[0m13:57:35.539202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8dbeec9-3173-4f99-943d-760dc4dce6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf07c10>]}
[0m13:57:35.642472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8dbeec9-3173-4f99-943d-760dc4dce6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff941b0a0>]}
[0m13:57:35.643912 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m13:57:35.663333 [debug] [MainThread]: checksum: 7c46c391780f5adbba4aeed1bb0cabed7e089d22e9df17dd41bd89837fdfafae, vars: {'is_test_run': False}, profile: , target: , version: 1.7.7
[0m13:57:35.739223 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:57:35.740374 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://taxi_rides_ny/models/staging/stg_green_trip_data.sql
[0m13:57:35.896631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8dbeec9-3173-4f99-943d-760dc4dce6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91e8640>]}
[0m13:57:35.912120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8dbeec9-3173-4f99-943d-760dc4dce6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9264580>]}
[0m13:57:35.912875 [info ] [MainThread]: Found 4 models, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m13:57:35.913703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8dbeec9-3173-4f99-943d-760dc4dce6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92660e0>]}
[0m13:57:35.915494 [info ] [MainThread]: 
[0m13:57:35.917061 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:57:35.920017 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_trips_all_data'
[0m13:57:35.920691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:36.503443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8dbeec9-3173-4f99-943d-760dc4dce6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9265ae0>]}
[0m13:57:36.506719 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:57:36.508104 [info ] [MainThread]: 
[0m13:57:36.524204 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m13:57:36.526081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_trips_all_data, now model.taxi_rides_ny.stg_green_trip_data)
[0m13:57:36.526795 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m13:57:36.541501 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m13:57:36.544120 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 13:57:36.527426 => 13:57:36.543639
[0m13:57:36.544875 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m13:57:36.545702 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 13:57:36.545393 => 13:57:36.545411
[0m13:57:36.547138 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m13:57:36.549417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:57:36.549940 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_green_trip_data' was properly closed.
[0m13:57:36.550813 [debug] [MainThread]: Command end result
[0m13:57:36.566346 [info ] [MainThread]: Compiled node 'stg_green_trip_data' is:
-- with source as
-- (select * 
--     from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
--     )
-- SELECT
--   
    
to_hex(md5(cast(coalesce(cast(VendorID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as trip_id,
--   VendorID,
--   lpep_pickup_datetime,
--   lpep_dropoff_datetime,
--   store_and_fwd_flag,
--   RatecodeID,
--   PULocationID,
--   DOLocationID,
--   passenger_count,
--   trip_distance,
--   fare_amount,
--   extra,
--   mta_tax,
--   tip_amount,
--   tolls_amount,
--   ehail_fee,
--   improvement_surcharge,
--   total_amount,
--   case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_desc,
--   trip_type,
--   congestion_surcharge
-- FROM source

select
-- identifiers

    
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
cast(trip_type as integer) as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(ehail_fee as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), lpep_pickup_datetime)=1
-- dbt-bq compile --select stg_green_trip_data --vars '{'is_test_run': 'false'}'

[0m13:57:36.569380 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.5508724, "process_user_time": 2.611977, "process_kernel_time": 0.156998, "process_mem_max_rss": "144652", "process_out_blocks": "704", "process_in_blocks": "0"}
[0m13:57:36.570192 [debug] [MainThread]: Command `dbt compile` succeeded at 13:57:36.569993 after 1.55 seconds
[0m13:57:36.570778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9079b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9264610>]}
[0m13:57:36.571557 [debug] [MainThread]: Flushing usage events
[0m14:02:44.351980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00ea10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00e860>]}


============================== 14:02:44.364785 | 3f93893f-4f62-47c3-8edd-bb9f847fe944 ==============================
[0m14:02:44.364785 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:02:44.365801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_green_trip_data --vars {is_test_run: false}', 'send_anonymous_usage_stats': 'True'}
[0m14:02:44.740994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f93893f-4f62-47c3-8edd-bb9f847fe944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc6dcee0>]}
[0m14:02:44.811874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f93893f-4f62-47c3-8edd-bb9f847fe944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95e51e0>]}
[0m14:02:44.812807 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:02:44.828199 [debug] [MainThread]: checksum: 7c46c391780f5adbba4aeed1bb0cabed7e089d22e9df17dd41bd89837fdfafae, vars: {'is_test_run': False}, profile: , target: , version: 1.7.7
[0m14:02:44.843169 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:02:44.844005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3f93893f-4f62-47c3-8edd-bb9f847fe944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95a4370>]}
[0m14:02:45.983575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f93893f-4f62-47c3-8edd-bb9f847fe944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7cdda50>]}
[0m14:02:45.998476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f93893f-4f62-47c3-8edd-bb9f847fe944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7c47c10>]}
[0m14:02:45.999066 [info ] [MainThread]: Found 4 models, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m14:02:45.999573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f93893f-4f62-47c3-8edd-bb9f847fe944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9313e80>]}
[0m14:02:46.000972 [info ] [MainThread]: 
[0m14:02:46.002124 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:02:46.004036 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m14:02:46.004644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:02:46.924502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now create_de-zoomcamp-413815_dbt_staging)
[0m14:02:46.928618 [debug] [ThreadPool]: Creating schema "database: "de-zoomcamp-413815"
schema: "dbt_staging"
"
[0m14:02:46.952558 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:02:46.956715 [debug] [ThreadPool]: On create_de-zoomcamp-413815_dbt_staging: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "connection_name": "create_de-zoomcamp-413815_dbt_staging"} */
create schema if not exists `de-zoomcamp-413815`.`dbt_staging`
  
[0m14:02:47.865989 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:702fb16f-b7bc-4d30-8c67-5a7e3d1b5c98&page=queryresults
[0m14:02:52.087034 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_de-zoomcamp-413815_dbt_staging, now list_de-zoomcamp-413815_dbt_staging)
[0m14:02:52.090288 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_trips_all_data'
[0m14:02:52.092068 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:02:52.093392 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:02:52.724292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f93893f-4f62-47c3-8edd-bb9f847fe944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95a5c60>]}
[0m14:02:52.727921 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:02:52.729729 [info ] [MainThread]: 
[0m14:02:52.747179 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m14:02:52.749264 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_staging.stg_green_trip_data .................... [RUN]
[0m14:02:52.751609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_trips_all_data, now model.taxi_rides_ny.stg_green_trip_data)
[0m14:02:52.752872 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m14:02:52.771772 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m14:02:52.775636 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 14:02:52.753563 => 14:02:52.775250
[0m14:02:52.776291 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m14:02:52.800467 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_trip_data"
[0m14:02:52.802972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:02:52.804729 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
  OPTIONS()
  as -- with source as
-- (select * 
--     from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
--     )
-- SELECT
--   
    
to_hex(md5(cast(coalesce(cast(VendorID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as trip_id,
--   VendorID,
--   lpep_pickup_datetime,
--   lpep_dropoff_datetime,
--   store_and_fwd_flag,
--   RatecodeID,
--   PULocationID,
--   DOLocationID,
--   passenger_count,
--   trip_distance,
--   fare_amount,
--   extra,
--   mta_tax,
--   tip_amount,
--   tolls_amount,
--   ehail_fee,
--   improvement_surcharge,
--   total_amount,
--   case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_desc,
--   trip_type,
--   congestion_surcharge
-- FROM source

select
-- identifiers

    
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
cast(trip_type as integer) as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(ehail_fee as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), lpep_pickup_datetime)=1
-- dbt-bq compile --select stg_green_trip_data --vars '{'is_test_run': 'false'}'
;


[0m14:02:53.457150 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:3f7baa02-d858-496d-9d79-15ab38821894&page=queryresults
[0m14:02:53.461805 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected identifier "to_hex" at [13:1]; reason: invalidQuery, location: query, message: Syntax error: Unexpected identifier "to_hex" at [13:1]')
[0m14:02:54.054870 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:556efb77-d616-4984-acd4-14f0d01a5961&page=queryresults
[0m14:02:54.060050 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:556efb77-d616-4984-acd4-14f0d01a5961&page=queryresults
[0m14:02:54.063241 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 14:02:52.776721 => 14:02:54.062074
[0m14:02:54.081823 [debug] [Thread-1 (]: Database Error in model stg_green_trip_data (taxi_rides_ny/models/staging/stg_green_trip_data.sql)
  Syntax error: Unexpected identifier "to_hex" at [13:1]
  compiled Code at target/run/taxi_rides_ny/taxi_rides_ny/models/staging/stg_green_trip_data.sql
[0m14:02:54.082638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f93893f-4f62-47c3-8edd-bb9f847fe944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7bd21a0>]}
[0m14:02:54.083516 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_staging.stg_green_trip_data ........... [[31mERROR[0m in 1.33s]
[0m14:02:54.084409 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m14:02:54.087318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:02:54.088026 [debug] [MainThread]: Connection 'list_de-zoomcamp-413815_dbt_staging' was properly closed.
[0m14:02:54.089101 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_green_trip_data' was properly closed.
[0m14:02:54.089805 [info ] [MainThread]: 
[0m14:02:54.090333 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.09 seconds (8.09s).
[0m14:02:54.091158 [debug] [MainThread]: Command end result
[0m14:02:54.102038 [info ] [MainThread]: 
[0m14:02:54.102777 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:02:54.103311 [info ] [MainThread]: 
[0m14:02:54.103854 [error] [MainThread]:   Database Error in model stg_green_trip_data (taxi_rides_ny/models/staging/stg_green_trip_data.sql)
  Syntax error: Unexpected identifier "to_hex" at [13:1]
  compiled Code at target/run/taxi_rides_ny/taxi_rides_ny/models/staging/stg_green_trip_data.sql
[0m14:02:54.104417 [info ] [MainThread]: 
[0m14:02:54.105188 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:02:54.106704 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.810156, "process_user_time": 3.800458, "process_kernel_time": 0.276688, "process_mem_max_rss": "153628", "process_in_blocks": "1040", "process_out_blocks": "704", "command_success": false}
[0m14:02:54.107639 [debug] [MainThread]: Command `dbt run` failed at 14:02:54.107430 after 9.81 seconds
[0m14:02:54.108201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc6dcee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95e51e0>]}
[0m14:02:54.108698 [debug] [MainThread]: Flushing usage events
[0m14:05:15.097489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00ef20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f8e0>]}


============================== 14:05:15.109619 | a3b8c929-8b68-4007-b2f2-a369f86019f3 ==============================
[0m14:05:15.109619 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:05:15.110734 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_green_trip_data --vars {is_test_run: false}', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:15.465525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3b8c929-8b68-4007-b2f2-a369f86019f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc6f2560>]}
[0m14:05:15.535605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3b8c929-8b68-4007-b2f2-a369f86019f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9411960>]}
[0m14:05:15.536429 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:05:15.551362 [debug] [MainThread]: checksum: 7c46c391780f5adbba4aeed1bb0cabed7e089d22e9df17dd41bd89837fdfafae, vars: {'is_test_run': False}, profile: , target: , version: 1.7.7
[0m14:05:15.565915 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:05:15.566700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a3b8c929-8b68-4007-b2f2-a369f86019f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff96e4820>]}
[0m14:05:16.699853 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxi_rides_ny.core
[0m14:05:16.705599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3b8c929-8b68-4007-b2f2-a369f86019f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7cddcf0>]}
[0m14:05:16.720054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3b8c929-8b68-4007-b2f2-a369f86019f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7c38fd0>]}
[0m14:05:16.720765 [info ] [MainThread]: Found 4 models, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m14:05:16.721350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3b8c929-8b68-4007-b2f2-a369f86019f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9567d30>]}
[0m14:05:16.722805 [info ] [MainThread]: 
[0m14:05:16.723908 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:05:16.726084 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m14:05:16.726846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:17.706624 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_dbt_staging'
[0m14:05:17.710787 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_trips_all_data)
[0m14:05:17.711652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:17.713058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:18.456915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3b8c929-8b68-4007-b2f2-a369f86019f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91e7f70>]}
[0m14:05:18.460018 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:05:18.462520 [info ] [MainThread]: 
[0m14:05:18.471345 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m14:05:18.472382 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_staging.stg_green_trip_data .................... [RUN]
[0m14:05:18.473581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_staging, now model.taxi_rides_ny.stg_green_trip_data)
[0m14:05:18.474125 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m14:05:18.485727 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m14:05:18.488766 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 14:05:18.474516 => 14:05:18.488425
[0m14:05:18.489335 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m14:05:18.519753 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_trip_data"
[0m14:05:18.521567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:18.523640 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
  OPTIONS()
  as -- with source as
-- (select * 
--     from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
--     )
-- SELECT
--   
    
to_hex(md5(cast(coalesce(cast(VendorID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as trip_id,
--   VendorID,
--   lpep_pickup_datetime,
--   lpep_dropoff_datetime,
--   store_and_fwd_flag,
--   RatecodeID,
--   PULocationID,
--   DOLocationID,
--   passenger_count,
--   trip_distance,
--   fare_amount,
--   extra,
--   mta_tax,
--   tip_amount,
--   tolls_amount,
--   ehail_fee,
--   improvement_surcharge,
--   total_amount,
--   case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_desc,
--   trip_type,
--   congestion_surcharge
-- FROM source

select
-- identifiers

    
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
cast(trip_type as integer) as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(ehail_fee as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), lpep_pickup_datetime)=1
-- dbt-bq compile --select stg_green_trip_data --vars '{'is_test_run': 'false'}'
;


[0m14:05:19.582958 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:08e5d69a-5848-4665-839a-e9a887ccea75&page=queryresults
[0m14:05:19.593267 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected identifier "to_hex" at [13:1]; reason: invalidQuery, location: query, message: Syntax error: Unexpected identifier "to_hex" at [13:1]')
[0m14:05:21.140206 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:5b503c51-113f-4c25-af4c-3bd42e218f02&page=queryresults
[0m14:05:21.150384 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:5b503c51-113f-4c25-af4c-3bd42e218f02&page=queryresults
[0m14:05:21.152899 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 14:05:18.489688 => 14:05:21.152537
[0m14:05:21.163132 [debug] [Thread-1 (]: Database Error in model stg_green_trip_data (taxi_rides_ny/models/staging/stg_green_trip_data.sql)
  Syntax error: Unexpected identifier "to_hex" at [13:1]
  compiled Code at target/run/taxi_rides_ny/taxi_rides_ny/models/staging/stg_green_trip_data.sql
[0m14:05:21.164928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3b8c929-8b68-4007-b2f2-a369f86019f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7b867d0>]}
[0m14:05:21.167286 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_staging.stg_green_trip_data ........... [[31mERROR[0m in 2.69s]
[0m14:05:21.169464 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m14:05:21.175602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:21.176657 [debug] [MainThread]: Connection 'list_de-zoomcamp-413815_trips_all_data' was properly closed.
[0m14:05:21.177402 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_green_trip_data' was properly closed.
[0m14:05:21.178643 [info ] [MainThread]: 
[0m14:05:21.180068 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.45 seconds (4.45s).
[0m14:05:21.181300 [debug] [MainThread]: Command end result
[0m14:05:21.200059 [info ] [MainThread]: 
[0m14:05:21.201053 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:05:21.201934 [info ] [MainThread]: 
[0m14:05:21.202913 [error] [MainThread]:   Database Error in model stg_green_trip_data (taxi_rides_ny/models/staging/stg_green_trip_data.sql)
  Syntax error: Unexpected identifier "to_hex" at [13:1]
  compiled Code at target/run/taxi_rides_ny/taxi_rides_ny/models/staging/stg_green_trip_data.sql
[0m14:05:21.203751 [info ] [MainThread]: 
[0m14:05:21.204691 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:05:21.206743 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.164, "process_user_time": 3.715021, "process_kernel_time": 0.164488, "process_mem_max_rss": "152844", "process_out_blocks": "704", "command_success": false, "process_in_blocks": "0"}
[0m14:05:21.207876 [debug] [MainThread]: Command `dbt run` failed at 14:05:21.207662 after 6.17 seconds
[0m14:05:21.208585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff96e4040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7b84970>]}
[0m14:05:21.209217 [debug] [MainThread]: Flushing usage events
[0m14:05:58.347032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00eb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00e890>]}


============================== 14:05:58.359225 | 85285f13-fa3a-4414-9148-7ecb2d734087 ==============================
[0m14:05:58.359225 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:05:58.360252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_green_trip_data', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:58.718535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85285f13-fa3a-4414-9148-7ecb2d734087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc30e2f0>]}
[0m14:05:58.789777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85285f13-fa3a-4414-9148-7ecb2d734087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f070>]}
[0m14:05:58.790674 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:05:58.804558 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:05:58.818463 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:05:58.819330 [debug] [MainThread]: previous checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, current checksum: 7c46c391780f5adbba4aeed1bb0cabed7e089d22e9df17dd41bd89837fdfafae
[0m14:05:58.819955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '85285f13-fa3a-4414-9148-7ecb2d734087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95a0790>]}
[0m14:05:59.951769 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxi_rides_ny.core
[0m14:05:59.958427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85285f13-fa3a-4414-9148-7ecb2d734087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7cd9c00>]}
[0m14:05:59.973648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85285f13-fa3a-4414-9148-7ecb2d734087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7c403a0>]}
[0m14:05:59.974384 [info ] [MainThread]: Found 4 models, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m14:05:59.974936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85285f13-fa3a-4414-9148-7ecb2d734087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff918c760>]}
[0m14:05:59.976452 [info ] [MainThread]: 
[0m14:05:59.977575 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:05:59.979673 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m14:05:59.980356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:00.970171 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_trips_all_data)
[0m14:06:00.971557 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_dbt_staging'
[0m14:06:00.972387 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:00.973012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:01.571248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85285f13-fa3a-4414-9148-7ecb2d734087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7c41150>]}
[0m14:06:01.573113 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:06:01.574122 [info ] [MainThread]: 
[0m14:06:01.586712 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m14:06:01.588272 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_staging.stg_green_trip_data .................... [RUN]
[0m14:06:01.589881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_staging, now model.taxi_rides_ny.stg_green_trip_data)
[0m14:06:01.591022 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m14:06:01.611252 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m14:06:01.614425 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 14:06:01.591770 => 14:06:01.613995
[0m14:06:01.615232 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m14:06:01.651549 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_trip_data"
[0m14:06:01.653148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:01.654957 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
  OPTIONS()
  as -- with source as
-- (select * 
--     from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
--     )
-- SELECT
--   
    
to_hex(md5(cast(coalesce(cast(VendorID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as trip_id,
--   VendorID,
--   lpep_pickup_datetime,
--   lpep_dropoff_datetime,
--   store_and_fwd_flag,
--   RatecodeID,
--   PULocationID,
--   DOLocationID,
--   passenger_count,
--   trip_distance,
--   fare_amount,
--   extra,
--   mta_tax,
--   tip_amount,
--   tolls_amount,
--   ehail_fee,
--   improvement_surcharge,
--   total_amount,
--   case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_desc,
--   trip_type,
--   congestion_surcharge
-- FROM source

select
-- identifiers

    
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
cast(trip_type as integer) as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(ehail_fee as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), lpep_pickup_datetime)=1
-- dbt-bq compile --select stg_green_trip_data --vars '{'is_test_run': 'false'}'

limit 100
;


[0m14:06:02.289339 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:e0130f18-c6df-4313-bbee-ed7f1686d391&page=queryresults
[0m14:06:02.304473 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected identifier "to_hex" at [13:1]; reason: invalidQuery, location: query, message: Syntax error: Unexpected identifier "to_hex" at [13:1]')
[0m14:06:03.515551 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:a54a229a-b0db-454f-a0e4-37b9860e391a&page=queryresults
[0m14:06:03.525802 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:a54a229a-b0db-454f-a0e4-37b9860e391a&page=queryresults
[0m14:06:03.529997 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 14:06:01.615795 => 14:06:03.529010
[0m14:06:03.540245 [debug] [Thread-1 (]: Database Error in model stg_green_trip_data (taxi_rides_ny/models/staging/stg_green_trip_data.sql)
  Syntax error: Unexpected identifier "to_hex" at [13:1]
  compiled Code at target/run/taxi_rides_ny/taxi_rides_ny/models/staging/stg_green_trip_data.sql
[0m14:06:03.542108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85285f13-fa3a-4414-9148-7ecb2d734087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7b8cf70>]}
[0m14:06:03.544703 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_staging.stg_green_trip_data ........... [[31mERROR[0m in 1.95s]
[0m14:06:03.546816 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m14:06:03.552638 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:03.553970 [debug] [MainThread]: Connection 'list_de-zoomcamp-413815_trips_all_data' was properly closed.
[0m14:06:03.555258 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_green_trip_data' was properly closed.
[0m14:06:03.556637 [info ] [MainThread]: 
[0m14:06:03.557780 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.58 seconds (3.58s).
[0m14:06:03.559359 [debug] [MainThread]: Command end result
[0m14:06:03.575840 [info ] [MainThread]: 
[0m14:06:03.576693 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:06:03.577389 [info ] [MainThread]: 
[0m14:06:03.578003 [error] [MainThread]:   Database Error in model stg_green_trip_data (taxi_rides_ny/models/staging/stg_green_trip_data.sql)
  Syntax error: Unexpected identifier "to_hex" at [13:1]
  compiled Code at target/run/taxi_rides_ny/taxi_rides_ny/models/staging/stg_green_trip_data.sql
[0m14:06:03.578676 [info ] [MainThread]: 
[0m14:06:03.579500 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:06:03.581213 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.2890234, "process_user_time": 3.751542, "process_kernel_time": 0.147572, "process_mem_max_rss": "153276", "process_out_blocks": "704", "command_success": false, "process_in_blocks": "0"}
[0m14:06:03.582117 [debug] [MainThread]: Command `dbt run` failed at 14:06:03.581949 after 5.29 seconds
[0m14:06:03.582732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95a2860>]}
[0m14:06:03.583359 [debug] [MainThread]: Flushing usage events
[0m14:08:23.984364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00fc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f850>]}


============================== 14:08:23.996686 | 98f10f66-313b-4607-8a75-b4fe2c44d375 ==============================
[0m14:08:23.996686 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:08:23.997763 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_green_trip_data', 'send_anonymous_usage_stats': 'True'}
[0m14:08:24.358691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98f10f66-313b-4607-8a75-b4fe2c44d375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc6dcee0>]}
[0m14:08:24.430672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98f10f66-313b-4607-8a75-b4fe2c44d375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cbb3a0>]}
[0m14:08:24.431522 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:08:24.446477 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:08:24.459740 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:08:24.460633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '98f10f66-313b-4607-8a75-b4fe2c44d375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9526740>]}
[0m14:08:25.619319 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxi_rides_ny.core
[0m14:08:25.625196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98f10f66-313b-4607-8a75-b4fe2c44d375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7ce1a80>]}
[0m14:08:25.639700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98f10f66-313b-4607-8a75-b4fe2c44d375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7c41ba0>]}
[0m14:08:25.640357 [info ] [MainThread]: Found 4 models, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m14:08:25.640843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98f10f66-313b-4607-8a75-b4fe2c44d375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7c40190>]}
[0m14:08:25.642428 [info ] [MainThread]: 
[0m14:08:25.643663 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:08:25.645521 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m14:08:25.646270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:26.480000 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_trips_all_data)
[0m14:08:26.482427 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:27.006830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98f10f66-313b-4607-8a75-b4fe2c44d375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9525300>]}
[0m14:08:27.010454 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:08:27.012485 [info ] [MainThread]: 
[0m14:08:27.021859 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m14:08:27.022824 [info ] [Thread-1 (]: 1 of 1 START sql view model trips_all_data.stg_green_trip_data ................. [RUN]
[0m14:08:27.023955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_trips_all_data, now model.taxi_rides_ny.stg_green_trip_data)
[0m14:08:27.024693 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m14:08:27.037214 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m14:08:27.040843 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 14:08:27.025125 => 14:08:27.040537
[0m14:08:27.041391 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m14:08:27.072982 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_trip_data"
[0m14:08:27.074964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:27.077062 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`trips_all_data`.`stg_green_trip_data`
  OPTIONS()
  as -- with source as
-- (select * 
--     from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
--     )
-- SELECT
--   
    
to_hex(md5(cast(coalesce(cast(VendorID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as trip_id,
--   VendorID,
--   lpep_pickup_datetime,
--   lpep_dropoff_datetime,
--   store_and_fwd_flag,
--   RatecodeID,
--   PULocationID,
--   DOLocationID,
--   passenger_count,
--   trip_distance,
--   fare_amount,
--   extra,
--   mta_tax,
--   tip_amount,
--   tolls_amount,
--   ehail_fee,
--   improvement_surcharge,
--   total_amount,
--   case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_desc,
--   trip_type,
--   congestion_surcharge
-- FROM source

select
-- identifiers

    
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
cast(trip_type as integer) as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(ehail_fee as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), lpep_pickup_datetime)=1
-- dbt-bq compile --select stg_green_trip_data --vars '{'is_test_run': 'false'}'

limit 100
;


[0m14:08:27.752016 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:4a43f6c2-28b0-41a3-8f02-0c8b71dede59&page=queryresults
[0m14:08:27.766780 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected identifier "to_hex" at [13:1]; reason: invalidQuery, location: query, message: Syntax error: Unexpected identifier "to_hex" at [13:1]')
[0m14:08:29.185514 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:db04ef68-fb37-48c2-bb47-d50a0d7a2203&page=queryresults
[0m14:08:29.197104 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:db04ef68-fb37-48c2-bb47-d50a0d7a2203&page=queryresults
[0m14:08:29.203911 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 14:08:27.041771 => 14:08:29.202900
[0m14:08:29.214630 [debug] [Thread-1 (]: Database Error in model stg_green_trip_data (taxi_rides_ny/models/staging/stg_green_trip_data.sql)
  Syntax error: Unexpected identifier "to_hex" at [13:1]
  compiled Code at target/run/taxi_rides_ny/taxi_rides_ny/models/staging/stg_green_trip_data.sql
[0m14:08:29.216719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98f10f66-313b-4607-8a75-b4fe2c44d375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7c43d30>]}
[0m14:08:29.219070 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model trips_all_data.stg_green_trip_data ........ [[31mERROR[0m in 2.19s]
[0m14:08:29.221114 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m14:08:29.226758 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:08:29.228107 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_green_trip_data' was properly closed.
[0m14:08:29.229732 [info ] [MainThread]: 
[0m14:08:29.231051 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.59 seconds (3.59s).
[0m14:08:29.232617 [debug] [MainThread]: Command end result
[0m14:08:29.249507 [info ] [MainThread]: 
[0m14:08:29.250262 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:08:29.250901 [info ] [MainThread]: 
[0m14:08:29.251511 [error] [MainThread]:   Database Error in model stg_green_trip_data (taxi_rides_ny/models/staging/stg_green_trip_data.sql)
  Syntax error: Unexpected identifier "to_hex" at [13:1]
  compiled Code at target/run/taxi_rides_ny/taxi_rides_ny/models/staging/stg_green_trip_data.sql
[0m14:08:29.252097 [info ] [MainThread]: 
[0m14:08:29.252900 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:08:29.254663 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.325069, "process_user_time": 3.699504, "process_kernel_time": 0.167203, "process_mem_max_rss": "151444", "process_out_blocks": "704", "command_success": false, "process_in_blocks": "0"}
[0m14:08:29.255499 [debug] [MainThread]: Command `dbt run` failed at 14:08:29.255354 after 5.33 seconds
[0m14:08:29.256207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc6dcee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7c41e70>]}
[0m14:08:29.256984 [debug] [MainThread]: Flushing usage events
[0m14:08:39.539183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00dae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d300>]}


============================== 14:08:39.554365 | 561df96f-7f0f-4151-9e1a-0529d612fd0c ==============================
[0m14:08:39.554365 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:08:39.555659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_green_trip_data', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:08:39.960976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '561df96f-7f0f-4151-9e1a-0529d612fd0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff96e73d0>]}
[0m14:08:40.033436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '561df96f-7f0f-4151-9e1a-0529d612fd0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9412230>]}
[0m14:08:40.034506 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:08:40.049125 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:08:40.111807 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:08:40.112458 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:08:40.113238 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxi_rides_ny.core
[0m14:08:40.119314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '561df96f-7f0f-4151-9e1a-0529d612fd0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92a40d0>]}
[0m14:08:40.133420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '561df96f-7f0f-4151-9e1a-0529d612fd0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9264610>]}
[0m14:08:40.134185 [info ] [MainThread]: Found 4 models, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m14:08:40.134736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '561df96f-7f0f-4151-9e1a-0529d612fd0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9266170>]}
[0m14:08:40.136482 [info ] [MainThread]: 
[0m14:08:40.137663 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:08:40.141098 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m14:08:40.142081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:40.949288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_trips_all_data)
[0m14:08:40.950502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:41.503172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '561df96f-7f0f-4151-9e1a-0529d612fd0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9265840>]}
[0m14:08:41.504471 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:08:41.505069 [info ] [MainThread]: 
[0m14:08:41.512737 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m14:08:41.513643 [info ] [Thread-1 (]: 1 of 1 START sql view model trips_all_data.stg_green_trip_data ................. [RUN]
[0m14:08:41.514692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_trips_all_data, now model.taxi_rides_ny.stg_green_trip_data)
[0m14:08:41.515478 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m14:08:41.539968 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m14:08:41.542266 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 14:08:41.516064 => 14:08:41.541869
[0m14:08:41.542825 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m14:08:41.569540 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_trip_data"
[0m14:08:41.571441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:41.573383 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`trips_all_data`.`stg_green_trip_data`
  OPTIONS()
  as -- with source as
-- (select * 
--     from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
--     )
-- SELECT
--   
    
to_hex(md5(cast(coalesce(cast(VendorID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as trip_id,
--   VendorID,
--   lpep_pickup_datetime,
--   lpep_dropoff_datetime,
--   store_and_fwd_flag,
--   RatecodeID,
--   PULocationID,
--   DOLocationID,
--   passenger_count,
--   trip_distance,
--   fare_amount,
--   extra,
--   mta_tax,
--   tip_amount,
--   tolls_amount,
--   ehail_fee,
--   improvement_surcharge,
--   total_amount,
--   case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_desc,
--   trip_type,
--   congestion_surcharge
-- FROM source

select
-- identifiers

    
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
cast(trip_type as integer) as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(ehail_fee as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), lpep_pickup_datetime)=1
-- dbt-bq compile --select stg_green_trip_data --vars '{'is_test_run': 'false'}'

limit 100
;


[0m14:08:42.286750 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:d4178266-d327-4384-ac68-26da86e45b77&page=queryresults
[0m14:08:42.301887 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected identifier "to_hex" at [13:1]; reason: invalidQuery, location: query, message: Syntax error: Unexpected identifier "to_hex" at [13:1]')
[0m14:08:43.353384 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:bc227455-da24-4150-aceb-240cec821e82&page=queryresults
[0m14:08:43.364837 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:bc227455-da24-4150-aceb-240cec821e82&page=queryresults
[0m14:08:43.370886 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 14:08:41.543158 => 14:08:43.369097
[0m14:08:43.385495 [debug] [Thread-1 (]: Database Error in model stg_green_trip_data (taxi_rides_ny/models/staging/stg_green_trip_data.sql)
  Syntax error: Unexpected identifier "to_hex" at [13:1]
  compiled Code at target/run/taxi_rides_ny/taxi_rides_ny/models/staging/stg_green_trip_data.sql
[0m14:08:43.387053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '561df96f-7f0f-4151-9e1a-0529d612fd0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9146620>]}
[0m14:08:43.389031 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model trips_all_data.stg_green_trip_data ........ [[31mERROR[0m in 1.87s]
[0m14:08:43.391037 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m14:08:43.397178 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:08:43.397826 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_green_trip_data' was properly closed.
[0m14:08:43.398814 [info ] [MainThread]: 
[0m14:08:43.399834 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.26 seconds (3.26s).
[0m14:08:43.401468 [debug] [MainThread]: Command end result
[0m14:08:43.417942 [info ] [MainThread]: 
[0m14:08:43.418924 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:08:43.419593 [info ] [MainThread]: 
[0m14:08:43.420303 [error] [MainThread]:   Database Error in model stg_green_trip_data (taxi_rides_ny/models/staging/stg_green_trip_data.sql)
  Syntax error: Unexpected identifier "to_hex" at [13:1]
  compiled Code at target/run/taxi_rides_ny/taxi_rides_ny/models/staging/stg_green_trip_data.sql
[0m14:08:43.420970 [info ] [MainThread]: 
[0m14:08:43.421779 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:08:43.423706 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.9517398, "process_user_time": 2.682782, "process_kernel_time": 0.169057, "process_mem_max_rss": "146428", "process_in_blocks": "2032", "process_out_blocks": "704", "command_success": false}
[0m14:08:43.424916 [debug] [MainThread]: Command `dbt run` failed at 14:08:43.424675 after 3.95 seconds
[0m14:08:43.425782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9145810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9146ec0>]}
[0m14:08:43.426583 [debug] [MainThread]: Flushing usage events
[0m14:09:46.958216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb011ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb011300>]}


============================== 14:09:46.970607 | 8c0db489-6250-4067-a69b-7a626a0c2ea3 ==============================
[0m14:09:46.970607 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:09:46.971588 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_green_trip_data', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:09:47.335122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c0db489-6250-4067-a69b-7a626a0c2ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb012500>]}
[0m14:09:47.407144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c0db489-6250-4067-a69b-7a626a0c2ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaff8130>]}
[0m14:09:47.408016 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:09:47.422145 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:09:47.484327 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:09:47.485096 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://taxi_rides_ny/models/staging/stg_green_trip_data.sql
[0m14:09:47.618502 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxi_rides_ny.core
[0m14:09:47.624089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c0db489-6250-4067-a69b-7a626a0c2ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91e3f10>]}
[0m14:09:47.638074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c0db489-6250-4067-a69b-7a626a0c2ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9260700>]}
[0m14:09:47.638733 [info ] [MainThread]: Found 4 models, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m14:09:47.639240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c0db489-6250-4067-a69b-7a626a0c2ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92607f0>]}
[0m14:09:47.640660 [info ] [MainThread]: 
[0m14:09:47.641715 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:09:47.644809 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m14:09:47.645602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:48.461912 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_trips_all_data'
[0m14:09:48.465956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:48.943111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c0db489-6250-4067-a69b-7a626a0c2ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9261a20>]}
[0m14:09:48.945102 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:09:48.946076 [info ] [MainThread]: 
[0m14:09:48.964987 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m14:09:48.967862 [info ] [Thread-1 (]: 1 of 1 START sql view model trips_all_data.stg_green_trip_data ................. [RUN]
[0m14:09:48.971275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_trips_all_data, now model.taxi_rides_ny.stg_green_trip_data)
[0m14:09:48.972489 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m14:09:48.995367 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m14:09:48.998518 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 14:09:48.973108 => 14:09:48.997873
[0m14:09:48.999668 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m14:09:49.031948 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_trip_data"
[0m14:09:49.033682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:49.035530 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`trips_all_data`.`stg_green_trip_data`
  OPTIONS()
  as with source as
(select * 
    from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
    )
SELECT
  
    
to_hex(md5(cast(coalesce(cast(VendorID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as trip_id,
  VendorID,
  lpep_pickup_datetime,
  lpep_dropoff_datetime,
  store_and_fwd_flag,
  RatecodeID,
  PULocationID,
  DOLocationID,
  passenger_count,
  trip_distance,
  fare_amount,
  extra,
  mta_tax,
  tip_amount,
  tolls_amount,
  ehail_fee,
  improvement_surcharge,
  total_amount,
  case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_desc,
  trip_type,
  congestion_surcharge
FROM source

-- select
-- -- identifiers
-- 
    
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
-- cast(vendorid as integer) as vendorid,
-- cast(ratecodeid as integer) as ratecodeid,
-- cast(pulocationid as integer) as pickup_locationid,
-- cast(dolocationid as integer) as dropoff_locationid,

-- -- timestamps
-- cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
-- cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

-- -- trip info
-- store_and_fwd_flag,
-- cast(passenger_count as integer) as passenger_count,
-- cast(trip_distance as numeric) as trip_distance,
-- cast(trip_type as integer) as trip_type,

-- -- payment info
-- cast(fare_amount as numeric) as fare_amount,
-- cast(extra as numeric) as extra,
-- cast(mta_tax as numeric) as mta_tax,
-- cast(tip_amount as numeric) as tip_amount,
-- cast(tolls_amount as numeric) as tolls_amount,
-- cast(ehail_fee as numeric) as ehail_fee,
-- cast(improvement_surcharge as numeric) as improvement_surcharge,
-- cast(total_amount as numeric) as total_amount,
-- cast(payment_type as integer) as payment_type,
-- case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
-- cast(congestion_surcharge as numeric) as congestion_surcharge
-- from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
-- where vendorid is not null
-- qualify row_number() over(partition by cast(VendorID as string), lpep_pickup_datetime)=1
-- -- dbt-bq compile --select stg_green_trip_data --vars '{'is_test_run': 'false'}'
-- 
-- limit 100
-- ;


[0m14:09:49.553936 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:bdac40b1-0f5c-4442-bc72-600d1af34f2a&page=queryresults
[0m14:09:49.579628 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got "(" at [48:7]; reason: invalidQuery, location: query, message: Syntax error: Expected end of input but got "(" at [48:7]')
[0m14:09:50.279107 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:42dc2b70-39f8-4bcd-8643-8c74f937dc36&page=queryresults
[0m14:09:50.285827 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:42dc2b70-39f8-4bcd-8643-8c74f937dc36&page=queryresults
[0m14:09:50.297790 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 14:09:49.000450 => 14:09:50.297039
[0m14:09:50.303635 [debug] [Thread-1 (]: Database Error in model stg_green_trip_data (taxi_rides_ny/models/staging/stg_green_trip_data.sql)
  Syntax error: Expected end of input but got "(" at [48:7]
  compiled Code at target/run/taxi_rides_ny/taxi_rides_ny/models/staging/stg_green_trip_data.sql
[0m14:09:50.304740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c0db489-6250-4067-a69b-7a626a0c2ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff90c51e0>]}
[0m14:09:50.306036 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model trips_all_data.stg_green_trip_data ........ [[31mERROR[0m in 1.33s]
[0m14:09:50.307408 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m14:09:50.311248 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:50.311955 [debug] [MainThread]: Connection 'list_de-zoomcamp-413815' was properly closed.
[0m14:09:50.312534 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_green_trip_data' was properly closed.
[0m14:09:50.313364 [info ] [MainThread]: 
[0m14:09:50.314098 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.67 seconds (2.67s).
[0m14:09:50.315322 [debug] [MainThread]: Command end result
[0m14:09:50.335783 [info ] [MainThread]: 
[0m14:09:50.336758 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:09:50.337668 [info ] [MainThread]: 
[0m14:09:50.338550 [error] [MainThread]:   Database Error in model stg_green_trip_data (taxi_rides_ny/models/staging/stg_green_trip_data.sql)
  Syntax error: Expected end of input but got "(" at [48:7]
  compiled Code at target/run/taxi_rides_ny/taxi_rides_ny/models/staging/stg_green_trip_data.sql
[0m14:09:50.339272 [info ] [MainThread]: 
[0m14:09:50.340274 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:09:50.342568 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.4377751, "process_user_time": 2.719797, "process_kernel_time": 0.171428, "process_mem_max_rss": "150112", "process_in_blocks": "120", "process_out_blocks": "704", "command_success": false}
[0m14:09:50.343770 [debug] [MainThread]: Command `dbt run` failed at 14:09:50.343549 after 3.44 seconds
[0m14:09:50.344679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9625c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff90904f0>]}
[0m14:09:50.345526 [debug] [MainThread]: Flushing usage events
[0m14:11:32.758623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00fc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f850>]}


============================== 14:11:32.771460 | 7b9df551-b4c4-48ef-bf21-fcdc02eed3a9 ==============================
[0m14:11:32.771460 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:11:32.772519 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_green_trip_data', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:11:33.151475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b9df551-b4c4-48ef-bf21-fcdc02eed3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc6dcee0>]}
[0m14:11:33.226570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b9df551-b4c4-48ef-bf21-fcdc02eed3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf086a0>]}
[0m14:11:33.227708 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:11:33.243277 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:11:33.307444 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:11:33.308356 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://taxi_rides_ny/models/staging/stg_green_trip_data.sql
[0m14:11:33.444568 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxi_rides_ny.core
[0m14:11:33.450579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b9df551-b4c4-48ef-bf21-fcdc02eed3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91dbd90>]}
[0m14:11:33.466493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b9df551-b4c4-48ef-bf21-fcdc02eed3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9264790>]}
[0m14:11:33.467181 [info ] [MainThread]: Found 4 models, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m14:11:33.467763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b9df551-b4c4-48ef-bf21-fcdc02eed3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9264880>]}
[0m14:11:33.469260 [info ] [MainThread]: 
[0m14:11:33.470444 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:11:33.473721 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m14:11:33.474650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:34.260538 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_trips_all_data)
[0m14:11:34.262704 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:34.672089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b9df551-b4c4-48ef-bf21-fcdc02eed3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9265ab0>]}
[0m14:11:34.673306 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:11:34.673990 [info ] [MainThread]: 
[0m14:11:34.683218 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m14:11:34.684362 [info ] [Thread-1 (]: 1 of 1 START sql view model trips_all_data.stg_green_trip_data ................. [RUN]
[0m14:11:34.685629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_trips_all_data, now model.taxi_rides_ny.stg_green_trip_data)
[0m14:11:34.686403 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m14:11:34.695991 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m14:11:34.700019 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 14:11:34.686932 => 14:11:34.699559
[0m14:11:34.700689 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m14:11:34.728177 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_trip_data"
[0m14:11:34.729946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:34.731666 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`trips_all_data`.`stg_green_trip_data`
  OPTIONS()
  as with source as
(select * 
    from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
    )
SELECT
  
    
to_hex(md5(cast(coalesce(cast(VendorID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as trip_id,
  VendorID,
  lpep_pickup_datetime,
  lpep_dropoff_datetime,
  store_and_fwd_flag,
  RatecodeID,
  PULocationID,
  DOLocationID,
  passenger_count,
  trip_distance,
  fare_amount,
  extra,
  mta_tax,
  tip_amount,
  tolls_amount,
  ehail_fee,
  improvement_surcharge,
  total_amount,
  case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_desc,
  trip_type,
  congestion_surcharge
FROM source;


[0m14:11:35.400635 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:072f3c07-6e56-4400-aeec-0e6cc981a776&page=queryresults
[0m14:11:35.740118 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 14:11:34.701069 => 14:11:35.739703
[0m14:11:35.742212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b9df551-b4c4-48ef-bf21-fcdc02eed3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff90cd0c0>]}
[0m14:11:35.744215 [info ] [Thread-1 (]: 1 of 1 OK created sql view model trips_all_data.stg_green_trip_data ............ [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m14:11:35.745997 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m14:11:35.749896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:35.750770 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_green_trip_data' was properly closed.
[0m14:11:35.751838 [info ] [MainThread]: 
[0m14:11:35.752726 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.28 seconds (2.28s).
[0m14:11:35.754079 [debug] [MainThread]: Command end result
[0m14:11:35.775608 [info ] [MainThread]: 
[0m14:11:35.776371 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:11:35.776983 [info ] [MainThread]: 
[0m14:11:35.777769 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:11:35.779571 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.074349, "process_user_time": 2.668309, "process_kernel_time": 0.161563, "process_mem_max_rss": "148796", "process_out_blocks": "704", "process_in_blocks": "0"}
[0m14:11:35.780452 [debug] [MainThread]: Command `dbt run` succeeded at 14:11:35.780252 after 3.08 seconds
[0m14:11:35.781099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffe358430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf086a0>]}
[0m14:11:35.781713 [debug] [MainThread]: Flushing usage events
[0m14:11:47.198331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00fac0>]}


============================== 14:11:47.210292 | 926f6df8-9b45-4083-b0f3-6b09ead6027b ==============================
[0m14:11:47.210292 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:11:47.211304 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_green_trip_data', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:11:47.567103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '926f6df8-9b45-4083-b0f3-6b09ead6027b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc641b70>]}
[0m14:11:47.638044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '926f6df8-9b45-4083-b0f3-6b09ead6027b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb7490>]}
[0m14:11:47.638938 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:11:47.652545 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:11:47.666291 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:11:47.667069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '926f6df8-9b45-4083-b0f3-6b09ead6027b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9524fa0>]}
[0m14:11:48.817000 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxi_rides_ny.core
[0m14:11:48.822956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '926f6df8-9b45-4083-b0f3-6b09ead6027b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7cd80d0>]}
[0m14:11:48.837855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '926f6df8-9b45-4083-b0f3-6b09ead6027b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7c3d0c0>]}
[0m14:11:48.838620 [info ] [MainThread]: Found 4 models, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m14:11:48.839195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '926f6df8-9b45-4083-b0f3-6b09ead6027b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92216c0>]}
[0m14:11:48.840690 [info ] [MainThread]: 
[0m14:11:48.841734 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:11:48.843681 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m14:11:48.844371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:49.546213 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_dbt_staging)
[0m14:11:49.552384 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_trips_all_data'
[0m14:11:49.555986 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:49.556841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:50.119775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '926f6df8-9b45-4083-b0f3-6b09ead6027b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7c3fe20>]}
[0m14:11:50.121955 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:11:50.123139 [info ] [MainThread]: 
[0m14:11:50.134894 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m14:11:50.136109 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_staging.stg_green_trip_data .................... [RUN]
[0m14:11:50.137461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_staging, now model.taxi_rides_ny.stg_green_trip_data)
[0m14:11:50.138247 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m14:11:50.154636 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m14:11:50.158146 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 14:11:50.138786 => 14:11:50.157625
[0m14:11:50.159068 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m14:11:50.198841 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_trip_data"
[0m14:11:50.200668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:50.202593 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
  OPTIONS()
  as with source as
(select * 
    from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
    )
SELECT
  
    
to_hex(md5(cast(coalesce(cast(VendorID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as trip_id,
  VendorID,
  lpep_pickup_datetime,
  lpep_dropoff_datetime,
  store_and_fwd_flag,
  RatecodeID,
  PULocationID,
  DOLocationID,
  passenger_count,
  trip_distance,
  fare_amount,
  extra,
  mta_tax,
  tip_amount,
  tolls_amount,
  ehail_fee,
  improvement_surcharge,
  total_amount,
  case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_desc,
  trip_type,
  congestion_surcharge
FROM source;


[0m14:11:50.816675 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:a249e943-87e9-4171-aff8-dd935cc06a9c&page=queryresults
[0m14:11:51.418954 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 14:11:50.159687 => 14:11:51.418721
[0m14:11:51.420414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '926f6df8-9b45-4083-b0f3-6b09ead6027b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7b92ad0>]}
[0m14:11:51.421776 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_staging.stg_green_trip_data ............... [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m14:11:51.423149 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m14:11:51.426246 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:51.426898 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_green_trip_data' was properly closed.
[0m14:11:51.427394 [debug] [MainThread]: Connection 'list_de-zoomcamp-413815_trips_all_data' was properly closed.
[0m14:11:51.428098 [info ] [MainThread]: 
[0m14:11:51.428781 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.59 seconds (2.59s).
[0m14:11:51.429780 [debug] [MainThread]: Command end result
[0m14:11:51.441528 [info ] [MainThread]: 
[0m14:11:51.442383 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:11:51.442985 [info ] [MainThread]: 
[0m14:11:51.443764 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:11:51.445757 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.3008375, "process_user_time": 3.741142, "process_kernel_time": 0.141442, "process_mem_max_rss": "153576", "process_out_blocks": "704", "process_in_blocks": "0"}
[0m14:11:51.446675 [debug] [MainThread]: Command `dbt run` succeeded at 14:11:51.446448 after 4.30 seconds
[0m14:11:51.447365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7b92a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9167d60>]}
[0m14:11:51.448118 [debug] [MainThread]: Flushing usage events
[0m14:12:51.642274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00dae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d300>]}


============================== 14:12:51.655101 | 96d17e30-7085-4a27-8e74-c1aeb24a2d4e ==============================
[0m14:12:51.655101 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:12:51.656244 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_green_trip_data', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:12:52.038604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96d17e30-7085-4a27-8e74-c1aeb24a2d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaff7280>]}
[0m14:12:52.116963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96d17e30-7085-4a27-8e74-c1aeb24a2d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff94102e0>]}
[0m14:12:52.118031 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:12:52.135959 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:12:52.200830 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:12:52.201611 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://taxi_rides_ny/models/staging/stg_green_trip_data.sql
[0m14:12:52.343230 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxi_rides_ny.core
[0m14:12:52.348754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96d17e30-7085-4a27-8e74-c1aeb24a2d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91e4220>]}
[0m14:12:52.364320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96d17e30-7085-4a27-8e74-c1aeb24a2d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92602e0>]}
[0m14:12:52.365014 [info ] [MainThread]: Found 4 models, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m14:12:52.365675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96d17e30-7085-4a27-8e74-c1aeb24a2d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92603d0>]}
[0m14:12:52.367305 [info ] [MainThread]: 
[0m14:12:52.368481 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:12:52.371239 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m14:12:52.372148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:53.224871 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_dbt_staging)
[0m14:12:53.236055 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_trips_all_data'
[0m14:12:53.238395 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:12:53.239927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:53.743732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96d17e30-7085-4a27-8e74-c1aeb24a2d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9261420>]}
[0m14:12:53.746425 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:12:53.747850 [info ] [MainThread]: 
[0m14:12:53.761621 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m14:12:53.762987 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_staging.stg_green_trip_data .................... [RUN]
[0m14:12:53.764535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_trips_all_data, now model.taxi_rides_ny.stg_green_trip_data)
[0m14:12:53.765666 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m14:12:53.779018 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m14:12:53.782290 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 14:12:53.766448 => 14:12:53.781947
[0m14:12:53.782888 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m14:12:53.810024 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_trip_data"
[0m14:12:53.811636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:53.813374 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
  OPTIONS()
  as select
-- identifiers

    
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
cast(trip_type as integer) as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(ehail_fee as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), lpep_pickup_datetime)=1
-- dbt-bq compile --select stg_green_trip_data --vars '{'is_test_run': 'false'}'

limit 100
;


[0m14:12:54.640845 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:8a60ef81-1f89-4cf7-bc86-2201699d3f38&page=queryresults
[0m14:12:55.001924 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 14:12:53.783329 => 14:12:55.001493
[0m14:12:55.004076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96d17e30-7085-4a27-8e74-c1aeb24a2d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff90d4040>]}
[0m14:12:55.006456 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_staging.stg_green_trip_data ............... [[32mCREATE VIEW (0 processed)[0m in 1.24s]
[0m14:12:55.008065 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m14:12:55.012578 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:55.013405 [debug] [MainThread]: Connection 'list_de-zoomcamp-413815_dbt_staging' was properly closed.
[0m14:12:55.014040 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_green_trip_data' was properly closed.
[0m14:12:55.015295 [info ] [MainThread]: 
[0m14:12:55.016431 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.65 seconds (2.65s).
[0m14:12:55.018022 [debug] [MainThread]: Command end result
[0m14:12:55.041532 [info ] [MainThread]: 
[0m14:12:55.042333 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:12:55.042864 [info ] [MainThread]: 
[0m14:12:55.043537 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:12:55.045290 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.4578319, "process_user_time": 2.831447, "process_kernel_time": 0.209625, "process_mem_max_rss": "150808", "process_out_blocks": "704", "process_in_blocks": "0"}
[0m14:12:55.046112 [debug] [MainThread]: Command `dbt run` succeeded at 14:12:55.045953 after 3.46 seconds
[0m14:12:55.046688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffe358430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff90d7b20>]}
[0m14:12:55.047241 [debug] [MainThread]: Flushing usage events
[0m14:34:32.397997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00fb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00dba0>]}


============================== 14:34:32.410733 | d87b301c-30fe-4fbc-b784-053a4678612d ==============================
[0m14:34:32.410733 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:34:32.411903 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:34:32.809844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd87b301c-30fe-4fbc-b784-053a4678612d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00df90>]}
[0m14:34:32.886270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd87b301c-30fe-4fbc-b784-053a4678612d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9421ff0>]}
[0m14:34:32.887476 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:34:32.902195 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:34:32.971073 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m14:34:32.971810 [debug] [MainThread]: Partial parsing: added file: taxi_rides_ny://taxi_rides_ny/models/core/dim_zones.sql
[0m14:34:32.972271 [debug] [MainThread]: Partial parsing: added file: taxi_rides_ny://taxi_rides_ny/seeds/taxi-zone-lookup.csv
[0m14:34:33.196263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd87b301c-30fe-4fbc-b784-053a4678612d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7cee050>]}
[0m14:34:33.212026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd87b301c-30fe-4fbc-b784-053a4678612d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff923f9a0>]}
[0m14:34:33.212657 [info ] [MainThread]: Found 5 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m14:34:33.214762 [info ] [MainThread]: 
[0m14:34:33.215910 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:34:33.218181 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m14:34:33.218887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:33.219512 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m14:34:33.220249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:34.545481 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_production'
[0m14:34:34.548520 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_trips_all_data)
[0m14:34:34.551511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_dbt_staging)
[0m14:34:34.552317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:34.552867 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:34:34.553301 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:34:35.766206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd87b301c-30fe-4fbc-b784-053a4678612d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95eb940>]}
[0m14:34:35.770404 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:34:35.777380 [info ] [MainThread]: 
[0m14:34:35.801550 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.my_first_dbt_model
[0m14:34:35.802488 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m14:34:35.803208 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
[0m14:34:35.804200 [debug] [Thread-4 (]: Began running node seed.taxi_rides_ny.taxi-zone-lookup
[0m14:34:35.805232 [info ] [Thread-1 (]: 1 of 5 START sql table model trips_all_data.my_first_dbt_model ................. [RUN]
[0m14:34:35.806843 [info ] [Thread-2 (]: 2 of 5 START sql view model dbt_staging.stg_green_trip_data .................... [RUN]
[0m14:34:35.808508 [info ] [Thread-3 (]: 3 of 5 START sql view model dbt_staging.stg_yellow_trip_data ................... [RUN]
[0m14:34:35.809926 [info ] [Thread-4 (]: 4 of 5 START seed file trips_all_data.taxi-zone-lookup ......................... [RUN]
[0m14:34:35.811846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_production, now model.taxi_rides_ny.my_first_dbt_model)
[0m14:34:35.813529 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_trips_all_data, now model.taxi_rides_ny.stg_green_trip_data)
[0m14:34:35.815080 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_staging, now model.taxi_rides_ny.stg_yellow_trip_data)
[0m14:34:35.817168 [debug] [Thread-4 (]: Acquiring new bigquery connection 'seed.taxi_rides_ny.taxi-zone-lookup'
[0m14:34:35.818495 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
[0m14:34:35.819611 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m14:34:35.820443 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
[0m14:34:35.821554 [debug] [Thread-4 (]: Began compiling node seed.taxi_rides_ny.taxi-zone-lookup
[0m14:34:35.833867 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
[0m14:34:35.856276 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m14:34:35.857817 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m14:34:35.858647 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi-zone-lookup (compile): 14:34:35.858390 => 14:34:35.858394
[0m14:34:35.861358 [debug] [Thread-4 (]: Began executing node seed.taxi_rides_ny.taxi-zone-lookup
[0m14:34:35.866622 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (compile): 14:34:35.822224 => 14:34:35.865900
[0m14:34:35.867084 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (compile): 14:34:35.853285 => 14:34:35.866849
[0m14:34:35.867470 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 14:34:35.834599 => 14:34:35.867266
[0m14:34:35.869350 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.my_first_dbt_model
[0m14:34:35.885731 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
[0m14:34:35.886428 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m14:34:35.906294 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:34:35.910554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:35.933061 [debug] [Thread-3 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m14:34:35.936056 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_trip_data"
[0m14:34:35.994022 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:34:35.994856 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:34:35.996846 [debug] [Thread-3 (]: On model.taxi_rides_ny.stg_yellow_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`stg_yellow_trip_data`
  OPTIONS()
  as with

sources as(
    select * from `de-zoomcamp-413815`.`trips_all_data`.`yello_trip_data` limit 20
)

select * from sources;


[0m14:34:36.024601 [debug] [Thread-2 (]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
  OPTIONS()
  as select
-- identifiers

    
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
cast(trip_type as integer) as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(ehail_fee as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), lpep_pickup_datetime)=1
-- dbt-bq compile --select stg_green_trip_data --vars '{'is_test_run': 'false'}'

limit 100
;


[0m14:34:36.593044 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.my_first_dbt_model"
[0m14:34:36.595452 [debug] [Thread-1 (]: On model.taxi_rides_ny.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_first_dbt_model"} */

  
    

    create or replace table `de-zoomcamp-413815`.`trips_all_data`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:34:36.828645 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:ca0dcf49-58b1-4e2d-a92e-dd1cba90b1eb&page=queryresults
[0m14:34:36.935655 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:a30275ef-3bd0-4a91-b711-df61cb663c84&page=queryresults
[0m14:34:36.948972 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:881b6e02-1a22-4b6c-a1c8-fc59c9b474db&page=queryresults
[0m14:34:37.167820 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 14:34:35.933325 => 14:34:37.167435
[0m14:34:37.169765 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd87b301c-30fe-4fbc-b784-053a4678612d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7bcce80>]}
[0m14:34:37.171974 [info ] [Thread-2 (]: 2 of 5 OK created sql view model dbt_staging.stg_green_trip_data ............... [[32mCREATE VIEW (0 processed)[0m in 1.36s]
[0m14:34:37.173933 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m14:34:37.311115 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (execute): 14:34:35.910977 => 14:34:37.310483
[0m14:34:37.314474 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd87b301c-30fe-4fbc-b784-053a4678612d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7b50370>]}
[0m14:34:37.316471 [info ] [Thread-3 (]: 3 of 5 OK created sql view model dbt_staging.stg_yellow_trip_data .............. [[32mCREATE VIEW (0 processed)[0m in 1.50s]
[0m14:34:37.318949 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
[0m14:34:38.375253 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (execute): 14:34:35.896784 => 14:34:38.374943
[0m14:34:38.377314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd87b301c-30fe-4fbc-b784-053a4678612d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7a0bd60>]}
[0m14:34:38.378336 [info ] [Thread-1 (]: 1 of 5 OK created sql table model trips_all_data.my_first_dbt_model ............ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.57s]
[0m14:34:38.379638 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.my_first_dbt_model
[0m14:34:38.380851 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.my_second_dbt_model
[0m14:34:38.381655 [info ] [Thread-2 (]: 5 of 5 START sql view model trips_all_data.my_second_dbt_model ................. [RUN]
[0m14:34:38.382941 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_green_trip_data, now model.taxi_rides_ny.my_second_dbt_model)
[0m14:34:38.383786 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
[0m14:34:38.388591 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
[0m14:34:38.392074 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (compile): 14:34:38.384286 => 14:34:38.391562
[0m14:34:38.393035 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.my_second_dbt_model
[0m14:34:38.398493 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.my_second_dbt_model"
[0m14:34:38.401574 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:34:38.405291 [debug] [Thread-2 (]: On model.taxi_rides_ny.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_second_dbt_model"} */


  create or replace view `de-zoomcamp-413815`.`trips_all_data`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `de-zoomcamp-413815`.`trips_all_data`.`my_first_dbt_model`
where id = 1;


[0m14:34:39.259830 [debug] [Thread-4 (]: On seed.taxi_rides_ny.taxi-zone-lookup: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "seed.taxi_rides_ny.taxi-zone-lookup"} */

    alter table `de-zoomcamp-413815`.`trips_all_data`.`taxi-zone-lookup` set OPTIONS()
  
[0m14:34:39.262134 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:109685c3-e1c9-45f2-910b-3ba288f499d7&page=queryresults
[0m14:34:39.467387 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (execute): 14:34:38.394027 => 14:34:39.466507
[0m14:34:39.471676 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd87b301c-30fe-4fbc-b784-053a4678612d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7bae650>]}
[0m14:34:39.474037 [info ] [Thread-2 (]: 5 of 5 OK created sql view model trips_all_data.my_second_dbt_model ............ [[32mCREATE VIEW (0 processed)[0m in 1.09s]
[0m14:34:39.476246 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.my_second_dbt_model
[0m14:34:39.491197 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:4da92f40-3fce-4494-adf9-827987c8e7fb&page=queryresults
[0m14:34:39.972956 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.taxi_rides_ny.taxi-zone-lookup"
[0m14:34:39.980493 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi-zone-lookup (execute): 14:34:35.861915 => 14:34:39.980255
[0m14:34:39.981472 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd87b301c-30fe-4fbc-b784-053a4678612d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7bcd420>]}
[0m14:34:39.982201 [info ] [Thread-4 (]: 4 of 5 OK loaded seed file trips_all_data.taxi-zone-lookup ..................... [[32mINSERT 265[0m in 4.17s]
[0m14:34:39.983087 [debug] [Thread-4 (]: Finished running node seed.taxi_rides_ny.taxi-zone-lookup
[0m14:34:39.985746 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:34:39.986269 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_yellow_trip_data' was properly closed.
[0m14:34:39.986917 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_second_dbt_model' was properly closed.
[0m14:34:39.987568 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_first_dbt_model' was properly closed.
[0m14:34:39.988038 [debug] [MainThread]: Connection 'seed.taxi_rides_ny.taxi-zone-lookup' was properly closed.
[0m14:34:39.988753 [info ] [MainThread]: 
[0m14:34:39.989374 [info ] [MainThread]: Finished running 3 view models, 1 table model, 1 seed in 0 hours 0 minutes and 6.77 seconds (6.77s).
[0m14:34:39.990889 [debug] [MainThread]: Command end result
[0m14:34:40.005429 [info ] [MainThread]: 
[0m14:34:40.006233 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:34:40.006904 [info ] [MainThread]: 
[0m14:34:40.007633 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:34:40.009347 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 7.667154, "process_user_time": 3.678183, "process_kernel_time": 0.338421, "process_mem_max_rss": "160360", "process_in_blocks": "1584", "process_out_blocks": "704"}
[0m14:34:40.010212 [debug] [MainThread]: Command `dbt build` succeeded at 14:34:40.010071 after 7.67 seconds
[0m14:34:40.010742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9421ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7c886d0>]}
[0m14:34:40.011340 [debug] [MainThread]: Flushing usage events
[0m14:36:14.024188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00ce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00ee00>]}


============================== 14:36:14.036363 | e8177074-1472-4977-9d67-73e91e152e4e ==============================
[0m14:36:14.036363 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:36:14.037342 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m14:36:14.402896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8177074-1472-4977-9d67-73e91e152e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc6eeda0>]}
[0m14:36:14.473391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8177074-1472-4977-9d67-73e91e152e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9418340>]}
[0m14:36:14.474337 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:36:14.488608 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:36:14.504223 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:36:14.505052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e8177074-1472-4977-9d67-73e91e152e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9638400>]}
[0m14:36:15.706469 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.taxi_rides_ny.taxi_zone_lookup
[0m14:36:15.712786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8177074-1472-4977-9d67-73e91e152e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7bd5270>]}
[0m14:36:15.727133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8177074-1472-4977-9d67-73e91e152e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92e4040>]}
[0m14:36:15.727833 [info ] [MainThread]: Found 5 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m14:36:15.729720 [info ] [MainThread]: 
[0m14:36:15.730753 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:36:15.732834 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m14:36:15.733706 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:15.734552 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m14:36:15.735637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:16.945952 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_production)
[0m14:36:16.949893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_trips_all_data)
[0m14:36:16.953353 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_dbt_staging'
[0m14:36:16.954115 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:36:16.955499 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:36:16.956751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:18.175381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8177074-1472-4977-9d67-73e91e152e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7bd6500>]}
[0m14:36:18.182037 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:36:18.185306 [info ] [MainThread]: 
[0m14:36:18.206961 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.my_first_dbt_model
[0m14:36:18.208062 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m14:36:18.208867 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
[0m14:36:18.209778 [debug] [Thread-4 (]: Began running node seed.taxi_rides_ny.taxi-zone-lookup
[0m14:36:18.210971 [info ] [Thread-1 (]: 1 of 5 START sql table model trips_all_data.my_first_dbt_model ................. [RUN]
[0m14:36:18.212300 [info ] [Thread-2 (]: 2 of 5 START sql view model dbt_staging.stg_green_trip_data .................... [RUN]
[0m14:36:18.213588 [info ] [Thread-3 (]: 3 of 5 START sql view model dbt_staging.stg_yellow_trip_data ................... [RUN]
[0m14:36:18.214858 [info ] [Thread-4 (]: 4 of 5 START seed file trips_all_data.taxi-zone-lookup ......................... [RUN]
[0m14:36:18.216770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_production, now model.taxi_rides_ny.my_first_dbt_model)
[0m14:36:18.218143 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_trips_all_data, now model.taxi_rides_ny.stg_green_trip_data)
[0m14:36:18.219499 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_staging, now model.taxi_rides_ny.stg_yellow_trip_data)
[0m14:36:18.220838 [debug] [Thread-4 (]: Acquiring new bigquery connection 'seed.taxi_rides_ny.taxi-zone-lookup'
[0m14:36:18.221796 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
[0m14:36:18.222913 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m14:36:18.223697 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
[0m14:36:18.224465 [debug] [Thread-4 (]: Began compiling node seed.taxi_rides_ny.taxi-zone-lookup
[0m14:36:18.241151 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m14:36:18.254843 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m14:36:18.255575 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
[0m14:36:18.256358 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi-zone-lookup (compile): 14:36:18.256072 => 14:36:18.256078
[0m14:36:18.258288 [debug] [Thread-4 (]: Began executing node seed.taxi_rides_ny.taxi-zone-lookup
[0m14:36:18.259018 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 14:36:18.234541 => 14:36:18.258784
[0m14:36:18.259469 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (compile): 14:36:18.251783 => 14:36:18.259254
[0m14:36:18.265082 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (compile): 14:36:18.225047 => 14:36:18.264847
[0m14:36:18.274684 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m14:36:18.275378 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
[0m14:36:18.285114 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:36:18.285468 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.my_first_dbt_model
[0m14:36:18.306891 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_trip_data"
[0m14:36:18.310188 [debug] [Thread-3 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m14:36:18.320376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:18.376066 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:36:18.376524 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:36:18.378477 [debug] [Thread-3 (]: On model.taxi_rides_ny.stg_yellow_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`stg_yellow_trip_data`
  OPTIONS()
  as with

sources as(
    select * from `de-zoomcamp-413815`.`trips_all_data`.`yello_trip_data` limit 20
)

select * from sources;


[0m14:36:18.405911 [debug] [Thread-2 (]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
  OPTIONS()
  as select
-- identifiers

    
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
cast(trip_type as integer) as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(ehail_fee as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), lpep_pickup_datetime)=1
-- dbt-bq compile --select stg_green_trip_data --vars '{'is_test_run': 'false'}'

limit 100
;


[0m14:36:18.957170 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.my_first_dbt_model"
[0m14:36:18.959159 [debug] [Thread-1 (]: On model.taxi_rides_ny.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_first_dbt_model"} */

  
    

    create or replace table `de-zoomcamp-413815`.`trips_all_data`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:36:19.079959 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:02a86ff1-800f-4a80-a091-762edfc3deaf&page=queryresults
[0m14:36:19.094021 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:8025f2e9-0c81-473d-a059-c5b965ad7e86&page=queryresults
[0m14:36:19.249988 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:7e61a077-8c04-46df-8df3-eca029194fe9&page=queryresults
[0m14:36:19.427172 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 14:36:18.285889 => 14:36:19.426851
[0m14:36:19.428984 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (execute): 14:36:18.307131 => 14:36:19.428698
[0m14:36:19.430346 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8177074-1472-4977-9d67-73e91e152e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7919150>]}
[0m14:36:19.431530 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8177074-1472-4977-9d67-73e91e152e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7930940>]}
[0m14:36:19.433100 [info ] [Thread-2 (]: 2 of 5 OK created sql view model dbt_staging.stg_green_trip_data ............... [[32mCREATE VIEW (0 processed)[0m in 1.21s]
[0m14:36:19.434110 [info ] [Thread-3 (]: 3 of 5 OK created sql view model dbt_staging.stg_yellow_trip_data .............. [[32mCREATE VIEW (0 processed)[0m in 1.21s]
[0m14:36:19.435407 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m14:36:19.436336 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
[0m14:36:20.641242 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (execute): 14:36:18.311790 => 14:36:20.640127
[0m14:36:20.645978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8177074-1472-4977-9d67-73e91e152e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7930940>]}
[0m14:36:20.648369 [info ] [Thread-1 (]: 1 of 5 OK created sql table model trips_all_data.my_first_dbt_model ............ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.43s]
[0m14:36:20.650901 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.my_first_dbt_model
[0m14:36:20.653430 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.my_second_dbt_model
[0m14:36:20.654971 [info ] [Thread-2 (]: 5 of 5 START sql view model trips_all_data.my_second_dbt_model ................. [RUN]
[0m14:36:20.657245 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_green_trip_data, now model.taxi_rides_ny.my_second_dbt_model)
[0m14:36:20.658519 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
[0m14:36:20.666903 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
[0m14:36:20.670832 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (compile): 14:36:20.659447 => 14:36:20.670343
[0m14:36:20.671693 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.my_second_dbt_model
[0m14:36:20.681066 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.my_second_dbt_model"
[0m14:36:20.684279 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:36:20.686697 [debug] [Thread-2 (]: On model.taxi_rides_ny.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_second_dbt_model"} */


  create or replace view `de-zoomcamp-413815`.`trips_all_data`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `de-zoomcamp-413815`.`trips_all_data`.`my_first_dbt_model`
where id = 1;


[0m14:36:21.425541 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:41e91a4a-bb3a-4f95-b6cd-7136c2eac8f6&page=queryresults
[0m14:36:21.563719 [debug] [Thread-4 (]: On seed.taxi_rides_ny.taxi-zone-lookup: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "seed.taxi_rides_ny.taxi-zone-lookup"} */

    alter table `de-zoomcamp-413815`.`trips_all_data`.`taxi-zone-lookup` set OPTIONS()
  
[0m14:36:21.632631 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (execute): 14:36:20.672260 => 14:36:21.631961
[0m14:36:21.635483 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8177074-1472-4977-9d67-73e91e152e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7930880>]}
[0m14:36:21.637650 [info ] [Thread-2 (]: 5 of 5 OK created sql view model trips_all_data.my_second_dbt_model ............ [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m14:36:21.640470 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.my_second_dbt_model
[0m14:36:21.794201 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:92a54b38-9cda-45d4-9517-16119136fc14&page=queryresults
[0m14:36:22.491711 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.taxi_rides_ny.taxi-zone-lookup"
[0m14:36:22.496010 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi-zone-lookup (execute): 14:36:18.259677 => 14:36:22.495799
[0m14:36:22.497034 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8177074-1472-4977-9d67-73e91e152e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7a9e620>]}
[0m14:36:22.497999 [info ] [Thread-4 (]: 4 of 5 OK loaded seed file trips_all_data.taxi-zone-lookup ..................... [[32mINSERT 265[0m in 4.28s]
[0m14:36:22.498811 [debug] [Thread-4 (]: Finished running node seed.taxi_rides_ny.taxi-zone-lookup
[0m14:36:22.501671 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:36:22.502202 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_second_dbt_model' was properly closed.
[0m14:36:22.502629 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_first_dbt_model' was properly closed.
[0m14:36:22.503008 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_yellow_trip_data' was properly closed.
[0m14:36:22.503396 [debug] [MainThread]: Connection 'seed.taxi_rides_ny.taxi-zone-lookup' was properly closed.
[0m14:36:22.504048 [info ] [MainThread]: 
[0m14:36:22.504655 [info ] [MainThread]: Finished running 3 view models, 1 table model, 1 seed in 0 hours 0 minutes and 6.77 seconds (6.77s).
[0m14:36:22.506232 [debug] [MainThread]: Command end result
[0m14:36:22.517372 [info ] [MainThread]: 
[0m14:36:22.518120 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:36:22.518701 [info ] [MainThread]: 
[0m14:36:22.519359 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:36:22.520957 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 8.551853, "process_user_time": 4.55208, "process_kernel_time": 0.243969, "process_mem_max_rss": "163172", "process_out_blocks": "704", "process_in_blocks": "0"}
[0m14:36:22.521716 [debug] [MainThread]: Command `dbt build` succeeded at 14:36:22.521563 after 8.55 seconds
[0m14:36:22.522334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc6eeda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92e4040>]}
[0m14:36:22.522920 [debug] [MainThread]: Flushing usage events
[0m14:38:18.954608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f8b0>]}


============================== 14:38:18.967333 | 54a15858-7d9d-4811-906d-1a91ac4ca8a0 ==============================
[0m14:38:18.967333 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:38:18.968337 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:38:19.348642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54a15858-7d9d-4811-906d-1a91ac4ca8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc30e2f0>]}
[0m14:38:19.420274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54a15858-7d9d-4811-906d-1a91ac4ca8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9522800>]}
[0m14:38:19.421133 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:38:19.436434 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:38:19.500786 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:38:19.501303 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:38:19.502129 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.taxi_rides_ny.taxi_zone_lookup
[0m14:38:19.507985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54a15858-7d9d-4811-906d-1a91ac4ca8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92a00d0>]}
[0m14:38:19.524428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54a15858-7d9d-4811-906d-1a91ac4ca8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff925d1e0>]}
[0m14:38:19.525059 [info ] [MainThread]: Found 5 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m14:38:19.525571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54a15858-7d9d-4811-906d-1a91ac4ca8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff925d2d0>]}
[0m14:38:19.527264 [info ] [MainThread]: 
[0m14:38:19.528436 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:38:19.531517 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m14:38:19.532228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:20.347201 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_trips_all_data)
[0m14:38:20.352418 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_production'
[0m14:38:20.355600 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_dbt_staging'
[0m14:38:20.356598 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:38:20.358020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:20.359903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:21.668845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54a15858-7d9d-4811-906d-1a91ac4ca8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9247fa0>]}
[0m14:38:21.678013 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:38:21.680401 [info ] [MainThread]: 
[0m14:38:21.701171 [debug] [Thread-1 (]: Began running node seed.taxi_rides_ny.taxi-zone-lookup
[0m14:38:21.703368 [info ] [Thread-1 (]: 1 of 1 START seed file trips_all_data.taxi-zone-lookup ......................... [RUN]
[0m14:38:21.705634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_production, now seed.taxi_rides_ny.taxi-zone-lookup)
[0m14:38:21.707019 [debug] [Thread-1 (]: Began compiling node seed.taxi_rides_ny.taxi-zone-lookup
[0m14:38:21.708357 [debug] [Thread-1 (]: Timing info for seed.taxi_rides_ny.taxi-zone-lookup (compile): 14:38:21.707752 => 14:38:21.707760
[0m14:38:21.709335 [debug] [Thread-1 (]: Began executing node seed.taxi_rides_ny.taxi-zone-lookup
[0m14:38:21.743549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:38:25.566083 [debug] [Thread-1 (]: On seed.taxi_rides_ny.taxi-zone-lookup: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "seed.taxi_rides_ny.taxi-zone-lookup"} */

    alter table `de-zoomcamp-413815`.`trips_all_data`.`taxi-zone-lookup` set OPTIONS()
  
[0m14:38:25.794470 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:939f3b36-ad6d-4b99-aed9-142ef7e784d8&page=queryresults
[0m14:38:26.068973 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.taxi_rides_ny.taxi-zone-lookup"
[0m14:38:26.095487 [debug] [Thread-1 (]: Timing info for seed.taxi_rides_ny.taxi-zone-lookup (execute): 14:38:21.709982 => 14:38:26.095168
[0m14:38:26.096928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54a15858-7d9d-4811-906d-1a91ac4ca8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9177430>]}
[0m14:38:26.098544 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file trips_all_data.taxi-zone-lookup ..................... [[32mINSERT 265[0m in 4.39s]
[0m14:38:26.099983 [debug] [Thread-1 (]: Finished running node seed.taxi_rides_ny.taxi-zone-lookup
[0m14:38:26.103372 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:38:26.104126 [debug] [MainThread]: Connection 'list_de-zoomcamp-413815_trips_all_data' was properly closed.
[0m14:38:26.104873 [debug] [MainThread]: Connection 'seed.taxi_rides_ny.taxi-zone-lookup' was properly closed.
[0m14:38:26.105449 [debug] [MainThread]: Connection 'list_de-zoomcamp-413815_dbt_staging' was properly closed.
[0m14:38:26.106296 [info ] [MainThread]: 
[0m14:38:26.106979 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 6.58 seconds (6.58s).
[0m14:38:26.108094 [debug] [MainThread]: Command end result
[0m14:38:26.120375 [info ] [MainThread]: 
[0m14:38:26.121135 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:38:26.121718 [info ] [MainThread]: 
[0m14:38:26.122340 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:38:26.123915 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 7.2242694, "process_user_time": 2.848549, "process_kernel_time": 0.25211, "process_mem_max_rss": "149792", "process_out_blocks": "704", "process_in_blocks": "0"}
[0m14:38:26.124667 [debug] [MainThread]: Command `dbt seed` succeeded at 14:38:26.124539 after 7.23 seconds
[0m14:38:26.125194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95a5ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9522800>]}
[0m14:38:26.125706 [debug] [MainThread]: Flushing usage events
[0m14:40:08.161935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00ef80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f940>]}


============================== 14:40:08.175235 | c9c36f35-792d-49e9-acc3-7d0d2f9249b2 ==============================
[0m14:40:08.175235 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:40:08.176414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:40:08.555053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9c36f35-792d-49e9-acc3-7d0d2f9249b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc6dcee0>]}
[0m14:40:08.628036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9c36f35-792d-49e9-acc3-7d0d2f9249b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9414610>]}
[0m14:40:08.629103 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:40:08.645378 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:40:08.660279 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:40:08.661047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c9c36f35-792d-49e9-acc3-7d0d2f9249b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff961c430>]}
[0m14:40:09.887231 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.taxi_rides_ny.taxi_zone_lookup
[0m14:40:09.893131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9c36f35-792d-49e9-acc3-7d0d2f9249b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7bdd300>]}
[0m14:40:09.908377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9c36f35-792d-49e9-acc3-7d0d2f9249b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92e5750>]}
[0m14:40:09.909031 [info ] [MainThread]: Found 5 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m14:40:09.909573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9c36f35-792d-49e9-acc3-7d0d2f9249b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff94a75b0>]}
[0m14:40:09.911250 [info ] [MainThread]: 
[0m14:40:09.912466 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:40:09.914301 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m14:40:09.914917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:10.671139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_dbt_staging)
[0m14:40:10.675695 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_trips_all_data'
[0m14:40:10.677292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:10.679382 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_production'
[0m14:40:10.680860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:10.682822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:11.765947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9c36f35-792d-49e9-acc3-7d0d2f9249b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7bddb40>]}
[0m14:40:11.775719 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:40:11.779208 [info ] [MainThread]: 
[0m14:40:11.798844 [debug] [Thread-1 (]: Began running node seed.taxi_rides_ny.taxi-zone-lookup
[0m14:40:11.800836 [info ] [Thread-1 (]: 1 of 1 START seed file dbt_staging.taxi-zone-lookup ............................ [RUN]
[0m14:40:11.802741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_production, now seed.taxi_rides_ny.taxi-zone-lookup)
[0m14:40:11.803847 [debug] [Thread-1 (]: Began compiling node seed.taxi_rides_ny.taxi-zone-lookup
[0m14:40:11.804982 [debug] [Thread-1 (]: Timing info for seed.taxi_rides_ny.taxi-zone-lookup (compile): 14:40:11.804535 => 14:40:11.804542
[0m14:40:11.805851 [debug] [Thread-1 (]: Began executing node seed.taxi_rides_ny.taxi-zone-lookup
[0m14:40:11.850287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:15.213366 [debug] [Thread-1 (]: On seed.taxi_rides_ny.taxi-zone-lookup: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "seed.taxi_rides_ny.taxi-zone-lookup"} */

    alter table `de-zoomcamp-413815`.`dbt_staging`.`taxi-zone-lookup` set OPTIONS()
  
[0m14:40:15.597276 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:3f83c13b-86e6-461f-85fa-7f05b411cef6&page=queryresults
[0m14:40:15.898488 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.taxi_rides_ny.taxi-zone-lookup"
[0m14:40:15.930493 [debug] [Thread-1 (]: Timing info for seed.taxi_rides_ny.taxi-zone-lookup (execute): 14:40:11.806515 => 14:40:15.930205
[0m14:40:15.931795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9c36f35-792d-49e9-acc3-7d0d2f9249b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff918a920>]}
[0m14:40:15.933284 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dbt_staging.taxi-zone-lookup ........................ [[32mINSERT 265[0m in 4.13s]
[0m14:40:15.934451 [debug] [Thread-1 (]: Finished running node seed.taxi_rides_ny.taxi-zone-lookup
[0m14:40:15.937738 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:40:15.938332 [debug] [MainThread]: Connection 'list_de-zoomcamp-413815_dbt_staging' was properly closed.
[0m14:40:15.938835 [debug] [MainThread]: Connection 'list_de-zoomcamp-413815_trips_all_data' was properly closed.
[0m14:40:15.939318 [debug] [MainThread]: Connection 'seed.taxi_rides_ny.taxi-zone-lookup' was properly closed.
[0m14:40:15.940083 [info ] [MainThread]: 
[0m14:40:15.940757 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 6.03 seconds (6.03s).
[0m14:40:15.941712 [debug] [MainThread]: Command end result
[0m14:40:15.954053 [info ] [MainThread]: 
[0m14:40:15.954688 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:40:15.955200 [info ] [MainThread]: 
[0m14:40:15.955962 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:40:15.957578 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 7.852383, "process_user_time": 3.917923, "process_kernel_time": 0.244119, "process_mem_max_rss": "156296", "process_out_blocks": "704", "process_in_blocks": "0"}
[0m14:40:15.958390 [debug] [MainThread]: Command `dbt seed` succeeded at 14:40:15.958265 after 7.85 seconds
[0m14:40:15.958879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff961fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92e5750>]}
[0m14:40:15.959362 [debug] [MainThread]: Flushing usage events
[0m14:41:46.127888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00e7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00ebf0>]}


============================== 14:41:46.139626 | 0f441d02-809a-4b62-a453-6e2c94956821 ==============================
[0m14:41:46.139626 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:41:46.140540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:41:46.503141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f441d02-809a-4b62-a453-6e2c94956821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc639b70>]}
[0m14:41:46.574194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f441d02-809a-4b62-a453-6e2c94956821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb7340>]}
[0m14:41:46.575123 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:41:46.588741 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:41:46.603395 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:41:46.604165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0f441d02-809a-4b62-a453-6e2c94956821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9525a20>]}
[0m14:41:47.800036 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.taxi_rides_ny.taxi_zone_lookup
[0m14:41:47.805721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f441d02-809a-4b62-a453-6e2c94956821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7a540d0>]}
[0m14:41:47.819799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f441d02-809a-4b62-a453-6e2c94956821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9492050>]}
[0m14:41:47.820487 [info ] [MainThread]: Found 5 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m14:41:47.821025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f441d02-809a-4b62-a453-6e2c94956821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffba8e4d0>]}
[0m14:41:47.822853 [info ] [MainThread]: 
[0m14:41:47.823887 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:41:47.825695 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m14:41:47.826428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:48.696921 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_production)
[0m14:41:48.702992 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_dbt_staging'
[0m14:41:48.705840 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:41:48.707430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:49.840081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f441d02-809a-4b62-a453-6e2c94956821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7a56b90>]}
[0m14:41:49.847138 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:41:49.851664 [info ] [MainThread]: 
[0m14:41:49.873851 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.my_first_dbt_model
[0m14:41:49.874943 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m14:41:49.875705 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
[0m14:41:49.877437 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_staging.my_first_dbt_model .................... [RUN]
[0m14:41:49.879400 [info ] [Thread-2 (]: 2 of 4 START sql view model dbt_staging.stg_green_trip_data .................... [RUN]
[0m14:41:49.880743 [info ] [Thread-3 (]: 3 of 4 START sql view model dbt_staging.stg_yellow_trip_data ................... [RUN]
[0m14:41:49.882017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_production, now model.taxi_rides_ny.my_first_dbt_model)
[0m14:41:49.883263 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_staging, now model.taxi_rides_ny.stg_green_trip_data)
[0m14:41:49.884575 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.stg_yellow_trip_data'
[0m14:41:49.885528 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
[0m14:41:49.886393 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m14:41:49.887224 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
[0m14:41:49.910067 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
[0m14:41:49.912718 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m14:41:49.915917 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m14:41:49.920675 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (compile): 14:41:49.912990 => 14:41:49.920316
[0m14:41:49.921191 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (compile): 14:41:49.887887 => 14:41:49.920910
[0m14:41:49.921584 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 14:41:49.898098 => 14:41:49.921387
[0m14:41:49.922120 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
[0m14:41:49.922651 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.my_first_dbt_model
[0m14:41:49.923166 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m14:41:49.955743 [debug] [Thread-3 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m14:41:49.972505 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.my_first_dbt_model"
[0m14:41:49.975812 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_trip_data"
[0m14:41:49.978800 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:41:49.979165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:49.979443 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:41:49.981154 [debug] [Thread-3 (]: On model.taxi_rides_ny.stg_yellow_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`stg_yellow_trip_data`
  OPTIONS()
  as with

sources as(
    select * from `de-zoomcamp-413815`.`trips_all_data`.`yello_trip_data` limit 20
)

select * from sources;


[0m14:41:50.009226 [debug] [Thread-2 (]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
  OPTIONS()
  as select
-- identifiers

    
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
cast(trip_type as integer) as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(ehail_fee as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), lpep_pickup_datetime)=1
-- dbt-bq compile --select stg_green_trip_data --vars '{'is_test_run': 'false'}'

limit 100
;


[0m14:41:50.009899 [debug] [Thread-1 (]: On model.taxi_rides_ny.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_first_dbt_model"} */

  
    

    create or replace table `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:41:50.771868 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:f83f13d8-41fc-4e53-9a8e-efa2adc90afe&page=queryresults
[0m14:41:50.785873 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:bf5bf200-ded2-4d26-ab50-0184a7442b85&page=queryresults
[0m14:41:50.789020 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:157ab427-8dce-4ebe-ba92-1838bcd82f58&page=queryresults
[0m14:41:51.129658 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 14:41:49.972733 => 14:41:51.129220
[0m14:41:51.132114 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f441d02-809a-4b62-a453-6e2c94956821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff799fd90>]}
[0m14:41:51.134439 [info ] [Thread-2 (]: 2 of 4 OK created sql view model dbt_staging.stg_green_trip_data ............... [[32mCREATE VIEW (0 processed)[0m in 1.25s]
[0m14:41:51.135889 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m14:41:51.176367 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (execute): 14:41:49.923534 => 14:41:51.175967
[0m14:41:51.178567 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f441d02-809a-4b62-a453-6e2c94956821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff79400d0>]}
[0m14:41:51.179937 [info ] [Thread-3 (]: 3 of 4 OK created sql view model dbt_staging.stg_yellow_trip_data .............. [[32mCREATE VIEW (0 processed)[0m in 1.29s]
[0m14:41:51.181397 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
[0m14:41:52.435398 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (execute): 14:41:49.947186 => 14:41:52.434694
[0m14:41:52.440836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f441d02-809a-4b62-a453-6e2c94956821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7910ac0>]}
[0m14:41:52.445715 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_staging.my_first_dbt_model ............... [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.56s]
[0m14:41:52.450505 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.my_first_dbt_model
[0m14:41:52.455029 [debug] [Thread-4 (]: Began running node model.taxi_rides_ny.my_second_dbt_model
[0m14:41:52.457409 [info ] [Thread-4 (]: 4 of 4 START sql view model dbt_staging.my_second_dbt_model .................... [RUN]
[0m14:41:52.460255 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.my_second_dbt_model'
[0m14:41:52.461694 [debug] [Thread-4 (]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
[0m14:41:52.471198 [debug] [Thread-4 (]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
[0m14:41:52.476262 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (compile): 14:41:52.462919 => 14:41:52.475562
[0m14:41:52.477219 [debug] [Thread-4 (]: Began executing node model.taxi_rides_ny.my_second_dbt_model
[0m14:41:52.482729 [debug] [Thread-4 (]: Writing runtime sql for node "model.taxi_rides_ny.my_second_dbt_model"
[0m14:41:52.484996 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:41:52.487704 [debug] [Thread-4 (]: On model.taxi_rides_ny.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_second_dbt_model"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
where id = 1;


[0m14:41:53.162931 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:074d998b-24dc-4212-9a3d-b16affe9b8b7&page=queryresults
[0m14:41:53.599464 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (execute): 14:41:52.477810 => 14:41:53.598714
[0m14:41:53.603221 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f441d02-809a-4b62-a453-6e2c94956821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff799f400>]}
[0m14:41:53.605464 [info ] [Thread-4 (]: 4 of 4 OK created sql view model dbt_staging.my_second_dbt_model ............... [[32mCREATE VIEW (0 processed)[0m in 1.14s]
[0m14:41:53.607763 [debug] [Thread-4 (]: Finished running node model.taxi_rides_ny.my_second_dbt_model
[0m14:41:53.612821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:53.613973 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_first_dbt_model' was properly closed.
[0m14:41:53.614908 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_green_trip_data' was properly closed.
[0m14:41:53.615737 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_yellow_trip_data' was properly closed.
[0m14:41:53.616627 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_second_dbt_model' was properly closed.
[0m14:41:53.618089 [info ] [MainThread]: 
[0m14:41:53.619728 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 5.79 seconds (5.79s).
[0m14:41:53.622917 [debug] [MainThread]: Command end result
[0m14:41:53.652028 [info ] [MainThread]: 
[0m14:41:53.652898 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:41:53.653616 [info ] [MainThread]: 
[0m14:41:53.654405 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:41:53.656231 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.583078, "process_user_time": 4.156932, "process_kernel_time": 0.198428, "process_mem_max_rss": "159776", "process_out_blocks": "704", "process_in_blocks": "0"}
[0m14:41:53.657084 [debug] [MainThread]: Command `dbt run` succeeded at 14:41:53.656938 after 7.58 seconds
[0m14:41:53.657590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff93ba1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9492050>]}
[0m14:41:53.658119 [debug] [MainThread]: Flushing usage events
[0m14:42:36.817900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f8b0>]}


============================== 14:42:36.829937 | 3fce84b6-ce1f-4674-8a8a-48e66621141c ==============================
[0m14:42:36.829937 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:42:36.831098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:42:37.195538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fce84b6-ce1f-4674-8a8a-48e66621141c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc30e2f0>]}
[0m14:42:37.266731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fce84b6-ce1f-4674-8a8a-48e66621141c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff941c280>]}
[0m14:42:37.267617 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:42:37.281729 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:42:37.296111 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:42:37.296901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3fce84b6-ce1f-4674-8a8a-48e66621141c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaff4130>]}
[0m14:42:38.506913 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.taxi_rides_ny.taxi_zone_lookup
[0m14:42:38.512713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fce84b6-ce1f-4674-8a8a-48e66621141c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7a4a3b0>]}
[0m14:42:38.526400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fce84b6-ce1f-4674-8a8a-48e66621141c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9371180>]}
[0m14:42:38.527046 [info ] [MainThread]: Found 5 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m14:42:38.527558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fce84b6-ce1f-4674-8a8a-48e66621141c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9354220>]}
[0m14:42:38.529485 [info ] [MainThread]: 
[0m14:42:38.530584 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:42:38.532865 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m14:42:38.533756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:39.390179 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_production)
[0m14:42:39.394672 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_dbt_staging'
[0m14:42:39.395944 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:42:39.397327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:40.632744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fce84b6-ce1f-4674-8a8a-48e66621141c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7a4b7c0>]}
[0m14:42:40.634256 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:42:40.634916 [info ] [MainThread]: 
[0m14:42:40.642768 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.my_first_dbt_model
[0m14:42:40.643354 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m14:42:40.643705 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
[0m14:42:40.644462 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_staging.my_first_dbt_model .................... [RUN]
[0m14:42:40.645283 [info ] [Thread-2 (]: 2 of 4 START sql view model dbt_staging.stg_green_trip_data .................... [RUN]
[0m14:42:40.646072 [info ] [Thread-3 (]: 3 of 4 START sql view model dbt_staging.stg_yellow_trip_data ................... [RUN]
[0m14:42:40.647346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_production, now model.taxi_rides_ny.my_first_dbt_model)
[0m14:42:40.648717 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_staging, now model.taxi_rides_ny.stg_green_trip_data)
[0m14:42:40.649829 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.stg_yellow_trip_data'
[0m14:42:40.650462 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
[0m14:42:40.651039 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m14:42:40.651542 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
[0m14:42:40.665852 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
[0m14:42:40.670947 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m14:42:40.674599 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m14:42:40.677435 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (compile): 14:42:40.651915 => 14:42:40.677117
[0m14:42:40.678121 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 14:42:40.666513 => 14:42:40.677873
[0m14:42:40.678696 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (compile): 14:42:40.671517 => 14:42:40.678314
[0m14:42:40.679287 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.my_first_dbt_model
[0m14:42:40.679853 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m14:42:40.680405 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
[0m14:42:40.694056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:40.718086 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_trip_data"
[0m14:42:40.722055 [debug] [Thread-3 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m14:42:40.752138 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:42:40.752942 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:42:40.754792 [debug] [Thread-2 (]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
  OPTIONS()
  as select
-- identifiers

    
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
cast(trip_type as integer) as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(ehail_fee as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), lpep_pickup_datetime)=1
-- dbt-bq compile --select stg_green_trip_data --vars '{'is_test_run': 'false'}'

limit 100
;


[0m14:42:40.756755 [debug] [Thread-3 (]: On model.taxi_rides_ny.stg_yellow_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`stg_yellow_trip_data`
  OPTIONS()
  as with

sources as(
    select * from `de-zoomcamp-413815`.`trips_all_data`.`yello_trip_data` limit 20
)

select * from sources;


[0m14:42:41.282900 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.my_first_dbt_model"
[0m14:42:41.286277 [debug] [Thread-1 (]: On model.taxi_rides_ny.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_first_dbt_model"} */

  
    

    create or replace table `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:42:41.457744 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:91905029-e108-4794-9cfd-8016645a4012&page=queryresults
[0m14:42:41.475632 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:b39dd24c-374e-410f-bb3b-091b3e5d8edb&page=queryresults
[0m14:42:41.577424 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:149b1d13-320a-41f9-b1e2-4304b65718d8&page=queryresults
[0m14:42:41.730635 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (execute): 14:42:40.718440 => 14:42:41.730128
[0m14:42:41.733243 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fce84b6-ce1f-4674-8a8a-48e66621141c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7949ab0>]}
[0m14:42:41.735901 [info ] [Thread-3 (]: 3 of 4 OK created sql view model dbt_staging.stg_yellow_trip_data .............. [[32mCREATE VIEW (0 processed)[0m in 1.08s]
[0m14:42:41.737692 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
[0m14:42:41.749906 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 14:42:40.694605 => 14:42:41.749535
[0m14:42:41.751976 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fce84b6-ce1f-4674-8a8a-48e66621141c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff794a830>]}
[0m14:42:41.753417 [info ] [Thread-2 (]: 2 of 4 OK created sql view model dbt_staging.stg_green_trip_data ............... [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m14:42:41.755106 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m14:42:43.250693 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (execute): 14:42:40.680763 => 14:42:43.249671
[0m14:42:43.255578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fce84b6-ce1f-4674-8a8a-48e66621141c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7914ac0>]}
[0m14:42:43.258316 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_staging.my_first_dbt_model ............... [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.61s]
[0m14:42:43.260965 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.my_first_dbt_model
[0m14:42:43.265353 [debug] [Thread-4 (]: Began running node model.taxi_rides_ny.my_second_dbt_model
[0m14:42:43.266727 [info ] [Thread-4 (]: 4 of 4 START sql view model dbt_staging.my_second_dbt_model .................... [RUN]
[0m14:42:43.269120 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.my_second_dbt_model'
[0m14:42:43.270400 [debug] [Thread-4 (]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
[0m14:42:43.278910 [debug] [Thread-4 (]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
[0m14:42:43.283071 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (compile): 14:42:43.271403 => 14:42:43.282503
[0m14:42:43.284029 [debug] [Thread-4 (]: Began executing node model.taxi_rides_ny.my_second_dbt_model
[0m14:42:43.289028 [debug] [Thread-4 (]: Writing runtime sql for node "model.taxi_rides_ny.my_second_dbt_model"
[0m14:42:43.291267 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:42:43.293972 [debug] [Thread-4 (]: On model.taxi_rides_ny.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_second_dbt_model"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
where id = 1;


[0m14:42:44.020157 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:07ac4899-3380-43df-849e-6ee0d1a61e8b&page=queryresults
[0m14:42:44.273205 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (execute): 14:42:43.284645 => 14:42:44.271961
[0m14:42:44.277671 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fce84b6-ce1f-4674-8a8a-48e66621141c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff79153c0>]}
[0m14:42:44.280305 [info ] [Thread-4 (]: 4 of 4 OK created sql view model dbt_staging.my_second_dbt_model ............... [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m14:42:44.283038 [debug] [Thread-4 (]: Finished running node model.taxi_rides_ny.my_second_dbt_model
[0m14:42:44.289942 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:42:44.291328 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_first_dbt_model' was properly closed.
[0m14:42:44.292601 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_green_trip_data' was properly closed.
[0m14:42:44.293884 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_yellow_trip_data' was properly closed.
[0m14:42:44.294877 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_second_dbt_model' was properly closed.
[0m14:42:44.296377 [info ] [MainThread]: 
[0m14:42:44.297773 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 5.77 seconds (5.77s).
[0m14:42:44.300037 [debug] [MainThread]: Command end result
[0m14:42:44.327718 [info ] [MainThread]: 
[0m14:42:44.328548 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:42:44.329367 [info ] [MainThread]: 
[0m14:42:44.330235 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:42:44.332005 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.565405, "process_user_time": 4.241552, "process_kernel_time": 0.158477, "process_mem_max_rss": "160192", "process_in_blocks": "1400", "process_out_blocks": "704"}
[0m14:42:44.332803 [debug] [MainThread]: Command `dbt run` succeeded at 14:42:44.332672 after 7.57 seconds
[0m14:42:44.333427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff795da80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9232b30>]}
[0m14:42:44.334064 [debug] [MainThread]: Flushing usage events
[0m14:47:46.494940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00dcf0>]}


============================== 14:47:46.508089 | f13ee6af-8c09-4d21-b010-d0972a484720 ==============================
[0m14:47:46.508089 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:47:46.509221 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select dim_zones', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:47:46.900772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f13ee6af-8c09-4d21-b010-d0972a484720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff963c910>]}
[0m14:47:46.975357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f13ee6af-8c09-4d21-b010-d0972a484720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9411ae0>]}
[0m14:47:46.976406 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:47:46.992873 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:47:47.060276 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:47:47.061184 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://taxi_rides_ny/models/core/dim_zones.sql
[0m14:47:47.198026 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.taxi_rides_ny.dim_zones' (taxi_rides_ny/models/core/dim_zones.sql) depends on a node named 'taxi_zone_lookup' which was not found
[0m14:47:47.200894 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.7611722, "process_user_time": 2.299692, "process_kernel_time": 0.229668, "process_mem_max_rss": "133228", "process_out_blocks": "648", "command_success": false, "process_in_blocks": "0"}
[0m14:47:47.201754 [debug] [MainThread]: Command `dbt build` failed at 14:47:47.201580 after 0.76 seconds
[0m14:47:47.202433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9113100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9112e30>]}
[0m14:47:47.202963 [debug] [MainThread]: Flushing usage events
[0m14:50:23.706930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00dd80>]}


============================== 14:50:23.718875 | 4de94b05-f868-4f11-b5bb-48d5d47fd573 ==============================
[0m14:50:23.718875 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:50:23.719797 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --select dim_zones', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:50:24.079086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4de94b05-f868-4f11-b5bb-48d5d47fd573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff963e110>]}
[0m14:50:24.151582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4de94b05-f868-4f11-b5bb-48d5d47fd573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9411030>]}
[0m14:50:24.152513 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:50:24.167003 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:50:24.230023 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:50:24.230793 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://taxi_rides_ny/models/core/dim_zones.sql
[0m14:50:24.374518 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.taxi_rides_ny.taxi_zone_lookup
[0m14:50:24.379926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4de94b05-f868-4f11-b5bb-48d5d47fd573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91e0b20>]}
[0m14:50:24.396638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4de94b05-f868-4f11-b5bb-48d5d47fd573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff925f550>]}
[0m14:50:24.397340 [info ] [MainThread]: Found 5 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m14:50:24.398961 [info ] [MainThread]: 
[0m14:50:24.399999 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:50:24.402189 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m14:50:24.402837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:25.430574 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now create_de-zoomcamp-413815_production)
[0m14:50:25.436584 [debug] [ThreadPool]: Creating schema "database: "de-zoomcamp-413815"
schema: "production"
"
[0m14:50:25.453362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:25.455863 [debug] [ThreadPool]: On create_de-zoomcamp-413815_production: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "connection_name": "create_de-zoomcamp-413815_production"} */
create schema if not exists `de-zoomcamp-413815`.`production`
  
[0m14:50:26.280506 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:adee4ce5-f447-40ae-9ec2-9ecf9f470ce8&page=queryresults
[0m14:50:29.997738 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_de-zoomcamp-413815_production, now list_de-zoomcamp-413815_production)
[0m14:50:30.000480 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_dbt_staging'
[0m14:50:30.001983 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:30.003370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:30.667889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4de94b05-f868-4f11-b5bb-48d5d47fd573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff925d240>]}
[0m14:50:30.672709 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:50:30.674795 [info ] [MainThread]: 
[0m14:50:30.694159 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.dim_zones
[0m14:50:30.696338 [info ] [Thread-1 (]: 1 of 1 START sql table model production.dim_zones .............................. [RUN]
[0m14:50:30.698466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_production, now model.taxi_rides_ny.dim_zones)
[0m14:50:30.699703 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m14:50:30.710983 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m14:50:30.714193 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.dim_zones (compile): 14:50:30.700543 => 14:50:30.713833
[0m14:50:30.714870 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m14:50:30.751846 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_zones"
[0m14:50:30.753957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:30.755732 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */

  
    

    create or replace table `de-zoomcamp-413815`.`production`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      select 
locationid,
borough,
zone,
replace(service_name, 'Boro', 'Green') as service_zone
from `de-zoomcamp-413815`.`dbt_staging`.`taxi-zone-lookup`
    );
  
[0m14:50:31.626524 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:cb6e5eba-51cb-4f6a-b28e-63028dcec72d&page=queryresults
[0m14:50:31.909623 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: service_name at [17:9]; reason: invalidQuery, location: query, message: Unrecognized name: service_name at [17:9]')
[0m14:50:32.353186 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:3adc597c-6b3c-4494-a925-9f8503236037&page=queryresults
[0m14:50:32.697980 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:3adc597c-6b3c-4494-a925-9f8503236037&page=queryresults
[0m14:50:32.707925 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.dim_zones (execute): 14:50:30.715464 => 14:50:32.706125
[0m14:50:32.732021 [debug] [Thread-1 (]: Database Error in model dim_zones (taxi_rides_ny/models/core/dim_zones.sql)
  Unrecognized name: service_name at [17:9]
  compiled Code at target/run/taxi_rides_ny/taxi_rides_ny/models/core/dim_zones.sql
[0m14:50:32.733978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4de94b05-f868-4f11-b5bb-48d5d47fd573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7ccd570>]}
[0m14:50:32.735808 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model production.dim_zones ..................... [[31mERROR[0m in 2.04s]
[0m14:50:32.737223 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m14:50:32.740701 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:32.741296 [debug] [MainThread]: Connection 'model.taxi_rides_ny.dim_zones' was properly closed.
[0m14:50:32.741680 [debug] [MainThread]: Connection 'list_de-zoomcamp-413815_dbt_staging' was properly closed.
[0m14:50:32.742319 [info ] [MainThread]: 
[0m14:50:32.743136 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.34 seconds (8.34s).
[0m14:50:32.744593 [debug] [MainThread]: Command end result
[0m14:50:32.765493 [info ] [MainThread]: 
[0m14:50:32.766505 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:50:32.767297 [info ] [MainThread]: 
[0m14:50:32.768031 [error] [MainThread]:   Database Error in model dim_zones (taxi_rides_ny/models/core/dim_zones.sql)
  Unrecognized name: service_name at [17:9]
  compiled Code at target/run/taxi_rides_ny/taxi_rides_ny/models/core/dim_zones.sql
[0m14:50:32.768797 [info ] [MainThread]: 
[0m14:50:32.769738 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:50:32.771569 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 9.117516, "process_user_time": 2.984862, "process_kernel_time": 0.175226, "process_mem_max_rss": "150956", "process_in_blocks": "920", "process_out_blocks": "704", "command_success": false}
[0m14:50:32.772493 [debug] [MainThread]: Command `dbt build` failed at 14:50:32.772338 after 9.12 seconds
[0m14:50:32.773376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff96d9810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7c68790>]}
[0m14:50:32.774238 [debug] [MainThread]: Flushing usage events
[0m14:53:12.737293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f8b0>]}


============================== 14:53:12.749969 | 4598d813-a1b9-47c7-b0c4-d042a7ec326d ==============================
[0m14:53:12.749969 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:53:12.750901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:53:13.135162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4598d813-a1b9-47c7-b0c4-d042a7ec326d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc30e2f0>]}
[0m14:53:13.208194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4598d813-a1b9-47c7-b0c4-d042a7ec326d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95eaad0>]}
[0m14:53:13.209057 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:53:13.222877 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:53:13.290123 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m14:53:13.290830 [debug] [MainThread]: Partial parsing: added file: taxi_rides_ny://taxi_rides_ny/seeds/taxi_zone_lookup.csv
[0m14:53:13.291324 [debug] [MainThread]: Partial parsing: deleted file: taxi_rides_ny://taxi_rides_ny/seeds/taxi-zone-lookup.csv
[0m14:53:13.500149 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.taxi_rides_ny.dim_zones' (taxi_rides_ny/models/core/dim_zones.sql) depends on a node named 'taxi-zone-lookup' which was not found
[0m14:53:13.502725 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 0.8197734, "process_user_time": 2.314065, "process_kernel_time": 0.189087, "process_mem_max_rss": "134936", "process_out_blocks": "648", "command_success": false, "process_in_blocks": "0"}
[0m14:53:13.503680 [debug] [MainThread]: Command `dbt seed` failed at 14:53:13.503432 after 0.82 seconds
[0m14:53:13.504441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7c28670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92d52d0>]}
[0m14:53:13.505090 [debug] [MainThread]: Flushing usage events
[0m14:53:28.112168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00eb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00e8f0>]}


============================== 14:53:28.123870 | ccbd1dd7-1304-4505-9157-9406941b891b ==============================
[0m14:53:28.123870 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:53:28.124833 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:53:28.482068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ccbd1dd7-1304-4505-9157-9406941b891b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc6fc160>]}
[0m14:53:28.553698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ccbd1dd7-1304-4505-9157-9406941b891b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9413b80>]}
[0m14:53:28.554623 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:53:28.568383 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:53:28.630018 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m14:53:28.630708 [debug] [MainThread]: Partial parsing: added file: taxi_rides_ny://taxi_rides_ny/seeds/taxi_zone_lookup.csv
[0m14:53:28.631198 [debug] [MainThread]: Partial parsing: deleted file: taxi_rides_ny://taxi_rides_ny/seeds/taxi-zone-lookup.csv
[0m14:53:28.631654 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://taxi_rides_ny/models/core/dim_zones.sql
[0m14:53:28.853710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ccbd1dd7-1304-4505-9157-9406941b891b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7cd4580>]}
[0m14:53:28.868029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ccbd1dd7-1304-4505-9157-9406941b891b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9255630>]}
[0m14:53:28.868602 [info ] [MainThread]: Found 5 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m14:53:28.869082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccbd1dd7-1304-4505-9157-9406941b891b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9255720>]}
[0m14:53:28.870682 [info ] [MainThread]: 
[0m14:53:28.871677 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:53:28.873336 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m14:53:28.874119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:29.866678 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_dbt_staging)
[0m14:53:29.869240 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_production'
[0m14:53:29.870663 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:29.871850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:30.539070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccbd1dd7-1304-4505-9157-9406941b891b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9247790>]}
[0m14:53:30.545878 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:53:30.549074 [info ] [MainThread]: 
[0m14:53:30.570270 [debug] [Thread-1 (]: Began running node seed.taxi_rides_ny.taxi_zone_lookup
[0m14:53:30.572426 [info ] [Thread-1 (]: 1 of 1 START seed file dbt_staging.taxi_zone_lookup ............................ [RUN]
[0m14:53:30.574750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_production, now seed.taxi_rides_ny.taxi_zone_lookup)
[0m14:53:30.575897 [debug] [Thread-1 (]: Began compiling node seed.taxi_rides_ny.taxi_zone_lookup
[0m14:53:30.577046 [debug] [Thread-1 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (compile): 14:53:30.576577 => 14:53:30.576587
[0m14:53:30.577871 [debug] [Thread-1 (]: Began executing node seed.taxi_rides_ny.taxi_zone_lookup
[0m14:53:30.619000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:33.756808 [debug] [Thread-1 (]: On seed.taxi_rides_ny.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "seed.taxi_rides_ny.taxi_zone_lookup"} */

    alter table `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup` set OPTIONS()
  
[0m14:53:34.100674 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:8254a4c4-dbc3-4c00-a668-6780e48446a3&page=queryresults
[0m14:53:34.354401 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.taxi_rides_ny.taxi_zone_lookup"
[0m14:53:34.384876 [debug] [Thread-1 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (execute): 14:53:30.578452 => 14:53:34.384578
[0m14:53:34.386191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccbd1dd7-1304-4505-9157-9406941b891b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffe358400>]}
[0m14:53:34.387745 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dbt_staging.taxi_zone_lookup ........................ [[32mINSERT 265[0m in 3.81s]
[0m14:53:34.389027 [debug] [Thread-1 (]: Finished running node seed.taxi_rides_ny.taxi_zone_lookup
[0m14:53:34.392334 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:34.392924 [debug] [MainThread]: Connection 'list_de-zoomcamp-413815_dbt_staging' was properly closed.
[0m14:53:34.393443 [debug] [MainThread]: Connection 'seed.taxi_rides_ny.taxi_zone_lookup' was properly closed.
[0m14:53:34.394198 [info ] [MainThread]: 
[0m14:53:34.394860 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 5.52 seconds (5.52s).
[0m14:53:34.395844 [debug] [MainThread]: Command end result
[0m14:53:34.414472 [info ] [MainThread]: 
[0m14:53:34.415199 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:53:34.415762 [info ] [MainThread]: 
[0m14:53:34.416412 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:53:34.418016 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 6.3594956, "process_user_time": 2.930276, "process_kernel_time": 0.177774, "process_mem_max_rss": "153552", "process_in_blocks": "8", "process_out_blocks": "704"}
[0m14:53:34.418952 [debug] [MainThread]: Command `dbt seed` succeeded at 14:53:34.418786 after 6.36 seconds
[0m14:53:34.419458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffe358400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9413b80>]}
[0m14:53:34.419969 [debug] [MainThread]: Flushing usage events
[0m14:54:28.627071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00dd80>]}


============================== 14:54:28.640085 | 6c36225c-41fc-4834-8ff4-7d17be333c3c ==============================
[0m14:54:28.640085 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:54:28.641082 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select dim_zones', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:54:29.029319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c36225c-41fc-4834-8ff4-7d17be333c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff963d930>]}
[0m14:54:29.100638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c36225c-41fc-4834-8ff4-7d17be333c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95eb370>]}
[0m14:54:29.101626 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:54:29.116321 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:54:29.183169 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:54:29.183765 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:54:29.190001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c36225c-41fc-4834-8ff4-7d17be333c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92a0280>]}
[0m14:54:29.204467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c36225c-41fc-4834-8ff4-7d17be333c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff925b580>]}
[0m14:54:29.205070 [info ] [MainThread]: Found 5 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m14:54:29.206618 [info ] [MainThread]: 
[0m14:54:29.207706 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:54:29.210445 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m14:54:29.211280 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:30.037723 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_dbt_staging)
[0m14:54:30.045567 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_production'
[0m14:54:30.049615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:54:30.051437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:30.563247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c36225c-41fc-4834-8ff4-7d17be333c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff925abc0>]}
[0m14:54:30.567675 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:54:30.572952 [info ] [MainThread]: 
[0m14:54:30.590104 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.dim_zones
[0m14:54:30.591083 [info ] [Thread-1 (]: 1 of 1 START sql table model production.dim_zones .............................. [RUN]
[0m14:54:30.592231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_staging, now model.taxi_rides_ny.dim_zones)
[0m14:54:30.592878 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m14:54:30.600714 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m14:54:30.603043 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.dim_zones (compile): 14:54:30.593284 => 14:54:30.602784
[0m14:54:30.603639 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m14:54:30.648666 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_zones"
[0m14:54:30.650797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:30.652827 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */

  
    

    create or replace table `de-zoomcamp-413815`.`production`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      select 
locationid,
borough,
zone,
replace(service_name, 'Boro', 'Green') as service_zone
from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
    );
  
[0m14:54:31.520449 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:faf08df4-ad20-4aae-a2e4-a65ecfb265fc&page=queryresults
[0m14:54:31.740795 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: service_name; Did you mean service_zone? at [17:9]; reason: invalidQuery, location: query, message: Unrecognized name: service_name; Did you mean service_zone? at [17:9]')
[0m14:54:32.572301 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:21d66bc2-fa37-49f0-a53d-ae677b2cf9d1&page=queryresults
[0m14:54:32.821476 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:21d66bc2-fa37-49f0-a53d-ae677b2cf9d1&page=queryresults
[0m14:54:32.840368 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.dim_zones (execute): 14:54:30.604165 => 14:54:32.838922
[0m14:54:32.851866 [debug] [Thread-1 (]: Database Error in model dim_zones (taxi_rides_ny/models/core/dim_zones.sql)
  Unrecognized name: service_name; Did you mean service_zone? at [17:9]
  compiled Code at target/run/taxi_rides_ny/taxi_rides_ny/models/core/dim_zones.sql
[0m14:54:32.854351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c36225c-41fc-4834-8ff4-7d17be333c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9159630>]}
[0m14:54:32.857141 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model production.dim_zones ..................... [[31mERROR[0m in 2.26s]
[0m14:54:32.859396 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m14:54:32.865152 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:32.865977 [debug] [MainThread]: Connection 'model.taxi_rides_ny.dim_zones' was properly closed.
[0m14:54:32.866903 [debug] [MainThread]: Connection 'list_de-zoomcamp-413815_production' was properly closed.
[0m14:54:32.867758 [info ] [MainThread]: 
[0m14:54:32.868855 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.66 seconds (3.66s).
[0m14:54:32.870766 [debug] [MainThread]: Command end result
[0m14:54:32.885395 [info ] [MainThread]: 
[0m14:54:32.886223 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:54:32.886807 [info ] [MainThread]: 
[0m14:54:32.887388 [error] [MainThread]:   Database Error in model dim_zones (taxi_rides_ny/models/core/dim_zones.sql)
  Unrecognized name: service_name; Did you mean service_zone? at [17:9]
  compiled Code at target/run/taxi_rides_ny/taxi_rides_ny/models/core/dim_zones.sql
[0m14:54:32.888090 [info ] [MainThread]: 
[0m14:54:32.888895 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:54:32.890825 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 4.318214, "process_user_time": 2.773868, "process_kernel_time": 0.167197, "process_mem_max_rss": "147124", "process_in_blocks": "8", "process_out_blocks": "704", "command_success": false}
[0m14:54:32.892291 [debug] [MainThread]: Command `dbt build` failed at 14:54:32.891968 after 4.32 seconds
[0m14:54:32.893348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95a6bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95a4eb0>]}
[0m14:54:32.894179 [debug] [MainThread]: Flushing usage events
[0m14:54:49.020782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00dcf0>]}


============================== 14:54:49.032892 | 9c529311-b532-49da-8a84-0d25b9f2a797 ==============================
[0m14:54:49.032892 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:54:49.033907 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --select dim_zones', 'send_anonymous_usage_stats': 'True'}
[0m14:54:49.399490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c529311-b532-49da-8a84-0d25b9f2a797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00e590>]}
[0m14:54:49.471033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c529311-b532-49da-8a84-0d25b9f2a797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95effa0>]}
[0m14:54:49.471929 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:54:49.485773 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:54:49.547576 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:54:49.548337 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://taxi_rides_ny/models/core/dim_zones.sql
[0m14:54:49.698651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c529311-b532-49da-8a84-0d25b9f2a797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91d7d90>]}
[0m14:54:49.712017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c529311-b532-49da-8a84-0d25b9f2a797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff925f130>]}
[0m14:54:49.712629 [info ] [MainThread]: Found 5 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m14:54:49.714130 [info ] [MainThread]: 
[0m14:54:49.715241 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:54:49.716967 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m14:54:49.717561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:51.264704 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_production)
[0m14:54:51.265718 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_dbt_staging'
[0m14:54:51.266374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:54:51.267014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:51.798328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c529311-b532-49da-8a84-0d25b9f2a797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9412b90>]}
[0m14:54:51.802238 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:54:51.803465 [info ] [MainThread]: 
[0m14:54:51.820468 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.dim_zones
[0m14:54:51.822406 [info ] [Thread-1 (]: 1 of 1 START sql table model production.dim_zones .............................. [RUN]
[0m14:54:51.824919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_staging, now model.taxi_rides_ny.dim_zones)
[0m14:54:51.826095 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m14:54:51.836271 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m14:54:51.838307 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.dim_zones (compile): 14:54:51.826778 => 14:54:51.838033
[0m14:54:51.838875 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m14:54:51.879380 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_zones"
[0m14:54:51.881191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:51.883065 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */

  
    

    create or replace table `de-zoomcamp-413815`.`production`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      select 
locationid,
borough,
zone,
replace(service_zone, 'Boro', 'Green') as service_zone
from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
    );
  
[0m14:54:52.559639 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:4dc8b4dd-f200-474f-8938-8f4ef00fb67c&page=queryresults
[0m14:54:54.118288 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.dim_zones (execute): 14:54:51.839250 => 14:54:54.117794
[0m14:54:54.121040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c529311-b532-49da-8a84-0d25b9f2a797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7c8a6b0>]}
[0m14:54:54.122900 [info ] [Thread-1 (]: 1 of 1 OK created sql table model production.dim_zones ......................... [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 2.30s]
[0m14:54:54.124464 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m14:54:54.129398 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:54.130349 [debug] [MainThread]: Connection 'list_de-zoomcamp-413815_production' was properly closed.
[0m14:54:54.131078 [debug] [MainThread]: Connection 'model.taxi_rides_ny.dim_zones' was properly closed.
[0m14:54:54.132091 [info ] [MainThread]: 
[0m14:54:54.132894 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.42 seconds (4.42s).
[0m14:54:54.134403 [debug] [MainThread]: Command end result
[0m14:54:54.153191 [info ] [MainThread]: 
[0m14:54:54.154098 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:54:54.154621 [info ] [MainThread]: 
[0m14:54:54.155256 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:54:54.156939 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 5.190207, "process_user_time": 2.817332, "process_kernel_time": 0.145378, "process_mem_max_rss": "149988", "process_out_blocks": "704", "process_in_blocks": "0"}
[0m14:54:54.157711 [debug] [MainThread]: Command `dbt build` succeeded at 14:54:54.157566 after 5.19 seconds
[0m14:54:54.158327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffe358430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95effa0>]}
[0m14:54:54.158865 [debug] [MainThread]: Flushing usage events
[0m14:57:26.452182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00db10>]}


============================== 14:57:26.465614 | a715a783-76e8-4ce0-90b0-c684dc05c3d2 ==============================
[0m14:57:26.465614 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:57:26.466610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:57:26.869479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a715a783-76e8-4ce0-90b0-c684dc05c3d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff963cc70>]}
[0m14:57:26.943039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a715a783-76e8-4ce0-90b0-c684dc05c3d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9412320>]}
[0m14:57:26.944047 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:57:26.960145 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:57:27.024805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m14:57:27.025615 [debug] [MainThread]: Partial parsing: added file: taxi_rides_ny://taxi_rides_ny/models/core/fact_trips.sql
[0m14:57:27.026146 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://taxi_rides_ny/models/staging/stg_yellow_trip_data.sql
[0m14:57:27.172124 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_yellow_trip_data (taxi_rides_ny/models/staging/stg_yellow_trip_data.sql)
  
  Warning: `dbt_utils.surrogate_key` has been replaced by `dbt_utils.generate_surrogate_key`. The new macro treats null values differently to empty strings. To restore the behaviour of the original macro, add a global variable in dbt_project.yml called `surrogate_key_treat_nulls_as_empty_strings` to your dbt_project.yml file with a value of True. The taxi_rides_ny.stg_yellow_trip_data model triggered this warning. 
  
  > in macro default__surrogate_key (macros/sql/surrogate_key.sql)
  > called by macro surrogate_key (macros/sql/surrogate_key.sql)
  > called by model stg_yellow_trip_data (taxi_rides_ny/models/staging/stg_yellow_trip_data.sql)
[0m14:57:27.174618 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.7770434, "process_user_time": 2.359478, "process_kernel_time": 0.20491, "process_mem_max_rss": "133628", "process_in_blocks": "24", "process_out_blocks": "648", "command_success": false}
[0m14:57:27.175414 [debug] [MainThread]: Command `dbt build` failed at 14:57:27.175230 after 0.78 seconds
[0m14:57:27.176081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91bb010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91bb0a0>]}
[0m14:57:27.176556 [debug] [MainThread]: Flushing usage events
[0m14:57:56.096529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00fb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00dba0>]}


============================== 14:57:56.112155 | 43fa67d1-caa5-48a4-b92d-b432da146ee8 ==============================
[0m14:57:56.112155 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:57:56.113544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:57:56.477693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43fa67d1-caa5-48a4-b92d-b432da146ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00e4d0>]}
[0m14:57:56.549337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43fa67d1-caa5-48a4-b92d-b432da146ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9411480>]}
[0m14:57:56.550160 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:57:56.564016 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:57:56.627065 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m14:57:56.627810 [debug] [MainThread]: Partial parsing: added file: taxi_rides_ny://taxi_rides_ny/models/core/fact_trips.sql
[0m14:57:56.628332 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://taxi_rides_ny/models/staging/stg_yellow_trip_data.sql
[0m14:57:56.788480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43fa67d1-caa5-48a4-b92d-b432da146ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91e9630>]}
[0m14:57:56.804843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43fa67d1-caa5-48a4-b92d-b432da146ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91aa170>]}
[0m14:57:56.805522 [info ] [MainThread]: Found 6 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m14:57:56.807694 [info ] [MainThread]: 
[0m14:57:56.809071 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:57:56.811453 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m14:57:56.812211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:56.812874 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m14:57:56.813702 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m14:57:56.814294 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:56.845495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:58.005513 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now create_de-zoomcamp-413815_dbt_abhishek_yadav)
[0m14:57:58.012524 [debug] [ThreadPool]: Creating schema "database: "de-zoomcamp-413815"
schema: "dbt_abhishek_yadav"
"
[0m14:57:58.034411 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:58.038164 [debug] [ThreadPool]: On create_de-zoomcamp-413815_dbt_abhishek_yadav: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "connection_name": "create_de-zoomcamp-413815_dbt_abhishek_yadav"} */
create schema if not exists `de-zoomcamp-413815`.`dbt_abhishek_yadav`
  
[0m14:57:58.767060 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:eacb1256-0f12-4bc4-9f6c-11aa8af26ff3&page=queryresults
[0m14:58:05.244088 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_production'
[0m14:58:05.246784 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_dbt_staging)
[0m14:58:05.249149 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_de-zoomcamp-413815_dbt_abhishek_yadav, now list_de-zoomcamp-413815_dbt_abhishek_yadav)
[0m14:58:05.250239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:05.251483 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:05.252585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:05.727879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43fa67d1-caa5-48a4-b92d-b432da146ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7c7fd30>]}
[0m14:58:05.729446 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:58:05.730384 [info ] [MainThread]: 
[0m14:58:05.739752 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.my_first_dbt_model
[0m14:58:05.740247 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m14:58:05.740696 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
[0m14:58:05.741237 [debug] [Thread-4 (]: Began running node seed.taxi_rides_ny.taxi_zone_lookup
[0m14:58:05.741881 [info ] [Thread-1 (]: 1 of 6 START sql table model dbt_staging.my_first_dbt_model .................... [RUN]
[0m14:58:05.742919 [info ] [Thread-2 (]: 2 of 6 START sql view model dbt_staging.stg_green_trip_data .................... [RUN]
[0m14:58:05.744001 [info ] [Thread-3 (]: 3 of 6 START sql view model dbt_abhishek_yadav.stg_yellow_trip_data ............ [RUN]
[0m14:58:05.744972 [info ] [Thread-4 (]: 4 of 6 START seed file dbt_staging.taxi_zone_lookup ............................ [RUN]
[0m14:58:05.746223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_abhishek_yadav, now model.taxi_rides_ny.my_first_dbt_model)
[0m14:58:05.747249 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_production, now model.taxi_rides_ny.stg_green_trip_data)
[0m14:58:05.748120 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_staging, now model.taxi_rides_ny.stg_yellow_trip_data)
[0m14:58:05.749034 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now seed.taxi_rides_ny.taxi_zone_lookup)
[0m14:58:05.749676 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
[0m14:58:05.750312 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m14:58:05.750962 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
[0m14:58:05.751455 [debug] [Thread-4 (]: Began compiling node seed.taxi_rides_ny.taxi_zone_lookup
[0m14:58:05.770010 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
[0m14:58:05.775580 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m14:58:05.781530 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (compile): 14:58:05.776144 => 14:58:05.781251
[0m14:58:05.782038 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (compile): 14:58:05.781785 => 14:58:05.781791
[0m14:58:05.786120 [debug] [Thread-4 (]: Began executing node seed.taxi_rides_ny.taxi_zone_lookup
[0m14:58:05.787243 [debug] [Thread-3 (]: Compilation Error in model stg_yellow_trip_data (taxi_rides_ny/models/staging/stg_yellow_trip_data.sql)
  'get_payment_type_description' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:58:05.787826 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (compile): 14:58:05.751872 => 14:58:05.787614
[0m14:58:05.788236 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 14:58:05.770657 => 14:58:05.788001
[0m14:58:05.802251 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43fa67d1-caa5-48a4-b92d-b432da146ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7b291e0>]}
[0m14:58:05.803614 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.my_first_dbt_model
[0m14:58:05.807907 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m14:58:05.814154 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:58:05.815100 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model dbt_abhishek_yadav.stg_yellow_trip_data ... [[31mERROR[0m in 0.05s]
[0m14:58:05.826031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:05.844802 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_trip_data"
[0m14:58:05.846582 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
[0m14:58:05.902223 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:58:05.904052 [debug] [Thread-2 (]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
  OPTIONS()
  as select
-- identifiers

    
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
cast(trip_type as integer) as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(ehail_fee as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), lpep_pickup_datetime)=1
-- dbt-bq compile --select stg_green_trip_data --vars '{'is_test_run': 'false'}'

limit 100
;


[0m14:58:06.367629 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.my_first_dbt_model"
[0m14:58:06.370518 [debug] [Thread-1 (]: On model.taxi_rides_ny.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_first_dbt_model"} */

  
    

    create or replace table `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:58:06.603059 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:869e5e9e-9de7-4822-b5bb-36d15f4b5fd5&page=queryresults
[0m14:58:06.687637 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:dad63ecc-f9b4-4bac-9344-d30ab7baaf5a&page=queryresults
[0m14:58:06.938491 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 14:58:05.826525 => 14:58:06.938058
[0m14:58:06.940647 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43fa67d1-caa5-48a4-b92d-b432da146ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7b70250>]}
[0m14:58:06.942152 [info ] [Thread-2 (]: 2 of 6 OK created sql view model dbt_staging.stg_green_trip_data ............... [[32mCREATE VIEW (0 processed)[0m in 1.19s]
[0m14:58:06.943947 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m14:58:08.109581 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (execute): 14:58:05.815617 => 14:58:08.108933
[0m14:58:08.115726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43fa67d1-caa5-48a4-b92d-b432da146ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7c7faf0>]}
[0m14:58:08.117205 [info ] [Thread-1 (]: 1 of 6 OK created sql table model dbt_staging.my_first_dbt_model ............... [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.37s]
[0m14:58:08.118515 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.my_first_dbt_model
[0m14:58:08.119805 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.my_second_dbt_model
[0m14:58:08.120808 [info ] [Thread-3 (]: 5 of 6 START sql view model dbt_staging.my_second_dbt_model .................... [RUN]
[0m14:58:08.122002 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_yellow_trip_data, now model.taxi_rides_ny.my_second_dbt_model)
[0m14:58:08.122751 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
[0m14:58:08.126968 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
[0m14:58:08.130104 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (compile): 14:58:08.123262 => 14:58:08.129739
[0m14:58:08.130722 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.my_second_dbt_model
[0m14:58:08.134964 [debug] [Thread-3 (]: Writing runtime sql for node "model.taxi_rides_ny.my_second_dbt_model"
[0m14:58:08.137294 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:58:08.139943 [debug] [Thread-3 (]: On model.taxi_rides_ny.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_second_dbt_model"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
where id = 1;


[0m14:58:08.803825 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:60a1ba77-dcf7-4704-b67b-fd5ebda98720&page=queryresults
[0m14:58:09.057536 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (execute): 14:58:08.131105 => 14:58:09.057297
[0m14:58:09.058783 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43fa67d1-caa5-48a4-b92d-b432da146ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7b29840>]}
[0m14:58:09.059626 [info ] [Thread-3 (]: 5 of 6 OK created sql view model dbt_staging.my_second_dbt_model ............... [[32mCREATE VIEW (0 processed)[0m in 0.94s]
[0m14:58:09.060719 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.my_second_dbt_model
[0m14:58:09.166872 [debug] [Thread-4 (]: On seed.taxi_rides_ny.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "seed.taxi_rides_ny.taxi_zone_lookup"} */

    alter table `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup` set OPTIONS()
  
[0m14:58:09.472894 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:967888ed-d383-48fc-ac36-ad6510c2403e&page=queryresults
[0m14:58:09.687844 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.taxi_rides_ny.taxi_zone_lookup"
[0m14:58:09.697770 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (execute): 14:58:05.788429 => 14:58:09.697310
[0m14:58:09.699807 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43fa67d1-caa5-48a4-b92d-b432da146ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7b5bac0>]}
[0m14:58:09.701230 [info ] [Thread-4 (]: 4 of 6 OK loaded seed file dbt_staging.taxi_zone_lookup ........................ [[32mINSERT 265[0m in 3.95s]
[0m14:58:09.702983 [debug] [Thread-4 (]: Finished running node seed.taxi_rides_ny.taxi_zone_lookup
[0m14:58:09.706238 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.dim_zones
[0m14:58:09.707395 [info ] [Thread-1 (]: 6 of 6 START sql table model production.dim_zones .............................. [RUN]
[0m14:58:09.709825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.my_first_dbt_model, now model.taxi_rides_ny.dim_zones)
[0m14:58:09.711400 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m14:58:09.765770 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m14:58:09.768801 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.dim_zones (compile): 14:58:09.712332 => 14:58:09.768484
[0m14:58:09.769282 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m14:58:09.771850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:10.210748 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_zones"
[0m14:58:10.221221 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */

  
    

    create or replace table `de-zoomcamp-413815`.`production`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      select 
locationid,
borough,
zone,
replace(service_zone, 'Boro', 'Green') as service_zone
from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
    );
  
[0m14:58:10.539308 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:8dcb80d0-25ee-4ac8-bc42-5b82cd85774a&page=queryresults
[0m14:58:12.056089 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.dim_zones (execute): 14:58:09.769689 => 14:58:12.054710
[0m14:58:12.063218 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43fa67d1-caa5-48a4-b92d-b432da146ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff424b6a0>]}
[0m14:58:12.065682 [info ] [Thread-1 (]: 6 of 6 OK created sql table model production.dim_zones ......................... [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 2.35s]
[0m14:58:12.067348 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m14:58:12.071411 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:58:12.072464 [debug] [MainThread]: Connection 'model.taxi_rides_ny.dim_zones' was properly closed.
[0m14:58:12.073386 [debug] [MainThread]: Connection 'seed.taxi_rides_ny.taxi_zone_lookup' was properly closed.
[0m14:58:12.074538 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_second_dbt_model' was properly closed.
[0m14:58:12.075922 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_green_trip_data' was properly closed.
[0m14:58:12.077785 [info ] [MainThread]: 
[0m14:58:12.079266 [info ] [MainThread]: Finished running 3 view models, 2 table models, 1 seed in 0 hours 0 minutes and 15.27 seconds (15.27s).
[0m14:58:12.082466 [debug] [MainThread]: Command end result
[0m14:58:12.100694 [info ] [MainThread]: 
[0m14:58:12.101732 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:58:12.102627 [info ] [MainThread]: 
[0m14:58:12.103457 [error] [MainThread]:   Compilation Error in model stg_yellow_trip_data (taxi_rides_ny/models/staging/stg_yellow_trip_data.sql)
  'get_payment_type_description' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:58:12.104260 [info ] [MainThread]: 
[0m14:58:12.105213 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m14:58:12.107312 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 16.070438, "process_user_time": 3.843964, "process_kernel_time": 0.269238, "process_mem_max_rss": "161796", "process_in_blocks": "184", "process_out_blocks": "704", "command_success": false}
[0m14:58:12.108552 [debug] [MainThread]: Command `dbt build` failed at 14:58:12.108326 after 16.07 seconds
[0m14:58:12.109565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff424b6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92d90f0>]}
[0m14:58:12.110554 [debug] [MainThread]: Flushing usage events
[0m14:58:38.849569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00db10>]}


============================== 14:58:38.862541 | bde78f03-5b91-4d36-8163-55f657656100 ==============================
[0m14:58:38.862541 [info ] [MainThread]: Running with dbt=1.7.7
[0m14:58:38.863634 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:58:39.220368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bde78f03-5b91-4d36-8163-55f657656100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00dd80>]}
[0m14:58:39.298033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bde78f03-5b91-4d36-8163-55f657656100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95ee0e0>]}
[0m14:58:39.299014 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m14:58:39.313493 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m14:58:39.379255 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:58:39.380002 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://taxi_rides_ny/models/staging/stg_yellow_trip_data.sql
[0m14:58:39.514348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bde78f03-5b91-4d36-8163-55f657656100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91e5750>]}
[0m14:58:39.527941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bde78f03-5b91-4d36-8163-55f657656100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91b3d90>]}
[0m14:58:39.528516 [info ] [MainThread]: Found 6 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m14:58:39.530395 [info ] [MainThread]: 
[0m14:58:39.531400 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:58:39.534201 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m14:58:39.535045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:39.535708 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m14:58:39.536519 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m14:58:39.537134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:39.565718 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:40.634124 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_production'
[0m14:58:40.636156 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_dbt_abhishek_yadav'
[0m14:58:40.637704 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_dbt_staging)
[0m14:58:40.638754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:40.639696 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:40.640617 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:41.114102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bde78f03-5b91-4d36-8163-55f657656100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff924b970>]}
[0m14:58:41.116242 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:58:41.117310 [info ] [MainThread]: 
[0m14:58:41.128141 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.my_first_dbt_model
[0m14:58:41.128800 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m14:58:41.129296 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
[0m14:58:41.129913 [debug] [Thread-4 (]: Began running node seed.taxi_rides_ny.taxi_zone_lookup
[0m14:58:41.130645 [info ] [Thread-1 (]: 1 of 6 START sql table model dbt_staging.my_first_dbt_model .................... [RUN]
[0m14:58:41.131956 [info ] [Thread-2 (]: 2 of 6 START sql view model dbt_staging.stg_green_trip_data .................... [RUN]
[0m14:58:41.133113 [info ] [Thread-3 (]: 3 of 6 START sql view model dbt_abhishek_yadav.stg_yellow_trip_data ............ [RUN]
[0m14:58:41.134152 [info ] [Thread-4 (]: 4 of 6 START seed file dbt_staging.taxi_zone_lookup ............................ [RUN]
[0m14:58:41.135435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_production, now model.taxi_rides_ny.my_first_dbt_model)
[0m14:58:41.136568 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_staging, now model.taxi_rides_ny.stg_green_trip_data)
[0m14:58:41.137652 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_abhishek_yadav, now model.taxi_rides_ny.stg_yellow_trip_data)
[0m14:58:41.138890 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now seed.taxi_rides_ny.taxi_zone_lookup)
[0m14:58:41.139836 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
[0m14:58:41.140642 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m14:58:41.141333 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
[0m14:58:41.141997 [debug] [Thread-4 (]: Began compiling node seed.taxi_rides_ny.taxi_zone_lookup
[0m14:58:41.152983 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
[0m14:58:41.174472 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m14:58:41.176626 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m14:58:41.177427 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (compile): 14:58:41.177146 => 14:58:41.177150
[0m14:58:41.179469 [debug] [Thread-4 (]: Began executing node seed.taxi_rides_ny.taxi_zone_lookup
[0m14:58:41.180186 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (compile): 14:58:41.142509 => 14:58:41.179949
[0m14:58:41.180630 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (compile): 14:58:41.168009 => 14:58:41.180382
[0m14:58:41.186250 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 14:58:41.153669 => 14:58:41.185981
[0m14:58:41.195238 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.my_first_dbt_model
[0m14:58:41.196824 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
[0m14:58:41.206709 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:58:41.207032 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m14:58:41.215996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:41.237801 [debug] [Thread-3 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m14:58:41.241871 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_trip_data"
[0m14:58:41.298631 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:58:41.299579 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:58:41.301317 [debug] [Thread-3 (]: On model.taxi_rides_ny.stg_yellow_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
  OPTIONS()
  as -- 

select
-- identifiers

    
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
1 as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(0 as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`yello_trip_data`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), tpep_pickup_datetime)=1
-- dbt-bq run --select stg_green_tripdata  --var 'is_test_run: false'

limit 100
;


[0m14:58:41.329180 [debug] [Thread-2 (]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
  OPTIONS()
  as select
-- identifiers

    
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
cast(trip_type as integer) as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(ehail_fee as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), lpep_pickup_datetime)=1
-- dbt-bq compile --select stg_green_trip_data --vars '{'is_test_run': 'false'}'

limit 100
;


[0m14:58:41.771957 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.my_first_dbt_model"
[0m14:58:41.775026 [debug] [Thread-1 (]: On model.taxi_rides_ny.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_first_dbt_model"} */

  
    

    create or replace table `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:58:41.907009 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:286d03d4-7f79-466c-89a2-f5bba50821fa&page=queryresults
[0m14:58:41.978655 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:363bf6dc-274c-44ff-8f9a-da5c72d43838&page=queryresults
[0m14:58:42.033644 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:5c230803-8740-4ee7-aca4-f95b753e115f&page=queryresults
[0m14:58:42.149051 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 14:58:41.239236 => 14:58:42.148581
[0m14:58:42.151223 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bde78f03-5b91-4d36-8163-55f657656100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff944a710>]}
[0m14:58:42.153740 [info ] [Thread-2 (]: 2 of 6 OK created sql view model dbt_staging.stg_green_trip_data ............... [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m14:58:42.156069 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m14:58:42.162922 [debug] [Thread-3 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Invalid cast from INT64 to TIMESTAMP at [19:6]; reason: invalidQuery, location: query, message: Invalid cast from INT64 to TIMESTAMP at [19:6]')
[0m14:58:43.171641 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:668fa128-a816-456a-81a3-a1d397717514&page=queryresults
[0m14:58:43.361413 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:668fa128-a816-456a-81a3-a1d397717514&page=queryresults
[0m14:58:43.369671 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (execute): 14:58:41.216400 => 14:58:43.368386
[0m14:58:43.383663 [debug] [Thread-3 (]: Database Error in model stg_yellow_trip_data (taxi_rides_ny/models/staging/stg_yellow_trip_data.sql)
  Invalid cast from INT64 to TIMESTAMP at [19:6]
  compiled Code at target/run/taxi_rides_ny/taxi_rides_ny/models/staging/stg_yellow_trip_data.sql
[0m14:58:43.385599 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bde78f03-5b91-4d36-8163-55f657656100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff90fd240>]}
[0m14:58:43.387494 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model dbt_abhishek_yadav.stg_yellow_trip_data ... [[31mERROR[0m in 2.25s]
[0m14:58:43.389649 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
[0m14:58:43.755249 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (execute): 14:58:41.207455 => 14:58:43.753078
[0m14:58:43.759031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bde78f03-5b91-4d36-8163-55f657656100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8f166e0>]}
[0m14:58:43.761148 [info ] [Thread-1 (]: 1 of 6 OK created sql table model dbt_staging.my_first_dbt_model ............... [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.62s]
[0m14:58:43.763669 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.my_first_dbt_model
[0m14:58:43.766012 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.my_second_dbt_model
[0m14:58:43.767671 [info ] [Thread-2 (]: 5 of 6 START sql view model dbt_staging.my_second_dbt_model .................... [RUN]
[0m14:58:43.770010 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_green_trip_data, now model.taxi_rides_ny.my_second_dbt_model)
[0m14:58:43.771200 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
[0m14:58:43.779950 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
[0m14:58:43.784116 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (compile): 14:58:43.772034 => 14:58:43.783377
[0m14:58:43.785100 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.my_second_dbt_model
[0m14:58:43.792026 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.my_second_dbt_model"
[0m14:58:43.794662 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:58:43.798595 [debug] [Thread-2 (]: On model.taxi_rides_ny.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_second_dbt_model"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
where id = 1;


[0m14:58:44.361319 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:863c2513-1c0a-4f75-9262-89d9ad513c31&page=queryresults
[0m14:58:44.596344 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (execute): 14:58:43.785839 => 14:58:44.595152
[0m14:58:44.600955 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bde78f03-5b91-4d36-8163-55f657656100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff90fd7e0>]}
[0m14:58:44.603506 [info ] [Thread-2 (]: 5 of 6 OK created sql view model dbt_staging.my_second_dbt_model ............... [[32mCREATE VIEW (0 processed)[0m in 0.83s]
[0m14:58:44.605995 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.my_second_dbt_model
[0m14:58:44.719557 [debug] [Thread-4 (]: On seed.taxi_rides_ny.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "seed.taxi_rides_ny.taxi_zone_lookup"} */

    alter table `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup` set OPTIONS()
  
[0m14:58:44.983438 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:2d2df517-56e6-4c8e-bc37-5af18159bc04&page=queryresults
[0m14:58:45.217335 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.taxi_rides_ny.taxi_zone_lookup"
[0m14:58:45.225840 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (execute): 14:58:41.180880 => 14:58:45.225390
[0m14:58:45.227881 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bde78f03-5b91-4d36-8163-55f657656100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff90d9ea0>]}
[0m14:58:45.229330 [info ] [Thread-4 (]: 4 of 6 OK loaded seed file dbt_staging.taxi_zone_lookup ........................ [[32mINSERT 265[0m in 4.09s]
[0m14:58:45.231453 [debug] [Thread-4 (]: Finished running node seed.taxi_rides_ny.taxi_zone_lookup
[0m14:58:45.235204 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.dim_zones
[0m14:58:45.236534 [info ] [Thread-1 (]: 6 of 6 START sql table model production.dim_zones .............................. [RUN]
[0m14:58:45.238438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.my_first_dbt_model, now model.taxi_rides_ny.dim_zones)
[0m14:58:45.239365 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m14:58:45.293331 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m14:58:45.295189 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.dim_zones (compile): 14:58:45.239971 => 14:58:45.294951
[0m14:58:45.295660 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m14:58:45.297914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:45.798975 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_zones"
[0m14:58:45.804404 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */

  
    

    create or replace table `de-zoomcamp-413815`.`production`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      select 
locationid,
borough,
zone,
replace(service_zone, 'Boro', 'Green') as service_zone
from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
    );
  
[0m14:58:46.103888 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:9a7622a0-0cbc-4bd8-9a8a-57206354ec3f&page=queryresults
[0m14:58:47.557320 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.dim_zones (execute): 14:58:45.295996 => 14:58:47.556209
[0m14:58:47.562906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bde78f03-5b91-4d36-8163-55f657656100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8530d60>]}
[0m14:58:47.566099 [info ] [Thread-1 (]: 6 of 6 OK created sql table model production.dim_zones ......................... [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 2.32s]
[0m14:58:47.568727 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m14:58:47.573679 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:58:47.574988 [debug] [MainThread]: Connection 'list_de-zoomcamp-413815' was properly closed.
[0m14:58:47.576301 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_second_dbt_model' was properly closed.
[0m14:58:47.577628 [debug] [MainThread]: Connection 'seed.taxi_rides_ny.taxi_zone_lookup' was properly closed.
[0m14:58:47.578761 [debug] [MainThread]: Connection 'model.taxi_rides_ny.dim_zones' was properly closed.
[0m14:58:47.579669 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_yellow_trip_data' was properly closed.
[0m14:58:47.581054 [info ] [MainThread]: 
[0m14:58:47.582274 [info ] [MainThread]: Finished running 3 view models, 2 table models, 1 seed in 0 hours 0 minutes and 8.05 seconds (8.05s).
[0m14:58:47.585540 [debug] [MainThread]: Command end result
[0m14:58:47.603157 [info ] [MainThread]: 
[0m14:58:47.604131 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:58:47.604895 [info ] [MainThread]: 
[0m14:58:47.605683 [error] [MainThread]:   Database Error in model stg_yellow_trip_data (taxi_rides_ny/models/staging/stg_yellow_trip_data.sql)
  Invalid cast from INT64 to TIMESTAMP at [19:6]
  compiled Code at target/run/taxi_rides_ny/taxi_rides_ny/models/staging/stg_yellow_trip_data.sql
[0m14:58:47.606469 [info ] [MainThread]: 
[0m14:58:47.607343 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m14:58:47.609622 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 8.814418, "process_user_time": 3.838476, "process_kernel_time": 0.208437, "process_mem_max_rss": "161216", "process_in_blocks": "32", "process_out_blocks": "704", "command_success": false}
[0m14:58:47.610909 [debug] [MainThread]: Command `dbt build` failed at 14:58:47.610604 after 8.82 seconds
[0m14:58:47.611839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91b3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9192380>]}
[0m14:58:47.612647 [debug] [MainThread]: Flushing usage events
[0m15:09:40.824231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00db10>]}


============================== 15:09:40.837631 | 70463f98-4b69-411c-87be-6adbf3488b0f ==============================
[0m15:09:40.837631 [info ] [MainThread]: Running with dbt=1.7.7
[0m15:09:40.838740 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m15:09:41.231513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70463f98-4b69-411c-87be-6adbf3488b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff963ab00>]}
[0m15:09:41.302825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70463f98-4b69-411c-87be-6adbf3488b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff940dff0>]}
[0m15:09:41.303736 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m15:09:41.318897 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m15:09:41.387782 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:09:41.388531 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://taxi_rides_ny/models/staging/stg_yellow_trip_data.sql
[0m15:09:41.527965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70463f98-4b69-411c-87be-6adbf3488b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91e1300>]}
[0m15:09:41.544577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70463f98-4b69-411c-87be-6adbf3488b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff917d780>]}
[0m15:09:41.545181 [info ] [MainThread]: Found 6 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m15:09:41.547084 [info ] [MainThread]: 
[0m15:09:41.548158 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:09:41.551304 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m15:09:41.552016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:41.552644 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m15:09:41.553454 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m15:09:41.554074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:41.582557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:42.920565 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_production'
[0m15:09:42.923409 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_dbt_abhishek_yadav)
[0m15:09:42.926800 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_dbt_staging)
[0m15:09:42.929287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:42.932062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:42.934315 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:43.456256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70463f98-4b69-411c-87be-6adbf3488b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95a5f30>]}
[0m15:09:43.459958 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:09:43.462059 [info ] [MainThread]: 
[0m15:09:43.481364 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.my_first_dbt_model
[0m15:09:43.482365 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m15:09:43.483120 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
[0m15:09:43.483907 [debug] [Thread-4 (]: Began running node seed.taxi_rides_ny.taxi_zone_lookup
[0m15:09:43.484781 [info ] [Thread-1 (]: 1 of 6 START sql table model dbt_staging.my_first_dbt_model .................... [RUN]
[0m15:09:43.486525 [info ] [Thread-2 (]: 2 of 6 START sql view model dbt_staging.stg_green_trip_data .................... [RUN]
[0m15:09:43.488149 [info ] [Thread-3 (]: 3 of 6 START sql view model dbt_abhishek_yadav.stg_yellow_trip_data ............ [RUN]
[0m15:09:43.489465 [info ] [Thread-4 (]: 4 of 6 START seed file dbt_staging.taxi_zone_lookup ............................ [RUN]
[0m15:09:43.490665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_staging, now model.taxi_rides_ny.my_first_dbt_model)
[0m15:09:43.491743 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_abhishek_yadav, now model.taxi_rides_ny.stg_green_trip_data)
[0m15:09:43.493112 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_production, now model.taxi_rides_ny.stg_yellow_trip_data)
[0m15:09:43.494342 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now seed.taxi_rides_ny.taxi_zone_lookup)
[0m15:09:43.495139 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
[0m15:09:43.495840 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m15:09:43.496540 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
[0m15:09:43.497214 [debug] [Thread-4 (]: Began compiling node seed.taxi_rides_ny.taxi_zone_lookup
[0m15:09:43.507558 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
[0m15:09:43.528951 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m15:09:43.530828 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m15:09:43.531346 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (compile): 15:09:43.531081 => 15:09:43.531086
[0m15:09:43.534234 [debug] [Thread-4 (]: Began executing node seed.taxi_rides_ny.taxi_zone_lookup
[0m15:09:43.535229 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (compile): 15:09:43.497740 => 15:09:43.534952
[0m15:09:43.546698 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (compile): 15:09:43.513199 => 15:09:43.546383
[0m15:09:43.547166 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 15:09:43.508208 => 15:09:43.546915
[0m15:09:43.549589 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.my_first_dbt_model
[0m15:09:43.551003 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
[0m15:09:43.561219 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m15:09:43.561524 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:09:43.570630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:43.595332 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_trip_data"
[0m15:09:43.595933 [debug] [Thread-3 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m15:09:43.653075 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:09:43.653527 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:09:43.655378 [debug] [Thread-2 (]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
  OPTIONS()
  as select
-- identifiers

    
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
cast(trip_type as integer) as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(ehail_fee as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), lpep_pickup_datetime)=1
-- dbt-bq compile --select stg_green_trip_data --vars '{'is_test_run': 'false'}'

limit 100
;


[0m15:09:43.683485 [debug] [Thread-3 (]: On model.taxi_rides_ny.stg_yellow_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
  OPTIONS()
  as -- 

select
-- identifiers

    
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
TIMESTAMP_SECONDS(CAST(CAST(tpep_pickup_datetime as INT64)/10000000 AS INT64)) as pickup_datetime,
TIMESTAMP_SECONDS(CAST(CAST(tpep_dropoff_datetime as INT64)/10000000 AS INT64)) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
1 as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(0 as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`yello_trip_data`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), tpep_pickup_datetime)=1
-- dbt-bq run --select stg_green_tripdata  --var 'is_test_run: false'

limit 100
;


[0m15:09:44.213743 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.my_first_dbt_model"
[0m15:09:44.217672 [debug] [Thread-1 (]: On model.taxi_rides_ny.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_first_dbt_model"} */

  
    

    create or replace table `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m15:09:44.390147 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:bdca3db0-0a2c-4e8f-9af1-dc1931e4c5d8&page=queryresults
[0m15:09:44.812524 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 15:09:43.589388 => 15:09:44.812083
[0m15:09:44.814727 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70463f98-4b69-411c-87be-6adbf3488b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff90c06d0>]}
[0m15:09:44.816921 [info ] [Thread-2 (]: 2 of 6 OK created sql view model dbt_staging.stg_green_trip_data ............... [[32mCREATE VIEW (0 processed)[0m in 1.32s]
[0m15:09:44.818774 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:4af3c3dc-2865-4458-a906-075a823f1cbe&page=queryresults
[0m15:09:44.819798 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m15:09:44.825452 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:f5d5e598-4106-4e00-9106-a834fd9e378e&page=queryresults
[0m15:09:45.123961 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (execute): 15:09:43.571040 => 15:09:45.122570
[0m15:09:45.127564 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70463f98-4b69-411c-87be-6adbf3488b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8f566b0>]}
[0m15:09:45.132891 [info ] [Thread-3 (]: 3 of 6 OK created sql view model dbt_abhishek_yadav.stg_yellow_trip_data ....... [[32mCREATE VIEW (0 processed)[0m in 1.63s]
[0m15:09:45.136522 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
[0m15:09:46.009432 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (execute): 15:09:43.561940 => 15:09:46.008484
[0m15:09:46.013334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70463f98-4b69-411c-87be-6adbf3488b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8f38a90>]}
[0m15:09:46.016430 [info ] [Thread-1 (]: 1 of 6 OK created sql table model dbt_staging.my_first_dbt_model ............... [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.52s]
[0m15:09:46.018447 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.my_first_dbt_model
[0m15:09:46.019511 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.my_second_dbt_model
[0m15:09:46.020278 [info ] [Thread-2 (]: 5 of 6 START sql view model dbt_staging.my_second_dbt_model .................... [RUN]
[0m15:09:46.022821 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_green_trip_data, now model.taxi_rides_ny.my_second_dbt_model)
[0m15:09:46.024347 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
[0m15:09:46.029736 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
[0m15:09:46.034113 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (compile): 15:09:46.025373 => 15:09:46.033624
[0m15:09:46.034780 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.my_second_dbt_model
[0m15:09:46.040368 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.my_second_dbt_model"
[0m15:09:46.043316 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:09:46.046204 [debug] [Thread-2 (]: On model.taxi_rides_ny.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_second_dbt_model"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
where id = 1;


[0m15:09:46.882263 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:8407692a-07db-4cc1-8203-70c240abca95&page=queryresults
[0m15:09:47.161654 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (execute): 15:09:46.035266 => 15:09:47.159759
[0m15:09:47.167407 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70463f98-4b69-411c-87be-6adbf3488b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff90fd690>]}
[0m15:09:47.170359 [info ] [Thread-2 (]: 5 of 6 OK created sql view model dbt_staging.my_second_dbt_model ............... [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m15:09:47.172909 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.my_second_dbt_model
[0m15:09:48.542571 [debug] [Thread-4 (]: On seed.taxi_rides_ny.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "seed.taxi_rides_ny.taxi_zone_lookup"} */

    alter table `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup` set OPTIONS()
  
[0m15:09:49.022220 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:679fc0e9-c1e3-4c89-951f-0df9d569aa59&page=queryresults
[0m15:09:49.324236 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.taxi_rides_ny.taxi_zone_lookup"
[0m15:09:49.334689 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (execute): 15:09:43.535458 => 15:09:49.334197
[0m15:09:49.336863 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70463f98-4b69-411c-87be-6adbf3488b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff90ad210>]}
[0m15:09:49.338420 [info ] [Thread-4 (]: 4 of 6 OK loaded seed file dbt_staging.taxi_zone_lookup ........................ [[32mINSERT 265[0m in 5.84s]
[0m15:09:49.340212 [debug] [Thread-4 (]: Finished running node seed.taxi_rides_ny.taxi_zone_lookup
[0m15:09:49.344581 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.dim_zones
[0m15:09:49.346209 [info ] [Thread-1 (]: 6 of 6 START sql table model production.dim_zones .............................. [RUN]
[0m15:09:49.348338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.my_first_dbt_model, now model.taxi_rides_ny.dim_zones)
[0m15:09:49.349633 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m15:09:49.362403 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m15:09:49.365204 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.dim_zones (compile): 15:09:49.350328 => 15:09:49.364845
[0m15:09:49.365881 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m15:09:49.407349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:49.917448 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_zones"
[0m15:09:49.928082 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */

  
    

    create or replace table `de-zoomcamp-413815`.`production`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      select 
locationid,
borough,
zone,
replace(service_zone, 'Boro', 'Green') as service_zone
from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
    );
  
[0m15:09:50.359787 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:fc213e14-531d-4f90-bc76-39094ce4c95d&page=queryresults
[0m15:09:51.811752 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.dim_zones (execute): 15:09:49.366369 => 15:09:51.810814
[0m15:09:51.816828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70463f98-4b69-411c-87be-6adbf3488b0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8637880>]}
[0m15:09:51.820107 [info ] [Thread-1 (]: 6 of 6 OK created sql table model production.dim_zones ......................... [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 2.47s]
[0m15:09:51.822544 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m15:09:51.827984 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:51.829698 [debug] [MainThread]: Connection 'seed.taxi_rides_ny.taxi_zone_lookup' was properly closed.
[0m15:09:51.831019 [debug] [MainThread]: Connection 'model.taxi_rides_ny.dim_zones' was properly closed.
[0m15:09:51.832030 [debug] [MainThread]: Connection 'model.taxi_rides_ny.my_second_dbt_model' was properly closed.
[0m15:09:51.832955 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_yellow_trip_data' was properly closed.
[0m15:09:51.834588 [info ] [MainThread]: 
[0m15:09:51.836141 [info ] [MainThread]: Finished running 3 view models, 2 table models, 1 seed in 0 hours 0 minutes and 10.29 seconds (10.29s).
[0m15:09:51.839790 [debug] [MainThread]: Command end result
[0m15:09:51.855970 [info ] [MainThread]: 
[0m15:09:51.856885 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:09:51.857686 [info ] [MainThread]: 
[0m15:09:51.858708 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m15:09:51.860958 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 11.09643, "process_user_time": 3.832694, "process_kernel_time": 0.353647, "process_mem_max_rss": "158684", "process_in_blocks": "1344", "process_out_blocks": "704"}
[0m15:09:51.861951 [debug] [MainThread]: Command `dbt build` succeeded at 15:09:51.861794 after 11.10 seconds
[0m15:09:51.862689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffe358400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff86367d0>]}
[0m15:09:51.863868 [debug] [MainThread]: Flushing usage events
[0m15:31:23.599050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d990>]}


============================== 15:31:23.613388 | 59ede60c-1a43-4d29-ae0a-f076cbe51890 ==============================
[0m15:31:23.613388 [info ] [MainThread]: Running with dbt=1.7.7
[0m15:31:23.614573 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:31:24.006130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59ede60c-1a43-4d29-ae0a-f076cbe51890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc6ee560>]}
[0m15:31:24.077883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59ede60c-1a43-4d29-ae0a-f076cbe51890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9412350>]}
[0m15:31:24.078800 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m15:31:24.095556 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m15:31:24.160682 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:31:24.161605 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://taxi_rides_ny/models/core/fact_trips.sql
[0m15:31:24.314741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59ede60c-1a43-4d29-ae0a-f076cbe51890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91e5090>]}
[0m15:31:24.331308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59ede60c-1a43-4d29-ae0a-f076cbe51890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92638b0>]}
[0m15:31:24.331931 [info ] [MainThread]: Found 6 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m15:31:24.334534 [info ] [MainThread]: 
[0m15:31:24.335922 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:31:24.338259 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m15:31:24.338831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:24.339655 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m15:31:24.340479 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m15:31:24.340954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:24.369974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:25.659235 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_dbt_staging'
[0m15:31:25.660579 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_production'
[0m15:31:25.661686 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_dbt_abhishek_yadav)
[0m15:31:25.662585 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:25.663155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:25.663746 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:31:26.267662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59ede60c-1a43-4d29-ae0a-f076cbe51890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95a6b00>]}
[0m15:31:26.273752 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:31:26.275302 [info ] [MainThread]: 
[0m15:31:26.286310 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.my_first_dbt_model
[0m15:31:26.286874 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m15:31:26.287316 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
[0m15:31:26.287803 [debug] [Thread-4 (]: Began running node seed.taxi_rides_ny.taxi_zone_lookup
[0m15:31:26.288376 [info ] [Thread-1 (]: 1 of 7 START sql table model dbt_staging.my_first_dbt_model .................... [RUN]
[0m15:31:26.289290 [info ] [Thread-2 (]: 2 of 7 START sql view model dbt_staging.stg_green_trip_data .................... [RUN]
[0m15:31:26.290258 [info ] [Thread-3 (]: 3 of 7 START sql view model dbt_abhishek_yadav.stg_yellow_trip_data ............ [RUN]
[0m15:31:26.291336 [info ] [Thread-4 (]: 4 of 7 START seed file dbt_staging.taxi_zone_lookup ............................ [RUN]
[0m15:31:26.292501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_abhishek_yadav, now model.taxi_rides_ny.my_first_dbt_model)
[0m15:31:26.293444 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_production, now model.taxi_rides_ny.stg_green_trip_data)
[0m15:31:26.294286 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_staging, now model.taxi_rides_ny.stg_yellow_trip_data)
[0m15:31:26.295128 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now seed.taxi_rides_ny.taxi_zone_lookup)
[0m15:31:26.295689 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
[0m15:31:26.296359 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m15:31:26.297067 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
[0m15:31:26.297637 [debug] [Thread-4 (]: Began compiling node seed.taxi_rides_ny.taxi_zone_lookup
[0m15:31:26.307509 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
[0m15:31:26.339190 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m15:31:26.340375 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (compile): 15:31:26.340078 => 15:31:26.340083
[0m15:31:26.344997 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m15:31:26.346294 [debug] [Thread-4 (]: Began executing node seed.taxi_rides_ny.taxi_zone_lookup
[0m15:31:26.348540 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (compile): 15:31:26.298071 => 15:31:26.348255
[0m15:31:26.361598 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (compile): 15:31:26.326734 => 15:31:26.361187
[0m15:31:26.364512 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 15:31:26.308307 => 15:31:26.364215
[0m15:31:26.365831 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.my_first_dbt_model
[0m15:31:26.366423 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
[0m15:31:26.376283 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m15:31:26.378176 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:31:26.388182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:26.411251 [debug] [Thread-3 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m15:31:26.414572 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_trip_data"
[0m15:31:26.473869 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:31:26.474416 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:31:26.476307 [debug] [Thread-3 (]: On model.taxi_rides_ny.stg_yellow_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
  OPTIONS()
  as -- 

select
-- identifiers

    
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
TIMESTAMP_SECONDS(CAST(CAST(tpep_pickup_datetime as INT64)/10000000 AS INT64)) as pickup_datetime,
TIMESTAMP_SECONDS(CAST(CAST(tpep_dropoff_datetime as INT64)/10000000 AS INT64)) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
1 as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(0 as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`yello_trip_data`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), tpep_pickup_datetime)=1
-- dbt-bq run --select stg_green_tripdata  --var 'is_test_run: false'

limit 100
;


[0m15:31:26.504494 [debug] [Thread-2 (]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
  OPTIONS()
  as select
-- identifiers

    
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
cast(trip_type as integer) as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(ehail_fee as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), lpep_pickup_datetime)=1
-- dbt-bq compile --select stg_green_trip_data --vars '{'is_test_run': 'false'}'

limit 100
;


[0m15:31:27.047229 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.my_first_dbt_model"
[0m15:31:27.049991 [debug] [Thread-1 (]: On model.taxi_rides_ny.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_first_dbt_model"} */

  
    

    create or replace table `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m15:31:27.389440 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:4d19d2a6-fbcf-4318-9915-ba72da01f5ce&page=queryresults
[0m15:31:27.390506 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:a6766bc3-7ec6-4e39-ab09-68ce3116d873&page=queryresults
[0m15:31:27.446354 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:4ab2dc5f-a174-4257-b1f9-6a1b37e6bdd2&page=queryresults
[0m15:31:27.700643 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (execute): 15:31:26.388641 => 15:31:27.700401
[0m15:31:27.701763 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59ede60c-1a43-4d29-ae0a-f076cbe51890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7b34400>]}
[0m15:31:27.703039 [info ] [Thread-3 (]: 3 of 7 OK created sql view model dbt_abhishek_yadav.stg_yellow_trip_data ....... [[32mCREATE VIEW (0 processed)[0m in 1.41s]
[0m15:31:27.703998 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
[0m15:31:27.731440 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 15:31:26.411570 => 15:31:27.731199
[0m15:31:27.732454 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59ede60c-1a43-4d29-ae0a-f076cbe51890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7b34400>]}
[0m15:31:27.733165 [info ] [Thread-2 (]: 2 of 7 OK created sql view model dbt_staging.stg_green_trip_data ............... [[32mCREATE VIEW (0 processed)[0m in 1.44s]
[0m15:31:27.733991 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m15:31:28.920927 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (execute): 15:31:26.378689 => 15:31:28.920385
[0m15:31:28.925332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59ede60c-1a43-4d29-ae0a-f076cbe51890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7b164d0>]}
[0m15:31:28.928097 [info ] [Thread-1 (]: 1 of 7 OK created sql table model dbt_staging.my_first_dbt_model ............... [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.63s]
[0m15:31:28.929922 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.my_first_dbt_model
[0m15:31:28.932063 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.my_second_dbt_model
[0m15:31:28.933519 [info ] [Thread-3 (]: 5 of 7 START sql view model dbt_staging.my_second_dbt_model .................... [RUN]
[0m15:31:28.935435 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_yellow_trip_data, now model.taxi_rides_ny.my_second_dbt_model)
[0m15:31:28.936639 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
[0m15:31:28.943735 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
[0m15:31:28.948912 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (compile): 15:31:28.937642 => 15:31:28.948310
[0m15:31:28.949872 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.my_second_dbt_model
[0m15:31:28.956168 [debug] [Thread-3 (]: Writing runtime sql for node "model.taxi_rides_ny.my_second_dbt_model"
[0m15:31:28.959799 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:31:28.964589 [debug] [Thread-3 (]: On model.taxi_rides_ny.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_second_dbt_model"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
where id = 1;


[0m15:31:29.758702 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:6347db3a-6d00-46f3-899e-cb4ad76dda99&page=queryresults
[0m15:31:30.103303 [debug] [Thread-4 (]: On seed.taxi_rides_ny.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "seed.taxi_rides_ny.taxi_zone_lookup"} */

    alter table `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup` set OPTIONS()
  
[0m15:31:30.132809 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (execute): 15:31:28.950410 => 15:31:30.132505
[0m15:31:30.136658 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59ede60c-1a43-4d29-ae0a-f076cbe51890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7cbd600>]}
[0m15:31:30.137967 [info ] [Thread-3 (]: 5 of 7 OK created sql view model dbt_staging.my_second_dbt_model ............... [[32mCREATE VIEW (0 processed)[0m in 1.20s]
[0m15:31:30.139190 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.my_second_dbt_model
[0m15:31:30.365706 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:68821b8a-bbea-49bf-9e9d-cea6db0d1ca4&page=queryresults
[0m15:31:30.625471 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.taxi_rides_ny.taxi_zone_lookup"
[0m15:31:30.632848 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (execute): 15:31:26.348757 => 15:31:30.632465
[0m15:31:30.634547 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59ede60c-1a43-4d29-ae0a-f076cbe51890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7c6e260>]}
[0m15:31:30.635802 [info ] [Thread-4 (]: 4 of 7 OK loaded seed file dbt_staging.taxi_zone_lookup ........................ [[32mINSERT 265[0m in 4.34s]
[0m15:31:30.637332 [debug] [Thread-4 (]: Finished running node seed.taxi_rides_ny.taxi_zone_lookup
[0m15:31:30.640386 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.dim_zones
[0m15:31:30.641906 [info ] [Thread-1 (]: 6 of 7 START sql table model production.dim_zones .............................. [RUN]
[0m15:31:30.643891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.my_first_dbt_model, now model.taxi_rides_ny.dim_zones)
[0m15:31:30.644957 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m15:31:30.650769 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m15:31:30.654244 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.dim_zones (compile): 15:31:30.645667 => 15:31:30.653851
[0m15:31:30.654957 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m15:31:30.707328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:31.271225 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_zones"
[0m15:31:31.280881 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */

  
    

    create or replace table `de-zoomcamp-413815`.`production`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      select 
locationid,
borough,
zone,
replace(service_zone, 'Boro', 'Green') as service_zone
from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
    );
  
[0m15:31:31.646450 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:a8f03621-b4cd-4c6e-a399-6f1e428921c8&page=queryresults
[0m15:31:33.089503 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.dim_zones (execute): 15:31:30.655500 => 15:31:33.089172
[0m15:31:33.091515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59ede60c-1a43-4d29-ae0a-f076cbe51890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff4234490>]}
[0m15:31:33.092563 [info ] [Thread-1 (]: 6 of 7 OK created sql table model production.dim_zones ......................... [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 2.45s]
[0m15:31:33.093580 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m15:31:33.094933 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.fact_trips
[0m15:31:33.095832 [info ] [Thread-3 (]: 7 of 7 START sql table model production.fact_trips ............................. [RUN]
[0m15:31:33.097283 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.my_second_dbt_model, now model.taxi_rides_ny.fact_trips)
[0m15:31:33.097927 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.fact_trips
[0m15:31:33.102775 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.fact_trips"
[0m15:31:33.105462 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.fact_trips (compile): 15:31:33.098406 => 15:31:33.104982
[0m15:31:33.106395 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.fact_trips
[0m15:31:33.112152 [debug] [Thread-3 (]: Writing runtime sql for node "model.taxi_rides_ny.fact_trips"
[0m15:31:33.115296 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:31:33.119328 [debug] [Thread-3 (]: On model.taxi_rides_ny.fact_trips: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.fact_trips"} */

  
    

    create or replace table `de-zoomcamp-413815`.`production`.`fact_trips`
      
    
    

    OPTIONS()
    as (
      with green_trip_data as(
    select *,
        'Green' as service_type
    from 
    `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
),

yellow_trip_data as(
    select *,
        'Yellow' as service_type
    from 
    `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
),

trips_unioned as(
    select * from green_trip_data
    union all
    slect * from yellow_trip_data
),
dim_zones as (
    select * from `de-zoomcamp-413815`.`production`.`dim_zones`
    wjere borough <> 'Unknown'
)

select * from trips_unioned
inner join dim_zones as pickup_zone
on (trips_unioned.pickup_locationid = pickup_zone.locationid)
inner join dim_zones as dropoff_zone
on (trips_unioned.dropoff_locationid = dropoff_zone.locationid)
    );
  
[0m15:31:33.779083 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:797f8f7f-6a2f-4e8e-a285-3f5c81826be3&page=queryresults
[0m15:31:33.789721 [debug] [Thread-3 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or keyword SELECT but got identifier "slect" at [30:5]; reason: invalidQuery, location: query, message: Syntax error: Expected "(" or keyword SELECT but got identifier "slect" at [30:5]')
[0m15:31:34.807720 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:661391bf-59ba-4e7e-bdef-d04f30b05e31&page=queryresults
[0m15:31:34.821601 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:661391bf-59ba-4e7e-bdef-d04f30b05e31&page=queryresults
[0m15:31:34.827898 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.fact_trips (execute): 15:31:33.107157 => 15:31:34.826552
[0m15:31:34.844169 [debug] [Thread-3 (]: Database Error in model fact_trips (taxi_rides_ny/models/core/fact_trips.sql)
  Syntax error: Expected "(" or keyword SELECT but got identifier "slect" at [30:5]
  compiled Code at target/run/taxi_rides_ny/taxi_rides_ny/models/core/fact_trips.sql
[0m15:31:34.846347 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59ede60c-1a43-4d29-ae0a-f076cbe51890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7b01030>]}
[0m15:31:34.848126 [error] [Thread-3 (]: 7 of 7 ERROR creating sql table model production.fact_trips .................... [[31mERROR[0m in 1.75s]
[0m15:31:34.849780 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.fact_trips
[0m15:31:34.853519 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:31:34.854447 [debug] [MainThread]: Connection 'model.taxi_rides_ny.dim_zones' was properly closed.
[0m15:31:34.855273 [debug] [MainThread]: Connection 'seed.taxi_rides_ny.taxi_zone_lookup' was properly closed.
[0m15:31:34.856030 [debug] [MainThread]: Connection 'list_de-zoomcamp-413815' was properly closed.
[0m15:31:34.856771 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fact_trips' was properly closed.
[0m15:31:34.857454 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_green_trip_data' was properly closed.
[0m15:31:34.858563 [info ] [MainThread]: 
[0m15:31:34.859543 [info ] [MainThread]: Finished running 3 view models, 3 table models, 1 seed in 0 hours 0 minutes and 10.52 seconds (10.52s).
[0m15:31:34.862379 [debug] [MainThread]: Command end result
[0m15:31:34.877811 [info ] [MainThread]: 
[0m15:31:34.878741 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:31:34.879469 [info ] [MainThread]: 
[0m15:31:34.880152 [error] [MainThread]:   Database Error in model fact_trips (taxi_rides_ny/models/core/fact_trips.sql)
  Syntax error: Expected "(" or keyword SELECT but got identifier "slect" at [30:5]
  compiled Code at target/run/taxi_rides_ny/taxi_rides_ny/models/core/fact_trips.sql
[0m15:31:34.880804 [info ] [MainThread]: 
[0m15:31:34.881597 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m15:31:34.883584 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 11.339834, "process_user_time": 3.90921, "process_kernel_time": 0.358087, "process_mem_max_rss": "162580", "process_in_blocks": "272", "process_out_blocks": "704", "command_success": false}
[0m15:31:34.884729 [debug] [MainThread]: Command `dbt build` failed at 15:31:34.884510 after 11.34 seconds
[0m15:31:34.885619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7cd2980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7b02ce0>]}
[0m15:31:34.886370 [debug] [MainThread]: Flushing usage events
[0m15:35:10.980704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00db10>]}


============================== 15:35:10.992672 | 0ca3afc5-331b-4c4d-8d03-9f94152d5f7b ==============================
[0m15:35:10.992672 [info ] [MainThread]: Running with dbt=1.7.7
[0m15:35:10.993651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m15:35:11.351685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ca3afc5-331b-4c4d-8d03-9f94152d5f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00e050>]}
[0m15:35:11.428646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ca3afc5-331b-4c4d-8d03-9f94152d5f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf05420>]}
[0m15:35:11.429652 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m15:35:11.443866 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m15:35:11.505040 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:35:11.505803 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://taxi_rides_ny/models/core/fact_trips.sql
[0m15:35:11.655175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ca3afc5-331b-4c4d-8d03-9f94152d5f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91ed030>]}
[0m15:35:11.670196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ca3afc5-331b-4c4d-8d03-9f94152d5f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9265db0>]}
[0m15:35:11.670827 [info ] [MainThread]: Found 6 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m15:35:11.672775 [info ] [MainThread]: 
[0m15:35:11.673954 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:35:11.676360 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m15:35:11.677137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:11.677828 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m15:35:11.678567 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m15:35:11.679198 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:11.708284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:12.758375 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_dbt_staging'
[0m15:35:12.760222 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_dbt_abhishek_yadav'
[0m15:35:12.761692 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_production)
[0m15:35:12.762714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:12.763785 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:12.764897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:35:13.384764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ca3afc5-331b-4c4d-8d03-9f94152d5f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9410040>]}
[0m15:35:13.390281 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:35:13.392547 [info ] [MainThread]: 
[0m15:35:13.412228 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.my_first_dbt_model
[0m15:35:13.413255 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m15:35:13.414221 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
[0m15:35:13.415337 [debug] [Thread-4 (]: Began running node seed.taxi_rides_ny.taxi_zone_lookup
[0m15:35:13.415923 [info ] [Thread-1 (]: 1 of 7 START sql table model dbt_staging.my_first_dbt_model .................... [RUN]
[0m15:35:13.417007 [info ] [Thread-2 (]: 2 of 7 START sql view model dbt_staging.stg_green_trip_data .................... [RUN]
[0m15:35:13.418316 [info ] [Thread-3 (]: 3 of 7 START sql view model dbt_abhishek_yadav.stg_yellow_trip_data ............ [RUN]
[0m15:35:13.419509 [info ] [Thread-4 (]: 4 of 7 START seed file dbt_staging.taxi_zone_lookup ............................ [RUN]
[0m15:35:13.421250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_abhishek_yadav, now model.taxi_rides_ny.my_first_dbt_model)
[0m15:35:13.422905 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_production, now model.taxi_rides_ny.stg_green_trip_data)
[0m15:35:13.424726 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_staging, now model.taxi_rides_ny.stg_yellow_trip_data)
[0m15:35:13.426193 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now seed.taxi_rides_ny.taxi_zone_lookup)
[0m15:35:13.427102 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
[0m15:35:13.427968 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m15:35:13.428816 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
[0m15:35:13.429593 [debug] [Thread-4 (]: Began compiling node seed.taxi_rides_ny.taxi_zone_lookup
[0m15:35:13.440325 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
[0m15:35:13.458388 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m15:35:13.470558 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m15:35:13.471535 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (compile): 15:35:13.471155 => 15:35:13.471159
[0m15:35:13.475665 [debug] [Thread-4 (]: Began executing node seed.taxi_rides_ny.taxi_zone_lookup
[0m15:35:13.482177 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (compile): 15:35:13.430220 => 15:35:13.481937
[0m15:35:13.482609 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (compile): 15:35:13.458693 => 15:35:13.482391
[0m15:35:13.490560 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 15:35:13.440897 => 15:35:13.490277
[0m15:35:13.491819 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.my_first_dbt_model
[0m15:35:13.492348 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
[0m15:35:13.502066 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m15:35:13.502952 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:35:13.512125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:13.532985 [debug] [Thread-3 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m15:35:13.535759 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_trip_data"
[0m15:35:13.593278 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:35:13.593782 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:35:13.595568 [debug] [Thread-2 (]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
  OPTIONS()
  as select
-- identifiers

    
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
cast(trip_type as integer) as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(ehail_fee as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), lpep_pickup_datetime)=1
-- dbt-bq compile --select stg_green_trip_data --vars '{'is_test_run': 'false'}'

limit 100
;


[0m15:35:13.623233 [debug] [Thread-3 (]: On model.taxi_rides_ny.stg_yellow_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
  OPTIONS()
  as -- 

select
-- identifiers

    
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
TIMESTAMP_SECONDS(CAST(CAST(tpep_pickup_datetime as INT64)/10000000 AS INT64)) as pickup_datetime,
TIMESTAMP_SECONDS(CAST(CAST(tpep_dropoff_datetime as INT64)/10000000 AS INT64)) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
1 as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(0 as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`yello_trip_data`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), tpep_pickup_datetime)=1
-- dbt-bq run --select stg_green_tripdata  --var 'is_test_run: false'

limit 100
;


[0m15:35:14.117699 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.my_first_dbt_model"
[0m15:35:14.120600 [debug] [Thread-1 (]: On model.taxi_rides_ny.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_first_dbt_model"} */

  
    

    create or replace table `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m15:35:14.331057 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:c882d18d-9f6d-4536-987d-bb11d2ed450a&page=queryresults
[0m15:35:14.336377 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:65f5f6bd-1568-4f3b-a32e-9286e2529c29&page=queryresults
[0m15:35:14.377526 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:2f86e69e-532b-41ef-a9cc-1f18cbfc5f7e&page=queryresults
[0m15:35:14.538953 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 15:35:13.533224 => 15:35:14.538735
[0m15:35:14.540038 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ca3afc5-331b-4c4d-8d03-9f94152d5f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7cb8f70>]}
[0m15:35:14.541216 [info ] [Thread-2 (]: 2 of 7 OK created sql view model dbt_staging.stg_green_trip_data ............... [[32mCREATE VIEW (0 processed)[0m in 1.12s]
[0m15:35:14.542179 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m15:35:14.782173 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (execute): 15:35:13.512539 => 15:35:14.781321
[0m15:35:14.786138 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ca3afc5-331b-4c4d-8d03-9f94152d5f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7b25fc0>]}
[0m15:35:14.789052 [info ] [Thread-3 (]: 3 of 7 OK created sql view model dbt_abhishek_yadav.stg_yellow_trip_data ....... [[32mCREATE VIEW (0 processed)[0m in 1.36s]
[0m15:35:14.791669 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
[0m15:35:15.771462 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (execute): 15:35:13.503365 => 15:35:15.770230
[0m15:35:15.774355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ca3afc5-331b-4c4d-8d03-9f94152d5f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7c82500>]}
[0m15:35:15.775637 [info ] [Thread-1 (]: 1 of 7 OK created sql table model dbt_staging.my_first_dbt_model ............... [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.35s]
[0m15:35:15.776713 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.my_first_dbt_model
[0m15:35:15.777952 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.my_second_dbt_model
[0m15:35:15.778694 [info ] [Thread-2 (]: 5 of 7 START sql view model dbt_staging.my_second_dbt_model .................... [RUN]
[0m15:35:15.780048 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_green_trip_data, now model.taxi_rides_ny.my_second_dbt_model)
[0m15:35:15.780812 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
[0m15:35:15.785860 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
[0m15:35:15.789717 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (compile): 15:35:15.781368 => 15:35:15.789258
[0m15:35:15.790565 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.my_second_dbt_model
[0m15:35:15.796793 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.my_second_dbt_model"
[0m15:35:15.799760 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:35:15.803096 [debug] [Thread-2 (]: On model.taxi_rides_ny.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_second_dbt_model"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
where id = 1;


[0m15:35:16.550735 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:93d23971-94b8-49e2-b45d-da443052bd39&page=queryresults
[0m15:35:16.788547 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (execute): 15:35:15.791184 => 15:35:16.787897
[0m15:35:16.791906 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ca3afc5-331b-4c4d-8d03-9f94152d5f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7b87df0>]}
[0m15:35:16.793705 [info ] [Thread-2 (]: 5 of 7 OK created sql view model dbt_staging.my_second_dbt_model ............... [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m15:35:16.795683 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.my_second_dbt_model
[0m15:35:16.945855 [debug] [Thread-4 (]: On seed.taxi_rides_ny.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "seed.taxi_rides_ny.taxi_zone_lookup"} */

    alter table `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup` set OPTIONS()
  
[0m15:35:17.162829 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:19dce9e8-3eec-4d32-bd13-28cb53ea968e&page=queryresults
[0m15:35:17.402866 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.taxi_rides_ny.taxi_zone_lookup"
[0m15:35:17.413607 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (execute): 15:35:13.476707 => 15:35:17.413085
[0m15:35:17.415774 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ca3afc5-331b-4c4d-8d03-9f94152d5f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7ce80d0>]}
[0m15:35:17.417209 [info ] [Thread-4 (]: 4 of 7 OK loaded seed file dbt_staging.taxi_zone_lookup ........................ [[32mINSERT 265[0m in 3.99s]
[0m15:35:17.419236 [debug] [Thread-4 (]: Finished running node seed.taxi_rides_ny.taxi_zone_lookup
[0m15:35:17.423496 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.dim_zones
[0m15:35:17.424841 [info ] [Thread-1 (]: 6 of 7 START sql table model production.dim_zones .............................. [RUN]
[0m15:35:17.426768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.my_first_dbt_model, now model.taxi_rides_ny.dim_zones)
[0m15:35:17.428363 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m15:35:17.435127 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m15:35:17.438093 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.dim_zones (compile): 15:35:17.429520 => 15:35:17.437681
[0m15:35:17.438860 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m15:35:17.485496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:18.109702 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_zones"
[0m15:35:18.118067 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */

  
    

    create or replace table `de-zoomcamp-413815`.`production`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      select 
locationid,
borough,
zone,
replace(service_zone, 'Boro', 'Green') as service_zone
from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
    );
  
[0m15:35:18.471643 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:80f8724c-7efc-463a-86a4-3472d0fcae01&page=queryresults
[0m15:35:19.843849 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.dim_zones (execute): 15:35:17.439324 => 15:35:19.843631
[0m15:35:19.845074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ca3afc5-331b-4c4d-8d03-9f94152d5f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7b03070>]}
[0m15:35:19.845864 [info ] [Thread-1 (]: 6 of 7 OK created sql table model production.dim_zones ......................... [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 2.42s]
[0m15:35:19.847044 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m15:35:19.848003 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.fact_trips
[0m15:35:19.848905 [info ] [Thread-2 (]: 7 of 7 START sql table model production.fact_trips ............................. [RUN]
[0m15:35:19.849952 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.my_second_dbt_model, now model.taxi_rides_ny.fact_trips)
[0m15:35:19.850528 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.fact_trips
[0m15:35:19.854401 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.fact_trips"
[0m15:35:19.856477 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.fact_trips (compile): 15:35:19.850903 => 15:35:19.856198
[0m15:35:19.856996 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.fact_trips
[0m15:35:19.860270 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.fact_trips"
[0m15:35:19.862046 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:35:19.863779 [debug] [Thread-2 (]: On model.taxi_rides_ny.fact_trips: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.fact_trips"} */

  
    

    create or replace table `de-zoomcamp-413815`.`production`.`fact_trips`
      
    
    

    OPTIONS()
    as (
      with green_trip_data as(
    select *,
        'Green' as service_type
    from 
    `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
),

yellow_trip_data as(
    select *,
        'Yellow' as service_type
    from 
    `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
),

trips_unioned as(
    select * from green_trip_data
    union all
    select * from yellow_trip_data
),
dim_zones as (
    select * from `de-zoomcamp-413815`.`production`.`dim_zones`
    where borough <> 'Unknown'
)

select * from trips_unioned
inner join dim_zones as pickup_zone
on (trips_unioned.pickup_locationid = pickup_zone.locationid)
inner join dim_zones as dropoff_zone
on (trips_unioned.dropoff_locationid = dropoff_zone.locationid)
    );
  
[0m15:35:21.157687 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:3ad11f75-3b6b-46fd-b741-9506b0e93e54&page=queryresults
[0m15:35:21.404135 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE TABLE has columns with duplicate name locationid at [13:7]; reason: invalidQuery, location: query, message: CREATE TABLE has columns with duplicate name locationid at [13:7]')
[0m15:35:22.377045 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:6fb834b2-f823-48f2-b978-f90e8ea4da48&page=queryresults
[0m15:35:22.603875 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:6fb834b2-f823-48f2-b978-f90e8ea4da48&page=queryresults
[0m15:35:22.611336 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.fact_trips (execute): 15:35:19.857326 => 15:35:22.610052
[0m15:35:22.628406 [debug] [Thread-2 (]: Database Error in model fact_trips (taxi_rides_ny/models/core/fact_trips.sql)
  CREATE TABLE has columns with duplicate name locationid at [13:7]
  compiled Code at target/run/taxi_rides_ny/taxi_rides_ny/models/core/fact_trips.sql
[0m15:35:22.630503 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ca3afc5-331b-4c4d-8d03-9f94152d5f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7b03dc0>]}
[0m15:35:22.631938 [error] [Thread-2 (]: 7 of 7 ERROR creating sql table model production.fact_trips .................... [[31mERROR[0m in 2.78s]
[0m15:35:22.632911 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.fact_trips
[0m15:35:22.635532 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:22.636124 [debug] [MainThread]: Connection 'list_de-zoomcamp-413815' was properly closed.
[0m15:35:22.636579 [debug] [MainThread]: Connection 'seed.taxi_rides_ny.taxi_zone_lookup' was properly closed.
[0m15:35:22.637040 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fact_trips' was properly closed.
[0m15:35:22.637531 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_yellow_trip_data' was properly closed.
[0m15:35:22.637959 [debug] [MainThread]: Connection 'model.taxi_rides_ny.dim_zones' was properly closed.
[0m15:35:22.638666 [info ] [MainThread]: 
[0m15:35:22.639610 [info ] [MainThread]: Finished running 3 view models, 3 table models, 1 seed in 0 hours 0 minutes and 10.96 seconds (10.96s).
[0m15:35:22.643320 [debug] [MainThread]: Command end result
[0m15:35:22.662281 [info ] [MainThread]: 
[0m15:35:22.663298 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:35:22.664174 [info ] [MainThread]: 
[0m15:35:22.665094 [error] [MainThread]:   Database Error in model fact_trips (taxi_rides_ny/models/core/fact_trips.sql)
  CREATE TABLE has columns with duplicate name locationid at [13:7]
  compiled Code at target/run/taxi_rides_ny/taxi_rides_ny/models/core/fact_trips.sql
[0m15:35:22.665982 [info ] [MainThread]: 
[0m15:35:22.667000 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m15:35:22.669100 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 11.737974, "process_user_time": 3.92614, "process_kernel_time": 0.22311, "process_mem_max_rss": "159392", "process_out_blocks": "704", "command_success": false, "process_in_blocks": "0"}
[0m15:35:22.670642 [debug] [MainThread]: Command `dbt build` failed at 15:35:22.670365 after 11.74 seconds
[0m15:35:22.671445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf05420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92674c0>]}
[0m15:35:22.672165 [debug] [MainThread]: Flushing usage events
[0m17:29:30.238779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00db10>]}


============================== 17:29:30.252046 | 4d75ab62-fa50-4402-b349-dbfea91a6a62 ==============================
[0m17:29:30.252046 [info ] [MainThread]: Running with dbt=1.7.7
[0m17:29:30.253065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:29:30.638534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d75ab62-fa50-4402-b349-dbfea91a6a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00dcf0>]}
[0m17:29:30.711574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d75ab62-fa50-4402-b349-dbfea91a6a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff940fb80>]}
[0m17:29:30.712531 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m17:29:30.729050 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m17:29:30.804039 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:29:30.804859 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://taxi_rides_ny/models/core/fact_trips.sql
[0m17:29:30.965727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d75ab62-fa50-4402-b349-dbfea91a6a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91e4f40>]}
[0m17:29:30.982090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d75ab62-fa50-4402-b349-dbfea91a6a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9265c30>]}
[0m17:29:30.982724 [info ] [MainThread]: Found 6 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m17:29:30.984646 [info ] [MainThread]: 
[0m17:29:30.985694 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:29:30.988148 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m17:29:30.988849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:30.989581 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m17:29:30.990359 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m17:29:30.991003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:31.020730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:32.203343 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_production'
[0m17:29:32.205550 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_dbt_staging'
[0m17:29:32.207593 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_dbt_abhishek_yadav)
[0m17:29:32.208522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:32.209971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:32.211270 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:29:32.809027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d75ab62-fa50-4402-b349-dbfea91a6a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95ecaf0>]}
[0m17:29:32.812334 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:29:32.814244 [info ] [MainThread]: 
[0m17:29:32.832356 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.my_first_dbt_model
[0m17:29:32.833495 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m17:29:32.834424 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
[0m17:29:32.835246 [debug] [Thread-4 (]: Began running node seed.taxi_rides_ny.taxi_zone_lookup
[0m17:29:32.836110 [info ] [Thread-1 (]: 1 of 7 START sql table model dbt_staging.my_first_dbt_model .................... [RUN]
[0m17:29:32.837505 [info ] [Thread-2 (]: 2 of 7 START sql view model dbt_staging.stg_green_trip_data .................... [RUN]
[0m17:29:32.838679 [info ] [Thread-3 (]: 3 of 7 START sql view model dbt_abhishek_yadav.stg_yellow_trip_data ............ [RUN]
[0m17:29:32.839813 [info ] [Thread-4 (]: 4 of 7 START seed file dbt_staging.taxi_zone_lookup ............................ [RUN]
[0m17:29:32.841300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_staging, now model.taxi_rides_ny.my_first_dbt_model)
[0m17:29:32.842637 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_abhishek_yadav, now model.taxi_rides_ny.stg_green_trip_data)
[0m17:29:32.843767 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_production, now model.taxi_rides_ny.stg_yellow_trip_data)
[0m17:29:32.844812 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now seed.taxi_rides_ny.taxi_zone_lookup)
[0m17:29:32.845513 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
[0m17:29:32.846151 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m17:29:32.846736 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
[0m17:29:32.847390 [debug] [Thread-4 (]: Began compiling node seed.taxi_rides_ny.taxi_zone_lookup
[0m17:29:32.857415 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
[0m17:29:32.875185 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m17:29:32.886934 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m17:29:32.887716 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (compile): 17:29:32.887480 => 17:29:32.887485
[0m17:29:32.890026 [debug] [Thread-4 (]: Began executing node seed.taxi_rides_ny.taxi_zone_lookup
[0m17:29:32.903269 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (compile): 17:29:32.847935 => 17:29:32.902802
[0m17:29:32.903846 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (compile): 17:29:32.875499 => 17:29:32.903522
[0m17:29:32.907235 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 17:29:32.858066 => 17:29:32.906972
[0m17:29:32.908429 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.my_first_dbt_model
[0m17:29:32.913016 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
[0m17:29:32.919717 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:29:32.920338 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m17:29:32.929582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:32.950885 [debug] [Thread-3 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m17:29:32.955387 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_trip_data"
[0m17:29:33.011679 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:29:33.012595 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:29:33.014046 [debug] [Thread-3 (]: On model.taxi_rides_ny.stg_yellow_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
  OPTIONS()
  as -- 

select
-- identifiers

    
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
TIMESTAMP_SECONDS(CAST(CAST(tpep_pickup_datetime as INT64)/10000000 AS INT64)) as pickup_datetime,
TIMESTAMP_SECONDS(CAST(CAST(tpep_dropoff_datetime as INT64)/10000000 AS INT64)) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
1 as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(0 as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`yello_trip_data`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), tpep_pickup_datetime)=1
-- dbt-bq run --select stg_green_tripdata  --var 'is_test_run: false'

limit 100
;


[0m17:29:33.042544 [debug] [Thread-2 (]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
  OPTIONS()
  as select
-- identifiers

    
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
cast(trip_type as integer) as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(ehail_fee as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), lpep_pickup_datetime)=1
-- dbt-bq compile --select stg_green_trip_data --vars '{'is_test_run': 'false'}'

limit 100
;


[0m17:29:33.591881 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.my_first_dbt_model"
[0m17:29:33.594053 [debug] [Thread-1 (]: On model.taxi_rides_ny.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_first_dbt_model"} */

  
    

    create or replace table `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m17:29:33.990059 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:7329894c-0ce7-4a99-81e0-f761538e0418&page=queryresults
[0m17:29:33.993031 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:7d0b28f8-6f9c-414a-ad33-5d7aedd37935&page=queryresults
[0m17:29:34.249923 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:65078811-0f16-4e45-b3e5-b25051b6a9d8&page=queryresults
[0m17:29:34.512407 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (execute): 17:29:32.929995 => 17:29:34.512030
[0m17:29:34.514055 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d75ab62-fa50-4402-b349-dbfea91a6a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7b311b0>]}
[0m17:29:34.516063 [info ] [Thread-3 (]: 3 of 7 OK created sql view model dbt_abhishek_yadav.stg_yellow_trip_data ....... [[32mCREATE VIEW (0 processed)[0m in 1.67s]
[0m17:29:34.517823 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
[0m17:29:34.785331 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 17:29:32.952323 => 17:29:34.785076
[0m17:29:34.787291 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d75ab62-fa50-4402-b349-dbfea91a6a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7cbd090>]}
[0m17:29:34.788148 [info ] [Thread-2 (]: 2 of 7 OK created sql view model dbt_staging.stg_green_trip_data ............... [[32mCREATE VIEW (0 processed)[0m in 1.95s]
[0m17:29:34.789233 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m17:29:35.614473 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (execute): 17:29:32.920756 => 17:29:35.614243
[0m17:29:35.615517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d75ab62-fa50-4402-b349-dbfea91a6a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7cba6e0>]}
[0m17:29:35.616233 [info ] [Thread-1 (]: 1 of 7 OK created sql table model dbt_staging.my_first_dbt_model ............... [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.77s]
[0m17:29:35.617298 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.my_first_dbt_model
[0m17:29:35.618226 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.my_second_dbt_model
[0m17:29:35.618841 [info ] [Thread-3 (]: 5 of 7 START sql view model dbt_staging.my_second_dbt_model .................... [RUN]
[0m17:29:35.619716 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_yellow_trip_data, now model.taxi_rides_ny.my_second_dbt_model)
[0m17:29:35.620254 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
[0m17:29:35.623703 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
[0m17:29:35.626385 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (compile): 17:29:35.620623 => 17:29:35.626152
[0m17:29:35.626991 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.my_second_dbt_model
[0m17:29:35.630280 [debug] [Thread-3 (]: Writing runtime sql for node "model.taxi_rides_ny.my_second_dbt_model"
[0m17:29:35.632154 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:29:35.634225 [debug] [Thread-3 (]: On model.taxi_rides_ny.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_second_dbt_model"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
where id = 1;


[0m17:29:36.355498 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:fda4ca2a-0e35-4476-a19e-67cfdcfc1137&page=queryresults
[0m17:29:36.692681 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (execute): 17:29:35.627404 => 17:29:36.691160
[0m17:29:36.696334 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d75ab62-fa50-4402-b349-dbfea91a6a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7cbd720>]}
[0m17:29:36.698526 [info ] [Thread-3 (]: 5 of 7 OK created sql view model dbt_staging.my_second_dbt_model ............... [[32mCREATE VIEW (0 processed)[0m in 1.08s]
[0m17:29:36.701200 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.my_second_dbt_model
[0m17:29:36.825949 [debug] [Thread-4 (]: On seed.taxi_rides_ny.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "seed.taxi_rides_ny.taxi_zone_lookup"} */

    alter table `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup` set OPTIONS()
  
[0m17:29:37.226643 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:950d7f49-3f74-4ef4-9d49-c4d8c6f4c941&page=queryresults
[0m17:29:37.434039 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.taxi_rides_ny.taxi_zone_lookup"
[0m17:29:37.443843 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (execute): 17:29:32.890664 => 17:29:37.443323
[0m17:29:37.445908 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d75ab62-fa50-4402-b349-dbfea91a6a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7ce4460>]}
[0m17:29:37.447590 [info ] [Thread-4 (]: 4 of 7 OK loaded seed file dbt_staging.taxi_zone_lookup ........................ [[32mINSERT 265[0m in 4.60s]
[0m17:29:37.449285 [debug] [Thread-4 (]: Finished running node seed.taxi_rides_ny.taxi_zone_lookup
[0m17:29:37.453380 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.dim_zones
[0m17:29:37.454824 [info ] [Thread-1 (]: 6 of 7 START sql table model production.dim_zones .............................. [RUN]
[0m17:29:37.456638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.my_first_dbt_model, now model.taxi_rides_ny.dim_zones)
[0m17:29:37.457583 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m17:29:37.472356 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m17:29:37.476806 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.dim_zones (compile): 17:29:37.458215 => 17:29:37.475984
[0m17:29:37.477587 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m17:29:37.525784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:38.071274 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_zones"
[0m17:29:38.079539 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */

  
    

    create or replace table `de-zoomcamp-413815`.`production`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      select 
locationid,
borough,
zone,
replace(service_zone, 'Boro', 'Green') as service_zone
from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
    );
  
[0m17:29:38.489333 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:678a2fa9-f74d-4fa0-a53d-56dcca3c1e44&page=queryresults
[0m17:29:39.974111 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.dim_zones (execute): 17:29:37.478027 => 17:29:39.972595
[0m17:29:39.980584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d75ab62-fa50-4402-b349-dbfea91a6a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff42117e0>]}
[0m17:29:39.983730 [info ] [Thread-1 (]: 6 of 7 OK created sql table model production.dim_zones ......................... [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 2.52s]
[0m17:29:39.986636 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m17:29:39.987752 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.fact_trips
[0m17:29:39.988803 [info ] [Thread-3 (]: 7 of 7 START sql table model production.fact_trips ............................. [RUN]
[0m17:29:39.989791 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.my_second_dbt_model, now model.taxi_rides_ny.fact_trips)
[0m17:29:39.990339 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.fact_trips
[0m17:29:39.994352 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.fact_trips"
[0m17:29:39.997247 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.fact_trips (compile): 17:29:39.990705 => 17:29:39.996974
[0m17:29:39.997783 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.fact_trips
[0m17:29:40.001014 [debug] [Thread-3 (]: Writing runtime sql for node "model.taxi_rides_ny.fact_trips"
[0m17:29:40.002595 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:29:40.004358 [debug] [Thread-3 (]: On model.taxi_rides_ny.fact_trips: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.fact_trips"} */

  
    

    create or replace table `de-zoomcamp-413815`.`production`.`fact_trips`
      
    
    

    OPTIONS()
    as (
      with green_trip_data as(
    select *,
        'Green' as service_type
    from 
    `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
),

yellow_trip_data as(
    select *,
        'Yellow' as service_type
    from 
    `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
),

trips_unioned as(
    select * from green_trip_data
    union all
    select * from yellow_trip_data
),
dim_zones as (
    select * from `de-zoomcamp-413815`.`production`.`dim_zones`
    where borough <> 'Unknown'
)

select trips_unioned.tripid, 
    trips_unioned.vendorid, 
    trips_unioned.service_type,
    trips_unioned.ratecodeid, 
    trips_unioned.pickup_locationid, 
    pickup_zone.borough as pickup_borough, 
    pickup_zone.zone as pickup_zone, 
    trips_unioned.dropoff_locationid,
    dropoff_zone.borough as dropoff_borough, 
    dropoff_zone.zone as dropoff_zone,  
    trips_unioned.pickup_datetime, 
    trips_unioned.dropoff_datetime, 
    trips_unioned.store_and_fwd_flag, 
    trips_unioned.passenger_count, 
    trips_unioned.trip_distance, 
    trips_unioned.trip_type, 
    trips_unioned.fare_amount, 
    trips_unioned.extra, 
    trips_unioned.mta_tax, 
    trips_unioned.tip_amount, 
    trips_unioned.tolls_amount, 
    trips_unioned.ehail_fee, 
    trips_unioned.improvement_surcharge, 
    trips_unioned.total_amount, 
    trips_unioned.payment_type, 
    trips_unioned.payment_type_description
from trips_unioned
inner join dim_zones as pickup_zone
on (trips_unioned.pickup_locationid = pickup_zone.locationid)
inner join dim_zones as dropoff_zone
on (trips_unioned.dropoff_locationid = dropoff_zone.locationid)
    );
  
[0m17:29:41.327819 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:30b5e37f-29b2-4891-a240-dd4e8299ce1f&page=queryresults
[0m17:29:44.460926 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.fact_trips (execute): 17:29:39.998148 => 17:29:44.459743
[0m17:29:44.467937 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d75ab62-fa50-4402-b349-dbfea91a6a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7b1cf10>]}
[0m17:29:44.470740 [info ] [Thread-3 (]: 7 of 7 OK created sql table model production.fact_trips ........................ [[32mCREATE TABLE (195.0 rows, 276.2 MiB processed)[0m in 4.48s]
[0m17:29:44.473646 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.fact_trips
[0m17:29:44.479592 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:29:44.480915 [debug] [MainThread]: Connection 'seed.taxi_rides_ny.taxi_zone_lookup' was properly closed.
[0m17:29:44.481919 [debug] [MainThread]: Connection 'list_de-zoomcamp-413815' was properly closed.
[0m17:29:44.482774 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_green_trip_data' was properly closed.
[0m17:29:44.483672 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fact_trips' was properly closed.
[0m17:29:44.484701 [debug] [MainThread]: Connection 'model.taxi_rides_ny.dim_zones' was properly closed.
[0m17:29:44.486667 [info ] [MainThread]: 
[0m17:29:44.488358 [info ] [MainThread]: Finished running 3 view models, 3 table models, 1 seed in 0 hours 0 minutes and 13.50 seconds (13.50s).
[0m17:29:44.491989 [debug] [MainThread]: Command end result
[0m17:29:44.512722 [info ] [MainThread]: 
[0m17:29:44.513760 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:29:44.514658 [info ] [MainThread]: 
[0m17:29:44.515699 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m17:29:44.517804 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 14.333404, "process_user_time": 4.099277, "process_kernel_time": 0.340932, "process_mem_max_rss": "161712", "process_out_blocks": "704", "process_in_blocks": "0"}
[0m17:29:44.518705 [debug] [MainThread]: Command `dbt build` succeeded at 17:29:44.518485 after 14.33 seconds
[0m17:29:44.519420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff42117e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7c8a680>]}
[0m17:29:44.520184 [debug] [MainThread]: Flushing usage events
[0m17:34:52.139010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00dd20>]}


============================== 17:34:52.151869 | 38a5d4ba-15bd-45c2-ab8a-d4871017e7e6 ==============================
[0m17:34:52.151869 [info ] [MainThread]: Running with dbt=1.7.7
[0m17:34:52.153006 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --select +fact_trips+ --vars {is_test_run:false}', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:34:52.548885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38a5d4ba-15bd-45c2-ab8a-d4871017e7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00e530>]}
[0m17:34:52.629575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38a5d4ba-15bd-45c2-ab8a-d4871017e7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95ecd60>]}
[0m17:34:52.630953 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m17:34:52.646525 [debug] [MainThread]: checksum: 713bb41cda6ff42d2f265f6cf8353336cad0950a7997ab268d6104f27f0b933c, vars: {'is_test_run:false': None}, profile: , target: , version: 1.7.7
[0m17:34:52.663458 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:34:52.664256 [debug] [MainThread]: previous checksum: 713bb41cda6ff42d2f265f6cf8353336cad0950a7997ab268d6104f27f0b933c, current checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4
[0m17:34:52.664845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '38a5d4ba-15bd-45c2-ab8a-d4871017e7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff952d240>]}
[0m17:34:53.916582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38a5d4ba-15bd-45c2-ab8a-d4871017e7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7a7e290>]}
[0m17:34:53.931563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38a5d4ba-15bd-45c2-ab8a-d4871017e7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff935f520>]}
[0m17:34:53.932200 [info ] [MainThread]: Found 6 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m17:34:53.934060 [info ] [MainThread]: 
[0m17:34:53.935201 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:34:53.937551 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m17:34:53.938488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:53.939116 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m17:34:53.939834 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m17:34:53.942372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:53.971600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:55.388196 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_production'
[0m17:34:55.398603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:55.395658 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_dbt_staging)
[0m17:34:55.392508 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_dbt_abhishek_yadav)
[0m17:34:55.402635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:34:55.433883 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:34:56.099648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38a5d4ba-15bd-45c2-ab8a-d4871017e7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7a7f2e0>]}
[0m17:34:56.105565 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:34:56.108676 [info ] [MainThread]: 
[0m17:34:56.129835 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m17:34:56.131023 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
[0m17:34:56.131842 [debug] [Thread-3 (]: Began running node seed.taxi_rides_ny.taxi_zone_lookup
[0m17:34:56.133558 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_staging.stg_green_trip_data .................... [RUN]
[0m17:34:56.135431 [info ] [Thread-2 (]: 2 of 5 START sql view model dbt_abhishek_yadav.stg_yellow_trip_data ............ [RUN]
[0m17:34:56.137378 [info ] [Thread-3 (]: 3 of 5 START seed file dbt_staging.taxi_zone_lookup ............................ [RUN]
[0m17:34:56.139519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_production, now model.taxi_rides_ny.stg_green_trip_data)
[0m17:34:56.141249 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_abhishek_yadav, now model.taxi_rides_ny.stg_yellow_trip_data)
[0m17:34:56.142971 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_staging, now seed.taxi_rides_ny.taxi_zone_lookup)
[0m17:34:56.144194 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m17:34:56.145028 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
[0m17:34:56.145821 [debug] [Thread-3 (]: Began compiling node seed.taxi_rides_ny.taxi_zone_lookup
[0m17:34:56.160061 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m17:34:56.167344 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m17:34:56.168071 [debug] [Thread-3 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (compile): 17:34:56.167806 => 17:34:56.167810
[0m17:34:56.169520 [debug] [Thread-3 (]: Began executing node seed.taxi_rides_ny.taxi_zone_lookup
[0m17:34:56.182129 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 17:34:56.146443 => 17:34:56.181831
[0m17:34:56.184950 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (compile): 17:34:56.160809 => 17:34:56.184645
[0m17:34:56.186189 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m17:34:56.186782 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
[0m17:34:56.199163 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:34:56.229622 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_trip_data"
[0m17:34:56.230612 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m17:34:56.260215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:56.260896 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:34:56.262613 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
  OPTIONS()
  as select
-- identifiers

    
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
cast(trip_type as integer) as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(ehail_fee as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), lpep_pickup_datetime)=1
-- dbt-bq compile --select stg_green_trip_data --vars '{'is_test_run': 'false'}'

limit 100
;


[0m17:34:56.290628 [debug] [Thread-2 (]: On model.taxi_rides_ny.stg_yellow_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
  OPTIONS()
  as -- 

select
-- identifiers

    
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
TIMESTAMP_SECONDS(CAST(CAST(tpep_pickup_datetime as INT64)/10000000 AS INT64)) as pickup_datetime,
TIMESTAMP_SECONDS(CAST(CAST(tpep_dropoff_datetime as INT64)/10000000 AS INT64)) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
1 as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(0 as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`yello_trip_data`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), tpep_pickup_datetime)=1
-- dbt-bq run --select stg_green_tripdata  --var 'is_test_run: false'

limit 100
;


[0m17:34:57.110491 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:b5a1a4c5-cead-42bb-82b3-0955962b0df5&page=queryresults
[0m17:34:57.117183 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:4f822eb3-a861-4b9c-a0eb-ef3e636ed63e&page=queryresults
[0m17:34:57.452192 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (execute): 17:34:56.213559 => 17:34:57.451753
[0m17:34:57.454442 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38a5d4ba-15bd-45c2-ab8a-d4871017e7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7af78b0>]}
[0m17:34:57.456798 [info ] [Thread-2 (]: 2 of 5 OK created sql view model dbt_abhishek_yadav.stg_yellow_trip_data ....... [[32mCREATE VIEW (0 processed)[0m in 1.31s]
[0m17:34:57.458235 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
[0m17:34:57.468764 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 17:34:56.196755 => 17:34:57.468395
[0m17:34:57.470825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38a5d4ba-15bd-45c2-ab8a-d4871017e7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff793c970>]}
[0m17:34:57.472396 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_staging.stg_green_trip_data ............... [[32mCREATE VIEW (0 processed)[0m in 1.33s]
[0m17:34:57.473687 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m17:34:59.555231 [debug] [Thread-3 (]: On seed.taxi_rides_ny.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "seed.taxi_rides_ny.taxi_zone_lookup"} */

    alter table `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup` set OPTIONS()
  
[0m17:34:59.787819 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:00e88ccf-45c6-423c-9b96-7c9ba99e112b&page=queryresults
[0m17:35:00.494208 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.taxi_rides_ny.taxi_zone_lookup"
[0m17:35:00.502762 [debug] [Thread-3 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (execute): 17:34:56.169996 => 17:35:00.502312
[0m17:35:00.504701 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38a5d4ba-15bd-45c2-ab8a-d4871017e7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff79983a0>]}
[0m17:35:00.506174 [info ] [Thread-3 (]: 3 of 5 OK loaded seed file dbt_staging.taxi_zone_lookup ........................ [[32mINSERT 265[0m in 4.36s]
[0m17:35:00.507951 [debug] [Thread-3 (]: Finished running node seed.taxi_rides_ny.taxi_zone_lookup
[0m17:35:00.511583 [debug] [Thread-4 (]: Began running node model.taxi_rides_ny.dim_zones
[0m17:35:00.512846 [info ] [Thread-4 (]: 4 of 5 START sql table model production.dim_zones .............................. [RUN]
[0m17:35:00.514619 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now model.taxi_rides_ny.dim_zones)
[0m17:35:00.515633 [debug] [Thread-4 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m17:35:00.521739 [debug] [Thread-4 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m17:35:00.524766 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.dim_zones (compile): 17:35:00.516314 => 17:35:00.524265
[0m17:35:00.525550 [debug] [Thread-4 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m17:35:00.538236 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:35:01.165569 [debug] [Thread-4 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_zones"
[0m17:35:01.168678 [debug] [Thread-4 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */

  
    

    create or replace table `de-zoomcamp-413815`.`production`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      select 
locationid,
borough,
zone,
replace(service_zone, 'Boro', 'Green') as service_zone
from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
    );
  
[0m17:35:01.529205 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:12614c3a-fadc-4ff1-8492-1d3b8bdd79ad&page=queryresults
[0m17:35:02.947893 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.dim_zones (execute): 17:35:00.526046 => 17:35:02.947661
[0m17:35:02.949164 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38a5d4ba-15bd-45c2-ab8a-d4871017e7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7958e50>]}
[0m17:35:02.949992 [info ] [Thread-4 (]: 4 of 5 OK created sql table model production.dim_zones ......................... [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 2.44s]
[0m17:35:02.951037 [debug] [Thread-4 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m17:35:02.952103 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fact_trips
[0m17:35:02.953023 [info ] [Thread-1 (]: 5 of 5 START sql table model production.fact_trips ............................. [RUN]
[0m17:35:02.954046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_green_trip_data, now model.taxi_rides_ny.fact_trips)
[0m17:35:02.954721 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fact_trips
[0m17:35:02.959015 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fact_trips"
[0m17:35:02.961057 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.fact_trips (compile): 17:35:02.955120 => 17:35:02.960736
[0m17:35:02.961625 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fact_trips
[0m17:35:02.964331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:03.605508 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fact_trips"
[0m17:35:03.614234 [debug] [Thread-1 (]: On model.taxi_rides_ny.fact_trips: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.fact_trips"} */

  
    

    create or replace table `de-zoomcamp-413815`.`production`.`fact_trips`
      
    
    

    OPTIONS()
    as (
      with green_trip_data as(
    select *,
        'Green' as service_type
    from 
    `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
),

yellow_trip_data as(
    select *,
        'Yellow' as service_type
    from 
    `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
),

trips_unioned as(
    select * from green_trip_data
    union all
    select * from yellow_trip_data
),
dim_zones as (
    select * from `de-zoomcamp-413815`.`production`.`dim_zones`
    where borough <> 'Unknown'
)

select trips_unioned.tripid, 
    trips_unioned.vendorid, 
    trips_unioned.service_type,
    trips_unioned.ratecodeid, 
    trips_unioned.pickup_locationid, 
    pickup_zone.borough as pickup_borough, 
    pickup_zone.zone as pickup_zone, 
    trips_unioned.dropoff_locationid,
    dropoff_zone.borough as dropoff_borough, 
    dropoff_zone.zone as dropoff_zone,  
    trips_unioned.pickup_datetime, 
    trips_unioned.dropoff_datetime, 
    trips_unioned.store_and_fwd_flag, 
    trips_unioned.passenger_count, 
    trips_unioned.trip_distance, 
    trips_unioned.trip_type, 
    trips_unioned.fare_amount, 
    trips_unioned.extra, 
    trips_unioned.mta_tax, 
    trips_unioned.tip_amount, 
    trips_unioned.tolls_amount, 
    trips_unioned.ehail_fee, 
    trips_unioned.improvement_surcharge, 
    trips_unioned.total_amount, 
    trips_unioned.payment_type, 
    trips_unioned.payment_type_description
from trips_unioned
inner join dim_zones as pickup_zone
on (trips_unioned.pickup_locationid = pickup_zone.locationid)
inner join dim_zones as dropoff_zone
on (trips_unioned.dropoff_locationid = dropoff_zone.locationid)
    );
  
[0m17:35:04.374741 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:fcfbfbdc-346b-45e9-a496-1f7238352d12&page=queryresults
[0m17:35:07.523434 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.fact_trips (execute): 17:35:02.961963 => 17:35:07.522409
[0m17:35:07.527300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38a5d4ba-15bd-45c2-ab8a-d4871017e7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7958ee0>]}
[0m17:35:07.530369 [info ] [Thread-1 (]: 5 of 5 OK created sql table model production.fact_trips ........................ [[32mCREATE TABLE (195.0 rows, 276.2 MiB processed)[0m in 4.57s]
[0m17:35:07.533064 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fact_trips
[0m17:35:07.536384 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:35:07.537275 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_yellow_trip_data' was properly closed.
[0m17:35:07.538016 [debug] [MainThread]: Connection 'seed.taxi_rides_ny.taxi_zone_lookup' was properly closed.
[0m17:35:07.538769 [debug] [MainThread]: Connection 'model.taxi_rides_ny.dim_zones' was properly closed.
[0m17:35:07.539457 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fact_trips' was properly closed.
[0m17:35:07.540852 [info ] [MainThread]: 
[0m17:35:07.542061 [info ] [MainThread]: Finished running 2 view models, 1 seed, 2 table models in 0 hours 0 minutes and 13.61 seconds (13.61s).
[0m17:35:07.544563 [debug] [MainThread]: Command end result
[0m17:35:07.561672 [info ] [MainThread]: 
[0m17:35:07.562845 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:35:07.563721 [info ] [MainThread]: 
[0m17:35:07.564737 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:35:07.567546 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 15.484713, "process_user_time": 4.801054, "process_kernel_time": 0.370858, "process_mem_max_rss": "166428", "process_in_blocks": "1016", "process_out_blocks": "704"}
[0m17:35:07.569112 [debug] [MainThread]: Command `dbt build` succeeded at 17:35:07.568832 after 15.49 seconds
[0m17:35:07.570179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff952cf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff935f520>]}
[0m17:35:07.571152 [debug] [MainThread]: Flushing usage events
[0m17:40:23.919003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00dde0>]}


============================== 17:40:23.931950 | 6b2fb392-ccc4-4bf6-8dc9-893cbfe4eec9 ==============================
[0m17:40:23.931950 [info ] [MainThread]: Running with dbt=1.7.7
[0m17:40:23.933010 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select +fact_trips+ --vars {is_test_run: false}', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:40:24.322416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b2fb392-ccc4-4bf6-8dc9-893cbfe4eec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf06200>]}
[0m17:40:24.398589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b2fb392-ccc4-4bf6-8dc9-893cbfe4eec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9621600>]}
[0m17:40:24.399599 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m17:40:24.414540 [debug] [MainThread]: checksum: 7c46c391780f5adbba4aeed1bb0cabed7e089d22e9df17dd41bd89837fdfafae, vars: {'is_test_run': False}, profile: , target: , version: 1.7.7
[0m17:40:24.430381 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:40:24.431121 [debug] [MainThread]: previous checksum: 7c46c391780f5adbba4aeed1bb0cabed7e089d22e9df17dd41bd89837fdfafae, current checksum: 713bb41cda6ff42d2f265f6cf8353336cad0950a7997ab268d6104f27f0b933c
[0m17:40:24.431743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6b2fb392-ccc4-4bf6-8dc9-893cbfe4eec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff963eb30>]}
[0m17:40:25.683985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b2fb392-ccc4-4bf6-8dc9-893cbfe4eec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7a81c90>]}
[0m17:40:25.699455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b2fb392-ccc4-4bf6-8dc9-893cbfe4eec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff934aec0>]}
[0m17:40:25.700133 [info ] [MainThread]: Found 6 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m17:40:25.701990 [info ] [MainThread]: 
[0m17:40:25.703076 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:40:25.705320 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m17:40:25.706215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:25.706870 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m17:40:25.707655 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m17:40:25.708284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:25.737367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:28.031468 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_dbt_abhishek_yadav)
[0m17:40:28.034381 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_production)
[0m17:40:28.036768 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_dbt_staging)
[0m17:40:28.037767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:28.039191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:28.040472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:28.761025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b2fb392-ccc4-4bf6-8dc9-893cbfe4eec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7a82ce0>]}
[0m17:40:28.764772 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:40:28.766597 [info ] [MainThread]: 
[0m17:40:28.784450 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m17:40:28.785458 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
[0m17:40:28.786155 [debug] [Thread-3 (]: Began running node seed.taxi_rides_ny.taxi_zone_lookup
[0m17:40:28.787536 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_staging.stg_green_trip_data .................... [RUN]
[0m17:40:28.788784 [info ] [Thread-2 (]: 2 of 5 START sql view model dbt_abhishek_yadav.stg_yellow_trip_data ............ [RUN]
[0m17:40:28.790345 [info ] [Thread-3 (]: 3 of 5 START seed file dbt_staging.taxi_zone_lookup ............................ [RUN]
[0m17:40:28.792333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_staging, now model.taxi_rides_ny.stg_green_trip_data)
[0m17:40:28.793625 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_production, now model.taxi_rides_ny.stg_yellow_trip_data)
[0m17:40:28.794639 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_abhishek_yadav, now seed.taxi_rides_ny.taxi_zone_lookup)
[0m17:40:28.795633 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m17:40:28.796498 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
[0m17:40:28.797228 [debug] [Thread-3 (]: Began compiling node seed.taxi_rides_ny.taxi_zone_lookup
[0m17:40:28.811741 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m17:40:28.818497 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m17:40:28.819266 [debug] [Thread-3 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (compile): 17:40:28.819015 => 17:40:28.819019
[0m17:40:28.820470 [debug] [Thread-3 (]: Began executing node seed.taxi_rides_ny.taxi_zone_lookup
[0m17:40:28.835955 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 17:40:28.797827 => 17:40:28.835651
[0m17:40:28.837523 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (compile): 17:40:28.812402 => 17:40:28.837225
[0m17:40:28.838023 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m17:40:28.849018 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:40:28.849377 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
[0m17:40:28.875556 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_trip_data"
[0m17:40:28.878864 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m17:40:28.908552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:28.909308 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:40:28.911106 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
  OPTIONS()
  as select
-- identifiers

    
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
cast(trip_type as integer) as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(ehail_fee as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), lpep_pickup_datetime)=1
-- dbt-bq compile --select stg_green_trip_data --vars '{'is_test_run': 'false'}'
;


[0m17:40:28.938641 [debug] [Thread-2 (]: On model.taxi_rides_ny.stg_yellow_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
  OPTIONS()
  as -- 

select
-- identifiers

    
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
TIMESTAMP_SECONDS(CAST(CAST(tpep_pickup_datetime as INT64)/10000000 AS INT64)) as pickup_datetime,
TIMESTAMP_SECONDS(CAST(CAST(tpep_dropoff_datetime as INT64)/10000000 AS INT64)) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
1 as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(0 as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`yello_trip_data`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), tpep_pickup_datetime)=1
-- dbt-bq run --select stg_green_tripdata  --var 'is_test_run: false'
;


[0m17:40:29.756936 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:9c5a7c74-d958-4160-8cfb-1634caebf88d&page=queryresults
[0m17:40:29.826718 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:fd368453-076c-45a7-b12f-6897bdd52aec&page=queryresults
[0m17:40:30.138542 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (execute): 17:40:28.875955 => 17:40:30.138284
[0m17:40:30.141243 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 17:40:28.849815 => 17:40:30.141042
[0m17:40:30.142032 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b2fb392-ccc4-4bf6-8dc9-893cbfe4eec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7955270>]}
[0m17:40:30.143037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b2fb392-ccc4-4bf6-8dc9-893cbfe4eec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7a8fb80>]}
[0m17:40:30.144210 [info ] [Thread-2 (]: 2 of 5 OK created sql view model dbt_abhishek_yadav.stg_yellow_trip_data ....... [[32mCREATE VIEW (0 processed)[0m in 1.35s]
[0m17:40:30.144876 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_staging.stg_green_trip_data ............... [[32mCREATE VIEW (0 processed)[0m in 1.35s]
[0m17:40:30.145798 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
[0m17:40:30.146433 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m17:40:32.279539 [debug] [Thread-3 (]: On seed.taxi_rides_ny.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "seed.taxi_rides_ny.taxi_zone_lookup"} */

    alter table `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup` set OPTIONS()
  
[0m17:40:32.789735 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:72fc628f-d46e-4f80-aa71-d241b10f7595&page=queryresults
[0m17:40:33.148009 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.taxi_rides_ny.taxi_zone_lookup"
[0m17:40:33.158188 [debug] [Thread-3 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (execute): 17:40:28.821070 => 17:40:33.157740
[0m17:40:33.160262 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b2fb392-ccc4-4bf6-8dc9-893cbfe4eec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff790b760>]}
[0m17:40:33.161762 [info ] [Thread-3 (]: 3 of 5 OK loaded seed file dbt_staging.taxi_zone_lookup ........................ [[32mINSERT 265[0m in 4.37s]
[0m17:40:33.163513 [debug] [Thread-3 (]: Finished running node seed.taxi_rides_ny.taxi_zone_lookup
[0m17:40:33.166853 [debug] [Thread-4 (]: Began running node model.taxi_rides_ny.dim_zones
[0m17:40:33.168063 [info ] [Thread-4 (]: 4 of 5 START sql table model production.dim_zones .............................. [RUN]
[0m17:40:33.169868 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.dim_zones'
[0m17:40:33.170848 [debug] [Thread-4 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m17:40:33.176559 [debug] [Thread-4 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m17:40:33.179632 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.dim_zones (compile): 17:40:33.171492 => 17:40:33.179216
[0m17:40:33.180402 [debug] [Thread-4 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m17:40:33.196103 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:40:33.869899 [debug] [Thread-4 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_zones"
[0m17:40:33.878661 [debug] [Thread-4 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */

  
    

    create or replace table `de-zoomcamp-413815`.`production`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      select 
locationid,
borough,
zone,
replace(service_zone, 'Boro', 'Green') as service_zone
from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
    );
  
[0m17:40:34.230935 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:eb09fc3f-e0bb-4f5e-84db-c504d2371c67&page=queryresults
[0m17:40:35.692649 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.dim_zones (execute): 17:40:33.181014 => 17:40:35.691726
[0m17:40:35.699939 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b2fb392-ccc4-4bf6-8dc9-893cbfe4eec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7909ab0>]}
[0m17:40:35.702629 [info ] [Thread-4 (]: 4 of 5 OK created sql table model production.dim_zones ......................... [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 2.53s]
[0m17:40:35.704746 [debug] [Thread-4 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m17:40:35.706526 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fact_trips
[0m17:40:35.707952 [info ] [Thread-1 (]: 5 of 5 START sql table model production.fact_trips ............................. [RUN]
[0m17:40:35.709776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_green_trip_data, now model.taxi_rides_ny.fact_trips)
[0m17:40:35.711131 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fact_trips
[0m17:40:35.718956 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fact_trips"
[0m17:40:35.722707 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.fact_trips (compile): 17:40:35.712212 => 17:40:35.722202
[0m17:40:35.723751 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fact_trips
[0m17:40:35.728885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:36.346979 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fact_trips"
[0m17:40:36.356807 [debug] [Thread-1 (]: On model.taxi_rides_ny.fact_trips: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.fact_trips"} */

  
    

    create or replace table `de-zoomcamp-413815`.`production`.`fact_trips`
      
    
    

    OPTIONS()
    as (
      with green_trip_data as(
    select *,
        'Green' as service_type
    from 
    `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
),

yellow_trip_data as(
    select *,
        'Yellow' as service_type
    from 
    `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
),

trips_unioned as(
    select * from green_trip_data
    union all
    select * from yellow_trip_data
),
dim_zones as (
    select * from `de-zoomcamp-413815`.`production`.`dim_zones`
    where borough <> 'Unknown'
)

select trips_unioned.tripid, 
    trips_unioned.vendorid, 
    trips_unioned.service_type,
    trips_unioned.ratecodeid, 
    trips_unioned.pickup_locationid, 
    pickup_zone.borough as pickup_borough, 
    pickup_zone.zone as pickup_zone, 
    trips_unioned.dropoff_locationid,
    dropoff_zone.borough as dropoff_borough, 
    dropoff_zone.zone as dropoff_zone,  
    trips_unioned.pickup_datetime, 
    trips_unioned.dropoff_datetime, 
    trips_unioned.store_and_fwd_flag, 
    trips_unioned.passenger_count, 
    trips_unioned.trip_distance, 
    trips_unioned.trip_type, 
    trips_unioned.fare_amount, 
    trips_unioned.extra, 
    trips_unioned.mta_tax, 
    trips_unioned.tip_amount, 
    trips_unioned.tolls_amount, 
    trips_unioned.ehail_fee, 
    trips_unioned.improvement_surcharge, 
    trips_unioned.total_amount, 
    trips_unioned.payment_type, 
    trips_unioned.payment_type_description
from trips_unioned
inner join dim_zones as pickup_zone
on (trips_unioned.pickup_locationid = pickup_zone.locationid)
inner join dim_zones as dropoff_zone
on (trips_unioned.dropoff_locationid = dropoff_zone.locationid)
    );
  
[0m17:40:37.098664 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:1f0a920a-bf00-4b15-8e73-3863cd35e56e&page=queryresults
[0m17:40:40.980355 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.fact_trips (execute): 17:40:35.724516 => 17:40:40.977072
[0m17:40:40.986484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b2fb392-ccc4-4bf6-8dc9-893cbfe4eec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fffaef17dc0>]}
[0m17:40:40.993092 [info ] [Thread-1 (]: 5 of 5 OK created sql table model production.fact_trips ........................ [[32mCREATE TABLE (1.8m rows, 276.2 MiB processed)[0m in 5.28s]
[0m17:40:40.995942 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fact_trips
[0m17:40:41.001366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:40:41.002853 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fact_trips' was properly closed.
[0m17:40:41.004050 [debug] [MainThread]: Connection 'seed.taxi_rides_ny.taxi_zone_lookup' was properly closed.
[0m17:40:41.005073 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_yellow_trip_data' was properly closed.
[0m17:40:41.006060 [debug] [MainThread]: Connection 'model.taxi_rides_ny.dim_zones' was properly closed.
[0m17:40:41.007825 [info ] [MainThread]: 
[0m17:40:41.009853 [info ] [MainThread]: Finished running 2 view models, 1 seed, 2 table models in 0 hours 0 minutes and 15.30 seconds (15.30s).
[0m17:40:41.013906 [debug] [MainThread]: Command end result
[0m17:40:41.038306 [info ] [MainThread]: 
[0m17:40:41.039520 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:40:41.040356 [info ] [MainThread]: 
[0m17:40:41.041619 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:40:41.044669 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 17.183485, "process_user_time": 4.934181, "process_kernel_time": 0.311728, "process_mem_max_rss": "164844", "process_in_blocks": "2584", "process_out_blocks": "704"}
[0m17:40:41.045815 [debug] [MainThread]: Command `dbt build` succeeded at 17:40:41.045622 after 17.19 seconds
[0m17:40:41.046425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff79e3580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff934aec0>]}
[0m17:40:41.047038 [debug] [MainThread]: Flushing usage events
[0m17:41:28.069235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00ef20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f8e0>]}


============================== 17:41:28.081340 | 899bf695-f6ff-431a-8227-2b7ec80084c8 ==============================
[0m17:41:28.081340 [info ] [MainThread]: Running with dbt=1.7.7
[0m17:41:28.082358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile --select +fact_trips+ --vars {is_test_run: false}', 'send_anonymous_usage_stats': 'True'}
[0m17:41:28.453750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '899bf695-f6ff-431a-8227-2b7ec80084c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc6f2560>]}
[0m17:41:28.526039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '899bf695-f6ff-431a-8227-2b7ec80084c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95ef5b0>]}
[0m17:41:28.527046 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m17:41:28.540994 [debug] [MainThread]: checksum: 7c46c391780f5adbba4aeed1bb0cabed7e089d22e9df17dd41bd89837fdfafae, vars: {'is_test_run': False}, profile: , target: , version: 1.7.7
[0m17:41:28.604167 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:41:28.604683 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:41:28.610467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '899bf695-f6ff-431a-8227-2b7ec80084c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92ac3d0>]}
[0m17:41:28.623669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '899bf695-f6ff-431a-8227-2b7ec80084c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9265a20>]}
[0m17:41:28.624271 [info ] [MainThread]: Found 6 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m17:41:28.624815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '899bf695-f6ff-431a-8227-2b7ec80084c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9267580>]}
[0m17:41:28.626632 [info ] [MainThread]: 
[0m17:41:28.627788 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:41:28.630522 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_production'
[0m17:41:28.631500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:28.632315 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_dbt_staging'
[0m17:41:28.633214 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_dbt_abhishek_yadav'
[0m17:41:28.635618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:28.663537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:29.461249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '899bf695-f6ff-431a-8227-2b7ec80084c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92655a0>]}
[0m17:41:29.464788 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:41:29.466451 [info ] [MainThread]: 
[0m17:41:29.483170 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m17:41:29.484053 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
[0m17:41:29.485058 [debug] [Thread-3 (]: Began running node seed.taxi_rides_ny.taxi_zone_lookup
[0m17:41:29.486855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_production, now model.taxi_rides_ny.stg_green_trip_data)
[0m17:41:29.488395 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_abhishek_yadav, now model.taxi_rides_ny.stg_yellow_trip_data)
[0m17:41:29.489718 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_staging, now seed.taxi_rides_ny.taxi_zone_lookup)
[0m17:41:29.490532 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m17:41:29.491347 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
[0m17:41:29.492094 [debug] [Thread-3 (]: Began compiling node seed.taxi_rides_ny.taxi_zone_lookup
[0m17:41:29.520345 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m17:41:29.529212 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m17:41:29.531204 [debug] [Thread-3 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (compile): 17:41:29.529475 => 17:41:29.530963
[0m17:41:29.532652 [debug] [Thread-3 (]: Began executing node seed.taxi_rides_ny.taxi_zone_lookup
[0m17:41:29.533428 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 17:41:29.492715 => 17:41:29.533200
[0m17:41:29.533814 [debug] [Thread-3 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (execute): 17:41:29.533618 => 17:41:29.533634
[0m17:41:29.534258 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (compile): 17:41:29.511998 => 17:41:29.534066
[0m17:41:29.534673 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m17:41:29.535835 [debug] [Thread-3 (]: Finished running node seed.taxi_rides_ny.taxi_zone_lookup
[0m17:41:29.536353 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
[0m17:41:29.536884 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 17:41:29.536687 => 17:41:29.536694
[0m17:41:29.537661 [debug] [Thread-4 (]: Began running node model.taxi_rides_ny.dim_zones
[0m17:41:29.538121 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (execute): 17:41:29.537902 => 17:41:29.537911
[0m17:41:29.539070 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m17:41:29.539809 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.dim_zones'
[0m17:41:29.540713 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
[0m17:41:29.541363 [debug] [Thread-4 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m17:41:29.544325 [debug] [Thread-4 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m17:41:29.545833 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.dim_zones (compile): 17:41:29.541861 => 17:41:29.545574
[0m17:41:29.546301 [debug] [Thread-4 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m17:41:29.546799 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.dim_zones (execute): 17:41:29.546607 => 17:41:29.546616
[0m17:41:29.547676 [debug] [Thread-4 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m17:41:29.549287 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.fact_trips
[0m17:41:29.550034 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.taxi_rides_ny.taxi_zone_lookup, now model.taxi_rides_ny.fact_trips)
[0m17:41:29.550500 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.fact_trips
[0m17:41:29.553912 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.fact_trips"
[0m17:41:29.555144 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.fact_trips (compile): 17:41:29.550823 => 17:41:29.554933
[0m17:41:29.555589 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.fact_trips
[0m17:41:29.556227 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.fact_trips (execute): 17:41:29.555962 => 17:41:29.555975
[0m17:41:29.557325 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.fact_trips
[0m17:41:29.558507 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:41:29.558930 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_green_trip_data' was properly closed.
[0m17:41:29.559294 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fact_trips' was properly closed.
[0m17:41:29.559632 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_yellow_trip_data' was properly closed.
[0m17:41:29.559960 [debug] [MainThread]: Connection 'model.taxi_rides_ny.dim_zones' was properly closed.
[0m17:41:29.561041 [debug] [MainThread]: Command end result
[0m17:41:29.570562 [debug] [MainThread]: Excluded node 'taxi_zone_lookup' from results
[0m17:41:29.571018 [debug] [MainThread]: Excluded node 'stg_green_trip_data' from results
[0m17:41:29.571452 [debug] [MainThread]: Excluded node 'stg_yellow_trip_data' from results
[0m17:41:29.571827 [debug] [MainThread]: Excluded node 'dim_zones' from results
[0m17:41:29.572288 [info ] [MainThread]: Compiled node 'fact_trips' is:
with green_trip_data as(
    select *,
        'Green' as service_type
    from 
    `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
),

yellow_trip_data as(
    select *,
        'Yellow' as service_type
    from 
    `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
),

trips_unioned as(
    select * from green_trip_data
    union all
    select * from yellow_trip_data
),
dim_zones as (
    select * from `de-zoomcamp-413815`.`production`.`dim_zones`
    where borough <> 'Unknown'
)

select trips_unioned.tripid, 
    trips_unioned.vendorid, 
    trips_unioned.service_type,
    trips_unioned.ratecodeid, 
    trips_unioned.pickup_locationid, 
    pickup_zone.borough as pickup_borough, 
    pickup_zone.zone as pickup_zone, 
    trips_unioned.dropoff_locationid,
    dropoff_zone.borough as dropoff_borough, 
    dropoff_zone.zone as dropoff_zone,  
    trips_unioned.pickup_datetime, 
    trips_unioned.dropoff_datetime, 
    trips_unioned.store_and_fwd_flag, 
    trips_unioned.passenger_count, 
    trips_unioned.trip_distance, 
    trips_unioned.trip_type, 
    trips_unioned.fare_amount, 
    trips_unioned.extra, 
    trips_unioned.mta_tax, 
    trips_unioned.tip_amount, 
    trips_unioned.tolls_amount, 
    trips_unioned.ehail_fee, 
    trips_unioned.improvement_surcharge, 
    trips_unioned.total_amount, 
    trips_unioned.payment_type, 
    trips_unioned.payment_type_description
from trips_unioned
inner join dim_zones as pickup_zone
on (trips_unioned.pickup_locationid = pickup_zone.locationid)
inner join dim_zones as dropoff_zone
on (trips_unioned.dropoff_locationid = dropoff_zone.locationid)
[0m17:41:29.574222 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.5594207, "process_user_time": 2.581684, "process_kernel_time": 0.149155, "process_mem_max_rss": "146696", "process_out_blocks": "704", "process_in_blocks": "0"}
[0m17:41:29.575057 [debug] [MainThread]: Command `dbt compile` succeeded at 17:41:29.574842 after 1.56 seconds
[0m17:41:29.575574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91718a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc6f2560>]}
[0m17:41:29.576049 [debug] [MainThread]: Flushing usage events
[0m17:45:00.304498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00dc00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00dba0>]}


============================== 17:45:00.316639 | 60564ab0-21e4-40d3-b133-6836cf138bf4 ==============================
[0m17:45:00.316639 [info ] [MainThread]: Running with dbt=1.7.7
[0m17:45:00.317561 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select +fact_trips+ --vars {is_test_run: false}', 'send_anonymous_usage_stats': 'True'}
[0m17:45:00.686438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60564ab0-21e4-40d3-b133-6836cf138bf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00e5c0>]}
[0m17:45:00.761415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60564ab0-21e4-40d3-b133-6836cf138bf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9415c00>]}
[0m17:45:00.762392 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m17:45:00.778387 [debug] [MainThread]: checksum: 7c46c391780f5adbba4aeed1bb0cabed7e089d22e9df17dd41bd89837fdfafae, vars: {'is_test_run': False}, profile: , target: , version: 1.7.7
[0m17:45:00.844814 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:45:00.845355 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:45:00.851506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60564ab0-21e4-40d3-b133-6836cf138bf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92b3d90>]}
[0m17:45:00.865181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60564ab0-21e4-40d3-b133-6836cf138bf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9261c60>]}
[0m17:45:00.865768 [info ] [MainThread]: Found 6 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 561 macros, 0 groups, 0 semantic models
[0m17:45:00.866260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60564ab0-21e4-40d3-b133-6836cf138bf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9261d50>]}
[0m17:45:00.867935 [info ] [MainThread]: 
[0m17:45:00.868991 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:45:00.871555 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m17:45:00.872318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:00.872937 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m17:45:00.873672 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m17:45:00.876578 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:00.904731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:02.326943 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_dbt_staging)
[0m17:45:02.329640 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_production)
[0m17:45:02.330798 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_dbt_abhishek_yadav)
[0m17:45:02.331476 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:02.331997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:02.332455 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:03.027382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60564ab0-21e4-40d3-b133-6836cf138bf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9247af0>]}
[0m17:45:03.030651 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:45:03.032277 [info ] [MainThread]: 
[0m17:45:03.052146 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.dim_zones
[0m17:45:03.053026 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m17:45:03.053652 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
[0m17:45:03.055167 [info ] [Thread-1 (]: 1 of 4 START sql table model production.dim_zones .............................. [RUN]
[0m17:45:03.056614 [info ] [Thread-2 (]: 2 of 4 START sql view model dbt_staging.stg_green_trip_data .................... [RUN]
[0m17:45:03.057993 [info ] [Thread-3 (]: 3 of 4 START sql view model dbt_abhishek_yadav.stg_yellow_trip_data ............ [RUN]
[0m17:45:03.059287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_production, now model.taxi_rides_ny.dim_zones)
[0m17:45:03.060300 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_abhishek_yadav, now model.taxi_rides_ny.stg_green_trip_data)
[0m17:45:03.061593 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_staging, now model.taxi_rides_ny.stg_yellow_trip_data)
[0m17:45:03.062444 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m17:45:03.063173 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m17:45:03.063878 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
[0m17:45:03.075118 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m17:45:03.102287 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m17:45:03.107009 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m17:45:03.110125 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.dim_zones (compile): 17:45:03.064467 => 17:45:03.109850
[0m17:45:03.110527 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 17:45:03.075743 => 17:45:03.110323
[0m17:45:03.110905 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (compile): 17:45:03.102580 => 17:45:03.110711
[0m17:45:03.111363 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m17:45:03.111855 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m17:45:03.112299 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
[0m17:45:03.125394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:03.151891 [debug] [Thread-3 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m17:45:03.152199 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_trip_data"
[0m17:45:03.181918 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:45:03.182934 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:45:03.184610 [debug] [Thread-3 (]: On model.taxi_rides_ny.stg_yellow_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
  OPTIONS()
  as -- 

select
-- identifiers

    
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
TIMESTAMP_SECONDS(CAST(CAST(tpep_pickup_datetime as INT64)/10000000 AS INT64)) as pickup_datetime,
TIMESTAMP_SECONDS(CAST(CAST(tpep_dropoff_datetime as INT64)/10000000 AS INT64)) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
1 as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(0 as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`yello_trip_data`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), tpep_pickup_datetime)=1
-- dbt-bq run --select stg_green_tripdata  --var 'is_test_run: false'
;


[0m17:45:03.186737 [debug] [Thread-2 (]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
  OPTIONS()
  as select
-- identifiers

    
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
cast(trip_type as integer) as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(ehail_fee as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), lpep_pickup_datetime)=1
-- dbt-bq compile --select stg_green_trip_data --vars '{'is_test_run': 'false'}'
;


[0m17:45:03.864365 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_zones"
[0m17:45:03.867986 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */

  
    

    create or replace table `de-zoomcamp-413815`.`production`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      select 
locationid,
borough,
zone,
replace(service_zone, 'Boro', 'Green') as service_zone
from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
    );
  
[0m17:45:04.006214 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:94999fc9-f24a-4d2b-82b3-17b24f58707a&page=queryresults
[0m17:45:04.126360 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:01cab7e5-9e7f-403f-82d9-e59c70eaa62a&page=queryresults
[0m17:45:04.219389 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:97a9ac93-750c-4f9a-9c6f-f29634f94a97&page=queryresults
[0m17:45:04.320858 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (execute): 17:45:03.148629 => 17:45:04.320387
[0m17:45:04.323109 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60564ab0-21e4-40d3-b133-6836cf138bf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9173d30>]}
[0m17:45:04.325391 [info ] [Thread-3 (]: 3 of 4 OK created sql view model dbt_abhishek_yadav.stg_yellow_trip_data ....... [[32mCREATE VIEW (0 processed)[0m in 1.26s]
[0m17:45:04.329090 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
[0m17:45:04.497551 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 17:45:03.125938 => 17:45:04.496742
[0m17:45:04.500796 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60564ab0-21e4-40d3-b133-6836cf138bf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91a11e0>]}
[0m17:45:04.502963 [info ] [Thread-2 (]: 2 of 4 OK created sql view model dbt_staging.stg_green_trip_data ............... [[32mCREATE VIEW (0 processed)[0m in 1.44s]
[0m17:45:04.505009 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m17:45:05.752196 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.dim_zones (execute): 17:45:03.112622 => 17:45:05.751899
[0m17:45:05.754007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60564ab0-21e4-40d3-b133-6836cf138bf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91940d0>]}
[0m17:45:05.754929 [info ] [Thread-1 (]: 1 of 4 OK created sql table model production.dim_zones ......................... [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 2.70s]
[0m17:45:05.756040 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m17:45:05.758084 [debug] [Thread-4 (]: Began running node model.taxi_rides_ny.fact_trips
[0m17:45:05.758818 [info ] [Thread-4 (]: 4 of 4 START sql table model production.fact_trips ............................. [RUN]
[0m17:45:05.760048 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.fact_trips'
[0m17:45:05.760671 [debug] [Thread-4 (]: Began compiling node model.taxi_rides_ny.fact_trips
[0m17:45:05.765428 [debug] [Thread-4 (]: Writing injected SQL for node "model.taxi_rides_ny.fact_trips"
[0m17:45:05.768601 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.fact_trips (compile): 17:45:05.761105 => 17:45:05.768259
[0m17:45:05.769404 [debug] [Thread-4 (]: Began executing node model.taxi_rides_ny.fact_trips
[0m17:45:05.773106 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:45:06.447817 [debug] [Thread-4 (]: Writing runtime sql for node "model.taxi_rides_ny.fact_trips"
[0m17:45:06.449984 [debug] [Thread-4 (]: On model.taxi_rides_ny.fact_trips: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.fact_trips"} */

  
    

    create or replace table `de-zoomcamp-413815`.`production`.`fact_trips`
      
    
    

    OPTIONS()
    as (
      with green_trip_data as(
    select *,
        'Green' as service_type
    from 
    `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
),

yellow_trip_data as(
    select *,
        'Yellow' as service_type
    from 
    `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
),

trips_unioned as(
    select * from green_trip_data
    union all
    select * from yellow_trip_data
),
dim_zones as (
    select * from `de-zoomcamp-413815`.`production`.`dim_zones`
    where borough <> 'Unknown'
)

select trips_unioned.tripid, 
    trips_unioned.vendorid, 
    trips_unioned.service_type,
    trips_unioned.ratecodeid, 
    trips_unioned.pickup_locationid, 
    pickup_zone.borough as pickup_borough, 
    pickup_zone.zone as pickup_zone, 
    trips_unioned.dropoff_locationid,
    dropoff_zone.borough as dropoff_borough, 
    dropoff_zone.zone as dropoff_zone,  
    trips_unioned.pickup_datetime, 
    trips_unioned.dropoff_datetime, 
    trips_unioned.store_and_fwd_flag, 
    trips_unioned.passenger_count, 
    trips_unioned.trip_distance, 
    trips_unioned.trip_type, 
    trips_unioned.fare_amount, 
    trips_unioned.extra, 
    trips_unioned.mta_tax, 
    trips_unioned.tip_amount, 
    trips_unioned.tolls_amount, 
    trips_unioned.ehail_fee, 
    trips_unioned.improvement_surcharge, 
    trips_unioned.total_amount, 
    trips_unioned.payment_type, 
    trips_unioned.payment_type_description
from trips_unioned
inner join dim_zones as pickup_zone
on (trips_unioned.pickup_locationid = pickup_zone.locationid)
inner join dim_zones as dropoff_zone
on (trips_unioned.dropoff_locationid = dropoff_zone.locationid)
    );
  
[0m17:45:07.334202 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:b24b1ed4-59cf-404d-80a3-71f9fe8c8ed3&page=queryresults
[0m17:45:11.222153 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.fact_trips (execute): 17:45:05.769924 => 17:45:11.221055
[0m17:45:11.228043 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60564ab0-21e4-40d3-b133-6836cf138bf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9261a50>]}
[0m17:45:11.231586 [info ] [Thread-4 (]: 4 of 4 OK created sql table model production.fact_trips ........................ [[32mCREATE TABLE (1.8m rows, 276.2 MiB processed)[0m in 5.47s]
[0m17:45:11.235136 [debug] [Thread-4 (]: Finished running node model.taxi_rides_ny.fact_trips
[0m17:45:11.240905 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:11.242576 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_green_trip_data' was properly closed.
[0m17:45:11.244183 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_yellow_trip_data' was properly closed.
[0m17:45:11.245286 [debug] [MainThread]: Connection 'model.taxi_rides_ny.dim_zones' was properly closed.
[0m17:45:11.246318 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fact_trips' was properly closed.
[0m17:45:11.247729 [info ] [MainThread]: 
[0m17:45:11.248820 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 10.38 seconds (10.38s).
[0m17:45:11.251175 [debug] [MainThread]: Command end result
[0m17:45:11.277726 [info ] [MainThread]: 
[0m17:45:11.278653 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:45:11.279473 [info ] [MainThread]: 
[0m17:45:11.280393 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:45:11.282446 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.032342, "process_user_time": 3.451734, "process_kernel_time": 0.272505, "process_mem_max_rss": "154572", "process_out_blocks": "704", "process_in_blocks": "0"}
[0m17:45:11.283500 [debug] [MainThread]: Command `dbt run` succeeded at 17:45:11.283310 after 11.03 seconds
[0m17:45:11.284429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95e8ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95e9180>]}
[0m17:45:11.285286 [debug] [MainThread]: Flushing usage events
[0m00:44:18.013556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00da50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d1e0>]}


============================== 00:44:18.026331 | b4e8705e-d4fb-4d3a-b97e-f40daaae71e2 ==============================
[0m00:44:18.026331 [info ] [MainThread]: Running with dbt=1.7.7
[0m00:44:18.027275 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:44:18.105294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4e8705e-d4fb-4d3a-b97e-f40daaae71e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf0f100>]}
[0m00:44:18.111955 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-otse3iz_'
[0m00:44:18.112792 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m00:44:18.313225 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m00:44:18.316898 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m00:44:18.398613 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m00:44:18.406701 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m00:44:18.914890 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m00:44:18.959687 [info ] [MainThread]: Updating lock file in file path: /usr/app/dbt/package-lock.yml
[0m00:44:19.034814 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-3r8m5m3v'
[0m00:44:19.040420 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m00:44:19.868867 [info ] [MainThread]: Installed from version 1.0.0
[0m00:44:19.869647 [info ] [MainThread]: Updated version available: 1.1.1
[0m00:44:19.870245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b4e8705e-d4fb-4d3a-b97e-f40daaae71e2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffae02d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffae03820>]}
[0m00:44:19.870775 [info ] [MainThread]: Installing dbt-labs/codegen
[0m00:44:20.599293 [info ] [MainThread]: Installed from version 0.12.1
[0m00:44:20.600709 [info ] [MainThread]: Up to date!
[0m00:44:20.601836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b4e8705e-d4fb-4d3a-b97e-f40daaae71e2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffae02380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffae00280>]}
[0m00:44:20.602612 [info ] [MainThread]: 
[0m00:44:20.603625 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m00:44:20.606331 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.6477108, "process_user_time": 2.112826, "process_kernel_time": 0.26751, "process_mem_max_rss": "107096", "process_in_blocks": "72", "process_out_blocks": "864"}
[0m00:44:20.607340 [debug] [MainThread]: Command `dbt deps` succeeded at 00:44:20.607023 after 2.65 seconds
[0m00:44:20.607972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00ea40>]}
[0m00:44:20.608905 [debug] [MainThread]: Flushing usage events
[0m00:50:16.783382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb0127d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb011240>]}


============================== 00:50:16.795256 | 8c8e9468-0ec0-4b77-bd99-9e3607664749 ==============================
[0m00:50:16.795256 [info ] [MainThread]: Running with dbt=1.7.7
[0m00:50:16.796371 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run-operation generate_model_yaml', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:50:17.186408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c8e9468-0ec0-4b77-bd99-9e3607664749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff961ab30>]}
[0m00:50:17.259668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c8e9468-0ec0-4b77-bd99-9e3607664749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb7340>]}
[0m00:50:17.260551 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m00:50:17.280491 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m00:50:17.296945 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:50:17.297663 [debug] [MainThread]: previous checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, current checksum: 7c46c391780f5adbba4aeed1bb0cabed7e089d22e9df17dd41bd89837fdfafae
[0m00:50:17.298147 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m00:50:17.298860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8c8e9468-0ec0-4b77-bd99-9e3607664749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95e5240>]}
[0m00:50:18.634467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c8e9468-0ec0-4b77-bd99-9e3607664749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7ade6e0>]}
[0m00:50:18.649585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c8e9468-0ec0-4b77-bd99-9e3607664749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff93ce950>]}
[0m00:50:18.650182 [info ] [MainThread]: Found 6 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 583 macros, 0 groups, 0 semantic models
[0m00:50:18.650685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c8e9468-0ec0-4b77-bd99-9e3607664749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9562800>]}
[0m00:50:18.651801 [debug] [MainThread]: Acquiring new bigquery connection 'macro_generate_model_yaml'
[0m00:50:18.664893 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 1.9364744, "process_user_time": 3.477443, "process_kernel_time": 0.135172, "process_mem_max_rss": "142768", "process_in_blocks": "16", "process_out_blocks": "648"}
[0m00:50:18.666016 [debug] [MainThread]: Command `dbt run-operation` succeeded at 00:50:18.665792 after 1.94 seconds
[0m00:50:18.666507 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m00:50:18.666965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7adea10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9301750>]}
[0m00:50:18.667478 [debug] [MainThread]: Flushing usage events
[0m00:51:06.664029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00da20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d1e0>]}


============================== 00:51:06.675671 | 380c63d7-24c9-4ad8-b30a-e4ad12a05c0f ==============================
[0m00:51:06.675671 [info ] [MainThread]: Running with dbt=1.7.7
[0m00:51:06.676633 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run-operation generate_model_yaml', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:51:07.037663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '380c63d7-24c9-4ad8-b30a-e4ad12a05c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc6dfb50>]}
[0m00:51:07.109962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '380c63d7-24c9-4ad8-b30a-e4ad12a05c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95ea860>]}
[0m00:51:07.110874 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m00:51:07.129434 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m00:51:07.201179 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:51:07.201783 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:51:07.208175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '380c63d7-24c9-4ad8-b30a-e4ad12a05c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92c40d0>]}
[0m00:51:07.222766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '380c63d7-24c9-4ad8-b30a-e4ad12a05c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9281b10>]}
[0m00:51:07.223363 [info ] [MainThread]: Found 6 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 583 macros, 0 groups, 0 semantic models
[0m00:51:07.223895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '380c63d7-24c9-4ad8-b30a-e4ad12a05c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9281e40>]}
[0m00:51:07.225002 [debug] [MainThread]: Acquiring new bigquery connection 'macro_generate_model_yaml'
[0m00:51:07.237608 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 0.62806344, "process_user_time": 2.234995, "process_kernel_time": 0.116416, "process_mem_max_rss": "134160", "process_out_blocks": "648", "process_in_blocks": "0"}
[0m00:51:07.238423 [debug] [MainThread]: Command `dbt run-operation` succeeded at 00:51:07.238225 after 0.63 seconds
[0m00:51:07.238836 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m00:51:07.239249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95ea860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9281900>]}
[0m00:51:07.239700 [debug] [MainThread]: Flushing usage events
[0m00:53:51.854760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00fac0>]}


============================== 00:53:51.868382 | 6f73b618-fe44-4cb7-b65a-04869ca91496 ==============================
[0m00:53:51.868382 [info ] [MainThread]: Running with dbt=1.7.7
[0m00:53:51.869389 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile --select generate_model_yaml', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:53:52.235153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f73b618-fe44-4cb7-b65a-04869ca91496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00ecb0>]}
[0m00:53:52.308157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f73b618-fe44-4cb7-b65a-04869ca91496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff941fb50>]}
[0m00:53:52.309124 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m00:53:52.327511 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m00:53:52.400164 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:53:52.400734 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:53:52.406783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f73b618-fe44-4cb7-b65a-04869ca91496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92c80d0>]}
[0m00:53:52.420573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f73b618-fe44-4cb7-b65a-04869ca91496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92896f0>]}
[0m00:53:52.421161 [info ] [MainThread]: Found 6 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 583 macros, 0 groups, 0 semantic models
[0m00:53:52.421678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f73b618-fe44-4cb7-b65a-04869ca91496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9289360>]}
[0m00:53:52.422502 [warn ] [MainThread]: The selection criterion 'generate_model_yaml' does not match any nodes
[0m00:53:52.423570 [info ] [MainThread]: 
[0m00:53:52.424083 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:53:52.424786 [debug] [MainThread]: Command end result
[0m00:53:52.435363 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.63842726, "process_user_time": 2.201718, "process_kernel_time": 0.116772, "process_mem_max_rss": "134420", "process_out_blocks": "648", "process_in_blocks": "0"}
[0m00:53:52.436311 [debug] [MainThread]: Command `dbt compile` succeeded at 00:53:52.436096 after 0.64 seconds
[0m00:53:52.436936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95353f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92892a0>]}
[0m00:53:52.437448 [debug] [MainThread]: Flushing usage events
[0m00:55:47.227126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb011a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb0111e0>]}


============================== 00:55:47.238875 | 0e1e719f-65b5-474a-bcfa-896c1e551db4 ==============================
[0m00:55:47.238875 [info ] [MainThread]: Running with dbt=1.7.7
[0m00:55:47.239952 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run-operation generate_model_yaml', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:55:47.602885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e1e719f-65b5-474a-bcfa-896c1e551db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc6dfb50>]}
[0m00:55:47.676327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e1e719f-65b5-474a-bcfa-896c1e551db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9420970>]}
[0m00:55:47.677306 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m00:55:47.696451 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m00:55:47.772774 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:55:47.773318 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:55:47.779363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e1e719f-65b5-474a-bcfa-896c1e551db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92c40d0>]}
[0m00:55:47.793096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e1e719f-65b5-474a-bcfa-896c1e551db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92818d0>]}
[0m00:55:47.793724 [info ] [MainThread]: Found 6 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 583 macros, 0 groups, 0 semantic models
[0m00:55:47.794345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e1e719f-65b5-474a-bcfa-896c1e551db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9281990>]}
[0m00:55:47.795461 [debug] [MainThread]: Acquiring new bigquery connection 'macro_generate_model_yaml'
[0m00:55:47.808586 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 0.63579047, "process_user_time": 2.172274, "process_kernel_time": 0.129777, "process_mem_max_rss": "134196", "process_out_blocks": "648", "process_in_blocks": "0"}
[0m00:55:47.809538 [debug] [MainThread]: Command `dbt run-operation` succeeded at 00:55:47.809330 after 0.64 seconds
[0m00:55:47.810004 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m00:55:47.810486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9420970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9281c60>]}
[0m00:55:47.811005 [debug] [MainThread]: Flushing usage events
[0m00:56:06.465192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00da20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d1e0>]}


============================== 00:56:06.477583 | fddffeaa-72c6-4027-8ac3-ec6e48fff7b4 ==============================
[0m00:56:06.477583 [info ] [MainThread]: Running with dbt=1.7.7
[0m00:56:06.478656 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run-operation generate_model_yaml', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:56:06.835290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fddffeaa-72c6-4027-8ac3-ec6e48fff7b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc6375e0>]}
[0m00:56:06.908444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fddffeaa-72c6-4027-8ac3-ec6e48fff7b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95ebdf0>]}
[0m00:56:06.909455 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m00:56:06.927060 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m00:56:06.996619 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:56:06.997250 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:56:07.003595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fddffeaa-72c6-4027-8ac3-ec6e48fff7b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92c40d0>]}
[0m00:56:07.017907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fddffeaa-72c6-4027-8ac3-ec6e48fff7b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9281990>]}
[0m00:56:07.018657 [info ] [MainThread]: Found 6 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 583 macros, 0 groups, 0 semantic models
[0m00:56:07.019285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fddffeaa-72c6-4027-8ac3-ec6e48fff7b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9281a50>]}
[0m00:56:07.020405 [debug] [MainThread]: Acquiring new bigquery connection 'macro_generate_model_yaml'
[0m00:56:07.033386 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 0.62350297, "process_user_time": 2.241978, "process_kernel_time": 0.103321, "process_mem_max_rss": "134052", "process_in_blocks": "832", "process_out_blocks": "648"}
[0m00:56:07.034251 [debug] [MainThread]: Command `dbt run-operation` succeeded at 00:56:07.034066 after 0.63 seconds
[0m00:56:07.034705 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m00:56:07.035150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95ebdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9281d20>]}
[0m00:56:07.035612 [debug] [MainThread]: Flushing usage events
[0m00:57:02.297161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00da20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d1e0>]}


============================== 00:57:02.309100 | 29d75d1f-d943-4c6a-80da-50cc29870486 ==============================
[0m00:57:02.309100 [info ] [MainThread]: Running with dbt=1.7.7
[0m00:57:02.310108 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run-operation generate_model_yaml', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:57:02.674742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29d75d1f-d943-4c6a-80da-50cc29870486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc6dfb50>]}
[0m00:57:02.747336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29d75d1f-d943-4c6a-80da-50cc29870486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff941c760>]}
[0m00:57:02.748251 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m00:57:02.766249 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m00:57:02.835989 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:57:02.836809 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://taxi_rides_ny/macros/generate_model_yaml.sql
[0m00:57:02.850685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29d75d1f-d943-4c6a-80da-50cc29870486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92dc0d0>]}
[0m00:57:02.864606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29d75d1f-d943-4c6a-80da-50cc29870486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9281e40>]}
[0m00:57:02.865219 [info ] [MainThread]: Found 6 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 583 macros, 0 groups, 0 semantic models
[0m00:57:02.865760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29d75d1f-d943-4c6a-80da-50cc29870486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9281ea0>]}
[0m00:57:02.866860 [debug] [MainThread]: Acquiring new bigquery connection 'macro_generate_model_yaml'
[0m00:57:02.879571 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 0.63644946, "process_user_time": 2.234677, "process_kernel_time": 0.104218, "process_mem_max_rss": "134628", "process_out_blocks": "648", "process_in_blocks": "0"}
[0m00:57:02.880371 [debug] [MainThread]: Command `dbt run-operation` succeeded at 00:57:02.880205 after 0.64 seconds
[0m00:57:02.880790 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m00:57:02.881234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff941c760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9281c00>]}
[0m00:57:02.881717 [debug] [MainThread]: Flushing usage events
[0m00:57:37.087085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00e6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d210>]}


============================== 00:57:37.099953 | cf04a231-39e0-4925-9946-0102598690e2 ==============================
[0m00:57:37.099953 [info ] [MainThread]: Running with dbt=1.7.7
[0m00:57:37.101073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run-operation generate_model_yaml', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:57:37.459869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf04a231-39e0-4925-9946-0102598690e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc30f2b0>]}
[0m00:57:37.531914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf04a231-39e0-4925-9946-0102598690e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9425510>]}
[0m00:57:37.532806 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m00:57:37.551608 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m00:57:37.623681 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:57:37.624274 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:57:37.630415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf04a231-39e0-4925-9946-0102598690e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92c40d0>]}
[0m00:57:37.643925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf04a231-39e0-4925-9946-0102598690e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92818d0>]}
[0m00:57:37.644503 [info ] [MainThread]: Found 6 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 583 macros, 0 groups, 0 semantic models
[0m00:57:37.645097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf04a231-39e0-4925-9946-0102598690e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9281990>]}
[0m00:57:37.646153 [debug] [MainThread]: Acquiring new bigquery connection 'macro_generate_model_yaml'
[0m00:57:37.658785 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 0.62588924, "process_user_time": 2.213361, "process_kernel_time": 0.106065, "process_mem_max_rss": "134372", "process_out_blocks": "648", "process_in_blocks": "0"}
[0m00:57:37.659604 [debug] [MainThread]: Command `dbt run-operation` succeeded at 00:57:37.659419 after 0.63 seconds
[0m00:57:37.660054 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m00:57:37.660594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9425510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9281c60>]}
[0m00:57:37.661209 [debug] [MainThread]: Flushing usage events
[0m00:58:02.558904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00e6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d210>]}


============================== 00:58:02.570552 | 2ac5e117-b992-4efa-9bd0-931b9c76664c ==============================
[0m00:58:02.570552 [info ] [MainThread]: Running with dbt=1.7.7
[0m00:58:02.571568 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:58:02.648300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ac5e117-b992-4efa-9bd0-931b9c76664c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf0fa60>]}
[0m00:58:02.734414 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-au3wo8il'
[0m00:58:02.735171 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m00:58:03.025431 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m00:58:03.028948 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m00:58:03.377865 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m00:58:03.401783 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m00:58:03.848146 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m00:58:03.880905 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m00:58:04.630506 [info ] [MainThread]: Installed from version 1.0.0
[0m00:58:04.631397 [info ] [MainThread]: Updated version available: 1.1.1
[0m00:58:04.632264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2ac5e117-b992-4efa-9bd0-931b9c76664c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaff7c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffae01fc0>]}
[0m00:58:04.633146 [info ] [MainThread]: Installing dbt-labs/codegen
[0m00:58:05.274604 [info ] [MainThread]: Installed from version 0.12.1
[0m00:58:05.275466 [info ] [MainThread]: Up to date!
[0m00:58:05.276102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2ac5e117-b992-4efa-9bd0-931b9c76664c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaff7c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffae00af0>]}
[0m00:58:05.276650 [info ] [MainThread]: 
[0m00:58:05.277388 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m00:58:05.279946 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.7738419, "process_user_time": 2.053909, "process_kernel_time": 0.179526, "process_mem_max_rss": "107196", "process_out_blocks": "864", "process_in_blocks": "0"}
[0m00:58:05.280898 [debug] [MainThread]: Command `dbt deps` succeeded at 00:58:05.280699 after 2.78 seconds
[0m00:58:05.281551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00da50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d4b0>]}
[0m00:58:05.282229 [debug] [MainThread]: Flushing usage events
[0m00:58:23.819138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00e6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d210>]}


============================== 00:58:23.831480 | 5a28ca10-892e-4fb3-98df-34d3ff041a3c ==============================
[0m00:58:23.831480 [info ] [MainThread]: Running with dbt=1.7.7
[0m00:58:23.832547 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:58:23.909318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a28ca10-892e-4fb3-98df-34d3ff041a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf091b0>]}
[0m00:58:23.912496 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-i2lrnibv'
[0m00:58:23.913348 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m00:58:24.024345 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m00:58:24.026705 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m00:58:24.092027 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m00:58:24.097827 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m00:58:24.142413 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m00:58:24.154831 [info ] [MainThread]: Updating lock file in file path: /usr/app/dbt/package-lock.yml
[0m00:58:24.228515 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-dywlkqo5'
[0m00:58:24.233636 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m00:58:25.826368 [info ] [MainThread]: Installed from version 1.1.1
[0m00:58:25.827365 [info ] [MainThread]: Up to date!
[0m00:58:25.828414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5a28ca10-892e-4fb3-98df-34d3ff041a3c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf95fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffae031c0>]}
[0m00:58:25.829142 [info ] [MainThread]: Installing dbt-labs/codegen
[0m00:58:26.306387 [info ] [MainThread]: Installed from version 0.12.1
[0m00:58:26.307208 [info ] [MainThread]: Up to date!
[0m00:58:26.308009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5a28ca10-892e-4fb3-98df-34d3ff041a3c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf95fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffae00070>]}
[0m00:58:26.310730 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.545372, "process_user_time": 2.019136, "process_kernel_time": 0.172056, "process_mem_max_rss": "107336", "process_out_blocks": "864", "process_in_blocks": "0"}
[0m00:58:26.311616 [debug] [MainThread]: Command `dbt deps` succeeded at 00:58:26.311425 after 2.55 seconds
[0m00:58:26.312071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf091b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaff4130>]}
[0m00:58:26.312524 [debug] [MainThread]: Flushing usage events
[0m01:01:26.020753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00da20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d1e0>]}


============================== 01:01:26.033265 | a02ec618-222c-4cc6-a53a-591740cbd5df ==============================
[0m01:01:26.033265 [info ] [MainThread]: Running with dbt=1.7.7
[0m01:01:26.034376 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run-operation generate_model_yaml', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:01:26.403586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a02ec618-222c-4cc6-a53a-591740cbd5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc6dfb50>]}
[0m01:01:26.475810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a02ec618-222c-4cc6-a53a-591740cbd5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9421510>]}
[0m01:01:26.476684 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m01:01:26.495807 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m01:01:26.569673 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 4 files changed.
[0m01:01:26.570381 [debug] [MainThread]: Partial parsing: added file: taxi_rides_ny://taxi_rides_ny/analyses/generate_model_yaml.sql
[0m01:01:26.570849 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m01:01:26.571315 [debug] [MainThread]: Partial parsing: deleted file: taxi_rides_ny://taxi_rides_ny/macros/generate_model_yaml.sql
[0m01:01:26.571953 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m01:01:26.572676 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m01:01:26.573161 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m01:01:26.573662 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/width_bucket.sql
[0m01:01:26.853361 [error] [MainThread]: Encountered an error:
Compilation Error in analysis generate_model_yaml (taxi_rides_ny/analyses/generate_model_yaml.sql)
  'dict object' has no attribute 'nodes'
[0m01:01:26.855771 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.88945323, "process_user_time": 2.465616, "process_kernel_time": 0.192047, "process_mem_max_rss": "136052", "process_in_blocks": "8", "process_out_blocks": "648", "command_success": false}
[0m01:01:26.856516 [debug] [MainThread]: Command `dbt run-operation` failed at 01:01:26.856354 after 0.89 seconds
[0m01:01:26.857098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7b04340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7b04520>]}
[0m01:01:26.857559 [debug] [MainThread]: Flushing usage events
[0m01:02:14.123693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d180>]}


============================== 01:02:14.135399 | 93f43779-7329-4028-9b3a-2d0c04ca3d6a ==============================
[0m01:02:14.135399 [info ] [MainThread]: Running with dbt=1.7.7
[0m01:02:14.136439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run-operation generate_model_yaml', 'send_anonymous_usage_stats': 'True'}
[0m01:02:14.504605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93f43779-7329-4028-9b3a-2d0c04ca3d6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc6f24d0>]}
[0m01:02:14.576433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93f43779-7329-4028-9b3a-2d0c04ca3d6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff941c760>]}
[0m01:02:14.577279 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m01:02:14.595583 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m01:02:14.668991 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 4 files changed.
[0m01:02:14.669692 [debug] [MainThread]: Partial parsing: added file: taxi_rides_ny://taxi_rides_ny/analyses/generate_model_yaml.sql
[0m01:02:14.670184 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m01:02:14.670568 [debug] [MainThread]: Partial parsing: deleted file: taxi_rides_ny://taxi_rides_ny/macros/generate_model_yaml.sql
[0m01:02:14.671210 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m01:02:14.671694 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m01:02:14.672202 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/width_bucket.sql
[0m01:02:14.672941 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m01:02:14.955004 [error] [MainThread]: Encountered an error:
Compilation Error in analysis generate_model_yaml (taxi_rides_ny/analyses/generate_model_yaml.sql)
  'dict object' has no attribute 'nodes'
[0m01:02:14.957398 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.8868606, "process_user_time": 2.433295, "process_kernel_time": 0.145017, "process_mem_max_rss": "135984", "process_out_blocks": "648", "command_success": false, "process_in_blocks": "0"}
[0m01:02:14.958174 [debug] [MainThread]: Command `dbt run-operation` failed at 01:02:14.957997 after 0.89 seconds
[0m01:02:14.958823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7b04340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7b04520>]}
[0m01:02:14.959346 [debug] [MainThread]: Flushing usage events
[0m01:03:52.939176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00da20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d1e0>]}


============================== 01:03:52.951118 | 17aa4fb6-75c4-49c5-80bb-fac7095c07f3 ==============================
[0m01:03:52.951118 [info ] [MainThread]: Running with dbt=1.7.7
[0m01:03:52.952095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run-operation generate_model_yaml', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:03:53.315266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17aa4fb6-75c4-49c5-80bb-fac7095c07f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc6dfb50>]}
[0m01:03:53.388176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17aa4fb6-75c4-49c5-80bb-fac7095c07f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95e9480>]}
[0m01:03:53.389213 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m01:03:53.407887 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m01:03:53.484308 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 4 files changed.
[0m01:03:53.484985 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m01:03:53.485466 [debug] [MainThread]: Partial parsing: added file: taxi_rides_ny://taxi_rides_ny/analyses/generate_model_yaml.sql
[0m01:03:53.485889 [debug] [MainThread]: Partial parsing: deleted file: taxi_rides_ny://taxi_rides_ny/macros/generate_model_yaml.sql
[0m01:03:53.486385 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m01:03:53.487150 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m01:03:53.487757 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m01:03:53.488225 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/width_bucket.sql
[0m01:03:53.766428 [error] [MainThread]: Encountered an error:
Compilation Error in analysis generate_model_yaml (taxi_rides_ny/analyses/generate_model_yaml.sql)
  'dict object' has no attribute 'nodes'
[0m01:03:53.768915 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.88332, "process_user_time": 2.481779, "process_kernel_time": 0.117273, "process_mem_max_rss": "136216", "process_in_blocks": "16", "process_out_blocks": "648", "command_success": false}
[0m01:03:53.769713 [debug] [MainThread]: Command `dbt run-operation` failed at 01:03:53.769524 after 0.89 seconds
[0m01:03:53.770395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7cf8340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7cf8520>]}
[0m01:03:53.770927 [debug] [MainThread]: Flushing usage events
[0m01:10:54.888007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d180>]}


============================== 01:10:54.900272 | 17a1a709-bd3f-4187-a4fe-174b74f84247 ==============================
[0m01:10:54.900272 [info ] [MainThread]: Running with dbt=1.7.7
[0m01:10:54.901120 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --quiet run-operation generate_model_yaml --args {"model_name": "stg_green_trip_data"}', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:10:55.277065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17a1a709-bd3f-4187-a4fe-174b74f84247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc6f24d0>]}
[0m01:10:55.349673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17a1a709-bd3f-4187-a4fe-174b74f84247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95ea6b0>]}
[0m01:10:55.350557 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m01:10:55.368525 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m01:10:55.446144 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 4 files changed.
[0m01:10:55.446780 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m01:10:55.447218 [debug] [MainThread]: Partial parsing: added file: taxi_rides_ny://taxi_rides_ny/analyses/generate_model_yaml.sql
[0m01:10:55.447628 [debug] [MainThread]: Partial parsing: deleted file: taxi_rides_ny://taxi_rides_ny/macros/generate_model_yaml.sql
[0m01:10:55.448391 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m01:10:55.448924 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/width_bucket.sql
[0m01:10:55.449457 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m01:10:55.450833 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m01:10:55.729389 [error] [MainThread]: Encountered an error:
Compilation Error in analysis generate_model_yaml (taxi_rides_ny/analyses/generate_model_yaml.sql)
  'dict object' has no attribute 'nodes'
[0m01:10:55.731865 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.8973919, "process_user_time": 2.478557, "process_kernel_time": 0.198284, "process_mem_max_rss": "136168", "process_in_blocks": "248", "process_out_blocks": "648", "command_success": false}
[0m01:10:55.732679 [debug] [MainThread]: Command `dbt run-operation` failed at 01:10:55.732499 after 0.90 seconds
[0m01:10:55.733281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7cf8340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7cf8520>]}
[0m01:10:55.733767 [debug] [MainThread]: Flushing usage events
[0m01:12:22.044342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d240>]}


============================== 01:12:22.056368 | 3716397c-55a3-46f0-9411-57b72855da9c ==============================
[0m01:12:22.056368 [info ] [MainThread]: Running with dbt=1.7.7
[0m01:12:22.057434 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run-operation generate_model_yaml --args {"model_names": ["stg_green_trip_data"]}', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:12:22.415563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3716397c-55a3-46f0-9411-57b72855da9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc6fcdc0>]}
[0m01:12:22.488792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3716397c-55a3-46f0-9411-57b72855da9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff96424d0>]}
[0m01:12:22.489847 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m01:12:22.509093 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m01:12:22.581022 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 4 files changed.
[0m01:12:22.581719 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m01:12:22.582196 [debug] [MainThread]: Partial parsing: added file: taxi_rides_ny://taxi_rides_ny/analyses/generate_model_yaml.sql
[0m01:12:22.582610 [debug] [MainThread]: Partial parsing: deleted file: taxi_rides_ny://taxi_rides_ny/macros/generate_model_yaml.sql
[0m01:12:22.583096 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m01:12:22.583584 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/width_bucket.sql
[0m01:12:22.584314 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m01:12:22.584940 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m01:12:22.861054 [error] [MainThread]: Encountered an error:
Compilation Error in analysis generate_model_yaml (taxi_rides_ny/analyses/generate_model_yaml.sql)
  'dict object' has no attribute 'nodes'
[0m01:12:22.863524 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.87191015, "process_user_time": 2.397121, "process_kernel_time": 0.139181, "process_mem_max_rss": "136044", "process_out_blocks": "648", "command_success": false, "process_in_blocks": "0"}
[0m01:12:22.864362 [debug] [MainThread]: Command `dbt run-operation` failed at 01:12:22.864182 after 0.87 seconds
[0m01:12:22.864956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7cf4340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7cf4520>]}
[0m01:12:22.865489 [debug] [MainThread]: Flushing usage events
[0m01:19:50.730454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d240>]}


============================== 01:19:50.743710 | fcfcdde5-67c6-4871-b94c-99cb3151cd2b ==============================
[0m01:19:50.743710 [info ] [MainThread]: Running with dbt=1.7.7
[0m01:19:50.744830 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run-operation generate_model_yaml --args {"model_names": ["stg_green_trip_data"]}', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:19:51.112977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcfcdde5-67c6-4871-b94c-99cb3151cd2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc6fcb20>]}
[0m01:19:51.184514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcfcdde5-67c6-4871-b94c-99cb3151cd2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95e9c00>]}
[0m01:19:51.185343 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m01:19:51.204622 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m01:19:51.281482 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 4 files changed.
[0m01:19:51.282232 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m01:19:51.282647 [debug] [MainThread]: Partial parsing: deleted file: taxi_rides_ny://taxi_rides_ny/macros/generate_model_yaml.sql
[0m01:19:51.283342 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m01:19:51.284078 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m01:19:51.284559 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/width_bucket.sql
[0m01:19:51.285046 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m01:19:51.508781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcfcdde5-67c6-4871-b94c-99cb3151cd2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7c08c10>]}
[0m01:19:51.524031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcfcdde5-67c6-4871-b94c-99cb3151cd2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff927e080>]}
[0m01:19:51.524536 [info ] [MainThread]: Found 6 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m01:19:51.524991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcfcdde5-67c6-4871-b94c-99cb3151cd2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff927e0e0>]}
[0m01:19:51.526096 [debug] [MainThread]: Acquiring new bigquery connection 'macro_generate_model_yaml'
[0m01:19:51.535905 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:19:52.329568 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 1.6530695, "process_user_time": 2.61454, "process_kernel_time": 0.198116, "process_mem_max_rss": "142212", "process_out_blocks": "648", "process_in_blocks": "0"}
[0m01:19:52.331266 [debug] [MainThread]: Command `dbt run-operation` succeeded at 01:19:52.330976 after 1.66 seconds
[0m01:19:52.332012 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m01:19:52.332773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95e9c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff927dc90>]}
[0m01:19:52.333641 [debug] [MainThread]: Flushing usage events
[0m01:22:22.264371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00da20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d1e0>]}


============================== 01:22:22.276340 | f6484e8b-4ff6-439a-9e45-a3ca2336fea6 ==============================
[0m01:22:22.276340 [info ] [MainThread]: Running with dbt=1.7.7
[0m01:22:22.277299 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run-operation generate_model_yaml --args {"model_names": ["stg_green_trip_data", "stg_yellow_trip_data"]}', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:22:22.663533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6484e8b-4ff6-439a-9e45-a3ca2336fea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc6dfb50>]}
[0m01:22:22.735680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6484e8b-4ff6-439a-9e45-a3ca2336fea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf0c580>]}
[0m01:22:22.736548 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m01:22:22.754746 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m01:22:22.827891 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:22:22.828435 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:22:22.834679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6484e8b-4ff6-439a-9e45-a3ca2336fea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92c40d0>]}
[0m01:22:22.850936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6484e8b-4ff6-439a-9e45-a3ca2336fea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff927dbd0>]}
[0m01:22:22.851552 [info ] [MainThread]: Found 6 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m01:22:22.852150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6484e8b-4ff6-439a-9e45-a3ca2336fea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff927dc90>]}
[0m01:22:22.853247 [debug] [MainThread]: Acquiring new bigquery connection 'macro_generate_model_yaml'
[0m01:22:22.863358 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:22:23.679248 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 1.4676293, "process_user_time": 2.465236, "process_kernel_time": 0.140127, "process_mem_max_rss": "138808", "process_in_blocks": "56", "process_out_blocks": "648"}
[0m01:22:23.680995 [debug] [MainThread]: Command `dbt run-operation` succeeded at 01:22:23.680715 after 1.47 seconds
[0m01:22:23.681759 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m01:22:23.682556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf0c580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff927df60>]}
[0m01:22:23.683471 [debug] [MainThread]: Flushing usage events
[0m01:34:24.521641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00db10>]}


============================== 01:34:24.535253 | 58c845a4-3c14-4060-bb64-3edf7e8031ab ==============================
[0m01:34:24.535253 [info ] [MainThread]: Running with dbt=1.7.7
[0m01:34:24.536336 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:34:24.908187 [error] [MainThread]: Encountered an error:
Runtime Error
  at path []: Additional properties are not allowed ('payment_type_values' was unexpected)

Error encountered in /usr/app/dbt/dbt_project.yml
[0m01:34:24.911085 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.4441876, "process_user_time": 2.064207, "process_kernel_time": 0.197019, "process_mem_max_rss": "126044", "process_in_blocks": "32", "process_out_blocks": "648", "command_success": false}
[0m01:34:24.912019 [debug] [MainThread]: Command `dbt build` failed at 01:34:24.911776 after 0.45 seconds
[0m01:34:24.912657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff963fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff963d930>]}
[0m01:34:24.913178 [debug] [MainThread]: Flushing usage events
[0m01:34:48.408760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d990>]}


============================== 01:34:48.420456 | 2c1a92ad-237b-4141-bed3-c47d6b528e1c ==============================
[0m01:34:48.420456 [info ] [MainThread]: Running with dbt=1.7.7
[0m01:34:48.421462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:34:48.778303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c1a92ad-237b-4141-bed3-c47d6b528e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc6ee560>]}
[0m01:34:48.850270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c1a92ad-237b-4141-bed3-c47d6b528e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9419900>]}
[0m01:34:48.851350 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m01:34:48.871542 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m01:34:48.886648 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:34:48.887311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2c1a92ad-237b-4141-bed3-c47d6b528e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff955d240>]}
[0m01:34:50.361873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c1a92ad-237b-4141-bed3-c47d6b528e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff79d00d0>]}
[0m01:34:50.381758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c1a92ad-237b-4141-bed3-c47d6b528e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff961abf0>]}
[0m01:34:50.382401 [info ] [MainThread]: Found 6 models, 1 seed, 10 tests, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m01:34:50.384852 [info ] [MainThread]: 
[0m01:34:50.386098 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:34:50.388197 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m01:34:50.388927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:34:50.389801 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m01:34:50.390858 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m01:34:50.393035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:34:50.420732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:34:51.928933 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_dbt_abhishek_yadav)
[0m01:34:51.931409 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_dbt_staging)
[0m01:34:51.933810 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_production)
[0m01:34:51.935258 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:34:51.936549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:34:51.937867 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:34:52.877232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c1a92ad-237b-4141-bed3-c47d6b528e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff941ac50>]}
[0m01:34:52.883393 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:34:52.888890 [info ] [MainThread]: 
[0m01:34:52.922522 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.my_first_dbt_model
[0m01:34:52.924288 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m01:34:52.925758 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:34:52.926592 [debug] [Thread-4 (]: Began running node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:34:52.927526 [info ] [Thread-1 (]: 1 of 17 START sql table model dbt_staging.my_first_dbt_model ................... [RUN]
[0m01:34:52.928624 [info ] [Thread-2 (]: 2 of 17 START sql view model dbt_staging.stg_green_trip_data ................... [RUN]
[0m01:34:52.929916 [info ] [Thread-3 (]: 3 of 17 START sql view model dbt_abhishek_yadav.stg_yellow_trip_data ........... [RUN]
[0m01:34:52.930936 [info ] [Thread-4 (]: 4 of 17 START seed file dbt_staging.taxi_zone_lookup ........................... [RUN]
[0m01:34:52.932665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_production, now model.taxi_rides_ny.my_first_dbt_model)
[0m01:34:52.933988 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_staging, now model.taxi_rides_ny.stg_green_trip_data)
[0m01:34:52.935116 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_abhishek_yadav, now model.taxi_rides_ny.stg_yellow_trip_data)
[0m01:34:52.936647 [debug] [Thread-4 (]: Acquiring new bigquery connection 'seed.taxi_rides_ny.taxi_zone_lookup'
[0m01:34:52.937415 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
[0m01:34:52.938079 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m01:34:52.938725 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:34:52.939364 [debug] [Thread-4 (]: Began compiling node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:34:52.949258 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
[0m01:34:52.956127 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m01:34:52.962159 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m01:34:52.963098 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (compile): 01:34:52.962858 => 01:34:52.962863
[0m01:34:52.967380 [debug] [Thread-4 (]: Began executing node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:34:52.973857 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 01:34:52.949941 => 01:34:52.973482
[0m01:34:52.974463 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (compile): 01:34:52.939932 => 01:34:52.974108
[0m01:34:52.984497 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (compile): 01:34:52.956725 => 01:34:52.984166
[0m01:34:52.985978 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m01:34:52.996018 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:34:52.996352 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.my_first_dbt_model
[0m01:34:52.996919 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:34:53.019414 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_trip_data"
[0m01:34:53.055440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:34:53.059792 [debug] [Thread-3 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m01:34:53.090888 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:34:53.091916 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:34:53.093617 [debug] [Thread-2 (]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
  OPTIONS()
  as select
-- identifiers
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
cast(trip_type as integer) as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(ehail_fee as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), lpep_pickup_datetime)=1
-- dbt-bq compile --select stg_green_trip_data --vars '{'is_test_run': 'false'}'

limit 100
;


[0m01:34:53.121590 [debug] [Thread-3 (]: On model.taxi_rides_ny.stg_yellow_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
  OPTIONS()
  as -- 

select
-- identifiers
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
TIMESTAMP_SECONDS(CAST(CAST(tpep_pickup_datetime as INT64)/10000000 AS INT64)) as pickup_datetime,
TIMESTAMP_SECONDS(CAST(CAST(tpep_dropoff_datetime as INT64)/10000000 AS INT64)) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
1 as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(0 as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`yello_trip_data`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), tpep_pickup_datetime)=1
-- dbt-bq run --select stg_green_tripdata  --var 'is_test_run: false'

limit 100
;


[0m01:34:53.701139 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.my_first_dbt_model"
[0m01:34:53.703479 [debug] [Thread-1 (]: On model.taxi_rides_ny.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_first_dbt_model"} */

  
    

    create or replace table `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m01:34:54.060619 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:38dc34f4-0814-4de8-a5d4-decd7857ef6c&page=queryresults
[0m01:34:54.205835 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:84084130-d36d-4e4e-8bdb-d7a7429c35cf&page=queryresults
[0m01:34:54.335488 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:3e33e927-d35c-4a83-8818-39ac90938267&page=queryresults
[0m01:34:54.550762 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (execute): 01:34:53.056659 => 01:34:54.549987
[0m01:34:54.555397 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c1a92ad-237b-4141-bed3-c47d6b528e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7721cc0>]}
[0m01:34:54.557710 [info ] [Thread-3 (]: 3 of 17 OK created sql view model dbt_abhishek_yadav.stg_yellow_trip_data ...... [[32mCREATE VIEW (0 processed)[0m in 1.62s]
[0m01:34:54.559490 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:34:54.560906 [debug] [Thread-3 (]: Began running node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:34:54.561704 [info ] [Thread-3 (]: 5 of 17 START test accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_  [RUN]
[0m01:34:54.563359 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_yellow_trip_data, now test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad)
[0m01:34:54.564113 [debug] [Thread-3 (]: Began compiling node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:34:54.571307 [debug] [Thread-3 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad"
[0m01:34:54.574793 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad (compile): 01:34:54.564591 => 01:34:54.574357
[0m01:34:54.575474 [debug] [Thread-3 (]: Began executing node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:34:54.592553 [debug] [Thread-3 (]: Writing runtime sql for node "test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad"
[0m01:34:54.594615 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:34:54.596361 [debug] [Thread-3 (]: On test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_type as value_field,
        count(*) as n_records

    from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
    group by payment_type

)

select *
from all_values
where value_field not in (
    1,2,3,4,5
)



      
    ) dbt_internal_test
[0m01:34:54.639162 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 01:34:52.997320 => 01:34:54.638951
[0m01:34:54.640210 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c1a92ad-237b-4141-bed3-c47d6b528e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff78a8f10>]}
[0m01:34:54.640957 [info ] [Thread-2 (]: 2 of 17 OK created sql view model dbt_staging.stg_green_trip_data .............. [[32mCREATE VIEW (0 processed)[0m in 1.71s]
[0m01:34:54.641740 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m01:34:54.642283 [debug] [Thread-2 (]: Began running node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m01:34:54.642901 [info ] [Thread-2 (]: 6 of 17 START test not_null_stg_yellow_trip_data_tripid ........................ [RUN]
[0m01:34:54.643872 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_green_trip_data, now test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039)
[0m01:34:54.644392 [debug] [Thread-2 (]: Began compiling node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m01:34:54.651160 [debug] [Thread-2 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039"
[0m01:34:54.652677 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039 (compile): 01:34:54.644725 => 01:34:54.652440
[0m01:34:54.653280 [debug] [Thread-2 (]: Began executing node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m01:34:54.656004 [debug] [Thread-2 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039"
[0m01:34:54.657160 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:34:54.658832 [debug] [Thread-2 (]: On test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select tripid
from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
where tripid is null



      
    ) dbt_internal_test
[0m01:34:55.477780 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (execute): 01:34:53.020989 => 01:34:55.476608
[0m01:34:55.483928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c1a92ad-237b-4141-bed3-c47d6b528e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff79e7d90>]}
[0m01:34:55.486848 [info ] [Thread-1 (]: 1 of 17 OK created sql table model dbt_staging.my_first_dbt_model .............. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.55s]
[0m01:34:55.489339 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.my_first_dbt_model
[0m01:34:55.491043 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:34:55.492764 [info ] [Thread-1 (]: 7 of 17 START test unique_stg_yellow_trip_data_tripid .......................... [RUN]
[0m01:34:55.494846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.my_first_dbt_model, now test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de)
[0m01:34:55.496065 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:34:55.515277 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de"
[0m01:34:55.518308 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de (compile): 01:34:55.496907 => 01:34:55.517928
[0m01:34:55.519065 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:34:55.591145 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de"
[0m01:34:55.592808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:34:55.594594 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select tripid as unique_field
  from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
  where tripid is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m01:34:56.048742 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:043fb990-17bf-4c7f-956a-e65416999677&page=queryresults
[0m01:34:56.217274 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:41d50ec5-c203-49d8-b4c0-c3eaecccd76e&page=queryresults
[0m01:34:56.408299 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad (execute): 01:34:54.575984 => 01:34:56.407877
[0m01:34:56.409594 [info ] [Thread-3 (]: 5 of 17 PASS accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_  [[32mPASS[0m in 1.85s]
[0m01:34:56.410575 [debug] [Thread-3 (]: Finished running node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:34:56.411210 [debug] [Thread-3 (]: Began running node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:34:56.411811 [info ] [Thread-3 (]: 8 of 17 START test accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_  [RUN]
[0m01:34:56.412759 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad, now test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9)
[0m01:34:56.413316 [debug] [Thread-3 (]: Began compiling node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:34:56.419319 [debug] [Thread-3 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9"
[0m01:34:56.421207 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9 (compile): 01:34:56.413695 => 01:34:56.420866
[0m01:34:56.421821 [debug] [Thread-3 (]: Began executing node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:34:56.424622 [debug] [Thread-3 (]: Writing runtime sql for node "test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9"
[0m01:34:56.425621 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:34:56.427174 [debug] [Thread-3 (]: On test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_type as value_field,
        count(*) as n_records

    from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
    group by payment_type

)

select *
from all_values
where value_field not in (
    1,2,3,4,5
)



      
    ) dbt_internal_test
[0m01:34:56.555558 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039 (execute): 01:34:54.653665 => 01:34:56.555214
[0m01:34:56.556859 [info ] [Thread-2 (]: 6 of 17 PASS not_null_stg_yellow_trip_data_tripid .............................. [[32mPASS[0m in 1.91s]
[0m01:34:56.557747 [debug] [Thread-2 (]: Finished running node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m01:34:56.558372 [debug] [Thread-2 (]: Began running node test.taxi_rides_ny.not_stg_green_trip_data_tripid.60d95c01e5
[0m01:34:56.558967 [info ] [Thread-2 (]: 9 of 17 START test not_stg_green_trip_data_tripid .............................. [RUN]
[0m01:34:56.559808 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039, now test.taxi_rides_ny.not_stg_green_trip_data_tripid.60d95c01e5)
[0m01:34:56.560362 [debug] [Thread-2 (]: Began compiling node test.taxi_rides_ny.not_stg_green_trip_data_tripid.60d95c01e5
[0m01:34:56.565797 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.not_stg_green_trip_data_tripid.60d95c01e5 (compile): 01:34:56.560741 => 01:34:56.565508
[0m01:34:56.572213 [debug] [Thread-2 (]: Compilation Error in test not_stg_green_trip_data_tripid (taxi_rides_ny/models/staging/schema.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m01:34:56.573053 [error] [Thread-2 (]: 9 of 17 ERROR not_stg_green_trip_data_tripid ................................... [[31mERROR[0m in 0.01s]
[0m01:34:56.573852 [debug] [Thread-2 (]: Finished running node test.taxi_rides_ny.not_stg_green_trip_data_tripid.60d95c01e5
[0m01:34:56.574529 [debug] [Thread-2 (]: Began running node test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5
[0m01:34:56.575225 [info ] [Thread-2 (]: 10 of 17 START test unique_stg_green_trip_data_tripid .......................... [RUN]
[0m01:34:56.576135 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_stg_green_trip_data_tripid.60d95c01e5, now test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5)
[0m01:34:56.576622 [debug] [Thread-2 (]: Began compiling node test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5
[0m01:34:56.581598 [debug] [Thread-2 (]: Writing injected SQL for node "test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5"
[0m01:34:56.583540 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5 (compile): 01:34:56.576981 => 01:34:56.583149
[0m01:34:56.584639 [debug] [Thread-2 (]: Began executing node test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5
[0m01:34:56.588832 [debug] [Thread-2 (]: Writing runtime sql for node "test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5"
[0m01:34:56.590448 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:34:56.592396 [debug] [Thread-2 (]: On test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select tripid as unique_field
  from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
  where tripid is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m01:34:57.729727 [debug] [Thread-4 (]: On seed.taxi_rides_ny.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "seed.taxi_rides_ny.taxi_zone_lookup"} */

    alter table `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup` set OPTIONS()
  
[0m01:34:57.862375 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:e4f4fb7d-7a05-4eae-9e91-a0652486757f&page=queryresults
[0m01:34:58.192390 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:4671bfdb-c4a2-4193-a086-4ed86d3f9d2e&page=queryresults
[0m01:34:58.235350 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de (execute): 01:34:55.519582 => 01:34:58.234008
[0m01:34:58.239969 [info ] [Thread-1 (]: 7 of 17 PASS unique_stg_yellow_trip_data_tripid ................................ [[32mPASS[0m in 2.75s]
[0m01:34:58.245395 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:34:58.247814 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.my_second_dbt_model
[0m01:34:58.250257 [info ] [Thread-1 (]: 11 of 17 START sql view model dbt_staging.my_second_dbt_model .................. [RUN]
[0m01:34:58.254157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de, now model.taxi_rides_ny.my_second_dbt_model)
[0m01:34:58.255778 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
[0m01:34:58.260835 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
[0m01:34:58.263505 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (compile): 01:34:58.256827 => 01:34:58.263157
[0m01:34:58.264332 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.my_second_dbt_model
[0m01:34:58.268752 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.my_second_dbt_model"
[0m01:34:58.270922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:34:58.273135 [debug] [Thread-1 (]: On model.taxi_rides_ny.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_second_dbt_model"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
where id = 1;


[0m01:34:58.545072 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:39c4f691-ad0d-469a-90a1-a4bea6cae924&page=queryresults
[0m01:34:58.642129 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.taxi_rides_ny.taxi_zone_lookup"
[0m01:34:58.652229 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (execute): 01:34:52.968210 => 01:34:58.651782
[0m01:34:58.654340 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c1a92ad-237b-4141-bed3-c47d6b528e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff78ca110>]}
[0m01:34:58.655767 [info ] [Thread-4 (]: 4 of 17 OK loaded seed file dbt_staging.taxi_zone_lookup ....................... [[32mINSERT 265[0m in 5.72s]
[0m01:34:58.658147 [debug] [Thread-4 (]: Finished running node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:34:58.660940 [debug] [Thread-4 (]: Began running node model.taxi_rides_ny.dim_zones
[0m01:34:58.662415 [info ] [Thread-4 (]: 12 of 17 START sql table model production.dim_zones ............................ [RUN]
[0m01:34:58.664293 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.taxi_rides_ny.taxi_zone_lookup, now model.taxi_rides_ny.dim_zones)
[0m01:34:58.665407 [debug] [Thread-4 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m01:34:58.671502 [debug] [Thread-4 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m01:34:58.675509 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.dim_zones (compile): 01:34:58.666074 => 01:34:58.674938
[0m01:34:58.676468 [debug] [Thread-4 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m01:34:58.682876 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:34:58.746671 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:8811ae00-0e49-4a6c-86da-f7d8bcaade15&page=queryresults
[0m01:34:58.951782 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9 (execute): 01:34:56.422126 => 01:34:58.951113
[0m01:34:58.953982 [info ] [Thread-3 (]: 8 of 17 PASS accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_  [[32mPASS[0m in 2.54s]
[0m01:34:58.955537 [debug] [Thread-3 (]: Finished running node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:34:58.956712 [debug] [Thread-3 (]: Began running node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:34:58.957848 [info ] [Thread-3 (]: 13 of 17 START test relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m01:34:58.959520 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9, now test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f)
[0m01:34:58.960654 [debug] [Thread-3 (]: Began compiling node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:34:58.969967 [debug] [Thread-3 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f"
[0m01:34:58.973115 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f (compile): 01:34:58.961317 => 01:34:58.972768
[0m01:34:58.973873 [debug] [Thread-3 (]: Began executing node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:34:58.978009 [debug] [Thread-3 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f"
[0m01:34:58.983059 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:34:58.985389 [debug] [Thread-3 (]: On test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select dropoff_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
    where dropoff_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:34:59.088579 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5 (execute): 01:34:56.585098 => 01:34:59.088196
[0m01:34:59.089877 [info ] [Thread-2 (]: 10 of 17 PASS unique_stg_green_trip_data_tripid ................................ [[32mPASS[0m in 2.51s]
[0m01:34:59.091038 [debug] [Thread-2 (]: Finished running node test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5
[0m01:34:59.091859 [debug] [Thread-2 (]: Began running node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:34:59.092604 [info ] [Thread-2 (]: 14 of 17 START test relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m01:34:59.093756 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5, now test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989)
[0m01:34:59.094491 [debug] [Thread-2 (]: Began compiling node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:34:59.100800 [debug] [Thread-2 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989"
[0m01:34:59.102315 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989 (compile): 01:34:59.094971 => 01:34:59.102086
[0m01:34:59.102848 [debug] [Thread-2 (]: Began executing node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:34:59.105495 [debug] [Thread-2 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989"
[0m01:34:59.106675 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:34:59.108516 [debug] [Thread-2 (]: On test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select pickup_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
    where pickup_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:34:59.533131 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:bebc60f9-abeb-4529-9d5a-3f85879968b7&page=queryresults
[0m01:34:59.585246 [debug] [Thread-4 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_zones"
[0m01:34:59.590806 [debug] [Thread-4 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */

  
    

    create or replace table `de-zoomcamp-413815`.`production`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      select 
locationid,
borough,
zone,
replace(service_zone, 'Boro', 'Green') as service_zone
from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
    );
  
[0m01:34:59.772539 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (execute): 01:34:58.264889 => 01:34:59.769036
[0m01:34:59.776773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c1a92ad-237b-4141-bed3-c47d6b528e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7c63b80>]}
[0m01:34:59.779181 [info ] [Thread-1 (]: 11 of 17 OK created sql view model dbt_staging.my_second_dbt_model ............. [[32mCREATE VIEW (0 processed)[0m in 1.52s]
[0m01:34:59.781518 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.my_second_dbt_model
[0m01:34:59.782963 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:34:59.784379 [info ] [Thread-1 (]: 15 of 17 START test relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m01:34:59.786609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.my_second_dbt_model, now test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3)
[0m01:34:59.787913 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:34:59.803081 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3"
[0m01:34:59.807286 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3 (compile): 01:34:59.788799 => 01:34:59.806753
[0m01:34:59.808250 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:34:59.812121 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3"
[0m01:34:59.813967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:34:59.816393 [debug] [Thread-1 (]: On test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select dropoff_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
    where dropoff_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:34:59.958614 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:bd2cf954-0134-43aa-b6eb-422998544451&page=queryresults
[0m01:35:00.605674 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:8d476761-7c0e-454d-899e-2c74234c894d&page=queryresults
[0m01:35:00.769976 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:2619ec27-bfda-441d-bdbe-0e6eb592df27&page=queryresults
[0m01:35:01.157381 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989 (execute): 01:34:59.103205 => 01:35:01.155226
[0m01:35:01.162145 [info ] [Thread-2 (]: 14 of 17 PASS relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 2.07s]
[0m01:35:01.164653 [debug] [Thread-2 (]: Finished running node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:35:01.166534 [debug] [Thread-2 (]: Began running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:35:01.168166 [info ] [Thread-2 (]: 16 of 17 START test relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m01:35:01.171072 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989, now test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739)
[0m01:35:01.172406 [debug] [Thread-2 (]: Began compiling node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:35:01.189182 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f (execute): 01:34:58.974415 => 01:35:01.188773
[0m01:35:01.187248 [debug] [Thread-2 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739"
[0m01:35:01.190916 [info ] [Thread-3 (]: 13 of 17 PASS relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 2.23s]
[0m01:35:01.192185 [debug] [Thread-3 (]: Finished running node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:35:01.194618 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739 (compile): 01:35:01.173307 => 01:35:01.194261
[0m01:35:01.195378 [debug] [Thread-2 (]: Began executing node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:35:01.199763 [debug] [Thread-2 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739"
[0m01:35:01.202182 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:35:01.204769 [debug] [Thread-2 (]: On test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select pickup_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
    where pickup_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:35:01.433017 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.dim_zones (execute): 01:34:58.677024 => 01:35:01.432481
[0m01:35:01.435235 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:3376cedd-f0f9-4554-8fac-1c905b09de49&page=queryresults
[0m01:35:01.437582 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c1a92ad-237b-4141-bed3-c47d6b528e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff941ba30>]}
[0m01:35:01.443643 [info ] [Thread-4 (]: 12 of 17 OK created sql table model production.dim_zones ....................... [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 2.77s]
[0m01:35:01.445486 [debug] [Thread-4 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m01:35:01.794072 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3 (execute): 01:34:59.808891 => 01:35:01.791313
[0m01:35:01.802395 [info ] [Thread-1 (]: 15 of 17 PASS relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 2.02s]
[0m01:35:01.809594 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:35:02.372039 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:3140c6ac-467a-4671-82cc-a81180653e0d&page=queryresults
[0m01:35:02.749800 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739 (execute): 01:35:01.195933 => 01:35:02.748366
[0m01:35:02.756640 [info ] [Thread-2 (]: 16 of 17 PASS relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 1.59s]
[0m01:35:02.762665 [debug] [Thread-2 (]: Finished running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:35:02.771993 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.fact_trips
[0m01:35:02.773888 [info ] [Thread-3 (]: 17 of 17 SKIP relation production.fact_trips ................................... [[33mSKIP[0m]
[0m01:35:02.776128 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.fact_trips
[0m01:35:02.782554 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:35:02.784251 [debug] [MainThread]: Connection 'test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3' was properly closed.
[0m01:35:02.785375 [debug] [MainThread]: Connection 'test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f' was properly closed.
[0m01:35:02.786754 [debug] [MainThread]: Connection 'test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739' was properly closed.
[0m01:35:02.787660 [debug] [MainThread]: Connection 'model.taxi_rides_ny.dim_zones' was properly closed.
[0m01:35:02.789174 [info ] [MainThread]: 
[0m01:35:02.790665 [info ] [MainThread]: Finished running 3 view models, 3 table models, 10 tests, 1 seed in 0 hours 0 minutes and 12.40 seconds (12.40s).
[0m01:35:02.796848 [debug] [MainThread]: Command end result
[0m01:35:02.826097 [info ] [MainThread]: 
[0m01:35:02.826981 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:35:02.827615 [info ] [MainThread]: 
[0m01:35:02.828276 [error] [MainThread]:   Compilation Error in test not_stg_green_trip_data_tripid (taxi_rides_ny/models/staging/schema.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m01:35:02.828927 [info ] [MainThread]: 
[0m01:35:02.829757 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=1 SKIP=1 TOTAL=17
[0m01:35:02.831782 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 14.47701, "process_user_time": 6.205886, "process_kernel_time": 0.322226, "process_mem_max_rss": "175944", "process_in_blocks": "352", "process_out_blocks": "704", "command_success": false}
[0m01:35:02.832855 [debug] [MainThread]: Command `dbt build` failed at 01:35:02.832666 after 14.48 seconds
[0m01:35:02.833616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff961abf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95ec700>]}
[0m01:35:02.834446 [debug] [MainThread]: Flushing usage events
[0m01:40:37.579806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00db10>]}


============================== 01:40:37.592995 | 833a8709-18ad-4c43-947d-8ec377f9858c ==============================
[0m01:40:37.592995 [info ] [MainThread]: Running with dbt=1.7.7
[0m01:40:37.594020 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:40:37.955153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '833a8709-18ad-4c43-947d-8ec377f9858c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00e590>]}
[0m01:40:38.026666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '833a8709-18ad-4c43-947d-8ec377f9858c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaff4490>]}
[0m01:40:38.027692 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m01:40:38.046980 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m01:40:38.126272 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:40:38.127586 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://taxi_rides_ny/models/staging/schema.yml
[0m01:40:38.418077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '833a8709-18ad-4c43-947d-8ec377f9858c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8e78e50>]}
[0m01:40:38.471442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '833a8709-18ad-4c43-947d-8ec377f9858c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff904fd30>]}
[0m01:40:38.472084 [info ] [MainThread]: Found 6 models, 1 seed, 6 tests, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m01:40:38.474165 [info ] [MainThread]: 
[0m01:40:38.475447 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:40:38.478431 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m01:40:38.479186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:38.479833 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m01:40:38.480729 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m01:40:38.481368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:38.510469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:39.780244 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_dbt_abhishek_yadav'
[0m01:40:39.782268 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_dbt_staging'
[0m01:40:39.783758 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_production)
[0m01:40:39.784823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:39.785980 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:39.786927 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:40:40.310624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '833a8709-18ad-4c43-947d-8ec377f9858c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9121390>]}
[0m01:40:40.315206 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:40:40.321158 [info ] [MainThread]: 
[0m01:40:40.329648 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.my_first_dbt_model
[0m01:40:40.330252 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m01:40:40.330732 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:40:40.331206 [debug] [Thread-4 (]: Began running node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:40:40.331747 [info ] [Thread-1 (]: 1 of 13 START sql table model dbt_staging.my_first_dbt_model ................... [RUN]
[0m01:40:40.332413 [info ] [Thread-2 (]: 2 of 13 START sql view model dbt_staging.stg_green_trip_data ................... [RUN]
[0m01:40:40.333263 [info ] [Thread-3 (]: 3 of 13 START sql view model dbt_abhishek_yadav.stg_yellow_trip_data ........... [RUN]
[0m01:40:40.334147 [info ] [Thread-4 (]: 4 of 13 START seed file dbt_staging.taxi_zone_lookup ........................... [RUN]
[0m01:40:40.335231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_production, now model.taxi_rides_ny.my_first_dbt_model)
[0m01:40:40.336177 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_staging, now model.taxi_rides_ny.stg_green_trip_data)
[0m01:40:40.337030 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_abhishek_yadav, now model.taxi_rides_ny.stg_yellow_trip_data)
[0m01:40:40.337912 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now seed.taxi_rides_ny.taxi_zone_lookup)
[0m01:40:40.338558 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
[0m01:40:40.339081 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m01:40:40.339544 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:40:40.340097 [debug] [Thread-4 (]: Began compiling node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:40:40.355009 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
[0m01:40:40.360774 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m01:40:40.368347 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m01:40:40.369306 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (compile): 01:40:40.369000 => 01:40:40.369005
[0m01:40:40.372844 [debug] [Thread-4 (]: Began executing node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:40:40.374021 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 01:40:40.355602 => 01:40:40.373737
[0m01:40:40.385049 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (compile): 01:40:40.361482 => 01:40:40.384712
[0m01:40:40.385551 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (compile): 01:40:40.340590 => 01:40:40.385284
[0m01:40:40.391422 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m01:40:40.393031 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:40:40.403369 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.my_first_dbt_model
[0m01:40:40.403746 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:40:40.428679 [debug] [Thread-3 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m01:40:40.425788 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_trip_data"
[0m01:40:40.438010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:40:40.468347 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:40:40.469197 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:40:40.497747 [debug] [Thread-3 (]: On model.taxi_rides_ny.stg_yellow_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
  OPTIONS()
  as -- 

select
-- identifiers
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
TIMESTAMP_SECONDS(CAST(CAST(tpep_pickup_datetime as INT64)/10000000 AS INT64)) as pickup_datetime,
TIMESTAMP_SECONDS(CAST(CAST(tpep_dropoff_datetime as INT64)/10000000 AS INT64)) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
1 as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(0 as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`yello_trip_data`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), tpep_pickup_datetime)=1
-- dbt-bq run --select stg_green_tripdata  --var 'is_test_run: false'

limit 100
;


[0m01:40:40.527473 [debug] [Thread-2 (]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
  OPTIONS()
  as select
-- identifiers
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
cast(trip_type as integer) as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(ehail_fee as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), lpep_pickup_datetime)=1
-- dbt-bq compile --select stg_green_trip_data --vars '{'is_test_run': 'false'}'

limit 100
;


[0m01:40:41.040962 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.my_first_dbt_model"
[0m01:40:41.044855 [debug] [Thread-1 (]: On model.taxi_rides_ny.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_first_dbt_model"} */

  
    

    create or replace table `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m01:40:41.242249 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:0c17f812-6ca4-4c6e-a7d4-817a62110498&page=queryresults
[0m01:40:41.262546 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:e0d08d99-cc2f-4aa8-b697-ec25593cd467&page=queryresults
[0m01:40:41.309797 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:09527773-3651-4c24-89d2-62c5fc282adc&page=queryresults
[0m01:40:41.574315 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (execute): 01:40:40.426059 => 01:40:41.573855
[0m01:40:41.576620 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '833a8709-18ad-4c43-947d-8ec377f9858c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8ea4820>]}
[0m01:40:41.579117 [info ] [Thread-3 (]: 3 of 13 OK created sql view model dbt_abhishek_yadav.stg_yellow_trip_data ...... [[32mCREATE VIEW (0 processed)[0m in 1.24s]
[0m01:40:41.581019 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:40:41.582658 [debug] [Thread-3 (]: Began running node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:40:41.583592 [info ] [Thread-3 (]: 5 of 13 START test accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_  [RUN]
[0m01:40:41.585014 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_yellow_trip_data, now test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad)
[0m01:40:41.585853 [debug] [Thread-3 (]: Began compiling node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:40:41.598364 [debug] [Thread-3 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad"
[0m01:40:41.602296 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad (compile): 01:40:41.586394 => 01:40:41.601953
[0m01:40:41.602993 [debug] [Thread-3 (]: Began executing node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:40:41.618942 [debug] [Thread-3 (]: Writing runtime sql for node "test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad"
[0m01:40:41.622306 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 01:40:40.404105 => 01:40:41.622107
[0m01:40:41.623209 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '833a8709-18ad-4c43-947d-8ec377f9858c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8e29540>]}
[0m01:40:41.624260 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:40:41.623935 [info ] [Thread-2 (]: 2 of 13 OK created sql view model dbt_staging.stg_green_trip_data .............. [[32mCREATE VIEW (0 processed)[0m in 1.29s]
[0m01:40:41.625209 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m01:40:41.626536 [debug] [Thread-3 (]: On test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_type as value_field,
        count(*) as n_records

    from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
    group by payment_type

)

select *
from all_values
where value_field not in (
    1,2,3,4,5
)



      
    ) dbt_internal_test
[0m01:40:41.627263 [debug] [Thread-2 (]: Began running node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:40:41.655077 [info ] [Thread-2 (]: 6 of 13 START test accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_  [RUN]
[0m01:40:41.656129 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_green_trip_data, now test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9)
[0m01:40:41.656706 [debug] [Thread-2 (]: Began compiling node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:40:41.662563 [debug] [Thread-2 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9"
[0m01:40:41.664185 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9 (compile): 01:40:41.657251 => 01:40:41.663954
[0m01:40:41.664701 [debug] [Thread-2 (]: Began executing node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:40:41.667265 [debug] [Thread-2 (]: Writing runtime sql for node "test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9"
[0m01:40:41.668429 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:40:41.670131 [debug] [Thread-2 (]: On test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_type as value_field,
        count(*) as n_records

    from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
    group by payment_type

)

select *
from all_values
where value_field not in (
    1,2,3,4,5
)



      
    ) dbt_internal_test
[0m01:40:43.001320 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (execute): 01:40:40.429233 => 01:40:42.998409
[0m01:40:43.006415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '833a8709-18ad-4c43-947d-8ec377f9858c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8e89cf0>]}
[0m01:40:43.008944 [info ] [Thread-1 (]: 1 of 13 OK created sql table model dbt_staging.my_first_dbt_model .............. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.67s]
[0m01:40:43.011674 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.my_first_dbt_model
[0m01:40:43.013985 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.my_second_dbt_model
[0m01:40:43.015452 [info ] [Thread-1 (]: 7 of 13 START sql view model dbt_staging.my_second_dbt_model ................... [RUN]
[0m01:40:43.017563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.my_first_dbt_model, now model.taxi_rides_ny.my_second_dbt_model)
[0m01:40:43.018799 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
[0m01:40:43.026849 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
[0m01:40:43.032436 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (compile): 01:40:43.019666 => 01:40:43.031820
[0m01:40:43.033457 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.my_second_dbt_model
[0m01:40:43.041238 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.my_second_dbt_model"
[0m01:40:43.045015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:40:43.048058 [debug] [Thread-1 (]: On model.taxi_rides_ny.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_second_dbt_model"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
where id = 1;


[0m01:40:43.155406 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:437c159f-0d23-429a-ab02-c8f06f890c79&page=queryresults
[0m01:40:43.358290 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:eb7b63e9-3664-4307-a3c5-052ad0bf1819&page=queryresults
[0m01:40:43.551090 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad (execute): 01:40:41.603416 => 01:40:43.548557
[0m01:40:43.556687 [info ] [Thread-3 (]: 5 of 13 PASS accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_  [[32mPASS[0m in 1.97s]
[0m01:40:43.562623 [debug] [Thread-3 (]: Finished running node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:40:43.693100 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:10473aa5-4150-4667-82ec-d3722d1b98f8&page=queryresults
[0m01:40:43.746620 [debug] [Thread-4 (]: On seed.taxi_rides_ny.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "seed.taxi_rides_ny.taxi_zone_lookup"} */

    alter table `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup` set OPTIONS()
  
[0m01:40:43.814727 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9 (execute): 01:40:41.665041 => 01:40:43.806024
[0m01:40:43.818659 [info ] [Thread-2 (]: 6 of 13 PASS accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_  [[32mPASS[0m in 2.16s]
[0m01:40:43.821354 [debug] [Thread-2 (]: Finished running node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:40:43.932933 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (execute): 01:40:43.034123 => 01:40:43.931728
[0m01:40:43.937489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '833a8709-18ad-4c43-947d-8ec377f9858c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8560d60>]}
[0m01:40:43.940955 [info ] [Thread-1 (]: 7 of 13 OK created sql view model dbt_staging.my_second_dbt_model .............. [[32mCREATE VIEW (0 processed)[0m in 0.92s]
[0m01:40:43.943603 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.my_second_dbt_model
[0m01:40:43.971287 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:600b03cf-f9b8-47b2-aecd-a5dfc49a20ad&page=queryresults
[0m01:40:44.216001 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.taxi_rides_ny.taxi_zone_lookup"
[0m01:40:44.228767 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (execute): 01:40:40.374245 => 01:40:44.228262
[0m01:40:44.230946 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '833a8709-18ad-4c43-947d-8ec377f9858c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9066140>]}
[0m01:40:44.232486 [info ] [Thread-4 (]: 4 of 13 OK loaded seed file dbt_staging.taxi_zone_lookup ....................... [[32mINSERT 265[0m in 3.89s]
[0m01:40:44.234299 [debug] [Thread-4 (]: Finished running node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:40:44.237986 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.dim_zones
[0m01:40:44.238780 [debug] [Thread-2 (]: Began running node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:40:44.239488 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:40:44.240232 [debug] [Thread-4 (]: Began running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:40:44.240955 [info ] [Thread-3 (]: 8 of 13 START sql table model production.dim_zones ............................. [RUN]
[0m01:40:44.241975 [info ] [Thread-2 (]: 9 of 13 START test relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m01:40:44.243097 [info ] [Thread-1 (]: 10 of 13 START test relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m01:40:44.244095 [info ] [Thread-4 (]: 11 of 13 START test relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m01:40:44.245540 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad, now model.taxi_rides_ny.dim_zones)
[0m01:40:44.246942 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9, now test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f)
[0m01:40:44.248331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.my_second_dbt_model, now test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989)
[0m01:40:44.249695 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.taxi_rides_ny.taxi_zone_lookup, now test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3)
[0m01:40:44.250578 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m01:40:44.251650 [debug] [Thread-2 (]: Began compiling node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:40:44.252672 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:40:44.254479 [debug] [Thread-4 (]: Began compiling node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:40:44.259442 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m01:40:44.265946 [debug] [Thread-2 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f"
[0m01:40:44.271645 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989"
[0m01:40:44.277300 [debug] [Thread-4 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3"
[0m01:40:44.280663 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.dim_zones (compile): 01:40:44.255201 => 01:40:44.280389
[0m01:40:44.281143 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f (compile): 01:40:44.260121 => 01:40:44.280926
[0m01:40:44.281798 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989 (compile): 01:40:44.266465 => 01:40:44.281525
[0m01:40:44.282146 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m01:40:44.282650 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3 (compile): 01:40:44.272236 => 01:40:44.282425
[0m01:40:44.283096 [debug] [Thread-2 (]: Began executing node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:40:44.283557 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:40:44.286064 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:40:44.286579 [debug] [Thread-4 (]: Began executing node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:40:44.291839 [debug] [Thread-2 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f"
[0m01:40:44.294669 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989"
[0m01:40:44.298806 [debug] [Thread-4 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3"
[0m01:40:44.328657 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:40:44.329479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:40:44.330477 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:40:44.332053 [debug] [Thread-2 (]: On test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select dropoff_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
    where dropoff_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:40:44.333495 [debug] [Thread-1 (]: On test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select pickup_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
    where pickup_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:40:44.361959 [debug] [Thread-4 (]: On test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select dropoff_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
    where dropoff_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:40:44.790624 [debug] [Thread-3 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_zones"
[0m01:40:44.796995 [debug] [Thread-3 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */

  
    

    create or replace table `de-zoomcamp-413815`.`production`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      select 
locationid,
borough,
zone,
replace(service_zone, 'Boro', 'Green') as service_zone
from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
    );
  
[0m01:40:45.205530 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:12d3e58d-13ea-4cda-a86e-94d6fd1788a2&page=queryresults
[0m01:40:45.918693 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:ab762495-cfb4-4246-b53a-2abc29833e16&page=queryresults
[0m01:40:45.935040 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:0e684b8f-e42c-4dc4-bb35-1f30281d61e5&page=queryresults
[0m01:40:46.121131 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:c2d1d780-2eb6-4c4c-9075-3c208b87933a&page=queryresults
[0m01:40:46.325137 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f (execute): 01:40:44.286932 => 01:40:46.322649
[0m01:40:46.323916 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3 (execute): 01:40:44.296535 => 01:40:46.313160
[0m01:40:46.330383 [info ] [Thread-2 (]: 9 of 13 PASS relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 2.08s]
[0m01:40:46.335110 [info ] [Thread-4 (]: 11 of 13 PASS relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 2.09s]
[0m01:40:46.338268 [debug] [Thread-2 (]: Finished running node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:40:46.340223 [debug] [Thread-4 (]: Finished running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:40:46.341788 [debug] [Thread-2 (]: Began running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:40:46.343972 [info ] [Thread-2 (]: 12 of 13 START test relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m01:40:46.346939 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f, now test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739)
[0m01:40:46.348473 [debug] [Thread-2 (]: Began compiling node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:40:46.361600 [debug] [Thread-2 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739"
[0m01:40:46.370768 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739 (compile): 01:40:46.349462 => 01:40:46.370048
[0m01:40:46.373660 [debug] [Thread-2 (]: Began executing node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:40:46.383800 [debug] [Thread-2 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739"
[0m01:40:46.386623 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:40:46.388957 [debug] [Thread-2 (]: On test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select pickup_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
    where pickup_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:40:46.462593 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989 (execute): 01:40:44.292160 => 01:40:46.462253
[0m01:40:46.463702 [info ] [Thread-1 (]: 10 of 13 PASS relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 2.22s]
[0m01:40:46.464479 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:40:46.588987 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.dim_zones (execute): 01:40:44.283903 => 01:40:46.588591
[0m01:40:46.590564 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '833a8709-18ad-4c43-947d-8ec377f9858c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff85f07c0>]}
[0m01:40:46.591668 [info ] [Thread-3 (]: 8 of 13 OK created sql table model production.dim_zones ........................ [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 2.35s]
[0m01:40:46.592971 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m01:40:47.674317 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:90dc86ca-a9d0-48a3-b2d9-0b79231f7cb6&page=queryresults
[0m01:40:48.043791 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739 (execute): 01:40:46.374926 => 01:40:48.040862
[0m01:40:48.049830 [info ] [Thread-2 (]: 12 of 13 PASS relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 1.70s]
[0m01:40:48.058485 [debug] [Thread-2 (]: Finished running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:40:48.063301 [debug] [Thread-4 (]: Began running node model.taxi_rides_ny.fact_trips
[0m01:40:48.065455 [info ] [Thread-4 (]: 13 of 13 START sql table model production.fact_trips ........................... [RUN]
[0m01:40:48.068153 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3, now model.taxi_rides_ny.fact_trips)
[0m01:40:48.069861 [debug] [Thread-4 (]: Began compiling node model.taxi_rides_ny.fact_trips
[0m01:40:48.079738 [debug] [Thread-4 (]: Writing injected SQL for node "model.taxi_rides_ny.fact_trips"
[0m01:40:48.086204 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.fact_trips (compile): 01:40:48.070994 => 01:40:48.085555
[0m01:40:48.087196 [debug] [Thread-4 (]: Began executing node model.taxi_rides_ny.fact_trips
[0m01:40:48.091234 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:40:48.583406 [debug] [Thread-4 (]: Writing runtime sql for node "model.taxi_rides_ny.fact_trips"
[0m01:40:48.592905 [debug] [Thread-4 (]: On model.taxi_rides_ny.fact_trips: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.fact_trips"} */

  
    

    create or replace table `de-zoomcamp-413815`.`production`.`fact_trips`
      
    
    

    OPTIONS()
    as (
      with green_trip_data as(
    select *,
        'Green' as service_type
    from 
    `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
),

yellow_trip_data as(
    select *,
        'Yellow' as service_type
    from 
    `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
),

trips_unioned as(
    select * from green_trip_data
    union all
    select * from yellow_trip_data
),
dim_zones as (
    select * from `de-zoomcamp-413815`.`production`.`dim_zones`
    where borough <> 'Unknown'
)

select trips_unioned.tripid, 
    trips_unioned.vendorid, 
    trips_unioned.service_type,
    trips_unioned.ratecodeid, 
    trips_unioned.pickup_locationid, 
    pickup_zone.borough as pickup_borough, 
    pickup_zone.zone as pickup_zone, 
    trips_unioned.dropoff_locationid,
    dropoff_zone.borough as dropoff_borough, 
    dropoff_zone.zone as dropoff_zone,  
    trips_unioned.pickup_datetime, 
    trips_unioned.dropoff_datetime, 
    trips_unioned.store_and_fwd_flag, 
    trips_unioned.passenger_count, 
    trips_unioned.trip_distance, 
    trips_unioned.trip_type, 
    trips_unioned.fare_amount, 
    trips_unioned.extra, 
    trips_unioned.mta_tax, 
    trips_unioned.tip_amount, 
    trips_unioned.tolls_amount, 
    trips_unioned.ehail_fee, 
    trips_unioned.improvement_surcharge, 
    trips_unioned.total_amount, 
    trips_unioned.payment_type, 
    trips_unioned.payment_type_description
from trips_unioned
inner join dim_zones as pickup_zone
on (trips_unioned.pickup_locationid = pickup_zone.locationid)
inner join dim_zones as dropoff_zone
on (trips_unioned.dropoff_locationid = dropoff_zone.locationid)
    );
  
[0m01:40:48.948808 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:50fc6756-cbce-42bc-b884-2e2c4f15b364&page=queryresults
[0m01:40:52.123575 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.fact_trips (execute): 01:40:48.087676 => 01:40:52.122522
[0m01:40:52.130275 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '833a8709-18ad-4c43-947d-8ec377f9858c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff85f0ee0>]}
[0m01:40:52.133208 [info ] [Thread-4 (]: 13 of 13 OK created sql table model production.fact_trips ...................... [[32mCREATE TABLE (196.0 rows, 276.2 MiB processed)[0m in 4.06s]
[0m01:40:52.136258 [debug] [Thread-4 (]: Finished running node model.taxi_rides_ny.fact_trips
[0m01:40:52.141938 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:40:52.143160 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fact_trips' was properly closed.
[0m01:40:52.144297 [debug] [MainThread]: Connection 'test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989' was properly closed.
[0m01:40:52.145350 [debug] [MainThread]: Connection 'list_de-zoomcamp-413815' was properly closed.
[0m01:40:52.146253 [debug] [MainThread]: Connection 'model.taxi_rides_ny.dim_zones' was properly closed.
[0m01:40:52.147104 [debug] [MainThread]: Connection 'test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739' was properly closed.
[0m01:40:52.148809 [info ] [MainThread]: 
[0m01:40:52.150329 [info ] [MainThread]: Finished running 3 view models, 3 table models, 6 tests, 1 seed in 0 hours 0 minutes and 13.67 seconds (13.67s).
[0m01:40:52.155227 [debug] [MainThread]: Command end result
[0m01:40:52.180516 [info ] [MainThread]: 
[0m01:40:52.181345 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:40:52.182009 [info ] [MainThread]: 
[0m01:40:52.182783 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m01:40:52.184794 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 14.659019, "process_user_time": 4.716139, "process_kernel_time": 0.287298, "process_mem_max_rss": "171816", "process_out_blocks": "704", "process_in_blocks": "0"}
[0m01:40:52.185650 [debug] [MainThread]: Command `dbt build` succeeded at 01:40:52.185472 after 14.66 seconds
[0m01:40:52.186273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff859f400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff85cbdf0>]}
[0m01:40:52.187146 [debug] [MainThread]: Flushing usage events
[0m01:41:08.958551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00ce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00ee00>]}


============================== 01:41:08.970792 | 35bb35c8-85d0-4a5b-9fc1-a4bd8b854bee ==============================
[0m01:41:08.970792 [info ] [MainThread]: Running with dbt=1.7.7
[0m01:41:08.971717 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:41:09.328357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35bb35c8-85d0-4a5b-9fc1-a4bd8b854bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc6ee4d0>]}
[0m01:41:09.400829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35bb35c8-85d0-4a5b-9fc1-a4bd8b854bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95e9e70>]}
[0m01:41:09.401865 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m01:41:09.421202 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m01:41:09.493694 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:41:09.494923 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://taxi_rides_ny/models/staging/schema.yml
[0m01:41:09.766622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35bb35c8-85d0-4a5b-9fc1-a4bd8b854bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8e82110>]}
[0m01:41:09.782517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35bb35c8-85d0-4a5b-9fc1-a4bd8b854bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92c4250>]}
[0m01:41:09.783132 [info ] [MainThread]: Found 6 models, 1 seed, 7 tests, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m01:41:09.785215 [info ] [MainThread]: 
[0m01:41:09.786253 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:41:09.789121 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m01:41:09.789818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:41:09.790443 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m01:41:09.791506 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m01:41:09.792111 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:41:09.821471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:41:11.248300 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_dbt_staging'
[0m01:41:11.251601 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_production'
[0m01:41:11.253567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_dbt_abhishek_yadav)
[0m01:41:11.254503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:41:11.255340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:41:11.256225 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:41:11.781432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35bb35c8-85d0-4a5b-9fc1-a4bd8b854bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9287eb0>]}
[0m01:41:11.784781 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:41:11.786348 [info ] [MainThread]: 
[0m01:41:11.804461 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.my_first_dbt_model
[0m01:41:11.805543 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m01:41:11.806208 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:41:11.806976 [debug] [Thread-4 (]: Began running node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:41:11.807871 [info ] [Thread-1 (]: 1 of 14 START sql table model dbt_staging.my_first_dbt_model ................... [RUN]
[0m01:41:11.809316 [info ] [Thread-2 (]: 2 of 14 START sql view model dbt_staging.stg_green_trip_data ................... [RUN]
[0m01:41:11.810660 [info ] [Thread-3 (]: 3 of 14 START sql view model dbt_abhishek_yadav.stg_yellow_trip_data ........... [RUN]
[0m01:41:11.811980 [info ] [Thread-4 (]: 4 of 14 START seed file dbt_staging.taxi_zone_lookup ........................... [RUN]
[0m01:41:11.813643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_production, now model.taxi_rides_ny.my_first_dbt_model)
[0m01:41:11.815105 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_abhishek_yadav, now model.taxi_rides_ny.stg_green_trip_data)
[0m01:41:11.816957 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_staging, now model.taxi_rides_ny.stg_yellow_trip_data)
[0m01:41:11.818715 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now seed.taxi_rides_ny.taxi_zone_lookup)
[0m01:41:11.819778 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
[0m01:41:11.820479 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m01:41:11.821224 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:41:11.821918 [debug] [Thread-4 (]: Began compiling node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:41:11.832286 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
[0m01:41:11.838905 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m01:41:11.847088 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (compile): 01:41:11.846544 => 01:41:11.846550
[0m01:41:11.852700 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m01:41:11.854121 [debug] [Thread-4 (]: Began executing node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:41:11.856490 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (compile): 01:41:11.822442 => 01:41:11.856263
[0m01:41:11.856861 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 01:41:11.832950 => 01:41:11.856683
[0m01:41:11.870542 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (compile): 01:41:11.839408 => 01:41:11.870222
[0m01:41:11.870940 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.my_first_dbt_model
[0m01:41:11.872439 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m01:41:11.882439 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:41:11.883172 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:41:11.892250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:11.916731 [debug] [Thread-3 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m01:41:11.918117 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_trip_data"
[0m01:41:11.975898 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:41:11.976936 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:41:11.978965 [debug] [Thread-3 (]: On model.taxi_rides_ny.stg_yellow_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
  OPTIONS()
  as -- 

select
-- identifiers
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
TIMESTAMP_SECONDS(CAST(CAST(tpep_pickup_datetime as INT64)/10000000 AS INT64)) as pickup_datetime,
TIMESTAMP_SECONDS(CAST(CAST(tpep_dropoff_datetime as INT64)/10000000 AS INT64)) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
1 as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(0 as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`yello_trip_data`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), tpep_pickup_datetime)=1
-- dbt-bq run --select stg_green_tripdata  --var 'is_test_run: false'

limit 100
;


[0m01:41:12.006748 [debug] [Thread-2 (]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
  OPTIONS()
  as select
-- identifiers
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
cast(trip_type as integer) as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(ehail_fee as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), lpep_pickup_datetime)=1
-- dbt-bq compile --select stg_green_trip_data --vars '{'is_test_run': 'false'}'

limit 100
;


[0m01:41:12.505215 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.my_first_dbt_model"
[0m01:41:12.509220 [debug] [Thread-1 (]: On model.taxi_rides_ny.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_first_dbt_model"} */

  
    

    create or replace table `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m01:41:12.651143 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:f17cc2ae-dcab-43d6-b7d6-85869a65a394&page=queryresults
[0m01:41:12.681087 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:f7b72bc9-aafc-43f3-8e4a-6e2e8984fe52&page=queryresults
[0m01:41:12.774711 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:3fb70c81-0df1-4728-92e0-7d9e2cf2db68&page=queryresults
[0m01:41:12.923560 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (execute): 01:41:11.911936 => 01:41:12.923263
[0m01:41:12.925061 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35bb35c8-85d0-4a5b-9fc1-a4bd8b854bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8e74d90>]}
[0m01:41:12.926860 [info ] [Thread-3 (]: 3 of 14 OK created sql view model dbt_abhishek_yadav.stg_yellow_trip_data ...... [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m01:41:12.928304 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:41:12.929702 [debug] [Thread-3 (]: Began running node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:41:12.930595 [info ] [Thread-3 (]: 5 of 14 START test accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_  [RUN]
[0m01:41:12.932089 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_yellow_trip_data, now test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad)
[0m01:41:12.933085 [debug] [Thread-3 (]: Began compiling node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:41:12.943502 [debug] [Thread-3 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad"
[0m01:41:12.946411 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad (compile): 01:41:12.933807 => 01:41:12.946013
[0m01:41:12.947257 [debug] [Thread-3 (]: Began executing node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:41:12.968870 [debug] [Thread-3 (]: Writing runtime sql for node "test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad"
[0m01:41:12.971050 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:41:12.973222 [debug] [Thread-3 (]: On test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_type as value_field,
        count(*) as n_records

    from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
    group by payment_type

)

select *
from all_values
where value_field not in (
    1,2,3,4,5
)



      
    ) dbt_internal_test
[0m01:41:13.117919 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 01:41:11.892668 => 01:41:13.117608
[0m01:41:13.119344 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35bb35c8-85d0-4a5b-9fc1-a4bd8b854bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8e33a60>]}
[0m01:41:13.120336 [info ] [Thread-2 (]: 2 of 14 OK created sql view model dbt_staging.stg_green_trip_data .............. [[32mCREATE VIEW (0 processed)[0m in 1.30s]
[0m01:41:13.121601 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m01:41:13.122404 [debug] [Thread-2 (]: Began running node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:41:13.123278 [info ] [Thread-2 (]: 6 of 14 START test unique_stg_yellow_trip_data_tripid .......................... [RUN]
[0m01:41:13.124449 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_green_trip_data, now test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de)
[0m01:41:13.125074 [debug] [Thread-2 (]: Began compiling node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:41:13.136908 [debug] [Thread-2 (]: Writing injected SQL for node "test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de"
[0m01:41:13.139906 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de (compile): 01:41:13.125504 => 01:41:13.139603
[0m01:41:13.140417 [debug] [Thread-2 (]: Began executing node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:41:13.143128 [debug] [Thread-2 (]: Writing runtime sql for node "test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de"
[0m01:41:13.145487 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:41:13.147516 [debug] [Thread-2 (]: On test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select tripid as unique_field
  from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
  where tripid is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m01:41:14.311104 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:d4904c71-040f-46ad-a2fc-c43afe8b7f05&page=queryresults
[0m01:41:14.469023 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (execute): 01:41:11.883601 => 01:41:14.467932
[0m01:41:14.481717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35bb35c8-85d0-4a5b-9fc1-a4bd8b854bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9011d80>]}
[0m01:41:14.484380 [info ] [Thread-1 (]: 1 of 14 OK created sql table model dbt_staging.my_first_dbt_model .............. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.67s]
[0m01:41:14.486804 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.my_first_dbt_model
[0m01:41:14.488424 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:41:14.490100 [info ] [Thread-1 (]: 7 of 14 START test accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_  [RUN]
[0m01:41:14.492183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.my_first_dbt_model, now test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9)
[0m01:41:14.493301 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:41:14.505355 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9"
[0m01:41:14.509404 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9 (compile): 01:41:14.494120 => 01:41:14.508806
[0m01:41:14.510677 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:41:14.515419 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9"
[0m01:41:14.518197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:14.520868 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_type as value_field,
        count(*) as n_records

    from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
    group by payment_type

)

select *
from all_values
where value_field not in (
    1,2,3,4,5
)



      
    ) dbt_internal_test
[0m01:41:14.688389 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad (execute): 01:41:12.947923 => 01:41:14.687873
[0m01:41:14.690159 [info ] [Thread-3 (]: 5 of 14 PASS accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_  [[32mPASS[0m in 1.76s]
[0m01:41:14.691479 [debug] [Thread-3 (]: Finished running node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:41:14.692398 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.my_second_dbt_model
[0m01:41:14.693351 [info ] [Thread-3 (]: 8 of 14 START sql view model dbt_staging.my_second_dbt_model ................... [RUN]
[0m01:41:14.695068 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad, now model.taxi_rides_ny.my_second_dbt_model)
[0m01:41:14.696754 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
[0m01:41:14.701311 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
[0m01:41:14.703440 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (compile): 01:41:14.697510 => 01:41:14.703086
[0m01:41:14.704187 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.my_second_dbt_model
[0m01:41:14.709162 [debug] [Thread-3 (]: Writing runtime sql for node "model.taxi_rides_ny.my_second_dbt_model"
[0m01:41:14.710859 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:41:14.712946 [debug] [Thread-3 (]: On model.taxi_rides_ny.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_second_dbt_model"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
where id = 1;


[0m01:41:14.834433 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:b6695974-59c1-48f2-ae71-b8ac6da3fa0b&page=queryresults
[0m01:41:14.912713 [debug] [Thread-4 (]: On seed.taxi_rides_ny.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "seed.taxi_rides_ny.taxi_zone_lookup"} */

    alter table `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup` set OPTIONS()
  
[0m01:41:15.131806 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:28a0eb58-41ea-4613-b7b8-b0567a55e05d&page=queryresults
[0m01:41:15.199512 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de (execute): 01:41:13.140768 => 01:41:15.198851
[0m01:41:15.202067 [info ] [Thread-2 (]: 6 of 14 PASS unique_stg_yellow_trip_data_tripid ................................ [[32mPASS[0m in 2.08s]
[0m01:41:15.204184 [debug] [Thread-2 (]: Finished running node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:41:15.343271 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:4bf349f4-09fe-4966-9260-44adbf9293a3&page=queryresults
[0m01:41:15.366147 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.taxi_rides_ny.taxi_zone_lookup"
[0m01:41:15.375958 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (execute): 01:41:11.857218 => 01:41:15.375500
[0m01:41:15.377767 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35bb35c8-85d0-4a5b-9fc1-a4bd8b854bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92c61d0>]}
[0m01:41:15.379001 [info ] [Thread-4 (]: 4 of 14 OK loaded seed file dbt_staging.taxi_zone_lookup ....................... [[32mINSERT 265[0m in 3.56s]
[0m01:41:15.380361 [debug] [Thread-4 (]: Finished running node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:41:15.381944 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.dim_zones
[0m01:41:15.382560 [debug] [Thread-4 (]: Began running node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:41:15.383719 [info ] [Thread-2 (]: 9 of 14 START sql table model production.dim_zones ............................. [RUN]
[0m01:41:15.385142 [info ] [Thread-4 (]: 10 of 14 START test relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m01:41:15.386563 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de, now model.taxi_rides_ny.dim_zones)
[0m01:41:15.387877 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.taxi_rides_ny.taxi_zone_lookup, now test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f)
[0m01:41:15.388784 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m01:41:15.389546 [debug] [Thread-4 (]: Began compiling node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:41:15.394678 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m01:41:15.401419 [debug] [Thread-4 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f"
[0m01:41:15.403194 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.dim_zones (compile): 01:41:15.390200 => 01:41:15.402909
[0m01:41:15.403840 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m01:41:15.404334 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f (compile): 01:41:15.395464 => 01:41:15.404063
[0m01:41:15.407371 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:41:15.408175 [debug] [Thread-4 (]: Began executing node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:41:15.411564 [debug] [Thread-4 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f"
[0m01:41:15.441508 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:41:15.443438 [debug] [Thread-4 (]: On test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select dropoff_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
    where dropoff_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:41:15.557251 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (execute): 01:41:14.704701 => 01:41:15.557012
[0m01:41:15.558404 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35bb35c8-85d0-4a5b-9fc1-a4bd8b854bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8437910>]}
[0m01:41:15.559216 [info ] [Thread-3 (]: 8 of 14 OK created sql view model dbt_staging.my_second_dbt_model .............. [[32mCREATE VIEW (0 processed)[0m in 0.86s]
[0m01:41:15.560089 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.my_second_dbt_model
[0m01:41:15.560738 [debug] [Thread-3 (]: Began running node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:41:15.561336 [info ] [Thread-3 (]: 11 of 14 START test relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m01:41:15.562339 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.my_second_dbt_model, now test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989)
[0m01:41:15.562902 [debug] [Thread-3 (]: Began compiling node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:41:15.568383 [debug] [Thread-3 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989"
[0m01:41:15.570075 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989 (compile): 01:41:15.563250 => 01:41:15.569853
[0m01:41:15.570548 [debug] [Thread-3 (]: Began executing node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:41:15.573131 [debug] [Thread-3 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989"
[0m01:41:15.575028 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:41:15.576865 [debug] [Thread-3 (]: On test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select pickup_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
    where pickup_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:41:15.885597 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_zones"
[0m01:41:15.889479 [debug] [Thread-2 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */

  
    

    create or replace table `de-zoomcamp-413815`.`production`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      select 
locationid,
borough,
zone,
replace(service_zone, 'Boro', 'Green') as service_zone
from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
    );
  
[0m01:41:16.234444 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:30148239-e30b-4229-b142-35c13af075e4&page=queryresults
[0m01:41:16.242602 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:9076ab18-248f-4ead-8ed1-a9c82afdb392&page=queryresults
[0m01:41:16.619119 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9 (execute): 01:41:14.511506 => 01:41:16.617368
[0m01:41:16.626738 [info ] [Thread-1 (]: 7 of 14 PASS accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_  [[32mPASS[0m in 2.13s]
[0m01:41:16.631041 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:41:16.632922 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:41:16.635107 [info ] [Thread-1 (]: 12 of 14 START test relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m01:41:16.637152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9, now test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3)
[0m01:41:16.637989 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:41:16.644218 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3"
[0m01:41:16.646216 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3 (compile): 01:41:16.638479 => 01:41:16.645920
[0m01:41:16.646814 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:41:16.650202 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3"
[0m01:41:16.652039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:16.654030 [debug] [Thread-1 (]: On test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select dropoff_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
    where dropoff_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:41:17.060556 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:c1b99bd2-d699-4296-8d3f-cd89689370f7&page=queryresults
[0m01:41:17.174115 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:1202e76b-0ae9-4d9b-9896-90f9423c1517&page=queryresults
[0m01:41:17.445374 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f (execute): 01:41:15.408938 => 01:41:17.443572
[0m01:41:17.454258 [info ] [Thread-4 (]: 10 of 14 PASS relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 2.06s]
[0m01:41:17.465197 [debug] [Thread-4 (]: Finished running node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:41:17.468105 [debug] [Thread-4 (]: Began running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:41:17.469809 [info ] [Thread-4 (]: 13 of 14 START test relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m01:41:17.472542 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f, now test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739)
[0m01:41:17.474416 [debug] [Thread-4 (]: Began compiling node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:41:17.489263 [debug] [Thread-4 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739"
[0m01:41:17.492678 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739 (compile): 01:41:17.475684 => 01:41:17.492144
[0m01:41:17.493591 [debug] [Thread-4 (]: Began executing node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:41:17.496993 [debug] [Thread-4 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739"
[0m01:41:17.498945 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:41:17.501752 [debug] [Thread-4 (]: On test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select pickup_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
    where pickup_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:41:17.554012 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989 (execute): 01:41:15.570885 => 01:41:17.553676
[0m01:41:17.555109 [info ] [Thread-3 (]: 11 of 14 PASS relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 1.99s]
[0m01:41:17.555911 [debug] [Thread-3 (]: Finished running node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:41:17.640563 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.dim_zones (execute): 01:41:15.404870 => 01:41:17.640291
[0m01:41:17.642113 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35bb35c8-85d0-4a5b-9fc1-a4bd8b854bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8dd7e50>]}
[0m01:41:17.642991 [info ] [Thread-2 (]: 9 of 14 OK created sql table model production.dim_zones ........................ [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 2.26s]
[0m01:41:17.643988 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m01:41:18.179558 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:6d662198-5aca-4b20-be8b-3c8d83195a5d&page=queryresults
[0m01:41:18.559849 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3 (execute): 01:41:16.647321 => 01:41:18.557675
[0m01:41:18.563776 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:7e604b00-851e-4bdc-b648-1efbefc5f322&page=queryresults
[0m01:41:18.570469 [info ] [Thread-1 (]: 12 of 14 PASS relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 1.93s]
[0m01:41:18.578390 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:41:18.986479 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739 (execute): 01:41:17.494171 => 01:41:18.983537
[0m01:41:18.996155 [info ] [Thread-4 (]: 13 of 14 PASS relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 1.52s]
[0m01:41:19.000440 [debug] [Thread-4 (]: Finished running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:41:19.005966 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.fact_trips
[0m01:41:19.007621 [info ] [Thread-3 (]: 14 of 14 START sql table model production.fact_trips ........................... [RUN]
[0m01:41:19.010132 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989, now model.taxi_rides_ny.fact_trips)
[0m01:41:19.011392 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.fact_trips
[0m01:41:19.021950 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.fact_trips"
[0m01:41:19.026381 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.fact_trips (compile): 01:41:19.012462 => 01:41:19.025763
[0m01:41:19.027391 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.fact_trips
[0m01:41:19.032173 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:41:19.540520 [debug] [Thread-3 (]: Writing runtime sql for node "model.taxi_rides_ny.fact_trips"
[0m01:41:19.548161 [debug] [Thread-3 (]: On model.taxi_rides_ny.fact_trips: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.fact_trips"} */

  
    

    create or replace table `de-zoomcamp-413815`.`production`.`fact_trips`
      
    
    

    OPTIONS()
    as (
      with green_trip_data as(
    select *,
        'Green' as service_type
    from 
    `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
),

yellow_trip_data as(
    select *,
        'Yellow' as service_type
    from 
    `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
),

trips_unioned as(
    select * from green_trip_data
    union all
    select * from yellow_trip_data
),
dim_zones as (
    select * from `de-zoomcamp-413815`.`production`.`dim_zones`
    where borough <> 'Unknown'
)

select trips_unioned.tripid, 
    trips_unioned.vendorid, 
    trips_unioned.service_type,
    trips_unioned.ratecodeid, 
    trips_unioned.pickup_locationid, 
    pickup_zone.borough as pickup_borough, 
    pickup_zone.zone as pickup_zone, 
    trips_unioned.dropoff_locationid,
    dropoff_zone.borough as dropoff_borough, 
    dropoff_zone.zone as dropoff_zone,  
    trips_unioned.pickup_datetime, 
    trips_unioned.dropoff_datetime, 
    trips_unioned.store_and_fwd_flag, 
    trips_unioned.passenger_count, 
    trips_unioned.trip_distance, 
    trips_unioned.trip_type, 
    trips_unioned.fare_amount, 
    trips_unioned.extra, 
    trips_unioned.mta_tax, 
    trips_unioned.tip_amount, 
    trips_unioned.tolls_amount, 
    trips_unioned.ehail_fee, 
    trips_unioned.improvement_surcharge, 
    trips_unioned.total_amount, 
    trips_unioned.payment_type, 
    trips_unioned.payment_type_description
from trips_unioned
inner join dim_zones as pickup_zone
on (trips_unioned.pickup_locationid = pickup_zone.locationid)
inner join dim_zones as dropoff_zone
on (trips_unioned.dropoff_locationid = dropoff_zone.locationid)
    );
  
[0m01:41:19.915041 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:c54bb5a5-c310-45ed-ad23-ff2f8dcc73b1&page=queryresults
[0m01:41:23.100493 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.fact_trips (execute): 01:41:19.028097 => 01:41:23.099581
[0m01:41:23.107470 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35bb35c8-85d0-4a5b-9fc1-a4bd8b854bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8e8e890>]}
[0m01:41:23.109621 [info ] [Thread-3 (]: 14 of 14 OK created sql table model production.fact_trips ...................... [[32mCREATE TABLE (197.0 rows, 276.2 MiB processed)[0m in 4.10s]
[0m01:41:23.112214 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.fact_trips
[0m01:41:23.117104 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:41:23.118528 [debug] [MainThread]: Connection 'model.taxi_rides_ny.dim_zones' was properly closed.
[0m01:41:23.119695 [debug] [MainThread]: Connection 'list_de-zoomcamp-413815' was properly closed.
[0m01:41:23.120959 [debug] [MainThread]: Connection 'test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739' was properly closed.
[0m01:41:23.121873 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fact_trips' was properly closed.
[0m01:41:23.122680 [debug] [MainThread]: Connection 'test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3' was properly closed.
[0m01:41:23.124163 [info ] [MainThread]: 
[0m01:41:23.125242 [info ] [MainThread]: Finished running 3 view models, 3 table models, 7 tests, 1 seed in 0 hours 0 minutes and 13.34 seconds (13.34s).
[0m01:41:23.130389 [debug] [MainThread]: Command end result
[0m01:41:23.162973 [info ] [MainThread]: 
[0m01:41:23.164376 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:41:23.165539 [info ] [MainThread]: 
[0m01:41:23.166786 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m01:41:23.169078 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 14.26486, "process_user_time": 4.792527, "process_kernel_time": 0.269071, "process_mem_max_rss": "178272", "process_out_blocks": "704", "process_in_blocks": "0"}
[0m01:41:23.170160 [debug] [MainThread]: Command `dbt build` succeeded at 01:41:23.169949 after 14.27 seconds
[0m01:41:23.170936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff963b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8d6f3d0>]}
[0m01:41:23.171895 [debug] [MainThread]: Flushing usage events
[0m01:41:34.206637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00db10>]}


============================== 01:41:34.218490 | 0d3a08af-25c7-474c-9018-59a0e5e5dc44 ==============================
[0m01:41:34.218490 [info ] [MainThread]: Running with dbt=1.7.7
[0m01:41:34.219572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:41:34.576282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d3a08af-25c7-474c-9018-59a0e5e5dc44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cc3ee0>]}
[0m01:41:34.648243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d3a08af-25c7-474c-9018-59a0e5e5dc44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95ef280>]}
[0m01:41:34.649149 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m01:41:34.667506 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m01:41:34.739525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:41:34.740733 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://taxi_rides_ny/models/staging/schema.yml
[0m01:41:35.012408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d3a08af-25c7-474c-9018-59a0e5e5dc44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9002020>]}
[0m01:41:35.027489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d3a08af-25c7-474c-9018-59a0e5e5dc44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92c81c0>]}
[0m01:41:35.028068 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m01:41:35.030128 [info ] [MainThread]: 
[0m01:41:35.031251 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:41:35.034050 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m01:41:35.034722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:41:35.035342 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m01:41:35.036365 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m01:41:35.036974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:41:35.039765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:41:36.420129 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_dbt_staging'
[0m01:41:36.423238 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_production'
[0m01:41:36.425599 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_dbt_abhishek_yadav)
[0m01:41:36.427313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:41:36.428828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:41:36.430254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:41:36.927353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d3a08af-25c7-474c-9018-59a0e5e5dc44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9088340>]}
[0m01:41:36.930190 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:41:36.931926 [info ] [MainThread]: 
[0m01:41:36.948591 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.my_first_dbt_model
[0m01:41:36.949603 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m01:41:36.950297 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:41:36.951097 [debug] [Thread-4 (]: Began running node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:41:36.951988 [info ] [Thread-1 (]: 1 of 15 START sql table model dbt_staging.my_first_dbt_model ................... [RUN]
[0m01:41:36.953432 [info ] [Thread-2 (]: 2 of 15 START sql view model dbt_staging.stg_green_trip_data ................... [RUN]
[0m01:41:36.954836 [info ] [Thread-3 (]: 3 of 15 START sql view model dbt_abhishek_yadav.stg_yellow_trip_data ........... [RUN]
[0m01:41:36.956014 [info ] [Thread-4 (]: 4 of 15 START seed file dbt_staging.taxi_zone_lookup ........................... [RUN]
[0m01:41:36.957246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_abhishek_yadav, now model.taxi_rides_ny.my_first_dbt_model)
[0m01:41:36.958688 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_production, now model.taxi_rides_ny.stg_green_trip_data)
[0m01:41:36.960192 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_staging, now model.taxi_rides_ny.stg_yellow_trip_data)
[0m01:41:36.961654 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now seed.taxi_rides_ny.taxi_zone_lookup)
[0m01:41:36.962539 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
[0m01:41:36.963252 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m01:41:36.963910 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:41:36.964564 [debug] [Thread-4 (]: Began compiling node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:41:36.974486 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
[0m01:41:36.980865 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m01:41:36.985974 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (compile): 01:41:36.985660 => 01:41:36.985665
[0m01:41:36.994067 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m01:41:36.995372 [debug] [Thread-4 (]: Began executing node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:41:36.996266 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (compile): 01:41:36.965114 => 01:41:36.996051
[0m01:41:36.996780 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 01:41:36.975171 => 01:41:36.996576
[0m01:41:37.002907 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (compile): 01:41:36.981314 => 01:41:37.002648
[0m01:41:37.011960 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.my_first_dbt_model
[0m01:41:37.013467 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m01:41:37.023508 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:41:37.023844 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:41:37.033108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:37.054576 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_trip_data"
[0m01:41:37.058979 [debug] [Thread-3 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m01:41:37.114949 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:41:37.115702 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:41:37.117319 [debug] [Thread-2 (]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
  OPTIONS()
  as select
-- identifiers
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
cast(trip_type as integer) as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(ehail_fee as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), lpep_pickup_datetime)=1
-- dbt-bq compile --select stg_green_trip_data --vars '{'is_test_run': 'false'}'

limit 100
;


[0m01:41:37.145956 [debug] [Thread-3 (]: On model.taxi_rides_ny.stg_yellow_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
  OPTIONS()
  as -- 

select
-- identifiers
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
TIMESTAMP_SECONDS(CAST(CAST(tpep_pickup_datetime as INT64)/10000000 AS INT64)) as pickup_datetime,
TIMESTAMP_SECONDS(CAST(CAST(tpep_dropoff_datetime as INT64)/10000000 AS INT64)) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
1 as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(0 as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`yello_trip_data`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), tpep_pickup_datetime)=1
-- dbt-bq run --select stg_green_tripdata  --var 'is_test_run: false'

limit 100
;


[0m01:41:37.588951 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.my_first_dbt_model"
[0m01:41:37.597544 [debug] [Thread-1 (]: On model.taxi_rides_ny.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_first_dbt_model"} */

  
    

    create or replace table `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m01:41:37.759727 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:c14d0b75-df5f-4633-ad7c-ea22a96d1f52&page=queryresults
[0m01:41:37.777246 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:15d8926c-993b-4623-bcbc-ef36bc133538&page=queryresults
[0m01:41:37.894206 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:71011359-7098-4489-89d7-5be8ddf775ba&page=queryresults
[0m01:41:38.010901 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 01:41:37.033521 => 01:41:38.010674
[0m01:41:38.012046 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d3a08af-25c7-474c-9018-59a0e5e5dc44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff901a470>]}
[0m01:41:38.013294 [info ] [Thread-2 (]: 2 of 15 OK created sql view model dbt_staging.stg_green_trip_data .............. [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m01:41:38.014343 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m01:41:38.015276 [debug] [Thread-2 (]: Began running node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:41:38.015949 [info ] [Thread-2 (]: 5 of 15 START test accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_  [RUN]
[0m01:41:38.017046 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_green_trip_data, now test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9)
[0m01:41:38.017793 [debug] [Thread-2 (]: Began compiling node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:41:38.023379 [debug] [Thread-2 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9"
[0m01:41:38.025385 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9 (compile): 01:41:38.018253 => 01:41:38.025116
[0m01:41:38.025996 [debug] [Thread-2 (]: Began executing node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:41:38.040908 [debug] [Thread-2 (]: Writing runtime sql for node "test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9"
[0m01:41:38.042457 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:41:38.044246 [debug] [Thread-2 (]: On test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_type as value_field,
        count(*) as n_records

    from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
    group by payment_type

)

select *
from all_values
where value_field not in (
    1,2,3,4,5
)



      
    ) dbt_internal_test
[0m01:41:38.118633 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (execute): 01:41:37.055858 => 01:41:38.118405
[0m01:41:38.119666 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d3a08af-25c7-474c-9018-59a0e5e5dc44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff901a800>]}
[0m01:41:38.120420 [info ] [Thread-3 (]: 3 of 15 OK created sql view model dbt_abhishek_yadav.stg_yellow_trip_data ...... [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m01:41:38.121219 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:41:38.122070 [debug] [Thread-3 (]: Began running node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:41:38.122585 [info ] [Thread-3 (]: 6 of 15 START test accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_  [RUN]
[0m01:41:38.123442 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_yellow_trip_data, now test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad)
[0m01:41:38.123973 [debug] [Thread-3 (]: Began compiling node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:41:38.132860 [debug] [Thread-3 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad"
[0m01:41:38.135379 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad (compile): 01:41:38.124311 => 01:41:38.135082
[0m01:41:38.135955 [debug] [Thread-3 (]: Began executing node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:41:38.138667 [debug] [Thread-3 (]: Writing runtime sql for node "test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad"
[0m01:41:38.140030 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:41:38.141635 [debug] [Thread-3 (]: On test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_type as value_field,
        count(*) as n_records

    from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
    group by payment_type

)

select *
from all_values
where value_field not in (
    1,2,3,4,5
)



      
    ) dbt_internal_test
[0m01:41:39.315045 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (execute): 01:41:37.024258 => 01:41:39.314439
[0m01:41:39.318614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d3a08af-25c7-474c-9018-59a0e5e5dc44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9287f10>]}
[0m01:41:39.320755 [info ] [Thread-1 (]: 1 of 15 OK created sql table model dbt_staging.my_first_dbt_model .............. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.36s]
[0m01:41:39.322935 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.my_first_dbt_model
[0m01:41:39.324280 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m01:41:39.326080 [info ] [Thread-1 (]: 7 of 15 START test not_null_stg_yellow_trip_data_tripid ........................ [RUN]
[0m01:41:39.328861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.my_first_dbt_model, now test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039)
[0m01:41:39.330351 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m01:41:39.347338 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039"
[0m01:41:39.350286 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039 (compile): 01:41:39.331390 => 01:41:39.349929
[0m01:41:39.351422 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m01:41:39.356413 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039"
[0m01:41:39.358874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:39.361515 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select tripid
from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
where tripid is null



      
    ) dbt_internal_test
[0m01:41:39.515916 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:ab0ef024-85cf-44f9-a8b2-9b012693008e&page=queryresults
[0m01:41:39.604317 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:0467fd62-8363-4a6b-847d-525b664589d7&page=queryresults
[0m01:41:39.876223 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad (execute): 01:41:38.136292 => 01:41:39.874626
[0m01:41:39.883902 [info ] [Thread-3 (]: 6 of 15 PASS accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_  [[32mPASS[0m in 1.76s]
[0m01:41:39.886785 [debug] [Thread-3 (]: Finished running node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:41:39.888469 [debug] [Thread-3 (]: Began running node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:41:39.889958 [info ] [Thread-3 (]: 8 of 15 START test unique_stg_yellow_trip_data_tripid .......................... [RUN]
[0m01:41:39.892260 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad, now test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de)
[0m01:41:39.893524 [debug] [Thread-3 (]: Began compiling node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:41:39.908274 [debug] [Thread-3 (]: Writing injected SQL for node "test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de"
[0m01:41:39.911392 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de (compile): 01:41:39.894377 => 01:41:39.910896
[0m01:41:39.912369 [debug] [Thread-3 (]: Began executing node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:41:39.921389 [debug] [Thread-3 (]: Writing runtime sql for node "test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de"
[0m01:41:39.923704 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:41:39.926051 [debug] [Thread-3 (]: On test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select tripid as unique_field
  from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
  where tripid is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m01:41:39.970898 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9 (execute): 01:41:38.026437 => 01:41:39.970562
[0m01:41:39.971951 [info ] [Thread-2 (]: 5 of 15 PASS accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_  [[32mPASS[0m in 1.96s]
[0m01:41:39.972845 [debug] [Thread-2 (]: Finished running node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:41:39.973441 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.my_second_dbt_model
[0m01:41:39.974068 [info ] [Thread-2 (]: 9 of 15 START sql view model dbt_staging.my_second_dbt_model ................... [RUN]
[0m01:41:39.974880 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9, now model.taxi_rides_ny.my_second_dbt_model)
[0m01:41:39.975377 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
[0m01:41:39.978536 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
[0m01:41:39.980189 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (compile): 01:41:39.975737 => 01:41:39.979955
[0m01:41:39.980679 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.my_second_dbt_model
[0m01:41:39.983915 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.my_second_dbt_model"
[0m01:41:39.985336 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:41:39.987048 [debug] [Thread-2 (]: On model.taxi_rides_ny.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_second_dbt_model"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
where id = 1;


[0m01:41:40.112293 [debug] [Thread-4 (]: On seed.taxi_rides_ny.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "seed.taxi_rides_ny.taxi_zone_lookup"} */

    alter table `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup` set OPTIONS()
  
[0m01:41:40.356990 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:385d0b09-bec6-4a9c-bcd6-283b68f9bdd3&page=queryresults
[0m01:41:40.603501 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.taxi_rides_ny.taxi_zone_lookup"
[0m01:41:40.605309 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:46b0101d-7f67-4f5b-b9f1-d090e62c5668&page=queryresults
[0m01:41:40.615509 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (execute): 01:41:36.997377 => 01:41:40.615070
[0m01:41:40.617360 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d3a08af-25c7-474c-9018-59a0e5e5dc44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92badd0>]}
[0m01:41:40.618553 [info ] [Thread-4 (]: 4 of 15 OK loaded seed file dbt_staging.taxi_zone_lookup ....................... [[32mINSERT 265[0m in 3.66s]
[0m01:41:40.619926 [debug] [Thread-4 (]: Finished running node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:41:40.622127 [debug] [Thread-4 (]: Began running node model.taxi_rides_ny.dim_zones
[0m01:41:40.623467 [info ] [Thread-4 (]: 10 of 15 START sql table model production.dim_zones ............................ [RUN]
[0m01:41:40.625315 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.taxi_rides_ny.taxi_zone_lookup, now model.taxi_rides_ny.dim_zones)
[0m01:41:40.626255 [debug] [Thread-4 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m01:41:40.631511 [debug] [Thread-4 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m01:41:40.634342 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.dim_zones (compile): 01:41:40.626812 => 01:41:40.633887
[0m01:41:40.635113 [debug] [Thread-4 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m01:41:40.638644 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:41:40.808927 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (execute): 01:41:39.981026 => 01:41:40.808603
[0m01:41:40.810449 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d3a08af-25c7-474c-9018-59a0e5e5dc44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8e02380>]}
[0m01:41:40.811488 [info ] [Thread-2 (]: 9 of 15 OK created sql view model dbt_staging.my_second_dbt_model .............. [[32mCREATE VIEW (0 processed)[0m in 0.84s]
[0m01:41:40.812616 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.my_second_dbt_model
[0m01:41:40.813451 [debug] [Thread-2 (]: Began running node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:41:40.814244 [info ] [Thread-2 (]: 11 of 15 START test relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m01:41:40.815413 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.my_second_dbt_model, now test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f)
[0m01:41:40.816113 [debug] [Thread-2 (]: Began compiling node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:41:40.822947 [debug] [Thread-2 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f"
[0m01:41:40.826751 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f (compile): 01:41:40.816608 => 01:41:40.826300
[0m01:41:40.827550 [debug] [Thread-2 (]: Began executing node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:41:40.830942 [debug] [Thread-2 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f"
[0m01:41:40.832459 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:41:40.834462 [debug] [Thread-2 (]: On test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select dropoff_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
    where dropoff_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:41:40.869984 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:646037c2-24ec-4b41-b88d-5b3ed84b0766&page=queryresults
[0m01:41:41.109367 [debug] [Thread-4 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_zones"
[0m01:41:41.112387 [debug] [Thread-4 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */

  
    

    create or replace table `de-zoomcamp-413815`.`production`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      select 
locationid,
borough,
zone,
replace(service_zone, 'Boro', 'Green') as service_zone
from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
    );
  
[0m01:41:41.214387 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039 (execute): 01:41:39.352295 => 01:41:41.212893
[0m01:41:41.218824 [info ] [Thread-1 (]: 7 of 15 PASS not_null_stg_yellow_trip_data_tripid .............................. [[32mPASS[0m in 1.89s]
[0m01:41:41.221800 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m01:41:41.223790 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:41:41.225387 [info ] [Thread-1 (]: 12 of 15 START test relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m01:41:41.227564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039, now test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989)
[0m01:41:41.228825 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:41:41.241685 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989"
[0m01:41:41.245180 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989 (compile): 01:41:41.229668 => 01:41:41.244511
[0m01:41:41.246161 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:41:41.251112 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989"
[0m01:41:41.253406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:41.256478 [debug] [Thread-1 (]: On test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select pickup_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
    where pickup_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:41:41.391818 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:a90b5c5f-ae04-4605-9ad9-cf2995d4c4ea&page=queryresults
[0m01:41:41.471070 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:6cb2d526-eb00-4e25-ac9d-fb4a6077606b&page=queryresults
[0m01:41:41.832794 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de (execute): 01:41:39.912970 => 01:41:41.831893
[0m01:41:41.835180 [info ] [Thread-3 (]: 8 of 15 PASS unique_stg_yellow_trip_data_tripid ................................ [[32mPASS[0m in 1.94s]
[0m01:41:41.846143 [debug] [Thread-3 (]: Finished running node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:41:41.850192 [debug] [Thread-3 (]: Began running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:41:41.857083 [info ] [Thread-3 (]: 13 of 15 START test relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m01:41:41.863896 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de, now test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3)
[0m01:41:41.865731 [debug] [Thread-3 (]: Began compiling node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:41:41.880696 [debug] [Thread-3 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3"
[0m01:41:41.884814 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3 (compile): 01:41:41.866643 => 01:41:41.884238
[0m01:41:41.885883 [debug] [Thread-3 (]: Began executing node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:41:41.891393 [debug] [Thread-3 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3"
[0m01:41:41.893853 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:41:41.897385 [debug] [Thread-3 (]: On test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select dropoff_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
    where dropoff_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:41:42.552607 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:cd08b824-aa52-44ca-8f97-43cf56311fe1&page=queryresults
[0m01:41:42.816561 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:8f81cbbe-a17d-4935-aa2e-865025fd164e&page=queryresults
[0m01:41:42.829711 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.dim_zones (execute): 01:41:40.635607 => 01:41:42.829155
[0m01:41:42.843107 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d3a08af-25c7-474c-9018-59a0e5e5dc44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8d49450>]}
[0m01:41:42.845166 [info ] [Thread-4 (]: 10 of 15 OK created sql table model production.dim_zones ....................... [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 2.22s]
[0m01:41:42.847483 [debug] [Thread-4 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m01:41:42.848898 [debug] [Thread-4 (]: Began running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:41:42.850280 [info ] [Thread-4 (]: 14 of 15 START test relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m01:41:42.852345 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.dim_zones, now test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739)
[0m01:41:42.853489 [debug] [Thread-4 (]: Began compiling node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:41:42.864877 [debug] [Thread-4 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739"
[0m01:41:42.867809 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739 (compile): 01:41:42.854233 => 01:41:42.867279
[0m01:41:42.868743 [debug] [Thread-4 (]: Began executing node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:41:42.873718 [debug] [Thread-4 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739"
[0m01:41:42.876011 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:41:42.878785 [debug] [Thread-4 (]: On test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select pickup_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
    where pickup_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:41:42.910944 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:54737559-19ff-484c-b81a-6e5269ef9f5c&page=queryresults
[0m01:41:42.935404 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f (execute): 01:41:40.828100 => 01:41:42.935062
[0m01:41:42.936526 [info ] [Thread-2 (]: 11 of 15 PASS relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 2.12s]
[0m01:41:42.937390 [debug] [Thread-2 (]: Finished running node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:41:43.155764 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989 (execute): 01:41:41.246828 => 01:41:43.155403
[0m01:41:43.156907 [info ] [Thread-1 (]: 12 of 15 PASS relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 1.93s]
[0m01:41:43.158450 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:41:43.234441 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3 (execute): 01:41:41.886655 => 01:41:43.233292
[0m01:41:43.238386 [info ] [Thread-3 (]: 13 of 15 PASS relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 1.38s]
[0m01:41:43.241204 [debug] [Thread-3 (]: Finished running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:41:43.898035 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:0fc90fca-0cfb-49c5-8a12-ee563117ccff&page=queryresults
[0m01:41:44.285312 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739 (execute): 01:41:42.869323 => 01:41:44.283365
[0m01:41:44.290878 [info ] [Thread-4 (]: 14 of 15 PASS relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 1.44s]
[0m01:41:44.295698 [debug] [Thread-4 (]: Finished running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:41:44.301125 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.fact_trips
[0m01:41:44.303016 [info ] [Thread-2 (]: 15 of 15 START sql table model production.fact_trips ........................... [RUN]
[0m01:41:44.305866 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f, now model.taxi_rides_ny.fact_trips)
[0m01:41:44.307174 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.fact_trips
[0m01:41:44.317186 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.fact_trips"
[0m01:41:44.321519 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.fact_trips (compile): 01:41:44.308267 => 01:41:44.320908
[0m01:41:44.322173 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.fact_trips
[0m01:41:44.325605 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:41:44.799034 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.fact_trips"
[0m01:41:44.806801 [debug] [Thread-2 (]: On model.taxi_rides_ny.fact_trips: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.fact_trips"} */

  
    

    create or replace table `de-zoomcamp-413815`.`production`.`fact_trips`
      
    
    

    OPTIONS()
    as (
      with green_trip_data as(
    select *,
        'Green' as service_type
    from 
    `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
),

yellow_trip_data as(
    select *,
        'Yellow' as service_type
    from 
    `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
),

trips_unioned as(
    select * from green_trip_data
    union all
    select * from yellow_trip_data
),
dim_zones as (
    select * from `de-zoomcamp-413815`.`production`.`dim_zones`
    where borough <> 'Unknown'
)

select trips_unioned.tripid, 
    trips_unioned.vendorid, 
    trips_unioned.service_type,
    trips_unioned.ratecodeid, 
    trips_unioned.pickup_locationid, 
    pickup_zone.borough as pickup_borough, 
    pickup_zone.zone as pickup_zone, 
    trips_unioned.dropoff_locationid,
    dropoff_zone.borough as dropoff_borough, 
    dropoff_zone.zone as dropoff_zone,  
    trips_unioned.pickup_datetime, 
    trips_unioned.dropoff_datetime, 
    trips_unioned.store_and_fwd_flag, 
    trips_unioned.passenger_count, 
    trips_unioned.trip_distance, 
    trips_unioned.trip_type, 
    trips_unioned.fare_amount, 
    trips_unioned.extra, 
    trips_unioned.mta_tax, 
    trips_unioned.tip_amount, 
    trips_unioned.tolls_amount, 
    trips_unioned.ehail_fee, 
    trips_unioned.improvement_surcharge, 
    trips_unioned.total_amount, 
    trips_unioned.payment_type, 
    trips_unioned.payment_type_description
from trips_unioned
inner join dim_zones as pickup_zone
on (trips_unioned.pickup_locationid = pickup_zone.locationid)
inner join dim_zones as dropoff_zone
on (trips_unioned.dropoff_locationid = dropoff_zone.locationid)
    );
  
[0m01:41:45.228932 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:6ba4b1e7-bbfe-44c7-8e89-78f206894fd8&page=queryresults
[0m01:41:48.987303 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.fact_trips (execute): 01:41:44.322511 => 01:41:48.986395
[0m01:41:48.990843 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d3a08af-25c7-474c-9018-59a0e5e5dc44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8d6a980>]}
[0m01:41:48.993907 [info ] [Thread-2 (]: 15 of 15 OK created sql table model production.fact_trips ...................... [[32mCREATE TABLE (199.0 rows, 276.2 MiB processed)[0m in 4.69s]
[0m01:41:48.996748 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.fact_trips
[0m01:41:49.001736 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:41:49.003160 [debug] [MainThread]: Connection 'test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989' was properly closed.
[0m01:41:49.004357 [debug] [MainThread]: Connection 'list_de-zoomcamp-413815' was properly closed.
[0m01:41:49.005627 [debug] [MainThread]: Connection 'test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739' was properly closed.
[0m01:41:49.006541 [debug] [MainThread]: Connection 'test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3' was properly closed.
[0m01:41:49.007362 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fact_trips' was properly closed.
[0m01:41:49.008787 [info ] [MainThread]: 
[0m01:41:49.009934 [info ] [MainThread]: Finished running 3 view models, 3 table models, 8 tests, 1 seed in 0 hours 0 minutes and 13.98 seconds (13.98s).
[0m01:41:49.014733 [debug] [MainThread]: Command end result
[0m01:41:49.036745 [info ] [MainThread]: 
[0m01:41:49.037694 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:41:49.038461 [info ] [MainThread]: 
[0m01:41:49.039405 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m01:41:49.041631 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 14.888247, "process_user_time": 4.795211, "process_kernel_time": 0.254337, "process_mem_max_rss": "178008", "process_out_blocks": "704", "process_in_blocks": "0"}
[0m01:41:49.042704 [debug] [MainThread]: Command `dbt build` succeeded at 01:41:49.042516 after 14.89 seconds
[0m01:41:49.043634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9056290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff925f520>]}
[0m01:41:49.044522 [debug] [MainThread]: Flushing usage events
[0m01:42:04.242633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00e8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f610>]}


============================== 01:42:04.254225 | 2d1021ee-7b94-41ac-a292-467370b50f7d ==============================
[0m01:42:04.254225 [info ] [MainThread]: Running with dbt=1.7.7
[0m01:42:04.255270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:42:04.613798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d1021ee-7b94-41ac-a292-467370b50f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc579cc0>]}
[0m01:42:04.685741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d1021ee-7b94-41ac-a292-467370b50f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb7460>]}
[0m01:42:04.686605 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m01:42:04.705142 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m01:42:04.777470 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:42:04.778689 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://taxi_rides_ny/models/staging/schema.yml
[0m01:42:05.054804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d1021ee-7b94-41ac-a292-467370b50f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8e82710>]}
[0m01:42:05.070234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d1021ee-7b94-41ac-a292-467370b50f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92c89a0>]}
[0m01:42:05.070849 [info ] [MainThread]: Found 6 models, 1 seed, 9 tests, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m01:42:05.073105 [info ] [MainThread]: 
[0m01:42:05.074167 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:42:05.077142 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m01:42:05.077850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:42:05.078473 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m01:42:05.079557 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m01:42:05.080207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:42:05.109036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:42:06.415669 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_dbt_staging)
[0m01:42:06.419088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_production)
[0m01:42:06.421904 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_dbt_abhishek_yadav)
[0m01:42:06.424896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:42:06.425772 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:42:06.426294 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:42:06.933072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d1021ee-7b94-41ac-a292-467370b50f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9088af0>]}
[0m01:42:06.936284 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:42:06.937685 [info ] [MainThread]: 
[0m01:42:06.955845 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.my_first_dbt_model
[0m01:42:06.956921 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m01:42:06.957537 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:42:06.958306 [debug] [Thread-4 (]: Began running node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:42:06.959259 [info ] [Thread-1 (]: 1 of 16 START sql table model dbt_staging.my_first_dbt_model ................... [RUN]
[0m01:42:06.961030 [info ] [Thread-2 (]: 2 of 16 START sql view model dbt_staging.stg_green_trip_data ................... [RUN]
[0m01:42:06.962310 [info ] [Thread-3 (]: 3 of 16 START sql view model dbt_abhishek_yadav.stg_yellow_trip_data ........... [RUN]
[0m01:42:06.963622 [info ] [Thread-4 (]: 4 of 16 START seed file dbt_staging.taxi_zone_lookup ........................... [RUN]
[0m01:42:06.965504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_production, now model.taxi_rides_ny.my_first_dbt_model)
[0m01:42:06.967050 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_abhishek_yadav, now model.taxi_rides_ny.stg_green_trip_data)
[0m01:42:06.968567 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_staging, now model.taxi_rides_ny.stg_yellow_trip_data)
[0m01:42:06.970048 [debug] [Thread-4 (]: Acquiring new bigquery connection 'seed.taxi_rides_ny.taxi_zone_lookup'
[0m01:42:06.970759 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
[0m01:42:06.971320 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m01:42:06.972035 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:42:06.972634 [debug] [Thread-4 (]: Began compiling node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:42:06.982228 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
[0m01:42:06.988286 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m01:42:07.003090 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m01:42:07.003877 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (compile): 01:42:07.003629 => 01:42:07.003633
[0m01:42:07.005693 [debug] [Thread-4 (]: Began executing node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:42:07.006369 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 01:42:06.982768 => 01:42:07.006155
[0m01:42:07.006740 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (compile): 01:42:06.973053 => 01:42:07.006540
[0m01:42:07.012363 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (compile): 01:42:06.988922 => 01:42:07.012123
[0m01:42:07.020832 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m01:42:07.022275 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.my_first_dbt_model
[0m01:42:07.026621 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:42:07.032708 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:42:07.053983 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_trip_data"
[0m01:42:07.062684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:42:07.066179 [debug] [Thread-3 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m01:42:07.097341 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:42:07.125850 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:42:07.127628 [debug] [Thread-2 (]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
  OPTIONS()
  as select
-- identifiers
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
cast(trip_type as integer) as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(ehail_fee as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), lpep_pickup_datetime)=1
-- dbt-bq compile --select stg_green_trip_data --vars '{'is_test_run': 'false'}'

limit 100
;


[0m01:42:07.155526 [debug] [Thread-3 (]: On model.taxi_rides_ny.stg_yellow_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
  OPTIONS()
  as -- 

select
-- identifiers
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
TIMESTAMP_SECONDS(CAST(CAST(tpep_pickup_datetime as INT64)/10000000 AS INT64)) as pickup_datetime,
TIMESTAMP_SECONDS(CAST(CAST(tpep_dropoff_datetime as INT64)/10000000 AS INT64)) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
1 as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(0 as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`yello_trip_data`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), tpep_pickup_datetime)=1
-- dbt-bq run --select stg_green_tripdata  --var 'is_test_run: false'

limit 100
;


[0m01:42:07.658387 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.my_first_dbt_model"
[0m01:42:07.660394 [debug] [Thread-1 (]: On model.taxi_rides_ny.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_first_dbt_model"} */

  
    

    create or replace table `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m01:42:07.770030 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:c50158a0-7f40-4767-b5f7-cd85beb618d6&page=queryresults
[0m01:42:07.782371 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:d55089c6-f0ad-4e89-b50a-f7301db302ff&page=queryresults
[0m01:42:07.912399 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:4336d18d-a6a9-4cce-863f-e1bd5321c1a7&page=queryresults
[0m01:42:08.033466 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 01:42:07.033089 => 01:42:08.033077
[0m01:42:08.035272 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d1021ee-7b94-41ac-a292-467370b50f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff904beb0>]}
[0m01:42:08.037380 [info ] [Thread-2 (]: 2 of 16 OK created sql view model dbt_staging.stg_green_trip_data .............. [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m01:42:08.039021 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m01:42:08.040313 [debug] [Thread-2 (]: Began running node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:42:08.041118 [info ] [Thread-2 (]: 5 of 16 START test accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_  [RUN]
[0m01:42:08.042562 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_green_trip_data, now test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9)
[0m01:42:08.043505 [debug] [Thread-2 (]: Began compiling node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:42:08.051561 [debug] [Thread-2 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9"
[0m01:42:08.054040 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9 (compile): 01:42:08.044147 => 01:42:08.053685
[0m01:42:08.054743 [debug] [Thread-2 (]: Began executing node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:42:08.072006 [debug] [Thread-2 (]: Writing runtime sql for node "test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9"
[0m01:42:08.073903 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:42:08.076007 [debug] [Thread-2 (]: On test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_type as value_field,
        count(*) as n_records

    from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
    group by payment_type

)

select *
from all_values
where value_field not in (
    1,2,3,4,5
)



      
    ) dbt_internal_test
[0m01:42:08.230819 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (execute): 01:42:07.063091 => 01:42:08.230461
[0m01:42:08.232323 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d1021ee-7b94-41ac-a292-467370b50f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8e76830>]}
[0m01:42:08.233312 [info ] [Thread-3 (]: 3 of 16 OK created sql view model dbt_abhishek_yadav.stg_yellow_trip_data ...... [[32mCREATE VIEW (0 processed)[0m in 1.26s]
[0m01:42:08.234457 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:42:08.235282 [debug] [Thread-3 (]: Began running node test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5
[0m01:42:08.236194 [info ] [Thread-3 (]: 6 of 16 START test unique_stg_green_trip_data_tripid ........................... [RUN]
[0m01:42:08.237325 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_yellow_trip_data, now test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5)
[0m01:42:08.238038 [debug] [Thread-3 (]: Began compiling node test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5
[0m01:42:08.250396 [debug] [Thread-3 (]: Writing injected SQL for node "test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5"
[0m01:42:08.253446 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5 (compile): 01:42:08.238511 => 01:42:08.253089
[0m01:42:08.254045 [debug] [Thread-3 (]: Began executing node test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5
[0m01:42:08.257045 [debug] [Thread-3 (]: Writing runtime sql for node "test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5"
[0m01:42:08.258448 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:42:08.260232 [debug] [Thread-3 (]: On test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select tripid as unique_field
  from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
  where tripid is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m01:42:09.289762 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (execute): 01:42:07.054226 => 01:42:09.288679
[0m01:42:09.294317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d1021ee-7b94-41ac-a292-467370b50f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff901e020>]}
[0m01:42:09.296678 [info ] [Thread-1 (]: 1 of 16 OK created sql table model dbt_staging.my_first_dbt_model .............. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.33s]
[0m01:42:09.299381 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.my_first_dbt_model
[0m01:42:09.301662 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:42:09.303953 [info ] [Thread-1 (]: 7 of 16 START test accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_  [RUN]
[0m01:42:09.306171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.my_first_dbt_model, now test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad)
[0m01:42:09.307510 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:42:09.320197 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad"
[0m01:42:09.324487 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad (compile): 01:42:09.308408 => 01:42:09.323866
[0m01:42:09.325603 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:42:09.330678 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad"
[0m01:42:09.333700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:42:09.337310 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_type as value_field,
        count(*) as n_records

    from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
    group by payment_type

)

select *
from all_values
where value_field not in (
    1,2,3,4,5
)



      
    ) dbt_internal_test
[0m01:42:09.690269 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:eb0de72e-b0e5-440b-840b-b0011c5dfb53&page=queryresults
[0m01:42:10.084797 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9 (execute): 01:42:08.055260 => 01:42:10.081727
[0m01:42:10.090186 [info ] [Thread-2 (]: 5 of 16 PASS accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_  [[32mPASS[0m in 2.05s]
[0m01:42:10.095685 [debug] [Thread-2 (]: Finished running node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:42:10.097790 [debug] [Thread-2 (]: Began running node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m01:42:10.099567 [info ] [Thread-2 (]: 8 of 16 START test not_null_stg_yellow_trip_data_tripid ........................ [RUN]
[0m01:42:10.102388 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9, now test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039)
[0m01:42:10.104029 [debug] [Thread-2 (]: Began compiling node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m01:42:10.122086 [debug] [Thread-2 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039"
[0m01:42:10.125868 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039 (compile): 01:42:10.105041 => 01:42:10.125124
[0m01:42:10.127060 [debug] [Thread-2 (]: Began executing node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m01:42:10.133837 [debug] [Thread-2 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039"
[0m01:42:10.137413 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:42:10.139894 [debug] [Thread-2 (]: On test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select tripid
from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
where tripid is null



      
    ) dbt_internal_test
[0m01:42:10.296301 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:f84c21e3-6a62-4cf2-bb29-f37e00a0f38d&page=queryresults
[0m01:42:10.657025 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5 (execute): 01:42:08.254434 => 01:42:10.655243
[0m01:42:10.662759 [info ] [Thread-3 (]: 6 of 16 PASS unique_stg_green_trip_data_tripid ................................. [[32mPASS[0m in 2.42s]
[0m01:42:10.668704 [debug] [Thread-3 (]: Finished running node test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5
[0m01:42:10.671375 [debug] [Thread-3 (]: Began running node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:42:10.673201 [info ] [Thread-3 (]: 9 of 16 START test unique_stg_yellow_trip_data_tripid .......................... [RUN]
[0m01:42:10.675875 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5, now test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de)
[0m01:42:10.677328 [debug] [Thread-3 (]: Began compiling node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:42:10.691800 [debug] [Thread-3 (]: Writing injected SQL for node "test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de"
[0m01:42:10.693728 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:91a46745-c6ba-42fc-8300-95a1e728b82d&page=queryresults
[0m01:42:10.699254 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de (compile): 01:42:10.678507 => 01:42:10.698747
[0m01:42:10.700351 [debug] [Thread-3 (]: Began executing node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:42:10.704604 [debug] [Thread-3 (]: Writing runtime sql for node "test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de"
[0m01:42:10.707100 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:42:10.710174 [debug] [Thread-3 (]: On test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select tripid as unique_field
  from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
  where tripid is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m01:42:11.009110 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad (execute): 01:42:09.326302 => 01:42:11.008193
[0m01:42:11.011933 [info ] [Thread-1 (]: 7 of 16 PASS accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_  [[32mPASS[0m in 1.71s]
[0m01:42:11.014311 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:42:11.015924 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.my_second_dbt_model
[0m01:42:11.017481 [info ] [Thread-1 (]: 10 of 16 START sql view model dbt_staging.my_second_dbt_model .................. [RUN]
[0m01:42:11.019454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad, now model.taxi_rides_ny.my_second_dbt_model)
[0m01:42:11.020499 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
[0m01:42:11.027265 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
[0m01:42:11.030069 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (compile): 01:42:11.021226 => 01:42:11.029629
[0m01:42:11.031031 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.my_second_dbt_model
[0m01:42:11.037077 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.my_second_dbt_model"
[0m01:42:11.039496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:42:11.042408 [debug] [Thread-1 (]: On model.taxi_rides_ny.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_second_dbt_model"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
where id = 1;


[0m01:42:11.227871 [debug] [Thread-4 (]: On seed.taxi_rides_ny.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "seed.taxi_rides_ny.taxi_zone_lookup"} */

    alter table `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup` set OPTIONS()
  
[0m01:42:11.451889 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:95aa6bb2-f6d1-4cd1-9062-fe561a035a86&page=queryresults
[0m01:42:11.616958 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:cf29c433-8d52-430d-829f-d34c4a853d3c&page=queryresults
[0m01:42:11.666976 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.taxi_rides_ny.taxi_zone_lookup"
[0m01:42:11.675657 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (execute): 01:42:07.006928 => 01:42:11.675307
[0m01:42:11.677201 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d1021ee-7b94-41ac-a292-467370b50f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8e780d0>]}
[0m01:42:11.678256 [info ] [Thread-4 (]: 4 of 16 OK loaded seed file dbt_staging.taxi_zone_lookup ....................... [[32mINSERT 265[0m in 4.71s]
[0m01:42:11.679581 [debug] [Thread-4 (]: Finished running node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:42:11.680916 [debug] [Thread-4 (]: Began running node model.taxi_rides_ny.dim_zones
[0m01:42:11.681851 [info ] [Thread-4 (]: 11 of 16 START sql table model production.dim_zones ............................ [RUN]
[0m01:42:11.683266 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.taxi_rides_ny.taxi_zone_lookup, now model.taxi_rides_ny.dim_zones)
[0m01:42:11.684089 [debug] [Thread-4 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m01:42:11.688731 [debug] [Thread-4 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m01:42:11.690950 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.dim_zones (compile): 01:42:11.684611 => 01:42:11.690492
[0m01:42:11.691790 [debug] [Thread-4 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m01:42:11.695192 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:42:11.746460 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:5c7ae45a-1195-481b-b808-d8a06c1c4294&page=queryresults
[0m01:42:11.932628 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (execute): 01:42:11.031762 => 01:42:11.932392
[0m01:42:11.933699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d1021ee-7b94-41ac-a292-467370b50f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9066260>]}
[0m01:42:11.934384 [info ] [Thread-1 (]: 10 of 16 OK created sql view model dbt_staging.my_second_dbt_model ............. [[32mCREATE VIEW (0 processed)[0m in 0.91s]
[0m01:42:11.935255 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.my_second_dbt_model
[0m01:42:11.935922 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:42:11.936546 [info ] [Thread-1 (]: 12 of 16 START test relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m01:42:11.937438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.my_second_dbt_model, now test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f)
[0m01:42:11.937988 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:42:11.943609 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f"
[0m01:42:11.945266 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f (compile): 01:42:11.938346 => 01:42:11.945010
[0m01:42:11.945935 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:42:11.948799 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f"
[0m01:42:11.950408 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:42:11.952161 [debug] [Thread-1 (]: On test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select dropoff_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
    where dropoff_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:42:12.003334 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039 (execute): 01:42:10.127697 => 01:42:12.002975
[0m01:42:12.005165 [info ] [Thread-2 (]: 8 of 16 PASS not_null_stg_yellow_trip_data_tripid .............................. [[32mPASS[0m in 1.90s]
[0m01:42:12.006127 [debug] [Thread-2 (]: Finished running node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m01:42:12.006830 [debug] [Thread-2 (]: Began running node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:42:12.007457 [info ] [Thread-2 (]: 13 of 16 START test relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m01:42:12.008627 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039, now test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989)
[0m01:42:12.009171 [debug] [Thread-2 (]: Began compiling node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:42:12.014810 [debug] [Thread-2 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989"
[0m01:42:12.016759 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989 (compile): 01:42:12.009521 => 01:42:12.016421
[0m01:42:12.017453 [debug] [Thread-2 (]: Began executing node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:42:12.021189 [debug] [Thread-2 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989"
[0m01:42:12.022819 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:42:12.024762 [debug] [Thread-2 (]: On test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select pickup_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
    where pickup_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:42:12.258954 [debug] [Thread-4 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_zones"
[0m01:42:12.261503 [debug] [Thread-4 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */

  
    

    create or replace table `de-zoomcamp-413815`.`production`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      select 
locationid,
borough,
zone,
replace(service_zone, 'Boro', 'Green') as service_zone
from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
    );
  
[0m01:42:12.364652 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:69a30b46-7a4f-457b-bfef-1c42fecea706&page=queryresults
[0m01:42:12.550621 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:aef13330-816b-4c03-ba75-81008832b553&page=queryresults
[0m01:42:12.727665 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de (execute): 01:42:10.701013 => 01:42:12.725150
[0m01:42:12.733324 [info ] [Thread-3 (]: 9 of 16 PASS unique_stg_yellow_trip_data_tripid ................................ [[32mPASS[0m in 2.06s]
[0m01:42:12.737825 [debug] [Thread-3 (]: Finished running node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:42:12.739947 [debug] [Thread-3 (]: Began running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:42:12.741804 [info ] [Thread-3 (]: 14 of 16 START test relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m01:42:12.744565 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de, now test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3)
[0m01:42:12.746103 [debug] [Thread-3 (]: Began compiling node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:42:12.760817 [debug] [Thread-3 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3"
[0m01:42:12.764998 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3 (compile): 01:42:12.747129 => 01:42:12.764306
[0m01:42:12.766040 [debug] [Thread-3 (]: Began executing node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:42:12.771624 [debug] [Thread-3 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3"
[0m01:42:12.773559 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:42:12.776294 [debug] [Thread-3 (]: On test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select dropoff_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
    where dropoff_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:42:13.686667 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:ddcd52f5-1141-4443-9c6d-21d49e6be74d&page=queryresults
[0m01:42:13.703208 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:cec38386-7c80-4e23-a99f-9a0d4c4e6e7a&page=queryresults
[0m01:42:13.911818 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:25ed5ad3-a1de-4f5e-82b9-f99e6858dc71&page=queryresults
[0m01:42:14.056308 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f (execute): 01:42:11.946369 => 01:42:14.054109
[0m01:42:14.068612 [info ] [Thread-1 (]: 12 of 16 PASS relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 2.13s]
[0m01:42:14.078512 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989 (execute): 01:42:12.017958 => 01:42:14.077639
[0m01:42:14.087964 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:42:14.094022 [info ] [Thread-2 (]: 13 of 16 PASS relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 2.09s]
[0m01:42:14.096158 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:42:14.098044 [debug] [Thread-2 (]: Finished running node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:42:14.099092 [info ] [Thread-1 (]: 15 of 16 START test relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m01:42:14.101783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f, now test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739)
[0m01:42:14.102882 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:42:14.112052 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739"
[0m01:42:14.115332 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739 (compile): 01:42:14.103523 => 01:42:14.114797
[0m01:42:14.116157 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:42:14.120128 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739"
[0m01:42:14.122008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:42:14.124380 [debug] [Thread-1 (]: On test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select pickup_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
    where pickup_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:42:14.177577 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.dim_zones (execute): 01:42:11.692284 => 01:42:14.177361
[0m01:42:14.178579 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d1021ee-7b94-41ac-a292-467370b50f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff84ac8b0>]}
[0m01:42:14.179261 [info ] [Thread-4 (]: 11 of 16 OK created sql table model production.dim_zones ....................... [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 2.50s]
[0m01:42:14.180065 [debug] [Thread-4 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m01:42:14.291504 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3 (execute): 01:42:12.766698 => 01:42:14.291023
[0m01:42:14.293560 [info ] [Thread-3 (]: 14 of 16 PASS relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 1.55s]
[0m01:42:14.294846 [debug] [Thread-3 (]: Finished running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:42:15.209180 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:a23393c8-7b1e-422b-882c-6efd818084ba&page=queryresults
[0m01:42:15.594037 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739 (execute): 01:42:14.116662 => 01:42:15.591264
[0m01:42:15.601066 [info ] [Thread-1 (]: 15 of 16 PASS relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 1.50s]
[0m01:42:15.607055 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:42:15.613005 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.fact_trips
[0m01:42:15.615046 [info ] [Thread-2 (]: 16 of 16 START sql table model production.fact_trips ........................... [RUN]
[0m01:42:15.617988 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989, now model.taxi_rides_ny.fact_trips)
[0m01:42:15.619790 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.fact_trips
[0m01:42:15.635378 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.fact_trips"
[0m01:42:15.638149 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.fact_trips (compile): 01:42:15.620970 => 01:42:15.637726
[0m01:42:15.638972 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.fact_trips
[0m01:42:15.643799 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:42:16.225350 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.fact_trips"
[0m01:42:16.228122 [debug] [Thread-2 (]: On model.taxi_rides_ny.fact_trips: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.fact_trips"} */

  
    

    create or replace table `de-zoomcamp-413815`.`production`.`fact_trips`
      
    
    

    OPTIONS()
    as (
      with green_trip_data as(
    select *,
        'Green' as service_type
    from 
    `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
),

yellow_trip_data as(
    select *,
        'Yellow' as service_type
    from 
    `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
),

trips_unioned as(
    select * from green_trip_data
    union all
    select * from yellow_trip_data
),
dim_zones as (
    select * from `de-zoomcamp-413815`.`production`.`dim_zones`
    where borough <> 'Unknown'
)

select trips_unioned.tripid, 
    trips_unioned.vendorid, 
    trips_unioned.service_type,
    trips_unioned.ratecodeid, 
    trips_unioned.pickup_locationid, 
    pickup_zone.borough as pickup_borough, 
    pickup_zone.zone as pickup_zone, 
    trips_unioned.dropoff_locationid,
    dropoff_zone.borough as dropoff_borough, 
    dropoff_zone.zone as dropoff_zone,  
    trips_unioned.pickup_datetime, 
    trips_unioned.dropoff_datetime, 
    trips_unioned.store_and_fwd_flag, 
    trips_unioned.passenger_count, 
    trips_unioned.trip_distance, 
    trips_unioned.trip_type, 
    trips_unioned.fare_amount, 
    trips_unioned.extra, 
    trips_unioned.mta_tax, 
    trips_unioned.tip_amount, 
    trips_unioned.tolls_amount, 
    trips_unioned.ehail_fee, 
    trips_unioned.improvement_surcharge, 
    trips_unioned.total_amount, 
    trips_unioned.payment_type, 
    trips_unioned.payment_type_description
from trips_unioned
inner join dim_zones as pickup_zone
on (trips_unioned.pickup_locationid = pickup_zone.locationid)
inner join dim_zones as dropoff_zone
on (trips_unioned.dropoff_locationid = dropoff_zone.locationid)
    );
  
[0m01:42:16.650381 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:71d4b746-603a-44cd-9d4f-a00f17c4af6a&page=queryresults
[0m01:42:19.844756 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.fact_trips (execute): 01:42:15.639604 => 01:42:19.839879
[0m01:42:19.851793 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d1021ee-7b94-41ac-a292-467370b50f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8342200>]}
[0m01:42:19.853872 [info ] [Thread-2 (]: 16 of 16 OK created sql table model production.fact_trips ...................... [[32mCREATE TABLE (198.0 rows, 276.2 MiB processed)[0m in 4.23s]
[0m01:42:19.855690 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.fact_trips
[0m01:42:19.860834 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:42:19.862132 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fact_trips' was properly closed.
[0m01:42:19.863263 [debug] [MainThread]: Connection 'test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3' was properly closed.
[0m01:42:19.864300 [debug] [MainThread]: Connection 'test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739' was properly closed.
[0m01:42:19.865302 [debug] [MainThread]: Connection 'model.taxi_rides_ny.dim_zones' was properly closed.
[0m01:42:19.866917 [info ] [MainThread]: 
[0m01:42:19.868393 [info ] [MainThread]: Finished running 3 view models, 3 table models, 9 tests, 1 seed in 0 hours 0 minutes and 14.79 seconds (14.79s).
[0m01:42:19.874775 [debug] [MainThread]: Command end result
[0m01:42:19.892940 [info ] [MainThread]: 
[0m01:42:19.894083 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:42:19.895168 [info ] [MainThread]: 
[0m01:42:19.896243 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m01:42:19.898377 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 15.709508, "process_user_time": 5.083831, "process_kernel_time": 0.246446, "process_mem_max_rss": "178148", "process_in_blocks": "16", "process_out_blocks": "704"}
[0m01:42:19.899545 [debug] [MainThread]: Command `dbt build` succeeded at 01:42:19.899248 after 15.71 seconds
[0m01:42:19.900558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8e77970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb7460>]}
[0m01:42:19.901462 [debug] [MainThread]: Flushing usage events
[0m01:42:30.853627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00db10>]}


============================== 01:42:30.865685 | 87601b11-608a-4b57-97e8-4f4d8e41f529 ==============================
[0m01:42:30.865685 [info ] [MainThread]: Running with dbt=1.7.7
[0m01:42:30.866615 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:42:31.224246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87601b11-608a-4b57-97e8-4f4d8e41f529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00dcf0>]}
[0m01:42:31.296990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87601b11-608a-4b57-97e8-4f4d8e41f529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff941c790>]}
[0m01:42:31.297938 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m01:42:31.317523 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m01:42:31.390956 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:42:31.392265 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://taxi_rides_ny/models/staging/schema.yml
[0m01:42:31.670717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87601b11-608a-4b57-97e8-4f4d8e41f529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8e86140>]}
[0m01:42:31.686100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87601b11-608a-4b57-97e8-4f4d8e41f529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92cc160>]}
[0m01:42:31.686701 [info ] [MainThread]: Found 6 models, 1 seed, 10 tests, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m01:42:31.688940 [info ] [MainThread]: 
[0m01:42:31.690021 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:42:31.692696 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m01:42:31.693404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:42:31.694030 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m01:42:31.695068 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m01:42:31.695768 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:42:31.724539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:42:33.113994 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_dbt_staging)
[0m01:42:33.117018 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_dbt_abhishek_yadav)
[0m01:42:33.119165 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_production)
[0m01:42:33.120853 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:42:33.122201 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:42:33.122807 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:42:33.738251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87601b11-608a-4b57-97e8-4f4d8e41f529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff928bd60>]}
[0m01:42:33.742843 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:42:33.744913 [info ] [MainThread]: 
[0m01:42:33.758351 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.my_first_dbt_model
[0m01:42:33.759165 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m01:42:33.759720 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:42:33.760339 [debug] [Thread-4 (]: Began running node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:42:33.761210 [info ] [Thread-1 (]: 1 of 17 START sql table model dbt_staging.my_first_dbt_model ................... [RUN]
[0m01:42:33.762307 [info ] [Thread-2 (]: 2 of 17 START sql view model dbt_staging.stg_green_trip_data ................... [RUN]
[0m01:42:33.763344 [info ] [Thread-3 (]: 3 of 17 START sql view model dbt_abhishek_yadav.stg_yellow_trip_data ........... [RUN]
[0m01:42:33.764199 [info ] [Thread-4 (]: 4 of 17 START seed file dbt_staging.taxi_zone_lookup ........................... [RUN]
[0m01:42:33.765639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_staging, now model.taxi_rides_ny.my_first_dbt_model)
[0m01:42:33.766827 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_production, now model.taxi_rides_ny.stg_green_trip_data)
[0m01:42:33.767909 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_abhishek_yadav, now model.taxi_rides_ny.stg_yellow_trip_data)
[0m01:42:33.769080 [debug] [Thread-4 (]: Acquiring new bigquery connection 'seed.taxi_rides_ny.taxi_zone_lookup'
[0m01:42:33.769778 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
[0m01:42:33.770437 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m01:42:33.771109 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:42:33.771673 [debug] [Thread-4 (]: Began compiling node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:42:33.781342 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
[0m01:42:33.788739 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m01:42:33.805836 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m01:42:33.806476 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (compile): 01:42:33.806172 => 01:42:33.806176
[0m01:42:33.808198 [debug] [Thread-4 (]: Began executing node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:42:33.809000 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (compile): 01:42:33.772143 => 01:42:33.808753
[0m01:42:33.814804 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 01:42:33.782051 => 01:42:33.814514
[0m01:42:33.822319 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (compile): 01:42:33.789354 => 01:42:33.821981
[0m01:42:33.826270 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.my_first_dbt_model
[0m01:42:33.827117 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m01:42:33.838007 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:42:33.838331 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:42:33.847707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:42:33.869395 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_trip_data"
[0m01:42:33.873810 [debug] [Thread-3 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m01:42:33.930706 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:42:33.931522 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:42:33.933383 [debug] [Thread-2 (]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
  OPTIONS()
  as select
-- identifiers
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
cast(trip_type as integer) as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(ehail_fee as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), lpep_pickup_datetime)=1
-- dbt-bq compile --select stg_green_trip_data --vars '{'is_test_run': 'false'}'

limit 100
;


[0m01:42:33.935421 [debug] [Thread-3 (]: On model.taxi_rides_ny.stg_yellow_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
  OPTIONS()
  as -- 

select
-- identifiers
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
TIMESTAMP_SECONDS(CAST(CAST(tpep_pickup_datetime as INT64)/10000000 AS INT64)) as pickup_datetime,
TIMESTAMP_SECONDS(CAST(CAST(tpep_dropoff_datetime as INT64)/10000000 AS INT64)) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
1 as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(0 as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`yello_trip_data`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), tpep_pickup_datetime)=1
-- dbt-bq run --select stg_green_tripdata  --var 'is_test_run: false'

limit 100
;


[0m01:42:34.545970 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.my_first_dbt_model"
[0m01:42:34.547963 [debug] [Thread-1 (]: On model.taxi_rides_ny.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_first_dbt_model"} */

  
    

    create or replace table `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m01:42:34.662592 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:c840a5f1-0145-4bc1-9735-44b3a5c748da&page=queryresults
[0m01:42:34.736029 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:1144bd5a-2cfa-4f2a-b820-cfbab0a0a060&page=queryresults
[0m01:42:34.825582 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:9ec7dd84-879b-4fdc-8626-c240690f1ecd&page=queryresults
[0m01:42:35.169032 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (execute): 01:42:33.870715 => 01:42:35.168583
[0m01:42:35.171076 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87601b11-608a-4b57-97e8-4f4d8e41f529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8e2dab0>]}
[0m01:42:35.173065 [info ] [Thread-3 (]: 3 of 17 OK created sql view model dbt_abhishek_yadav.stg_yellow_trip_data ...... [[32mCREATE VIEW (0 processed)[0m in 1.40s]
[0m01:42:35.174464 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:42:35.175981 [debug] [Thread-3 (]: Began running node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:42:35.176903 [info ] [Thread-3 (]: 5 of 17 START test accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_  [RUN]
[0m01:42:35.178292 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_yellow_trip_data, now test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad)
[0m01:42:35.179143 [debug] [Thread-3 (]: Began compiling node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:42:35.186160 [debug] [Thread-3 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad"
[0m01:42:35.188629 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad (compile): 01:42:35.179656 => 01:42:35.188231
[0m01:42:35.189306 [debug] [Thread-3 (]: Began executing node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:42:35.205823 [debug] [Thread-3 (]: Writing runtime sql for node "test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad"
[0m01:42:35.207581 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:42:35.210847 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 01:42:33.848181 => 01:42:35.210643
[0m01:42:35.212619 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87601b11-608a-4b57-97e8-4f4d8e41f529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8e8ba30>]}
[0m01:42:35.213072 [debug] [Thread-3 (]: On test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_type as value_field,
        count(*) as n_records

    from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
    group by payment_type

)

select *
from all_values
where value_field not in (
    1,2,3,4,5
)



      
    ) dbt_internal_test
[0m01:42:35.213807 [info ] [Thread-2 (]: 2 of 17 OK created sql view model dbt_staging.stg_green_trip_data .............. [[32mCREATE VIEW (0 processed)[0m in 1.45s]
[0m01:42:35.242541 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m01:42:35.244031 [debug] [Thread-2 (]: Began running node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m01:42:35.244866 [info ] [Thread-2 (]: 6 of 17 START test not_null_stg_yellow_trip_data_tripid ........................ [RUN]
[0m01:42:35.245819 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_green_trip_data, now test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039)
[0m01:42:35.246502 [debug] [Thread-2 (]: Began compiling node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m01:42:35.256636 [debug] [Thread-2 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039"
[0m01:42:35.258033 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039 (compile): 01:42:35.246934 => 01:42:35.257811
[0m01:42:35.258560 [debug] [Thread-2 (]: Began executing node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m01:42:35.261123 [debug] [Thread-2 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039"
[0m01:42:35.262256 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:42:35.263907 [debug] [Thread-2 (]: On test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select tripid
from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
where tripid is null



      
    ) dbt_internal_test
[0m01:42:36.247203 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (execute): 01:42:33.838729 => 01:42:36.245837
[0m01:42:36.253071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87601b11-608a-4b57-97e8-4f4d8e41f529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8e8a260>]}
[0m01:42:36.255979 [info ] [Thread-1 (]: 1 of 17 OK created sql table model dbt_staging.my_first_dbt_model .............. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.49s]
[0m01:42:36.259059 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.my_first_dbt_model
[0m01:42:36.260883 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:42:36.262945 [info ] [Thread-1 (]: 7 of 17 START test unique_stg_yellow_trip_data_tripid .......................... [RUN]
[0m01:42:36.265365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.my_first_dbt_model, now test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de)
[0m01:42:36.266639 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:42:36.282018 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de"
[0m01:42:36.286006 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de (compile): 01:42:36.267455 => 01:42:36.285523
[0m01:42:36.286790 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:42:36.290849 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de"
[0m01:42:36.293347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:42:36.295863 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select tripid as unique_field
  from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
  where tripid is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m01:42:36.695566 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:1b1085be-eb8f-42f4-8dc0-202308821a89&page=queryresults
[0m01:42:36.883081 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:b1ae7850-5dec-42af-b751-09e3fe0b2d7c&page=queryresults
[0m01:42:37.012404 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad (execute): 01:42:35.189783 => 01:42:37.008493
[0m01:42:37.018097 [info ] [Thread-3 (]: 5 of 17 PASS accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_  [[32mPASS[0m in 1.84s]
[0m01:42:37.023305 [debug] [Thread-3 (]: Finished running node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:42:37.025092 [debug] [Thread-3 (]: Began running node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:42:37.026506 [info ] [Thread-3 (]: 8 of 17 START test accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_  [RUN]
[0m01:42:37.028642 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad, now test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9)
[0m01:42:37.029917 [debug] [Thread-3 (]: Began compiling node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:42:37.042174 [debug] [Thread-3 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9"
[0m01:42:37.045406 [debug] [Thread-4 (]: On seed.taxi_rides_ny.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "seed.taxi_rides_ny.taxi_zone_lookup"} */

    alter table `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup` set OPTIONS()
  
[0m01:42:37.049647 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9 (compile): 01:42:37.030755 => 01:42:37.049162
[0m01:42:37.050501 [debug] [Thread-3 (]: Began executing node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:42:37.056351 [debug] [Thread-3 (]: Writing runtime sql for node "test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9"
[0m01:42:37.058502 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:42:37.061501 [debug] [Thread-3 (]: On test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_type as value_field,
        count(*) as n_records

    from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
    group by payment_type

)

select *
from all_values
where value_field not in (
    1,2,3,4,5
)



      
    ) dbt_internal_test
[0m01:42:37.219710 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039 (execute): 01:42:35.258921 => 01:42:37.219168
[0m01:42:37.221402 [info ] [Thread-2 (]: 6 of 17 PASS not_null_stg_yellow_trip_data_tripid .............................. [[32mPASS[0m in 1.98s]
[0m01:42:37.222663 [debug] [Thread-2 (]: Finished running node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m01:42:37.223459 [debug] [Thread-2 (]: Began running node test.taxi_rides_ny.not_stg_green_trip_data_tripid.60d95c01e5
[0m01:42:37.224230 [info ] [Thread-2 (]: 9 of 17 START test not_stg_green_trip_data_tripid .............................. [RUN]
[0m01:42:37.225359 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039, now test.taxi_rides_ny.not_stg_green_trip_data_tripid.60d95c01e5)
[0m01:42:37.226133 [debug] [Thread-2 (]: Began compiling node test.taxi_rides_ny.not_stg_green_trip_data_tripid.60d95c01e5
[0m01:42:37.233557 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.not_stg_green_trip_data_tripid.60d95c01e5 (compile): 01:42:37.226667 => 01:42:37.233167
[0m01:42:37.240441 [debug] [Thread-2 (]: Compilation Error in test not_stg_green_trip_data_tripid (taxi_rides_ny/models/staging/schema.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m01:42:37.241306 [error] [Thread-2 (]: 9 of 17 ERROR not_stg_green_trip_data_tripid ................................... [[31mERROR[0m in 0.02s]
[0m01:42:37.242090 [debug] [Thread-2 (]: Finished running node test.taxi_rides_ny.not_stg_green_trip_data_tripid.60d95c01e5
[0m01:42:37.242705 [debug] [Thread-2 (]: Began running node test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5
[0m01:42:37.243316 [info ] [Thread-2 (]: 10 of 17 START test unique_stg_green_trip_data_tripid .......................... [RUN]
[0m01:42:37.244312 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_stg_green_trip_data_tripid.60d95c01e5, now test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5)
[0m01:42:37.244862 [debug] [Thread-2 (]: Began compiling node test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5
[0m01:42:37.249750 [debug] [Thread-2 (]: Writing injected SQL for node "test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5"
[0m01:42:37.251342 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5 (compile): 01:42:37.245224 => 01:42:37.251118
[0m01:42:37.251850 [debug] [Thread-2 (]: Began executing node test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5
[0m01:42:37.254485 [debug] [Thread-2 (]: Writing runtime sql for node "test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5"
[0m01:42:37.255481 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:42:37.257188 [debug] [Thread-2 (]: On test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select tripid as unique_field
  from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
  where tripid is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m01:42:37.285577 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:e814a1a7-7546-4269-bdc7-368a15fe5a46&page=queryresults
[0m01:42:37.475655 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.taxi_rides_ny.taxi_zone_lookup"
[0m01:42:37.480046 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (execute): 01:42:33.809242 => 01:42:37.479771
[0m01:42:37.481182 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87601b11-608a-4b57-97e8-4f4d8e41f529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92ccf40>]}
[0m01:42:37.481970 [info ] [Thread-4 (]: 4 of 17 OK loaded seed file dbt_staging.taxi_zone_lookup ....................... [[32mINSERT 265[0m in 3.71s]
[0m01:42:37.483002 [debug] [Thread-4 (]: Finished running node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:42:37.483757 [debug] [Thread-4 (]: Began running node model.taxi_rides_ny.my_second_dbt_model
[0m01:42:37.484702 [info ] [Thread-4 (]: 11 of 17 START sql view model dbt_staging.my_second_dbt_model .................. [RUN]
[0m01:42:37.486005 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.taxi_rides_ny.taxi_zone_lookup, now model.taxi_rides_ny.my_second_dbt_model)
[0m01:42:37.486676 [debug] [Thread-4 (]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
[0m01:42:37.490546 [debug] [Thread-4 (]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
[0m01:42:37.492395 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (compile): 01:42:37.487108 => 01:42:37.492123
[0m01:42:37.493024 [debug] [Thread-4 (]: Began executing node model.taxi_rides_ny.my_second_dbt_model
[0m01:42:37.497710 [debug] [Thread-4 (]: Writing runtime sql for node "model.taxi_rides_ny.my_second_dbt_model"
[0m01:42:37.499141 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:42:37.501006 [debug] [Thread-4 (]: On model.taxi_rides_ny.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_second_dbt_model"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
where id = 1;


[0m01:42:37.959395 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:262e5985-2d90-4fd1-9703-3e2067e7e90d&page=queryresults
[0m01:42:38.302962 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:38b464af-7611-45a6-8bbf-27d349227efb&page=queryresults
[0m01:42:38.324736 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de (execute): 01:42:36.287214 => 01:42:38.323759
[0m01:42:38.328466 [info ] [Thread-1 (]: 7 of 17 PASS unique_stg_yellow_trip_data_tripid ................................ [[32mPASS[0m in 2.06s]
[0m01:42:38.331312 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:42:38.333020 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.dim_zones
[0m01:42:38.334785 [info ] [Thread-1 (]: 12 of 17 START sql table model production.dim_zones ............................ [RUN]
[0m01:42:38.337520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de, now model.taxi_rides_ny.dim_zones)
[0m01:42:38.339074 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m01:42:38.346607 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m01:42:38.349741 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.dim_zones (compile): 01:42:38.339916 => 01:42:38.349193
[0m01:42:38.350840 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m01:42:38.355832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:42:38.498612 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (execute): 01:42:37.493462 => 01:42:38.498300
[0m01:42:38.500018 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87601b11-608a-4b57-97e8-4f4d8e41f529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8e78250>]}
[0m01:42:38.500930 [info ] [Thread-4 (]: 11 of 17 OK created sql view model dbt_staging.my_second_dbt_model ............. [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m01:42:38.502060 [debug] [Thread-4 (]: Finished running node model.taxi_rides_ny.my_second_dbt_model
[0m01:42:38.502782 [debug] [Thread-4 (]: Began running node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:42:38.503462 [info ] [Thread-4 (]: 13 of 17 START test relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m01:42:38.504479 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.my_second_dbt_model, now test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f)
[0m01:42:38.505120 [debug] [Thread-4 (]: Began compiling node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:42:38.511354 [debug] [Thread-4 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f"
[0m01:42:38.513364 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f (compile): 01:42:38.505573 => 01:42:38.513080
[0m01:42:38.513928 [debug] [Thread-4 (]: Began executing node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:42:38.516833 [debug] [Thread-4 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f"
[0m01:42:38.518188 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:42:38.520003 [debug] [Thread-4 (]: On test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select dropoff_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
    where dropoff_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:42:38.649658 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:70c37291-a50f-4c71-a150-4e9f480593a3&page=queryresults
[0m01:42:38.920545 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_zones"
[0m01:42:38.925402 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */

  
    

    create or replace table `de-zoomcamp-413815`.`production`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      select 
locationid,
borough,
zone,
replace(service_zone, 'Boro', 'Green') as service_zone
from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
    );
  
[0m01:42:38.967710 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9 (execute): 01:42:37.051106 => 01:42:38.966381
[0m01:42:38.972201 [info ] [Thread-3 (]: 8 of 17 PASS accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_  [[32mPASS[0m in 1.94s]
[0m01:42:38.973603 [debug] [Thread-3 (]: Finished running node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:42:38.974332 [debug] [Thread-3 (]: Began running node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:42:38.974977 [info ] [Thread-3 (]: 14 of 17 START test relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m01:42:38.975999 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9, now test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989)
[0m01:42:38.976600 [debug] [Thread-3 (]: Began compiling node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:42:38.984657 [debug] [Thread-3 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989"
[0m01:42:38.986285 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989 (compile): 01:42:38.976977 => 01:42:38.986043
[0m01:42:38.986798 [debug] [Thread-3 (]: Began executing node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:42:38.990294 [debug] [Thread-3 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989"
[0m01:42:38.995151 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:42:38.997153 [debug] [Thread-3 (]: On test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select pickup_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
    where pickup_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:42:39.246832 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:22bfc99f-3ba5-48f2-8e32-e45eaddb32ca&page=queryresults
[0m01:42:39.542808 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:d6999ce9-b71f-4e03-8a81-ade0c8cb9ef6&page=queryresults
[0m01:42:40.002124 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5 (execute): 01:42:37.252236 => 01:42:39.999030
[0m01:42:40.009764 [info ] [Thread-2 (]: 10 of 17 PASS unique_stg_green_trip_data_tripid ................................ [[32mPASS[0m in 2.76s]
[0m01:42:40.017687 [debug] [Thread-2 (]: Finished running node test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5
[0m01:42:40.020023 [debug] [Thread-2 (]: Began running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:42:40.022915 [info ] [Thread-2 (]: 15 of 17 START test relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m01:42:40.025635 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5, now test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3)
[0m01:42:40.027137 [debug] [Thread-2 (]: Began compiling node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:42:40.038376 [debug] [Thread-2 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3"
[0m01:42:40.041900 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3 (compile): 01:42:40.028210 => 01:42:40.041376
[0m01:42:40.043175 [debug] [Thread-2 (]: Began executing node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:42:40.048440 [debug] [Thread-2 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3"
[0m01:42:40.051070 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:42:40.054051 [debug] [Thread-2 (]: On test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select dropoff_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
    where dropoff_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:42:40.186361 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:45cee339-f51c-45d0-b4fb-49b16d62083f&page=queryresults
[0m01:42:40.517585 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f (execute): 01:42:38.514303 => 01:42:40.515838
[0m01:42:40.522211 [info ] [Thread-4 (]: 13 of 17 PASS relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 2.02s]
[0m01:42:40.525200 [debug] [Thread-4 (]: Finished running node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:42:40.527104 [debug] [Thread-4 (]: Began running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:42:40.528599 [info ] [Thread-4 (]: 16 of 17 START test relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m01:42:40.530696 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f, now test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739)
[0m01:42:40.531970 [debug] [Thread-4 (]: Began compiling node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:42:40.544800 [debug] [Thread-4 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739"
[0m01:42:40.548113 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739 (compile): 01:42:40.532839 => 01:42:40.547661
[0m01:42:40.549475 [debug] [Thread-4 (]: Began executing node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:42:40.554870 [debug] [Thread-4 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739"
[0m01:42:40.558073 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:42:40.560946 [debug] [Thread-4 (]: On test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select pickup_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
    where pickup_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:42:40.611219 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.dim_zones (execute): 01:42:38.351719 => 01:42:40.611006
[0m01:42:40.612351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87601b11-608a-4b57-97e8-4f4d8e41f529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8d3a0e0>]}
[0m01:42:40.613116 [info ] [Thread-1 (]: 12 of 17 OK created sql table model production.dim_zones ....................... [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 2.28s]
[0m01:42:40.613978 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m01:42:40.732642 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:5445381f-b37c-40fe-85a2-a9377f3d4d02&page=queryresults
[0m01:42:41.079059 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989 (execute): 01:42:38.987885 => 01:42:41.077006
[0m01:42:41.087156 [info ] [Thread-3 (]: 14 of 17 PASS relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 2.11s]
[0m01:42:41.095118 [debug] [Thread-3 (]: Finished running node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:42:41.543593 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:c9be421b-dd76-4689-b165-2ce7323f5f34&page=queryresults
[0m01:42:41.639927 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:99264c3f-5bc2-489e-bce4-5d5cc82aac8b&page=queryresults
[0m01:42:41.923157 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3 (execute): 01:42:40.044216 => 01:42:41.920970
[0m01:42:41.930608 [info ] [Thread-2 (]: 15 of 17 PASS relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 1.91s]
[0m01:42:41.933574 [debug] [Thread-2 (]: Finished running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:42:42.028467 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739 (execute): 01:42:40.550197 => 01:42:42.026427
[0m01:42:42.036821 [info ] [Thread-4 (]: 16 of 17 PASS relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 1.51s]
[0m01:42:42.039543 [debug] [Thread-4 (]: Finished running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:42:42.043114 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fact_trips
[0m01:42:42.045425 [info ] [Thread-1 (]: 17 of 17 SKIP relation production.fact_trips ................................... [[33mSKIP[0m]
[0m01:42:42.046951 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fact_trips
[0m01:42:42.051984 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:42:42.053557 [debug] [MainThread]: Connection 'test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989' was properly closed.
[0m01:42:42.054675 [debug] [MainThread]: Connection 'test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3' was properly closed.
[0m01:42:42.055554 [debug] [MainThread]: Connection 'model.taxi_rides_ny.dim_zones' was properly closed.
[0m01:42:42.056390 [debug] [MainThread]: Connection 'test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739' was properly closed.
[0m01:42:42.057917 [info ] [MainThread]: 
[0m01:42:42.059295 [info ] [MainThread]: Finished running 3 view models, 3 table models, 10 tests, 1 seed in 0 hours 0 minutes and 10.37 seconds (10.37s).
[0m01:42:42.065690 [debug] [MainThread]: Command end result
[0m01:42:42.085579 [info ] [MainThread]: 
[0m01:42:42.086486 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:42:42.087308 [info ] [MainThread]: 
[0m01:42:42.088116 [error] [MainThread]:   Compilation Error in test not_stg_green_trip_data_tripid (taxi_rides_ny/models/staging/schema.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m01:42:42.088875 [info ] [MainThread]: 
[0m01:42:42.089865 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=1 SKIP=1 TOTAL=17
[0m01:42:42.091925 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 11.292411, "process_user_time": 4.921033, "process_kernel_time": 0.281576, "process_mem_max_rss": "175500", "process_in_blocks": "368", "process_out_blocks": "704", "command_success": false}
[0m01:42:42.093090 [debug] [MainThread]: Command `dbt build` failed at 01:42:42.092902 after 11.29 seconds
[0m01:42:42.093787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8ee4670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff838ff70>]}
[0m01:42:42.094427 [debug] [MainThread]: Flushing usage events
[0m01:44:38.068123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00dd20>]}


============================== 01:44:38.081628 | 9a989fa5-7681-4f4c-870f-7dc8ff005a5c ==============================
[0m01:44:38.081628 [info ] [MainThread]: Running with dbt=1.7.7
[0m01:44:38.082859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt build', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:44:38.477279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a989fa5-7681-4f4c-870f-7dc8ff005a5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f010>]}
[0m01:44:38.553962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a989fa5-7681-4f4c-870f-7dc8ff005a5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff963d360>]}
[0m01:44:38.555084 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m01:44:38.577033 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m01:44:38.654719 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:44:38.655318 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:44:38.662058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a989fa5-7681-4f4c-870f-7dc8ff005a5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92f2470>]}
[0m01:44:38.683572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a989fa5-7681-4f4c-870f-7dc8ff005a5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92c8910>]}
[0m01:44:38.684383 [info ] [MainThread]: Found 6 models, 1 seed, 10 tests, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m01:44:38.686858 [info ] [MainThread]: 
[0m01:44:38.688336 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:44:38.691361 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m01:44:38.692083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:44:38.692856 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m01:44:38.693950 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m01:44:38.694723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:44:38.723780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:44:40.125200 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_dbt_staging'
[0m01:44:40.126477 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_production'
[0m01:44:40.127489 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_dbt_abhishek_yadav)
[0m01:44:40.128216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:44:40.128837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:44:40.129419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:44:40.764618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a989fa5-7681-4f4c-870f-7dc8ff005a5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf04910>]}
[0m01:44:40.768137 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:44:40.770112 [info ] [MainThread]: 
[0m01:44:40.787762 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.my_first_dbt_model
[0m01:44:40.788961 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m01:44:40.789805 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:44:40.790553 [debug] [Thread-4 (]: Began running node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:44:40.791972 [info ] [Thread-1 (]: 1 of 17 START sql table model dbt_staging.my_first_dbt_model ................... [RUN]
[0m01:44:40.793391 [info ] [Thread-2 (]: 2 of 17 START sql view model dbt_staging.stg_green_trip_data ................... [RUN]
[0m01:44:40.794874 [info ] [Thread-3 (]: 3 of 17 START sql view model dbt_abhishek_yadav.stg_yellow_trip_data ........... [RUN]
[0m01:44:40.796279 [info ] [Thread-4 (]: 4 of 17 START seed file dbt_staging.taxi_zone_lookup ........................... [RUN]
[0m01:44:40.797994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_production, now model.taxi_rides_ny.my_first_dbt_model)
[0m01:44:40.799484 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_abhishek_yadav, now model.taxi_rides_ny.stg_green_trip_data)
[0m01:44:40.800744 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_staging, now model.taxi_rides_ny.stg_yellow_trip_data)
[0m01:44:40.801920 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now seed.taxi_rides_ny.taxi_zone_lookup)
[0m01:44:40.803176 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
[0m01:44:40.804059 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m01:44:40.804750 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:44:40.805294 [debug] [Thread-4 (]: Began compiling node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:44:40.814459 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
[0m01:44:40.832733 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m01:44:40.837867 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m01:44:40.838579 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (compile): 01:44:40.838358 => 01:44:40.838362
[0m01:44:40.841828 [debug] [Thread-4 (]: Began executing node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:44:40.844015 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (compile): 01:44:40.805676 => 01:44:40.843720
[0m01:44:40.844472 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 01:44:40.814995 => 01:44:40.844239
[0m01:44:40.846201 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (compile): 01:44:40.833005 => 01:44:40.845680
[0m01:44:40.847267 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.my_first_dbt_model
[0m01:44:40.853984 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m01:44:40.864770 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:44:40.881594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:44:40.885197 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:44:40.912592 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_trip_data"
[0m01:44:40.914040 [debug] [Thread-3 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m01:44:40.971012 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:44:40.971444 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:44:40.973366 [debug] [Thread-2 (]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
  OPTIONS()
  as select
-- identifiers
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
cast(trip_type as integer) as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(ehail_fee as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), lpep_pickup_datetime)=1
-- dbt-bq compile --select stg_green_trip_data --vars '{'is_test_run': 'false'}'

limit 100
;


[0m01:44:41.001029 [debug] [Thread-3 (]: On model.taxi_rides_ny.stg_yellow_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
  OPTIONS()
  as -- 

select
-- identifiers
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
TIMESTAMP_SECONDS(CAST(CAST(tpep_pickup_datetime as INT64)/10000000 AS INT64)) as pickup_datetime,
TIMESTAMP_SECONDS(CAST(CAST(tpep_dropoff_datetime as INT64)/10000000 AS INT64)) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
1 as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(0 as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`yello_trip_data`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), tpep_pickup_datetime)=1
-- dbt-bq run --select stg_green_tripdata  --var 'is_test_run: false'

limit 100
;


[0m01:44:41.552339 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.my_first_dbt_model"
[0m01:44:41.554614 [debug] [Thread-1 (]: On model.taxi_rides_ny.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_first_dbt_model"} */

  
    

    create or replace table `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m01:44:41.711242 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:a502548a-2700-42d3-b51e-e34e4b039b0d&page=queryresults
[0m01:44:41.722612 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:fce42b97-d310-4427-a324-426e78f01d40&page=queryresults
[0m01:44:41.813451 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:952b9225-21ae-4376-bb5e-ca8f4b17cf0b&page=queryresults
[0m01:44:41.962379 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 01:44:40.885383 => 01:44:41.962056
[0m01:44:41.961206 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (execute): 01:44:40.903613 => 01:44:41.960854
[0m01:44:41.963940 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a989fa5-7681-4f4c-870f-7dc8ff005a5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92ef790>]}
[0m01:44:41.965105 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a989fa5-7681-4f4c-870f-7dc8ff005a5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff90d1270>]}
[0m01:44:41.966721 [info ] [Thread-2 (]: 2 of 17 OK created sql view model dbt_staging.stg_green_trip_data .............. [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m01:44:41.967746 [info ] [Thread-3 (]: 3 of 17 OK created sql view model dbt_abhishek_yadav.stg_yellow_trip_data ...... [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m01:44:41.969055 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m01:44:41.970007 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:44:41.971140 [debug] [Thread-2 (]: Began running node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:44:41.971768 [debug] [Thread-3 (]: Began running node test.taxi_rides_ny.not_stg_green_trip_data_tripid.60d95c01e5
[0m01:44:41.972651 [info ] [Thread-2 (]: 5 of 17 START test accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_  [RUN]
[0m01:44:41.973447 [info ] [Thread-3 (]: 6 of 17 START test not_stg_green_trip_data_tripid .............................. [RUN]
[0m01:44:41.974688 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_green_trip_data, now test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9)
[0m01:44:41.975813 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_yellow_trip_data, now test.taxi_rides_ny.not_stg_green_trip_data_tripid.60d95c01e5)
[0m01:44:41.976491 [debug] [Thread-2 (]: Began compiling node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:44:41.977117 [debug] [Thread-3 (]: Began compiling node test.taxi_rides_ny.not_stg_green_trip_data_tripid.60d95c01e5
[0m01:44:41.990133 [debug] [Thread-2 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9"
[0m01:44:41.995694 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.not_stg_green_trip_data_tripid.60d95c01e5 (compile): 01:44:41.990756 => 01:44:41.995376
[0m01:44:41.997922 [debug] [Thread-3 (]: Compilation Error in test not_stg_green_trip_data_tripid (taxi_rides_ny/models/staging/schema.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m01:44:41.998590 [error] [Thread-3 (]: 6 of 17 ERROR not_stg_green_trip_data_tripid ................................... [[31mERROR[0m in 0.02s]
[0m01:44:41.999508 [debug] [Thread-3 (]: Finished running node test.taxi_rides_ny.not_stg_green_trip_data_tripid.60d95c01e5
[0m01:44:41.999900 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9 (compile): 01:44:41.977577 => 01:44:41.999699
[0m01:44:42.000424 [debug] [Thread-3 (]: Began running node test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5
[0m01:44:42.000996 [debug] [Thread-2 (]: Began executing node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:44:42.001524 [info ] [Thread-3 (]: 7 of 17 START test unique_stg_green_trip_data_tripid ........................... [RUN]
[0m01:44:42.020221 [debug] [Thread-2 (]: Writing runtime sql for node "test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9"
[0m01:44:42.020929 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_stg_green_trip_data_tripid.60d95c01e5, now test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5)
[0m01:44:42.021825 [debug] [Thread-3 (]: Began compiling node test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5
[0m01:44:42.027877 [debug] [Thread-3 (]: Writing injected SQL for node "test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5"
[0m01:44:42.028783 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:44:42.029663 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5 (compile): 01:44:42.022303 => 01:44:42.029403
[0m01:44:42.030986 [debug] [Thread-3 (]: Began executing node test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5
[0m01:44:42.031440 [debug] [Thread-2 (]: On test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_type as value_field,
        count(*) as n_records

    from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
    group by payment_type

)

select *
from all_values
where value_field not in (
    1,2,3,4,5
)



      
    ) dbt_internal_test
[0m01:44:42.034041 [debug] [Thread-3 (]: Writing runtime sql for node "test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5"
[0m01:44:42.063470 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:44:42.065415 [debug] [Thread-3 (]: On test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select tripid as unique_field
  from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
  where tripid is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m01:44:43.206429 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (execute): 01:44:40.865290 => 01:44:43.205225
[0m01:44:43.213248 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a989fa5-7681-4f4c-870f-7dc8ff005a5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92c8370>]}
[0m01:44:43.216778 [info ] [Thread-1 (]: 1 of 17 OK created sql table model dbt_staging.my_first_dbt_model .............. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.42s]
[0m01:44:43.221013 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.my_first_dbt_model
[0m01:44:43.223300 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:44:43.225555 [info ] [Thread-1 (]: 8 of 17 START test accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_  [RUN]
[0m01:44:43.228197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.my_first_dbt_model, now test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad)
[0m01:44:43.229526 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:44:43.242589 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad"
[0m01:44:43.247059 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad (compile): 01:44:43.230376 => 01:44:43.246300
[0m01:44:43.248271 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:44:43.252112 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad"
[0m01:44:43.254483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:44:43.257263 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_type as value_field,
        count(*) as n_records

    from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
    group by payment_type

)

select *
from all_values
where value_field not in (
    1,2,3,4,5
)



      
    ) dbt_internal_test
[0m01:44:43.902038 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:30d26538-24e8-4874-8cbb-1471f675a4f3&page=queryresults
[0m01:44:44.058123 [debug] [Thread-4 (]: On seed.taxi_rides_ny.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "seed.taxi_rides_ny.taxi_zone_lookup"} */

    alter table `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup` set OPTIONS()
  
[0m01:44:44.225667 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:cd6a5b6e-c7ca-42de-a506-a60d2c126e0a&page=queryresults
[0m01:44:44.289752 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9 (execute): 01:44:42.001994 => 01:44:44.288693
[0m01:44:44.292047 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:5218c74f-ac29-46a0-8b5c-ede741e4f3e1&page=queryresults
[0m01:44:44.294028 [info ] [Thread-2 (]: 5 of 17 PASS accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_  [[32mPASS[0m in 2.32s]
[0m01:44:44.301022 [debug] [Thread-2 (]: Finished running node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:44:44.302485 [debug] [Thread-2 (]: Began running node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m01:44:44.303829 [info ] [Thread-2 (]: 9 of 17 START test not_null_stg_yellow_trip_data_tripid ........................ [RUN]
[0m01:44:44.307063 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9, now test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039)
[0m01:44:44.308634 [debug] [Thread-2 (]: Began compiling node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m01:44:44.370934 [debug] [Thread-2 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039"
[0m01:44:44.373030 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039 (compile): 01:44:44.309643 => 01:44:44.372779
[0m01:44:44.373532 [debug] [Thread-2 (]: Began executing node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m01:44:44.376122 [debug] [Thread-2 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039"
[0m01:44:44.377409 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:44:44.379020 [debug] [Thread-2 (]: On test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select tripid
from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
where tripid is null



      
    ) dbt_internal_test
[0m01:44:44.488961 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.taxi_rides_ny.taxi_zone_lookup"
[0m01:44:44.493644 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (execute): 01:44:40.842729 => 01:44:44.493427
[0m01:44:44.494573 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a989fa5-7681-4f4c-870f-7dc8ff005a5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff90db730>]}
[0m01:44:44.495260 [info ] [Thread-4 (]: 4 of 17 OK loaded seed file dbt_staging.taxi_zone_lookup ....................... [[32mINSERT 265[0m in 3.69s]
[0m01:44:44.495998 [debug] [Thread-4 (]: Finished running node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:44:44.496550 [debug] [Thread-4 (]: Began running node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:44:44.497180 [info ] [Thread-4 (]: 10 of 17 START test unique_stg_yellow_trip_data_tripid ......................... [RUN]
[0m01:44:44.498213 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.taxi_rides_ny.taxi_zone_lookup, now test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de)
[0m01:44:44.498711 [debug] [Thread-4 (]: Began compiling node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:44:44.503285 [debug] [Thread-4 (]: Writing injected SQL for node "test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de"
[0m01:44:44.504730 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de (compile): 01:44:44.499061 => 01:44:44.504495
[0m01:44:44.505248 [debug] [Thread-4 (]: Began executing node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:44:44.508053 [debug] [Thread-4 (]: Writing runtime sql for node "test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de"
[0m01:44:44.511454 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:44:44.513102 [debug] [Thread-4 (]: On test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select tripid as unique_field
  from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
  where tripid is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m01:44:44.600265 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5 (execute): 01:44:42.031806 => 01:44:44.599887
[0m01:44:44.601432 [info ] [Thread-3 (]: 7 of 17 PASS unique_stg_green_trip_data_tripid ................................. [[32mPASS[0m in 2.58s]
[0m01:44:44.602479 [debug] [Thread-3 (]: Finished running node test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5
[0m01:44:44.603276 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.my_second_dbt_model
[0m01:44:44.604008 [info ] [Thread-3 (]: 11 of 17 START sql view model dbt_staging.my_second_dbt_model .................. [RUN]
[0m01:44:44.605052 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5, now model.taxi_rides_ny.my_second_dbt_model)
[0m01:44:44.605616 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
[0m01:44:44.608951 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
[0m01:44:44.610415 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (compile): 01:44:44.605991 => 01:44:44.610185
[0m01:44:44.610880 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.my_second_dbt_model
[0m01:44:44.615213 [debug] [Thread-3 (]: Writing runtime sql for node "model.taxi_rides_ny.my_second_dbt_model"
[0m01:44:44.616772 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:44:44.618432 [debug] [Thread-3 (]: On model.taxi_rides_ny.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_second_dbt_model"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
where id = 1;


[0m01:44:44.846172 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:4beb6414-344a-4790-8346-39f322aea3db&page=queryresults
[0m01:44:45.200378 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad (execute): 01:44:43.248920 => 01:44:45.198299
[0m01:44:45.206565 [info ] [Thread-1 (]: 8 of 17 PASS accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_  [[32mPASS[0m in 1.98s]
[0m01:44:45.211833 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:44:45.215930 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.dim_zones
[0m01:44:45.218439 [info ] [Thread-1 (]: 12 of 17 START sql table model production.dim_zones ............................ [RUN]
[0m01:44:45.221060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad, now model.taxi_rides_ny.dim_zones)
[0m01:44:45.222881 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m01:44:45.231802 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m01:44:45.236724 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.dim_zones (compile): 01:44:45.224217 => 01:44:45.236088
[0m01:44:45.237808 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m01:44:45.243130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:44:45.323327 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:a3873ca8-bcfd-424a-8317-0a2d2efdc307&page=queryresults
[0m01:44:45.533486 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (execute): 01:44:44.611280 => 01:44:45.532906
[0m01:44:45.536182 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a989fa5-7681-4f4c-870f-7dc8ff005a5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91eae60>]}
[0m01:44:45.537984 [info ] [Thread-3 (]: 11 of 17 OK created sql view model dbt_staging.my_second_dbt_model ............. [[32mCREATE VIEW (0 processed)[0m in 0.93s]
[0m01:44:45.539918 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.my_second_dbt_model
[0m01:44:45.541234 [debug] [Thread-3 (]: Began running node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:44:45.542369 [info ] [Thread-3 (]: 13 of 17 START test relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m01:44:45.544312 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.my_second_dbt_model, now test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f)
[0m01:44:45.545361 [debug] [Thread-3 (]: Began compiling node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:44:45.563298 [debug] [Thread-3 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f"
[0m01:44:45.567416 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f (compile): 01:44:45.546066 => 01:44:45.566662
[0m01:44:45.568319 [debug] [Thread-3 (]: Began executing node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:44:45.572233 [debug] [Thread-3 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f"
[0m01:44:45.574506 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:44:45.576734 [debug] [Thread-3 (]: On test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select dropoff_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
    where dropoff_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:44:45.803639 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_zones"
[0m01:44:45.807764 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */

  
    

    create or replace table `de-zoomcamp-413815`.`production`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      select 
locationid,
borough,
zone,
replace(service_zone, 'Boro', 'Green') as service_zone
from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
    );
  
[0m01:44:45.907944 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:7c6ea91e-c10c-45b0-baa7-8e36b1fc46e4&page=queryresults
[0m01:44:46.092096 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:0461122b-0e36-476f-8559-ebdad5773266&page=queryresults
[0m01:44:46.261921 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039 (execute): 01:44:44.373873 => 01:44:46.259826
[0m01:44:46.269647 [info ] [Thread-2 (]: 9 of 17 PASS not_null_stg_yellow_trip_data_tripid .............................. [[32mPASS[0m in 1.96s]
[0m01:44:46.271736 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:bb7e9165-888b-47ce-9774-d0a939aa46c0&page=queryresults
[0m01:44:46.274022 [debug] [Thread-2 (]: Finished running node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m01:44:46.276995 [debug] [Thread-2 (]: Began running node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:44:46.282556 [info ] [Thread-2 (]: 14 of 17 START test relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m01:44:46.285144 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039, now test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989)
[0m01:44:46.286799 [debug] [Thread-2 (]: Began compiling node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:44:46.303760 [debug] [Thread-2 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989"
[0m01:44:46.307340 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989 (compile): 01:44:46.287874 => 01:44:46.306809
[0m01:44:46.308412 [debug] [Thread-2 (]: Began executing node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:44:46.313017 [debug] [Thread-2 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989"
[0m01:44:46.315450 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:44:46.317817 [debug] [Thread-2 (]: On test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select pickup_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
    where pickup_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:44:46.607755 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de (execute): 01:44:44.505635 => 01:44:46.607274
[0m01:44:46.609506 [info ] [Thread-4 (]: 10 of 17 PASS unique_stg_yellow_trip_data_tripid ............................... [[32mPASS[0m in 2.11s]
[0m01:44:46.610702 [debug] [Thread-4 (]: Finished running node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:44:46.611995 [debug] [Thread-4 (]: Began running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:44:46.613337 [info ] [Thread-4 (]: 15 of 17 START test relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m01:44:46.614876 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de, now test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3)
[0m01:44:46.615720 [debug] [Thread-4 (]: Began compiling node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:44:46.624631 [debug] [Thread-4 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3"
[0m01:44:46.628448 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3 (compile): 01:44:46.616347 => 01:44:46.628046
[0m01:44:46.629355 [debug] [Thread-4 (]: Began executing node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:44:46.634001 [debug] [Thread-4 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3"
[0m01:44:46.636793 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:44:46.639761 [debug] [Thread-4 (]: On test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select dropoff_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
    where dropoff_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:44:47.305217 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:2786a01a-126d-4a9f-a350-c8f29e6f8b97&page=queryresults
[0m01:44:47.699017 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f (execute): 01:44:45.568818 => 01:44:47.697970
[0m01:44:47.701695 [info ] [Thread-3 (]: 13 of 17 PASS relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 2.16s]
[0m01:44:47.703684 [debug] [Thread-3 (]: Finished running node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:44:47.705282 [debug] [Thread-3 (]: Began running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:44:47.707005 [info ] [Thread-3 (]: 16 of 17 START test relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m01:44:47.710113 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f, now test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739)
[0m01:44:47.713960 [debug] [Thread-3 (]: Began compiling node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:44:47.730174 [debug] [Thread-3 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739"
[0m01:44:47.735002 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739 (compile): 01:44:47.715750 => 01:44:47.734182
[0m01:44:47.736265 [debug] [Thread-3 (]: Began executing node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:44:47.743503 [debug] [Thread-3 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739"
[0m01:44:47.746451 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:44:47.749943 [debug] [Thread-3 (]: On test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select pickup_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
    where pickup_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:44:47.795990 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:50304d8c-a627-4e14-b474-2be71ee4d67c&page=queryresults
[0m01:44:47.929874 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:9cf9e91d-ea2d-4a5f-bb84-211801fa2221&page=queryresults
[0m01:44:48.034052 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.dim_zones (execute): 01:44:45.238565 => 01:44:48.033479
[0m01:44:48.036906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a989fa5-7681-4f4c-870f-7dc8ff005a5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff0793880>]}
[0m01:44:48.038819 [info ] [Thread-1 (]: 12 of 17 OK created sql table model production.dim_zones ....................... [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 2.82s]
[0m01:44:48.040646 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m01:44:48.123053 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3 (execute): 01:44:46.630053 => 01:44:48.122093
[0m01:44:48.126895 [info ] [Thread-4 (]: 15 of 17 PASS relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 1.51s]
[0m01:44:48.129254 [debug] [Thread-4 (]: Finished running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:44:48.259552 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989 (execute): 01:44:46.308984 => 01:44:48.257578
[0m01:44:48.265957 [info ] [Thread-2 (]: 14 of 17 PASS relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 1.98s]
[0m01:44:48.270950 [debug] [Thread-2 (]: Finished running node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:44:48.878918 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:92030078-6078-475e-8f44-332d0e66642d&page=queryresults
[0m01:44:49.259751 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739 (execute): 01:44:47.736961 => 01:44:49.256867
[0m01:44:49.262601 [info ] [Thread-3 (]: 16 of 17 PASS relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 1.55s]
[0m01:44:49.263641 [debug] [Thread-3 (]: Finished running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:44:49.265165 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fact_trips
[0m01:44:49.265996 [info ] [Thread-1 (]: 17 of 17 SKIP relation production.fact_trips ................................... [[33mSKIP[0m]
[0m01:44:49.266761 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fact_trips
[0m01:44:49.268958 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:44:49.269669 [debug] [MainThread]: Connection 'list_de-zoomcamp-413815' was properly closed.
[0m01:44:49.270263 [debug] [MainThread]: Connection 'test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3' was properly closed.
[0m01:44:49.271001 [debug] [MainThread]: Connection 'test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989' was properly closed.
[0m01:44:49.271571 [debug] [MainThread]: Connection 'test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739' was properly closed.
[0m01:44:49.271992 [debug] [MainThread]: Connection 'model.taxi_rides_ny.dim_zones' was properly closed.
[0m01:44:49.272777 [info ] [MainThread]: 
[0m01:44:49.273341 [info ] [MainThread]: Finished running 3 view models, 10 tests, 3 table models, 1 seed in 0 hours 0 minutes and 10.58 seconds (10.58s).
[0m01:44:49.276178 [debug] [MainThread]: Command end result
[0m01:44:49.288718 [info ] [MainThread]: 
[0m01:44:49.289397 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:44:49.289972 [info ] [MainThread]: 
[0m01:44:49.290490 [error] [MainThread]:   Compilation Error in test not_stg_green_trip_data_tripid (taxi_rides_ny/models/staging/schema.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m01:44:49.291009 [info ] [MainThread]: 
[0m01:44:49.291659 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=1 SKIP=1 TOTAL=17
[0m01:44:49.293204 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 11.28166, "process_user_time": 4.65497, "process_kernel_time": 0.351375, "process_mem_max_rss": "167416", "process_in_blocks": "16", "process_out_blocks": "704", "command_success": false}
[0m01:44:49.293886 [debug] [MainThread]: Command `dbt build` failed at 01:44:49.293777 after 11.28 seconds
[0m01:44:49.294409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff0793a00>]}
[0m01:44:49.294986 [debug] [MainThread]: Flushing usage events
[0m01:45:41.756845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00db10>]}


============================== 01:45:41.770109 | 7e5f0541-a8ad-4f8b-8328-8fec9dd446ab ==============================
[0m01:45:41.770109 [info ] [MainThread]: Running with dbt=1.7.7
[0m01:45:41.771132 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:45:42.146352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e5f0541-a8ad-4f8b-8328-8fec9dd446ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff963f9a0>]}
[0m01:45:42.221748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e5f0541-a8ad-4f8b-8328-8fec9dd446ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95e5a50>]}
[0m01:45:42.222814 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m01:45:42.242941 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m01:45:42.321971 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:45:42.323240 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://taxi_rides_ny/models/staging/schema.yml
[0m01:45:42.603372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e5f0541-a8ad-4f8b-8328-8fec9dd446ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8e82980>]}
[0m01:45:42.620404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e5f0541-a8ad-4f8b-8328-8fec9dd446ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92c4f70>]}
[0m01:45:42.621043 [info ] [MainThread]: Found 6 models, 1 seed, 10 tests, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m01:45:42.623209 [info ] [MainThread]: 
[0m01:45:42.624260 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:45:42.627041 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m01:45:42.627756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:45:42.628366 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m01:45:42.629427 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m01:45:42.631753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:45:42.659392 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:45:44.765437 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_dbt_staging'
[0m01:45:44.768821 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_dbt_abhishek_yadav)
[0m01:45:44.771435 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_production)
[0m01:45:44.773004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:45:44.774187 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:45:44.775288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:45:45.427613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e5f0541-a8ad-4f8b-8328-8fec9dd446ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8fd7790>]}
[0m01:45:45.429129 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:45:45.430067 [info ] [MainThread]: 
[0m01:45:45.439221 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.my_first_dbt_model
[0m01:45:45.440650 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m01:45:45.445368 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:45:45.446674 [debug] [Thread-4 (]: Began running node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:45:45.448473 [info ] [Thread-1 (]: 1 of 17 START sql table model dbt_staging.my_first_dbt_model ................... [RUN]
[0m01:45:45.449905 [info ] [Thread-2 (]: 2 of 17 START sql view model dbt_staging.stg_green_trip_data ................... [RUN]
[0m01:45:45.450925 [info ] [Thread-3 (]: 3 of 17 START sql view model dbt_abhishek_yadav.stg_yellow_trip_data ........... [RUN]
[0m01:45:45.452420 [info ] [Thread-4 (]: 4 of 17 START seed file dbt_staging.taxi_zone_lookup ........................... [RUN]
[0m01:45:45.453876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_production, now model.taxi_rides_ny.my_first_dbt_model)
[0m01:45:45.455063 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_abhishek_yadav, now model.taxi_rides_ny.stg_green_trip_data)
[0m01:45:45.456174 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_staging, now model.taxi_rides_ny.stg_yellow_trip_data)
[0m01:45:45.457325 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now seed.taxi_rides_ny.taxi_zone_lookup)
[0m01:45:45.457943 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
[0m01:45:45.458536 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m01:45:45.459046 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:45:45.459516 [debug] [Thread-4 (]: Began compiling node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:45:45.467284 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
[0m01:45:45.473784 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m01:45:45.481220 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (compile): 01:45:45.480774 => 01:45:45.480782
[0m01:45:45.489573 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m01:45:45.491012 [debug] [Thread-4 (]: Began executing node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:45:45.498129 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (compile): 01:45:45.459929 => 01:45:45.497707
[0m01:45:45.509261 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 01:45:45.467812 => 01:45:45.508802
[0m01:45:45.510819 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (compile): 01:45:45.474402 => 01:45:45.510571
[0m01:45:45.511356 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.my_first_dbt_model
[0m01:45:45.516338 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m01:45:45.523665 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:45:45.524256 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:45:45.534466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:45.557953 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_trip_data"
[0m01:45:45.562931 [debug] [Thread-3 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m01:45:45.620712 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:45:45.621364 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:45:45.623306 [debug] [Thread-2 (]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
  OPTIONS()
  as select
-- identifiers
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
cast(trip_type as integer) as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(ehail_fee as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), lpep_pickup_datetime)=1
-- dbt-bq compile --select stg_green_trip_data --vars '{'is_test_run': 'false'}'

limit 100
;


[0m01:45:45.652347 [debug] [Thread-3 (]: On model.taxi_rides_ny.stg_yellow_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
  OPTIONS()
  as -- 

select
-- identifiers
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
TIMESTAMP_SECONDS(CAST(CAST(tpep_pickup_datetime as INT64)/10000000 AS INT64)) as pickup_datetime,
TIMESTAMP_SECONDS(CAST(CAST(tpep_dropoff_datetime as INT64)/10000000 AS INT64)) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
1 as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(0 as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`yello_trip_data`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), tpep_pickup_datetime)=1
-- dbt-bq run --select stg_green_tripdata  --var 'is_test_run: false'

limit 100
;


[0m01:45:46.194924 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.my_first_dbt_model"
[0m01:45:46.197403 [debug] [Thread-1 (]: On model.taxi_rides_ny.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_first_dbt_model"} */

  
    

    create or replace table `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m01:45:46.436653 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:7bfbdd29-d4cb-4615-aeea-bd7dda106661&page=queryresults
[0m01:45:46.459298 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:d703b205-15e5-4ac6-aafe-4b718dd2be2f&page=queryresults
[0m01:45:46.461836 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:3cb628cd-2900-4bbf-8b8c-d1aea069d465&page=queryresults
[0m01:45:46.778026 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 01:45:45.535025 => 01:45:46.777650
[0m01:45:46.779508 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (execute): 01:45:45.559500 => 01:45:46.779195
[0m01:45:46.781256 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e5f0541-a8ad-4f8b-8328-8fec9dd446ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92f7a00>]}
[0m01:45:46.783349 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e5f0541-a8ad-4f8b-8328-8fec9dd446ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92f6a70>]}
[0m01:45:46.785679 [info ] [Thread-2 (]: 2 of 17 OK created sql view model dbt_staging.stg_green_trip_data .............. [[32mCREATE VIEW (0 processed)[0m in 1.33s]
[0m01:45:46.787002 [info ] [Thread-3 (]: 3 of 17 OK created sql view model dbt_abhishek_yadav.stg_yellow_trip_data ...... [[32mCREATE VIEW (0 processed)[0m in 1.33s]
[0m01:45:46.788654 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m01:45:46.789879 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:45:46.791936 [debug] [Thread-2 (]: Began running node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:45:46.792693 [debug] [Thread-3 (]: Began running node test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2
[0m01:45:46.793644 [info ] [Thread-2 (]: 5 of 17 START test accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_  [RUN]
[0m01:45:46.794807 [info ] [Thread-3 (]: 6 of 17 START test not_null_stg_green_trip_data_tripid ......................... [RUN]
[0m01:45:46.796251 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_green_trip_data, now test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9)
[0m01:45:46.797576 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_yellow_trip_data, now test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2)
[0m01:45:46.798534 [debug] [Thread-2 (]: Began compiling node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:45:46.799242 [debug] [Thread-3 (]: Began compiling node test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2
[0m01:45:46.806495 [debug] [Thread-2 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9"
[0m01:45:46.817168 [debug] [Thread-3 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2"
[0m01:45:46.820790 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2 (compile): 01:45:46.807143 => 01:45:46.820332
[0m01:45:46.821475 [debug] [Thread-3 (]: Began executing node test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2
[0m01:45:46.821920 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9 (compile): 01:45:46.799780 => 01:45:46.821709
[0m01:45:46.831030 [debug] [Thread-2 (]: Began executing node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:45:46.840651 [debug] [Thread-3 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2"
[0m01:45:46.844139 [debug] [Thread-2 (]: Writing runtime sql for node "test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9"
[0m01:45:46.846440 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:45:46.847054 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:45:46.848933 [debug] [Thread-2 (]: On test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_type as value_field,
        count(*) as n_records

    from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
    group by payment_type

)

select *
from all_values
where value_field not in (
    1,2,3,4,5
)



      
    ) dbt_internal_test
[0m01:45:46.877528 [debug] [Thread-3 (]: On test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select tripid
from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
where tripid is null



      
    ) dbt_internal_test
[0m01:45:47.908177 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (execute): 01:45:45.524652 => 01:45:47.907777
[0m01:45:47.911661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e5f0541-a8ad-4f8b-8328-8fec9dd446ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9118ca0>]}
[0m01:45:47.915715 [info ] [Thread-1 (]: 1 of 17 OK created sql table model dbt_staging.my_first_dbt_model .............. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.46s]
[0m01:45:47.920645 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.my_first_dbt_model
[0m01:45:47.923188 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5
[0m01:45:47.924724 [info ] [Thread-1 (]: 7 of 17 START test unique_stg_green_trip_data_tripid ........................... [RUN]
[0m01:45:47.927127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.my_first_dbt_model, now test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5)
[0m01:45:47.929016 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5
[0m01:45:47.943250 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5"
[0m01:45:47.948482 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5 (compile): 01:45:47.929896 => 01:45:47.947860
[0m01:45:47.949417 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5
[0m01:45:47.954327 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5"
[0m01:45:47.957589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:47.961264 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select tripid as unique_field
  from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
  where tripid is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m01:45:48.550503 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:02f9ccc8-649d-4973-bf13-5d9c3ef75648&page=queryresults
[0m01:45:48.557236 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:1383bdd8-d37a-4cbe-83de-8fcc1cbcb333&page=queryresults
[0m01:45:48.833700 [debug] [Thread-4 (]: On seed.taxi_rides_ny.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "seed.taxi_rides_ny.taxi_zone_lookup"} */

    alter table `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup` set OPTIONS()
  
[0m01:45:48.976153 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2 (execute): 01:45:46.822298 => 01:45:48.974767
[0m01:45:48.983014 [info ] [Thread-3 (]: 6 of 17 PASS not_null_stg_green_trip_data_tripid ............................... [[32mPASS[0m in 2.18s]
[0m01:45:48.987869 [debug] [Thread-3 (]: Finished running node test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2
[0m01:45:48.988845 [debug] [Thread-3 (]: Began running node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:45:48.989551 [info ] [Thread-3 (]: 8 of 17 START test accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_  [RUN]
[0m01:45:48.990747 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2, now test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad)
[0m01:45:48.994384 [debug] [Thread-3 (]: Began compiling node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:45:49.000155 [debug] [Thread-3 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad"
[0m01:45:49.001723 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9 (execute): 01:45:46.841196 => 01:45:49.001450
[0m01:45:49.002789 [info ] [Thread-2 (]: 5 of 17 PASS accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_  [[32mPASS[0m in 2.21s]
[0m01:45:49.004117 [debug] [Thread-2 (]: Finished running node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:45:49.004885 [debug] [Thread-2 (]: Began running node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m01:45:49.005311 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad (compile): 01:45:48.994864 => 01:45:49.005078
[0m01:45:49.005873 [info ] [Thread-2 (]: 9 of 17 START test not_null_stg_yellow_trip_data_tripid ........................ [RUN]
[0m01:45:49.006663 [debug] [Thread-3 (]: Began executing node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:45:49.007609 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9, now test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039)
[0m01:45:49.010880 [debug] [Thread-2 (]: Began compiling node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m01:45:49.015333 [debug] [Thread-3 (]: Writing runtime sql for node "test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad"
[0m01:45:49.020188 [debug] [Thread-2 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039"
[0m01:45:49.022335 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039 (compile): 01:45:49.015853 => 01:45:49.022035
[0m01:45:49.022800 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:45:49.023265 [debug] [Thread-2 (]: Began executing node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m01:45:49.026341 [debug] [Thread-2 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039"
[0m01:45:49.027787 [debug] [Thread-3 (]: On test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_type as value_field,
        count(*) as n_records

    from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
    group by payment_type

)

select *
from all_values
where value_field not in (
    1,2,3,4,5
)



      
    ) dbt_internal_test
[0m01:45:49.057178 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:9c81d6f2-2610-4ba5-9188-527376c76f1a&page=queryresults
[0m01:45:49.058092 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:45:49.061870 [debug] [Thread-2 (]: On test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select tripid
from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
where tripid is null



      
    ) dbt_internal_test
[0m01:45:49.260357 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.taxi_rides_ny.taxi_zone_lookup"
[0m01:45:49.264490 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (execute): 01:45:45.492377 => 01:45:49.264256
[0m01:45:49.265562 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e5f0541-a8ad-4f8b-8328-8fec9dd446ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8e82d70>]}
[0m01:45:49.266275 [info ] [Thread-4 (]: 4 of 17 OK loaded seed file dbt_staging.taxi_zone_lookup ....................... [[32mINSERT 265[0m in 3.81s]
[0m01:45:49.267208 [debug] [Thread-4 (]: Finished running node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:45:49.267841 [debug] [Thread-4 (]: Began running node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:45:49.268577 [info ] [Thread-4 (]: 10 of 17 START test unique_stg_yellow_trip_data_tripid ......................... [RUN]
[0m01:45:49.269614 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.taxi_rides_ny.taxi_zone_lookup, now test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de)
[0m01:45:49.270225 [debug] [Thread-4 (]: Began compiling node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:45:49.275652 [debug] [Thread-4 (]: Writing injected SQL for node "test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de"
[0m01:45:49.277455 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de (compile): 01:45:49.270668 => 01:45:49.277103
[0m01:45:49.278066 [debug] [Thread-4 (]: Began executing node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:45:49.281081 [debug] [Thread-4 (]: Writing runtime sql for node "test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de"
[0m01:45:49.283521 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:45:49.285834 [debug] [Thread-4 (]: On test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select tripid as unique_field
  from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
  where tripid is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m01:45:50.254710 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:e4ccaa47-bbaa-4138-850a-30a42f7419bf&page=queryresults
[0m01:45:50.588823 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:de08a4e3-99d1-446a-9313-88e392b0c8f0&page=queryresults
[0m01:45:50.609708 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:a8633550-5386-4581-a2c3-73d1c714ef6b&page=queryresults
[0m01:45:50.728052 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5 (execute): 01:45:47.950716 => 01:45:50.726433
[0m01:45:50.733290 [info ] [Thread-1 (]: 7 of 17 PASS unique_stg_green_trip_data_tripid ................................. [[32mPASS[0m in 2.81s]
[0m01:45:50.736491 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5
[0m01:45:50.740504 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.my_second_dbt_model
[0m01:45:50.741932 [info ] [Thread-1 (]: 11 of 17 START sql view model dbt_staging.my_second_dbt_model .................. [RUN]
[0m01:45:50.743295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5, now model.taxi_rides_ny.my_second_dbt_model)
[0m01:45:50.743937 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
[0m01:45:50.747215 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
[0m01:45:50.749975 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (compile): 01:45:50.744325 => 01:45:50.749725
[0m01:45:50.750505 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.my_second_dbt_model
[0m01:45:50.754226 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.my_second_dbt_model"
[0m01:45:50.755795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:50.757573 [debug] [Thread-1 (]: On model.taxi_rides_ny.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_second_dbt_model"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
where id = 1;


[0m01:45:50.927537 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad (execute): 01:45:49.008003 => 01:45:50.927134
[0m01:45:50.928897 [info ] [Thread-3 (]: 8 of 17 PASS accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_  [[32mPASS[0m in 1.94s]
[0m01:45:50.929842 [debug] [Thread-3 (]: Finished running node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:45:50.930477 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.dim_zones
[0m01:45:50.931130 [info ] [Thread-3 (]: 12 of 17 START sql table model production.dim_zones ............................ [RUN]
[0m01:45:50.932068 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad, now model.taxi_rides_ny.dim_zones)
[0m01:45:50.932627 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m01:45:50.936066 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m01:45:50.938671 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.dim_zones (compile): 01:45:50.933046 => 01:45:50.938336
[0m01:45:50.939293 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m01:45:50.941855 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:45:50.972795 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:253ab208-1f53-4f97-a429-2e900ace955e&page=queryresults
[0m01:45:50.989796 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039 (execute): 01:45:49.023859 => 01:45:50.989376
[0m01:45:50.990999 [info ] [Thread-2 (]: 9 of 17 PASS not_null_stg_yellow_trip_data_tripid .............................. [[32mPASS[0m in 1.98s]
[0m01:45:50.992014 [debug] [Thread-2 (]: Finished running node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m01:45:50.992784 [debug] [Thread-2 (]: Began running node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:45:50.993486 [info ] [Thread-2 (]: 13 of 17 START test relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m01:45:50.994419 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039, now test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f)
[0m01:45:50.995022 [debug] [Thread-2 (]: Began compiling node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:45:51.000638 [debug] [Thread-2 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f"
[0m01:45:51.002613 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f (compile): 01:45:50.995404 => 01:45:51.002272
[0m01:45:51.003134 [debug] [Thread-2 (]: Began executing node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:45:51.007037 [debug] [Thread-2 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f"
[0m01:45:51.008797 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:45:51.010716 [debug] [Thread-2 (]: On test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select dropoff_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
    where dropoff_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:45:51.334259 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de (execute): 01:45:49.278466 => 01:45:51.333713
[0m01:45:51.336278 [info ] [Thread-4 (]: 10 of 17 PASS unique_stg_yellow_trip_data_tripid ............................... [[32mPASS[0m in 2.07s]
[0m01:45:51.337815 [debug] [Thread-4 (]: Finished running node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:45:51.338944 [debug] [Thread-4 (]: Began running node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:45:51.339912 [info ] [Thread-4 (]: 14 of 17 START test relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m01:45:51.341414 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de, now test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989)
[0m01:45:51.342366 [debug] [Thread-4 (]: Began compiling node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:45:51.350509 [debug] [Thread-4 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989"
[0m01:45:51.352726 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989 (compile): 01:45:51.342984 => 01:45:51.352336
[0m01:45:51.353504 [debug] [Thread-4 (]: Began executing node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:45:51.357520 [debug] [Thread-4 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989"
[0m01:45:51.360131 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:45:51.362526 [debug] [Thread-4 (]: On test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select pickup_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
    where pickup_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:45:51.480188 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:ec122466-c0d1-4e8e-815d-ab2c7f124a56&page=queryresults
[0m01:45:51.516633 [debug] [Thread-3 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_zones"
[0m01:45:51.519282 [debug] [Thread-3 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */

  
    

    create or replace table `de-zoomcamp-413815`.`production`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      select 
locationid,
borough,
zone,
replace(service_zone, 'Boro', 'Green') as service_zone
from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
    );
  
[0m01:45:51.668758 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (execute): 01:45:50.750919 => 01:45:51.668393
[0m01:45:51.670668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e5f0541-a8ad-4f8b-8328-8fec9dd446ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8482ce0>]}
[0m01:45:51.672413 [info ] [Thread-1 (]: 11 of 17 OK created sql view model dbt_staging.my_second_dbt_model ............. [[32mCREATE VIEW (0 processed)[0m in 0.93s]
[0m01:45:51.674322 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.my_second_dbt_model
[0m01:45:51.675466 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:45:51.676511 [info ] [Thread-1 (]: 15 of 17 START test relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m01:45:51.678067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.my_second_dbt_model, now test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3)
[0m01:45:51.679212 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:45:51.688005 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3"
[0m01:45:51.690083 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3 (compile): 01:45:51.680009 => 01:45:51.689714
[0m01:45:51.690804 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:45:51.694119 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3"
[0m01:45:51.696108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:51.698414 [debug] [Thread-1 (]: On test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select dropoff_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
    where dropoff_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:45:51.834583 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:18babf5d-f725-48b8-9f13-9de4f33dc02e&page=queryresults
[0m01:45:52.614505 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:7a7968b8-2a2f-4247-87c4-86c1db8e73c6&page=queryresults
[0m01:45:52.616916 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:e7bb11e5-e097-430e-949a-4dd15698333c&page=queryresults
[0m01:45:52.988716 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989 (execute): 01:45:51.354051 => 01:45:52.987067
[0m01:45:52.993144 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f (execute): 01:45:51.003478 => 01:45:52.992167
[0m01:45:52.995656 [info ] [Thread-4 (]: 14 of 17 PASS relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 1.65s]
[0m01:45:52.998848 [info ] [Thread-2 (]: 13 of 17 PASS relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 2.00s]
[0m01:45:53.002066 [debug] [Thread-4 (]: Finished running node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:45:53.006585 [debug] [Thread-2 (]: Finished running node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:45:53.008309 [debug] [Thread-4 (]: Began running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:45:53.010219 [info ] [Thread-4 (]: 16 of 17 START test relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m01:45:53.012471 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989, now test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739)
[0m01:45:53.013767 [debug] [Thread-4 (]: Began compiling node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:45:53.026705 [debug] [Thread-4 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739"
[0m01:45:53.031761 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739 (compile): 01:45:53.014591 => 01:45:53.030790
[0m01:45:53.032916 [debug] [Thread-4 (]: Began executing node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:45:53.038489 [debug] [Thread-4 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739"
[0m01:45:53.041575 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:45:53.044759 [debug] [Thread-4 (]: On test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select pickup_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
    where pickup_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:45:53.197194 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.dim_zones (execute): 01:45:50.939693 => 01:45:53.196883
[0m01:45:53.198928 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e5f0541-a8ad-4f8b-8328-8fec9dd446ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8ee61d0>]}
[0m01:45:53.200349 [info ] [Thread-3 (]: 12 of 17 OK created sql table model production.dim_zones ....................... [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 2.27s]
[0m01:45:53.201741 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m01:45:53.208886 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:83036057-74d1-44f1-841e-2633ce881941&page=queryresults
[0m01:45:53.566943 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3 (execute): 01:45:51.691261 => 01:45:53.564678
[0m01:45:53.574147 [info ] [Thread-1 (]: 15 of 17 PASS relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 1.90s]
[0m01:45:53.580396 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:45:54.254282 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:9fc54c4d-3bca-4f5b-a0cd-1baefc2f7a2f&page=queryresults
[0m01:45:54.606961 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739 (execute): 01:45:53.033502 => 01:45:54.603075
[0m01:45:54.614274 [info ] [Thread-4 (]: 16 of 17 PASS relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 1.60s]
[0m01:45:54.619920 [debug] [Thread-4 (]: Finished running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:45:54.624807 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.fact_trips
[0m01:45:54.627015 [info ] [Thread-2 (]: 17 of 17 START sql table model production.fact_trips ........................... [RUN]
[0m01:45:54.629426 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f, now model.taxi_rides_ny.fact_trips)
[0m01:45:54.630823 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.fact_trips
[0m01:45:54.639573 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.fact_trips"
[0m01:45:54.645777 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.fact_trips (compile): 01:45:54.631804 => 01:45:54.644714
[0m01:45:54.647362 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.fact_trips
[0m01:45:54.652847 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:45:55.236316 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.fact_trips"
[0m01:45:55.244841 [debug] [Thread-2 (]: On model.taxi_rides_ny.fact_trips: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.fact_trips"} */

  
    

    create or replace table `de-zoomcamp-413815`.`production`.`fact_trips`
      
    
    

    OPTIONS()
    as (
      with green_trip_data as(
    select *,
        'Green' as service_type
    from 
    `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
),

yellow_trip_data as(
    select *,
        'Yellow' as service_type
    from 
    `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
),

trips_unioned as(
    select * from green_trip_data
    union all
    select * from yellow_trip_data
),
dim_zones as (
    select * from `de-zoomcamp-413815`.`production`.`dim_zones`
    where borough <> 'Unknown'
)

select trips_unioned.tripid, 
    trips_unioned.vendorid, 
    trips_unioned.service_type,
    trips_unioned.ratecodeid, 
    trips_unioned.pickup_locationid, 
    pickup_zone.borough as pickup_borough, 
    pickup_zone.zone as pickup_zone, 
    trips_unioned.dropoff_locationid,
    dropoff_zone.borough as dropoff_borough, 
    dropoff_zone.zone as dropoff_zone,  
    trips_unioned.pickup_datetime, 
    trips_unioned.dropoff_datetime, 
    trips_unioned.store_and_fwd_flag, 
    trips_unioned.passenger_count, 
    trips_unioned.trip_distance, 
    trips_unioned.trip_type, 
    trips_unioned.fare_amount, 
    trips_unioned.extra, 
    trips_unioned.mta_tax, 
    trips_unioned.tip_amount, 
    trips_unioned.tolls_amount, 
    trips_unioned.ehail_fee, 
    trips_unioned.improvement_surcharge, 
    trips_unioned.total_amount, 
    trips_unioned.payment_type, 
    trips_unioned.payment_type_description
from trips_unioned
inner join dim_zones as pickup_zone
on (trips_unioned.pickup_locationid = pickup_zone.locationid)
inner join dim_zones as dropoff_zone
on (trips_unioned.dropoff_locationid = dropoff_zone.locationid)
    );
  
[0m01:45:55.691773 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:8dc80a79-4fc9-48d2-9670-5f06604824e7&page=queryresults
[0m01:45:58.574260 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.fact_trips (execute): 01:45:54.648451 => 01:45:58.573249
[0m01:45:58.589772 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e5f0541-a8ad-4f8b-8328-8fec9dd446ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8e77880>]}
[0m01:45:58.594696 [info ] [Thread-2 (]: 17 of 17 OK created sql table model production.fact_trips ...................... [[32mCREATE TABLE (197.0 rows, 276.2 MiB processed)[0m in 3.96s]
[0m01:45:58.597946 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.fact_trips
[0m01:45:58.604716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:45:58.606252 [debug] [MainThread]: Connection 'test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3' was properly closed.
[0m01:45:58.607350 [debug] [MainThread]: Connection 'test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739' was properly closed.
[0m01:45:58.608402 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fact_trips' was properly closed.
[0m01:45:58.609389 [debug] [MainThread]: Connection 'model.taxi_rides_ny.dim_zones' was properly closed.
[0m01:45:58.611135 [info ] [MainThread]: 
[0m01:45:58.612560 [info ] [MainThread]: Finished running 3 view models, 3 table models, 10 tests, 1 seed in 0 hours 0 minutes and 15.99 seconds (15.99s).
[0m01:45:58.618787 [debug] [MainThread]: Command end result
[0m01:45:58.648953 [info ] [MainThread]: 
[0m01:45:58.650040 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:45:58.650819 [info ] [MainThread]: 
[0m01:45:58.651611 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m01:45:58.653617 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 16.953444, "process_user_time": 5.230526, "process_kernel_time": 0.298128, "process_mem_max_rss": "177236", "process_in_blocks": "8", "process_out_blocks": "704"}
[0m01:45:58.654639 [debug] [MainThread]: Command `dbt build` succeeded at 01:45:58.654427 after 16.95 seconds
[0m01:45:58.655283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9059180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8eb0b80>]}
[0m01:45:58.655999 [debug] [MainThread]: Flushing usage events
[0m01:51:41.142188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00da20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d1e0>]}


============================== 01:51:41.154309 | 8f7c4ce8-5baa-43bc-9797-daae0233c507 ==============================
[0m01:51:41.154309 [info ] [MainThread]: Running with dbt=1.7.7
[0m01:51:41.155407 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run-operation generate_model_yaml --args {"model_names": ["stg_green_trip_data", "stg_yellow_trip_data"]}', 'send_anonymous_usage_stats': 'True'}
[0m01:51:41.539720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f7c4ce8-5baa-43bc-9797-daae0233c507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc63f5e0>]}
[0m01:51:41.612583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f7c4ce8-5baa-43bc-9797-daae0233c507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95e76d0>]}
[0m01:51:41.613514 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m01:51:41.632660 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m01:51:41.649155 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:51:41.649896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8f7c4ce8-5baa-43bc-9797-daae0233c507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95e7520>]}
[0m01:51:43.111740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f7c4ce8-5baa-43bc-9797-daae0233c507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff79c00d0>]}
[0m01:51:43.129232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f7c4ce8-5baa-43bc-9797-daae0233c507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7ad5750>]}
[0m01:51:43.129833 [info ] [MainThread]: Found 6 models, 1 seed, 10 tests, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m01:51:43.130399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f7c4ce8-5baa-43bc-9797-daae0233c507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff938f850>]}
[0m01:51:43.131480 [debug] [MainThread]: Acquiring new bigquery connection 'macro_generate_model_yaml'
[0m01:51:43.140838 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:51:44.122759 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 3.034128, "process_user_time": 3.828465, "process_kernel_time": 0.223552, "process_mem_max_rss": "149532", "process_out_blocks": "648", "process_in_blocks": "0"}
[0m01:51:44.124518 [debug] [MainThread]: Command `dbt run-operation` succeeded at 01:51:44.124217 after 3.04 seconds
[0m01:51:44.125314 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m01:51:44.126135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9374160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7ad5750>]}
[0m01:51:44.126962 [debug] [MainThread]: Flushing usage events
[0m01:52:14.400315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00d1b0>]}


============================== 01:52:14.412090 | 06b792f9-b888-421c-bbfe-b7e6e38cd003 ==============================
[0m01:52:14.412090 [info ] [MainThread]: Running with dbt=1.7.7
[0m01:52:14.412935 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'True', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --quiet run-operation generate_model_yaml --args {"model_names": ["dim_zones", "fact_trips"]}', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:52:14.772623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06b792f9-b888-421c-bbfe-b7e6e38cd003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc6f2710>]}
[0m01:52:14.844898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06b792f9-b888-421c-bbfe-b7e6e38cd003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9421210>]}
[0m01:52:14.845912 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m01:52:14.863475 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m01:52:14.934717 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:52:14.935231 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:52:14.941407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06b792f9-b888-421c-bbfe-b7e6e38cd003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92e9d80>]}
[0m01:52:14.956951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06b792f9-b888-421c-bbfe-b7e6e38cd003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92ac250>]}
[0m01:52:14.957518 [info ] [MainThread]: Found 6 models, 1 seed, 10 tests, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m01:52:14.957940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06b792f9-b888-421c-bbfe-b7e6e38cd003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92ac310>]}
[0m01:52:14.958927 [debug] [MainThread]: Acquiring new bigquery connection 'macro_generate_model_yaml'
[0m01:52:14.968528 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:52:15.690610 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 1.3425637, "process_user_time": 2.38703, "process_kernel_time": 0.123001, "process_mem_max_rss": "138408", "process_in_blocks": "32", "process_out_blocks": "648"}
[0m01:52:15.691548 [debug] [MainThread]: Command `dbt run-operation` succeeded at 01:52:15.691370 after 1.34 seconds
[0m01:52:15.691982 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m01:52:15.692425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9421210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92ac0d0>]}
[0m01:52:15.692884 [debug] [MainThread]: Flushing usage events
[0m01:54:03.619495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00db40>]}


============================== 01:54:03.631419 | ea700ef6-6712-4004-ad9e-a067c395e9a9 ==============================
[0m01:54:03.631419 [info ] [MainThread]: Running with dbt=1.7.7
[0m01:54:03.632497 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:54:03.990848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea700ef6-6712-4004-ad9e-a067c395e9a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00e080>]}
[0m01:54:04.062808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea700ef6-6712-4004-ad9e-a067c395e9a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff941a0b0>]}
[0m01:54:04.063800 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m01:54:04.084516 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m01:54:04.157218 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m01:54:04.158044 [debug] [MainThread]: Partial parsing: added file: taxi_rides_ny://taxi_rides_ny/models/core/schema.yml
[0m01:54:04.226083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea700ef6-6712-4004-ad9e-a067c395e9a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91da7d0>]}
[0m01:54:04.231437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea700ef6-6712-4004-ad9e-a067c395e9a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9297df0>]}
[0m01:54:04.232187 [info ] [MainThread]: Found 6 models, 1 seed, 10 tests, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m01:54:04.232827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea700ef6-6712-4004-ad9e-a067c395e9a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9297ee0>]}
[0m01:54:04.234948 [info ] [MainThread]: 
[0m01:54:04.236068 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:54:04.238594 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_dbt_staging'
[0m01:54:04.239251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:54:04.239861 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_production'
[0m01:54:04.240732 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_dbt_abhishek_yadav'
[0m01:54:04.242918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:54:04.271102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:54:04.912097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea700ef6-6712-4004-ad9e-a067c395e9a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9295fc0>]}
[0m01:54:04.915366 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:54:04.916965 [info ] [MainThread]: 
[0m01:54:04.934359 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.my_first_dbt_model
[0m01:54:04.935166 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m01:54:04.935856 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:54:04.936642 [debug] [Thread-4 (]: Began running node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:54:04.938233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_production, now model.taxi_rides_ny.my_first_dbt_model)
[0m01:54:04.939682 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_abhishek_yadav, now model.taxi_rides_ny.stg_green_trip_data)
[0m01:54:04.940902 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_staging, now model.taxi_rides_ny.stg_yellow_trip_data)
[0m01:54:04.942452 [debug] [Thread-4 (]: Acquiring new bigquery connection 'seed.taxi_rides_ny.taxi_zone_lookup'
[0m01:54:04.943290 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
[0m01:54:04.944087 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m01:54:04.944860 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:54:04.945555 [debug] [Thread-4 (]: Began compiling node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:54:04.955714 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
[0m01:54:04.973151 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m01:54:04.983412 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m01:54:04.985596 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (compile): 01:54:04.983935 => 01:54:04.985353
[0m01:54:04.989095 [debug] [Thread-4 (]: Began executing node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:54:04.990071 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (execute): 01:54:04.989827 => 01:54:04.989842
[0m01:54:04.990784 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 01:54:04.956179 => 01:54:04.990568
[0m01:54:04.991785 [debug] [Thread-4 (]: Finished running node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:54:04.992241 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (compile): 01:54:04.946084 => 01:54:04.992020
[0m01:54:04.992626 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (compile): 01:54:04.973608 => 01:54:04.992425
[0m01:54:04.993073 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m01:54:04.993861 [debug] [Thread-4 (]: Began running node model.taxi_rides_ny.dim_zones
[0m01:54:04.994159 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.my_first_dbt_model
[0m01:54:04.994633 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:54:04.995135 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 01:54:04.994949 => 01:54:04.994956
[0m01:54:04.995853 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.taxi_rides_ny.taxi_zone_lookup, now model.taxi_rides_ny.dim_zones)
[0m01:54:04.996423 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (execute): 01:54:04.996222 => 01:54:04.996228
[0m01:54:04.996919 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (execute): 01:54:04.996731 => 01:54:04.996738
[0m01:54:04.997815 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m01:54:04.998252 [debug] [Thread-4 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m01:54:04.999181 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.my_first_dbt_model
[0m01:54:05.000231 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:54:05.001147 [debug] [Thread-2 (]: Began running node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:54:05.003956 [debug] [Thread-4 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m01:54:05.004549 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2
[0m01:54:05.005170 [debug] [Thread-3 (]: Began running node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:54:05.005998 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_green_trip_data, now test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9)
[0m01:54:05.006942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.my_first_dbt_model, now test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2)
[0m01:54:05.007680 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_yellow_trip_data, now test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f)
[0m01:54:05.008200 [debug] [Thread-2 (]: Began compiling node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:54:05.008605 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.dim_zones (compile): 01:54:05.001353 => 01:54:05.008414
[0m01:54:05.009012 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2
[0m01:54:05.009491 [debug] [Thread-3 (]: Began compiling node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:54:05.020205 [debug] [Thread-2 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9"
[0m01:54:05.020801 [debug] [Thread-4 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m01:54:05.028567 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2"
[0m01:54:05.035826 [debug] [Thread-3 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f"
[0m01:54:05.036736 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.dim_zones (execute): 01:54:05.036517 => 01:54:05.036528
[0m01:54:05.037873 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9 (compile): 01:54:05.009834 => 01:54:05.037655
[0m01:54:05.039031 [debug] [Thread-4 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m01:54:05.039831 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2 (compile): 01:54:05.021147 => 01:54:05.039627
[0m01:54:05.040209 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f (compile): 01:54:05.028947 => 01:54:05.040000
[0m01:54:05.040544 [debug] [Thread-2 (]: Began executing node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:54:05.041133 [debug] [Thread-4 (]: Began running node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:54:05.041737 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2
[0m01:54:05.042164 [debug] [Thread-3 (]: Began executing node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:54:05.042715 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9 (execute): 01:54:05.042509 => 01:54:05.042518
[0m01:54:05.043435 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.dim_zones, now test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989)
[0m01:54:05.043954 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2 (execute): 01:54:05.043770 => 01:54:05.043778
[0m01:54:05.044458 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f (execute): 01:54:05.044255 => 01:54:05.044261
[0m01:54:05.045339 [debug] [Thread-2 (]: Finished running node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:54:05.045798 [debug] [Thread-4 (]: Began compiling node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:54:05.046697 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2
[0m01:54:05.047601 [debug] [Thread-3 (]: Finished running node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:54:05.048132 [debug] [Thread-2 (]: Began running node test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5
[0m01:54:05.053556 [debug] [Thread-4 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989"
[0m01:54:05.054230 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.my_second_dbt_model
[0m01:54:05.054814 [debug] [Thread-3 (]: Began running node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:54:05.055559 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9, now test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5)
[0m01:54:05.056965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2, now model.taxi_rides_ny.my_second_dbt_model)
[0m01:54:05.057716 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f, now test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad)
[0m01:54:05.058255 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989 (compile): 01:54:05.048634 => 01:54:05.058056
[0m01:54:05.058574 [debug] [Thread-2 (]: Began compiling node test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5
[0m01:54:05.059026 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
[0m01:54:05.059444 [debug] [Thread-3 (]: Began compiling node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:54:05.059911 [debug] [Thread-4 (]: Began executing node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:54:05.065791 [debug] [Thread-2 (]: Writing injected SQL for node "test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5"
[0m01:54:05.068593 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
[0m01:54:05.073473 [debug] [Thread-3 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad"
[0m01:54:05.074129 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989 (execute): 01:54:05.073909 => 01:54:05.073920
[0m01:54:05.076328 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5 (compile): 01:54:05.060241 => 01:54:05.075983
[0m01:54:05.077056 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (compile): 01:54:05.066171 => 01:54:05.076809
[0m01:54:05.077993 [debug] [Thread-4 (]: Finished running node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:54:05.078611 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad (compile): 01:54:05.069064 => 01:54:05.078406
[0m01:54:05.079035 [debug] [Thread-2 (]: Began executing node test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5
[0m01:54:05.079502 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.my_second_dbt_model
[0m01:54:05.080012 [debug] [Thread-4 (]: Began running node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m01:54:05.080509 [debug] [Thread-3 (]: Began executing node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:54:05.081039 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5 (execute): 01:54:05.080847 => 01:54:05.080854
[0m01:54:05.081551 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (execute): 01:54:05.081365 => 01:54:05.081372
[0m01:54:05.082273 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989, now test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039)
[0m01:54:05.082823 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad (execute): 01:54:05.082627 => 01:54:05.082633
[0m01:54:05.083717 [debug] [Thread-2 (]: Finished running node test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5
[0m01:54:05.084664 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.my_second_dbt_model
[0m01:54:05.085100 [debug] [Thread-4 (]: Began compiling node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m01:54:05.086020 [debug] [Thread-3 (]: Finished running node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:54:05.086513 [debug] [Thread-2 (]: Began running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:54:05.087030 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:54:05.091802 [debug] [Thread-4 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039"
[0m01:54:05.092513 [debug] [Thread-3 (]: Began running node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:54:05.093339 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5, now test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3)
[0m01:54:05.094066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.my_second_dbt_model, now test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739)
[0m01:54:05.095422 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad, now test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de)
[0m01:54:05.095948 [debug] [Thread-2 (]: Began compiling node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:54:05.096492 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039 (compile): 01:54:05.087467 => 01:54:05.096268
[0m01:54:05.096786 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:54:05.097211 [debug] [Thread-3 (]: Began compiling node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:54:05.137255 [debug] [Thread-2 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3"
[0m01:54:05.137928 [debug] [Thread-4 (]: Began executing node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m01:54:05.142646 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739"
[0m01:54:05.146486 [debug] [Thread-3 (]: Writing injected SQL for node "test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de"
[0m01:54:05.147536 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039 (execute): 01:54:05.147315 => 01:54:05.147327
[0m01:54:05.150758 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3 (compile): 01:54:05.097535 => 01:54:05.150539
[0m01:54:05.151990 [debug] [Thread-4 (]: Finished running node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m01:54:05.152537 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739 (compile): 01:54:05.138321 => 01:54:05.152319
[0m01:54:05.153075 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de (compile): 01:54:05.143062 => 01:54:05.152893
[0m01:54:05.153390 [debug] [Thread-2 (]: Began executing node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:54:05.153911 [debug] [Thread-4 (]: Began running node model.taxi_rides_ny.fact_trips
[0m01:54:05.154419 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:54:05.154878 [debug] [Thread-3 (]: Began executing node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:54:05.155411 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3 (execute): 01:54:05.155200 => 01:54:05.155207
[0m01:54:05.156100 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039, now model.taxi_rides_ny.fact_trips)
[0m01:54:05.156653 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739 (execute): 01:54:05.156447 => 01:54:05.156455
[0m01:54:05.157199 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de (execute): 01:54:05.157012 => 01:54:05.157018
[0m01:54:05.158091 [debug] [Thread-2 (]: Finished running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:54:05.158538 [debug] [Thread-4 (]: Began compiling node model.taxi_rides_ny.fact_trips
[0m01:54:05.159471 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:54:05.160534 [debug] [Thread-3 (]: Finished running node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:54:05.164382 [debug] [Thread-4 (]: Writing injected SQL for node "model.taxi_rides_ny.fact_trips"
[0m01:54:05.166875 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.fact_trips (compile): 01:54:05.161171 => 01:54:05.166675
[0m01:54:05.167292 [debug] [Thread-4 (]: Began executing node model.taxi_rides_ny.fact_trips
[0m01:54:05.167808 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.fact_trips (execute): 01:54:05.167621 => 01:54:05.167629
[0m01:54:05.168709 [debug] [Thread-4 (]: Finished running node model.taxi_rides_ny.fact_trips
[0m01:54:05.170587 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:54:05.171013 [debug] [MainThread]: Connection 'test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de' was properly closed.
[0m01:54:05.171416 [debug] [MainThread]: Connection 'test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739' was properly closed.
[0m01:54:05.171782 [debug] [MainThread]: Connection 'test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3' was properly closed.
[0m01:54:05.172126 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fact_trips' was properly closed.
[0m01:54:05.174424 [debug] [MainThread]: Command end result
[0m01:54:05.191634 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m01:54:05.192136 [info ] [MainThread]: Building catalog
[0m01:54:05.194363 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:54:06.094380 [debug] [ThreadPool]: Acquiring new bigquery connection 'de-zoomcamp-413815.information_schema'
[0m01:54:06.098474 [debug] [ThreadPool]: Acquiring new bigquery connection 'de-zoomcamp-413815.information_schema'
[0m01:54:06.102364 [debug] [ThreadPool]: Acquiring new bigquery connection 'de-zoomcamp-413815.information_schema'
[0m01:54:06.104282 [debug] [ThreadPool]: Acquiring new bigquery connection 'de-zoomcamp-413815.information_schema'
[0m01:54:06.132560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:54:06.137286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:54:06.141485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:54:06.145212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:54:06.148238 [debug] [ThreadPool]: On de-zoomcamp-413815.information_schema: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "connection_name": "de-zoomcamp-413815.information_schema"} */

    with materialized_views as (
        select
            table_catalog as project_id,
            table_schema as dataset_id,
            table_name as table_id
        from `de-zoomcamp-413815`.`dbt_staging`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS
    ),
    tables as (
        select
            tables.project_id as table_database,
            tables.dataset_id as table_schema,
            tables.table_id as original_table_name,

            concat(tables.project_id, '.', tables.dataset_id, '.', tables.table_id) as relation_id,

            tables.row_count,
            tables.size_bytes as size_bytes,
            case
                when materialized_views.table_id is not null then 'materialized view'
                when tables.type = 1 then 'table'
                when tables.type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_name

        from `de-zoomcamp-413815`.`dbt_staging`.__TABLES__ tables
        left join materialized_views
            on materialized_views.project_id = tables.project_id
            and materialized_views.dataset_id = tables.dataset_id
            and materialized_views.table_id = tables.table_id
        where (upper(tables.dataset_id) = upper('dbt_staging'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `de-zoomcamp-413815`.`dbt_staging`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `de-zoomcamp-413815`.`dbt_staging`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `de-zoomcamp-413815`.`dbt_staging`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m01:54:06.151112 [debug] [ThreadPool]: On de-zoomcamp-413815.information_schema: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "connection_name": "de-zoomcamp-413815.information_schema"} */

    with materialized_views as (
        select
            table_catalog as project_id,
            table_schema as dataset_id,
            table_name as table_id
        from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS
    ),
    tables as (
        select
            tables.project_id as table_database,
            tables.dataset_id as table_schema,
            tables.table_id as original_table_name,

            concat(tables.project_id, '.', tables.dataset_id, '.', tables.table_id) as relation_id,

            tables.row_count,
            tables.size_bytes as size_bytes,
            case
                when materialized_views.table_id is not null then 'materialized view'
                when tables.type = 1 then 'table'
                when tables.type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_name

        from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.__TABLES__ tables
        left join materialized_views
            on materialized_views.project_id = tables.project_id
            and materialized_views.dataset_id = tables.dataset_id
            and materialized_views.table_id = tables.table_id
        where (upper(tables.dataset_id) = upper('dbt_abhishek_yadav'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m01:54:06.153675 [debug] [ThreadPool]: On de-zoomcamp-413815.information_schema: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "connection_name": "de-zoomcamp-413815.information_schema"} */

    with materialized_views as (
        select
            table_catalog as project_id,
            table_schema as dataset_id,
            table_name as table_id
        from `de-zoomcamp-413815`.`production`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS
    ),
    tables as (
        select
            tables.project_id as table_database,
            tables.dataset_id as table_schema,
            tables.table_id as original_table_name,

            concat(tables.project_id, '.', tables.dataset_id, '.', tables.table_id) as relation_id,

            tables.row_count,
            tables.size_bytes as size_bytes,
            case
                when materialized_views.table_id is not null then 'materialized view'
                when tables.type = 1 then 'table'
                when tables.type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_name

        from `de-zoomcamp-413815`.`production`.__TABLES__ tables
        left join materialized_views
            on materialized_views.project_id = tables.project_id
            and materialized_views.dataset_id = tables.dataset_id
            and materialized_views.table_id = tables.table_id
        where (upper(tables.dataset_id) = upper('production'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `de-zoomcamp-413815`.`production`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `de-zoomcamp-413815`.`production`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `de-zoomcamp-413815`.`production`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m01:54:06.185791 [debug] [ThreadPool]: On de-zoomcamp-413815.information_schema: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "connection_name": "de-zoomcamp-413815.information_schema"} */

    with materialized_views as (
        select
            table_catalog as project_id,
            table_schema as dataset_id,
            table_name as table_id
        from `de-zoomcamp-413815`.`trips_all_data`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS
    ),
    tables as (
        select
            tables.project_id as table_database,
            tables.dataset_id as table_schema,
            tables.table_id as original_table_name,

            concat(tables.project_id, '.', tables.dataset_id, '.', tables.table_id) as relation_id,

            tables.row_count,
            tables.size_bytes as size_bytes,
            case
                when materialized_views.table_id is not null then 'materialized view'
                when tables.type = 1 then 'table'
                when tables.type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_name

        from `de-zoomcamp-413815`.`trips_all_data`.__TABLES__ tables
        left join materialized_views
            on materialized_views.project_id = tables.project_id
            and materialized_views.dataset_id = tables.dataset_id
            and materialized_views.table_id = tables.table_id
        where (upper(tables.dataset_id) = upper('trips_all_data'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `de-zoomcamp-413815`.`trips_all_data`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `de-zoomcamp-413815`.`trips_all_data`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `de-zoomcamp-413815`.`trips_all_data`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m01:54:07.006242 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:dada4d96-d317-41e8-adee-4f65126cced0&page=queryresults
[0m01:54:07.025720 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:8273c9f4-328a-494e-8fa8-a48469c92314&page=queryresults
[0m01:54:07.031609 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:93a2b185-a942-4bfa-892d-416dbf65f779&page=queryresults
[0m01:54:07.067632 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:67f28a41-de03-4aab-9846-5fcc24d1170a&page=queryresults
[0m01:54:08.762656 [info ] [MainThread]: Catalog written to /usr/app/dbt/target/catalog.json
[0m01:54:08.764749 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 5.2012167, "process_user_time": 3.381419, "process_kernel_time": 0.198729, "process_mem_max_rss": "156084", "process_in_blocks": "2968", "process_out_blocks": "704"}
[0m01:54:08.765652 [debug] [MainThread]: Command `dbt docs generate` succeeded at 01:54:08.765505 after 5.20 seconds
[0m01:54:08.766106 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m01:54:08.766523 [debug] [MainThread]: Connection 'de-zoomcamp-413815.information_schema' was properly closed.
[0m01:54:08.766874 [debug] [MainThread]: Connection 'de-zoomcamp-413815.information_schema' was properly closed.
[0m01:54:08.767230 [debug] [MainThread]: Connection 'de-zoomcamp-413815.information_schema' was properly closed.
[0m01:54:08.767606 [debug] [MainThread]: Connection 'de-zoomcamp-413815.information_schema' was properly closed.
[0m01:54:08.768031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9641390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff941a0b0>]}
[0m01:54:08.768498 [debug] [MainThread]: Flushing usage events
[0m01:55:27.819007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00feb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00dc90>]}


============================== 01:55:27.832915 | 4b010224-77fd-4a32-8e7e-af04e1783763 ==============================
[0m01:55:27.832915 [info ] [MainThread]: Running with dbt=1.7.7
[0m01:55:27.834030 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:55:28.231462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b010224-77fd-4a32-8e7e-af04e1783763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00ebf0>]}
[0m01:55:28.304957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b010224-77fd-4a32-8e7e-af04e1783763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9415b40>]}
[0m01:55:28.305973 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m01:55:28.326206 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m01:55:28.402487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:55:28.403096 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:55:28.409810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b010224-77fd-4a32-8e7e-af04e1783763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff93000d0>]}
[0m01:55:28.416194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b010224-77fd-4a32-8e7e-af04e1783763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92b9060>]}
[0m01:55:28.416761 [info ] [MainThread]: Found 6 models, 1 seed, 10 tests, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m01:55:28.417386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b010224-77fd-4a32-8e7e-af04e1783763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92b90c0>]}
[0m01:55:28.419713 [info ] [MainThread]: 
[0m01:55:28.420898 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:55:28.423546 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_dbt_staging'
[0m01:55:28.424320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:55:28.424937 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_dbt_abhishek_yadav'
[0m01:55:28.425862 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_production'
[0m01:55:28.426455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:55:28.456811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:55:29.046586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b010224-77fd-4a32-8e7e-af04e1783763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92a60e0>]}
[0m01:55:29.049506 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:55:29.050408 [info ] [MainThread]: 
[0m01:55:29.064998 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.my_first_dbt_model
[0m01:55:29.065892 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m01:55:29.066648 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:55:29.067654 [debug] [Thread-4 (]: Began running node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:55:29.069016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_staging, now model.taxi_rides_ny.my_first_dbt_model)
[0m01:55:29.070912 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_production, now model.taxi_rides_ny.stg_green_trip_data)
[0m01:55:29.072543 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_abhishek_yadav, now model.taxi_rides_ny.stg_yellow_trip_data)
[0m01:55:29.074208 [debug] [Thread-4 (]: Acquiring new bigquery connection 'seed.taxi_rides_ny.taxi_zone_lookup'
[0m01:55:29.075176 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
[0m01:55:29.076062 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m01:55:29.077001 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:55:29.077902 [debug] [Thread-4 (]: Began compiling node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:55:29.089496 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
[0m01:55:29.120760 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m01:55:29.121723 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m01:55:29.123900 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (compile): 01:55:29.121939 => 01:55:29.123669
[0m01:55:29.128571 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (compile): 01:55:29.078590 => 01:55:29.128344
[0m01:55:29.128987 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 01:55:29.090076 => 01:55:29.128800
[0m01:55:29.129347 [debug] [Thread-4 (]: Began executing node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:55:29.129915 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (compile): 01:55:29.103958 => 01:55:29.129692
[0m01:55:29.130452 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.my_first_dbt_model
[0m01:55:29.130964 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m01:55:29.131528 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (execute): 01:55:29.131323 => 01:55:29.131338
[0m01:55:29.131958 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:55:29.132491 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (execute): 01:55:29.132294 => 01:55:29.132301
[0m01:55:29.133011 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 01:55:29.132814 => 01:55:29.132821
[0m01:55:29.134172 [debug] [Thread-4 (]: Finished running node seed.taxi_rides_ny.taxi_zone_lookup
[0m01:55:29.134800 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (execute): 01:55:29.134592 => 01:55:29.134599
[0m01:55:29.135744 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.my_first_dbt_model
[0m01:55:29.136660 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m01:55:29.137466 [debug] [Thread-4 (]: Began running node model.taxi_rides_ny.dim_zones
[0m01:55:29.138474 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
[0m01:55:29.139561 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.my_second_dbt_model
[0m01:55:29.140245 [debug] [Thread-2 (]: Began running node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:55:29.141031 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.taxi_rides_ny.taxi_zone_lookup, now model.taxi_rides_ny.dim_zones)
[0m01:55:29.141618 [debug] [Thread-3 (]: Began running node test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2
[0m01:55:29.142577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.my_first_dbt_model, now model.taxi_rides_ny.my_second_dbt_model)
[0m01:55:29.143403 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_green_trip_data, now test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9)
[0m01:55:29.143955 [debug] [Thread-4 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m01:55:29.144690 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_yellow_trip_data, now test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2)
[0m01:55:29.145159 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
[0m01:55:29.145635 [debug] [Thread-2 (]: Began compiling node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:55:29.149039 [debug] [Thread-4 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m01:55:29.149770 [debug] [Thread-3 (]: Began compiling node test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2
[0m01:55:29.152574 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
[0m01:55:29.163292 [debug] [Thread-2 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9"
[0m01:55:29.171778 [debug] [Thread-3 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2"
[0m01:55:29.172995 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.dim_zones (compile): 01:55:29.146007 => 01:55:29.172747
[0m01:55:29.174444 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (compile): 01:55:29.150169 => 01:55:29.174166
[0m01:55:29.175872 [debug] [Thread-4 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m01:55:29.176577 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9 (compile): 01:55:29.153025 => 01:55:29.176296
[0m01:55:29.177334 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2 (compile): 01:55:29.164093 => 01:55:29.177075
[0m01:55:29.177667 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.my_second_dbt_model
[0m01:55:29.178339 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.dim_zones (execute): 01:55:29.178074 => 01:55:29.178087
[0m01:55:29.178755 [debug] [Thread-2 (]: Began executing node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:55:29.179204 [debug] [Thread-3 (]: Began executing node test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2
[0m01:55:29.179750 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (execute): 01:55:29.179538 => 01:55:29.179545
[0m01:55:29.180796 [debug] [Thread-4 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m01:55:29.181275 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9 (execute): 01:55:29.181069 => 01:55:29.181075
[0m01:55:29.181800 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2 (execute): 01:55:29.181603 => 01:55:29.181609
[0m01:55:29.182695 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.my_second_dbt_model
[0m01:55:29.183240 [debug] [Thread-4 (]: Began running node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:55:29.184303 [debug] [Thread-2 (]: Finished running node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m01:55:29.185216 [debug] [Thread-3 (]: Finished running node test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2
[0m01:55:29.185734 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:55:29.186515 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.dim_zones, now test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f)
[0m01:55:29.187101 [debug] [Thread-2 (]: Began running node test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5
[0m01:55:29.187731 [debug] [Thread-3 (]: Began running node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:55:29.188575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.my_second_dbt_model, now test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989)
[0m01:55:29.189105 [debug] [Thread-4 (]: Began compiling node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:55:29.189843 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9, now test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5)
[0m01:55:29.190603 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2, now test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad)
[0m01:55:29.191109 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:55:29.200524 [debug] [Thread-4 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f"
[0m01:55:29.201245 [debug] [Thread-2 (]: Began compiling node test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5
[0m01:55:29.201824 [debug] [Thread-3 (]: Began compiling node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:55:29.206810 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989"
[0m01:55:29.213480 [debug] [Thread-2 (]: Writing injected SQL for node "test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5"
[0m01:55:29.218456 [debug] [Thread-3 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad"
[0m01:55:29.218942 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f (compile): 01:55:29.191488 => 01:55:29.218701
[0m01:55:29.220548 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989 (compile): 01:55:29.202205 => 01:55:29.220259
[0m01:55:29.221080 [debug] [Thread-4 (]: Began executing node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:55:29.221612 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5 (compile): 01:55:29.207836 => 01:55:29.221402
[0m01:55:29.221988 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad (compile): 01:55:29.214032 => 01:55:29.221782
[0m01:55:29.222293 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:55:29.222858 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f (execute): 01:55:29.222651 => 01:55:29.222661
[0m01:55:29.223324 [debug] [Thread-2 (]: Began executing node test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5
[0m01:55:29.223805 [debug] [Thread-3 (]: Began executing node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:55:29.224352 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989 (execute): 01:55:29.224131 => 01:55:29.224138
[0m01:55:29.225377 [debug] [Thread-4 (]: Finished running node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m01:55:29.225909 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5 (execute): 01:55:29.225720 => 01:55:29.225726
[0m01:55:29.226498 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad (execute): 01:55:29.226246 => 01:55:29.226256
[0m01:55:29.227643 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m01:55:29.228273 [debug] [Thread-4 (]: Began running node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m01:55:29.229287 [debug] [Thread-2 (]: Finished running node test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5
[0m01:55:29.230192 [debug] [Thread-3 (]: Finished running node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m01:55:29.230783 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:55:29.231595 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f, now test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039)
[0m01:55:29.232231 [debug] [Thread-2 (]: Began running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:55:29.232830 [debug] [Thread-3 (]: Began running node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:55:29.233588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989, now test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3)
[0m01:55:29.234078 [debug] [Thread-4 (]: Began compiling node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m01:55:29.234766 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5, now test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739)
[0m01:55:29.235674 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad, now test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de)
[0m01:55:29.236159 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:55:29.240935 [debug] [Thread-4 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039"
[0m01:55:29.241614 [debug] [Thread-2 (]: Began compiling node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:55:29.242116 [debug] [Thread-3 (]: Began compiling node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:55:29.247849 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3"
[0m01:55:29.253212 [debug] [Thread-2 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739"
[0m01:55:29.257374 [debug] [Thread-3 (]: Writing injected SQL for node "test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de"
[0m01:55:29.257808 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039 (compile): 01:55:29.236528 => 01:55:29.257599
[0m01:55:29.259891 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3 (compile): 01:55:29.242513 => 01:55:29.259654
[0m01:55:29.260624 [debug] [Thread-4 (]: Began executing node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m01:55:29.261235 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739 (compile): 01:55:29.248775 => 01:55:29.260941
[0m01:55:29.262044 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de (compile): 01:55:29.253705 => 01:55:29.261815
[0m01:55:29.262402 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:55:29.263074 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039 (execute): 01:55:29.262811 => 01:55:29.262824
[0m01:55:29.263649 [debug] [Thread-2 (]: Began executing node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:55:29.264116 [debug] [Thread-3 (]: Began executing node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:55:29.264678 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3 (execute): 01:55:29.264459 => 01:55:29.264467
[0m01:55:29.265708 [debug] [Thread-4 (]: Finished running node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m01:55:29.266245 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739 (execute): 01:55:29.266042 => 01:55:29.266049
[0m01:55:29.266763 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de (execute): 01:55:29.266577 => 01:55:29.266583
[0m01:55:29.267689 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m01:55:29.268208 [debug] [Thread-4 (]: Began running node model.taxi_rides_ny.fact_trips
[0m01:55:29.269311 [debug] [Thread-2 (]: Finished running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m01:55:29.270191 [debug] [Thread-3 (]: Finished running node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m01:55:29.271159 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039, now model.taxi_rides_ny.fact_trips)
[0m01:55:29.272449 [debug] [Thread-4 (]: Began compiling node model.taxi_rides_ny.fact_trips
[0m01:55:29.276236 [debug] [Thread-4 (]: Writing injected SQL for node "model.taxi_rides_ny.fact_trips"
[0m01:55:29.278027 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.fact_trips (compile): 01:55:29.272824 => 01:55:29.277814
[0m01:55:29.278470 [debug] [Thread-4 (]: Began executing node model.taxi_rides_ny.fact_trips
[0m01:55:29.278994 [debug] [Thread-4 (]: Timing info for model.taxi_rides_ny.fact_trips (execute): 01:55:29.278793 => 01:55:29.278801
[0m01:55:29.279927 [debug] [Thread-4 (]: Finished running node model.taxi_rides_ny.fact_trips
[0m01:55:29.281925 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:55:29.282372 [debug] [MainThread]: Connection 'test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3' was properly closed.
[0m01:55:29.282743 [debug] [MainThread]: Connection 'test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de' was properly closed.
[0m01:55:29.283097 [debug] [MainThread]: Connection 'test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739' was properly closed.
[0m01:55:29.283457 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fact_trips' was properly closed.
[0m01:55:29.285907 [debug] [MainThread]: Command end result
[0m01:55:29.306757 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m01:55:29.307332 [info ] [MainThread]: Building catalog
[0m01:55:29.309956 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:55:30.263555 [debug] [ThreadPool]: Acquiring new bigquery connection 'de-zoomcamp-413815.information_schema'
[0m01:55:30.267819 [debug] [ThreadPool]: Acquiring new bigquery connection 'de-zoomcamp-413815.information_schema'
[0m01:55:30.273021 [debug] [ThreadPool]: Acquiring new bigquery connection 'de-zoomcamp-413815.information_schema'
[0m01:55:30.282347 [debug] [ThreadPool]: Acquiring new bigquery connection 'de-zoomcamp-413815.information_schema'
[0m01:55:30.308595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:55:30.312903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:55:30.316947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:55:30.320571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:55:30.323698 [debug] [ThreadPool]: On de-zoomcamp-413815.information_schema: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "connection_name": "de-zoomcamp-413815.information_schema"} */

    with materialized_views as (
        select
            table_catalog as project_id,
            table_schema as dataset_id,
            table_name as table_id
        from `de-zoomcamp-413815`.`dbt_staging`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS
    ),
    tables as (
        select
            tables.project_id as table_database,
            tables.dataset_id as table_schema,
            tables.table_id as original_table_name,

            concat(tables.project_id, '.', tables.dataset_id, '.', tables.table_id) as relation_id,

            tables.row_count,
            tables.size_bytes as size_bytes,
            case
                when materialized_views.table_id is not null then 'materialized view'
                when tables.type = 1 then 'table'
                when tables.type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_name

        from `de-zoomcamp-413815`.`dbt_staging`.__TABLES__ tables
        left join materialized_views
            on materialized_views.project_id = tables.project_id
            and materialized_views.dataset_id = tables.dataset_id
            and materialized_views.table_id = tables.table_id
        where (upper(tables.dataset_id) = upper('dbt_staging'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `de-zoomcamp-413815`.`dbt_staging`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `de-zoomcamp-413815`.`dbt_staging`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `de-zoomcamp-413815`.`dbt_staging`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m01:55:30.326367 [debug] [ThreadPool]: On de-zoomcamp-413815.information_schema: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "connection_name": "de-zoomcamp-413815.information_schema"} */

    with materialized_views as (
        select
            table_catalog as project_id,
            table_schema as dataset_id,
            table_name as table_id
        from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS
    ),
    tables as (
        select
            tables.project_id as table_database,
            tables.dataset_id as table_schema,
            tables.table_id as original_table_name,

            concat(tables.project_id, '.', tables.dataset_id, '.', tables.table_id) as relation_id,

            tables.row_count,
            tables.size_bytes as size_bytes,
            case
                when materialized_views.table_id is not null then 'materialized view'
                when tables.type = 1 then 'table'
                when tables.type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_name

        from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.__TABLES__ tables
        left join materialized_views
            on materialized_views.project_id = tables.project_id
            and materialized_views.dataset_id = tables.dataset_id
            and materialized_views.table_id = tables.table_id
        where (upper(tables.dataset_id) = upper('dbt_abhishek_yadav'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m01:55:30.328891 [debug] [ThreadPool]: On de-zoomcamp-413815.information_schema: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "connection_name": "de-zoomcamp-413815.information_schema"} */

    with materialized_views as (
        select
            table_catalog as project_id,
            table_schema as dataset_id,
            table_name as table_id
        from `de-zoomcamp-413815`.`production`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS
    ),
    tables as (
        select
            tables.project_id as table_database,
            tables.dataset_id as table_schema,
            tables.table_id as original_table_name,

            concat(tables.project_id, '.', tables.dataset_id, '.', tables.table_id) as relation_id,

            tables.row_count,
            tables.size_bytes as size_bytes,
            case
                when materialized_views.table_id is not null then 'materialized view'
                when tables.type = 1 then 'table'
                when tables.type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_name

        from `de-zoomcamp-413815`.`production`.__TABLES__ tables
        left join materialized_views
            on materialized_views.project_id = tables.project_id
            and materialized_views.dataset_id = tables.dataset_id
            and materialized_views.table_id = tables.table_id
        where (upper(tables.dataset_id) = upper('production'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `de-zoomcamp-413815`.`production`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `de-zoomcamp-413815`.`production`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `de-zoomcamp-413815`.`production`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m01:55:30.359377 [debug] [ThreadPool]: On de-zoomcamp-413815.information_schema: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "connection_name": "de-zoomcamp-413815.information_schema"} */

    with materialized_views as (
        select
            table_catalog as project_id,
            table_schema as dataset_id,
            table_name as table_id
        from `de-zoomcamp-413815`.`trips_all_data`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS
    ),
    tables as (
        select
            tables.project_id as table_database,
            tables.dataset_id as table_schema,
            tables.table_id as original_table_name,

            concat(tables.project_id, '.', tables.dataset_id, '.', tables.table_id) as relation_id,

            tables.row_count,
            tables.size_bytes as size_bytes,
            case
                when materialized_views.table_id is not null then 'materialized view'
                when tables.type = 1 then 'table'
                when tables.type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_name

        from `de-zoomcamp-413815`.`trips_all_data`.__TABLES__ tables
        left join materialized_views
            on materialized_views.project_id = tables.project_id
            and materialized_views.dataset_id = tables.dataset_id
            and materialized_views.table_id = tables.table_id
        where (upper(tables.dataset_id) = upper('trips_all_data'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `de-zoomcamp-413815`.`trips_all_data`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `de-zoomcamp-413815`.`trips_all_data`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `de-zoomcamp-413815`.`trips_all_data`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m01:55:31.088014 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:053f0fdc-c01c-484f-ac73-fff583ecbf95&page=queryresults
[0m01:55:31.167580 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:b97d9750-0c8b-404f-9a62-88142ae16a2e&page=queryresults
[0m01:55:31.168315 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:a944e76e-49f5-48d0-9f53-240ff4b70d44&page=queryresults
[0m01:55:31.170071 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:12c26200-ee45-4ccb-b6b7-cfa6c302a4f0&page=queryresults
[0m01:55:32.636749 [info ] [MainThread]: Catalog written to /usr/app/dbt/target/catalog.json
[0m01:55:32.639174 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 4.878875, "process_user_time": 3.349189, "process_kernel_time": 0.363237, "process_mem_max_rss": "155188", "process_in_blocks": "16", "process_out_blocks": "704"}
[0m01:55:32.640170 [debug] [MainThread]: Command `dbt docs generate` succeeded at 01:55:32.639957 after 4.88 seconds
[0m01:55:32.640821 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m01:55:32.641378 [debug] [MainThread]: Connection 'de-zoomcamp-413815.information_schema' was properly closed.
[0m01:55:32.641807 [debug] [MainThread]: Connection 'de-zoomcamp-413815.information_schema' was properly closed.
[0m01:55:32.642190 [debug] [MainThread]: Connection 'de-zoomcamp-413815.information_schema' was properly closed.
[0m01:55:32.642574 [debug] [MainThread]: Connection 'de-zoomcamp-413815.information_schema' was properly closed.
[0m01:55:32.643075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9415b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92a75e0>]}
[0m01:55:32.643700 [debug] [MainThread]: Flushing usage events
[0m08:38:24.348379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00db10>]}


============================== 08:38:24.361886 | 14dc88a3-6313-4c65-bdf7-e9db11ae0cd8 ==============================
[0m08:38:24.361886 [info ] [MainThread]: Running with dbt=1.7.7
[0m08:38:24.363049 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:38:24.740618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14dc88a3-6313-4c65-bdf7-e9db11ae0cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff963a8c0>]}
[0m08:38:24.813352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14dc88a3-6313-4c65-bdf7-e9db11ae0cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff961bb50>]}
[0m08:38:24.814180 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m08:38:24.836000 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m08:38:24.920050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:38:24.920587 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:38:24.927377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14dc88a3-6313-4c65-bdf7-e9db11ae0cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff93000d0>]}
[0m08:38:24.945810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14dc88a3-6313-4c65-bdf7-e9db11ae0cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92c5510>]}
[0m08:38:24.946412 [info ] [MainThread]: Found 6 models, 1 seed, 10 tests, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m08:38:24.948542 [info ] [MainThread]: 
[0m08:38:24.949687 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:38:24.952966 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m08:38:24.953822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:38:24.954519 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m08:38:24.955459 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m08:38:24.955955 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/.google/credentials/google_credentials_2024.json''
[0m08:38:24.956560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:38:24.956972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:38:24.958379 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/.google/credentials/google_credentials_2024.json''
[0m08:38:24.958911 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/.google/credentials/google_credentials_2024.json''
[0m08:38:24.960842 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:38:24.961470 [debug] [MainThread]: Connection 'list_de-zoomcamp-413815' was properly closed.
[0m08:38:24.961857 [debug] [MainThread]: Connection 'list_de-zoomcamp-413815' was properly closed.
[0m08:38:24.962212 [debug] [MainThread]: Connection 'list_de-zoomcamp-413815' was properly closed.
[0m08:38:24.963220 [info ] [MainThread]: 
[0m08:38:24.964023 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.01 seconds (0.01s).
[0m08:38:24.964743 [error] [MainThread]: Encountered an error:
Database Error
  [Errno 2] No such file or directory: '/.google/credentials/google_credentials_2024.json'
[0m08:38:24.966867 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.6775457, "process_user_time": 2.205907, "process_kernel_time": 0.146927, "process_mem_max_rss": "134440", "process_in_blocks": "5008", "process_out_blocks": "648", "command_success": false}
[0m08:38:24.967669 [debug] [MainThread]: Command `dbt build` failed at 08:38:24.967548 after 0.68 seconds
[0m08:38:24.968182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92c5570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92a7ac0>]}
[0m08:38:24.968714 [debug] [MainThread]: Flushing usage events
[0m08:38:48.452283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00fb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb00dba0>]}


============================== 08:38:48.463939 | 293223b7-477e-4688-b9ae-8d2101d1e8f4 ==============================
[0m08:38:48.463939 [info ] [MainThread]: Running with dbt=1.7.7
[0m08:38:48.464878 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:38:48.828508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '293223b7-477e-4688-b9ae-8d2101d1e8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cc7eb0>]}
[0m08:38:48.900593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '293223b7-477e-4688-b9ae-8d2101d1e8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff95ef8b0>]}
[0m08:38:48.901440 [info ] [MainThread]: Registered adapter: bigquery=1.7.0
[0m08:38:48.922102 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m08:38:48.999990 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:38:49.000527 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:38:49.007302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '293223b7-477e-4688-b9ae-8d2101d1e8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92fe8f0>]}
[0m08:38:49.023884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '293223b7-477e-4688-b9ae-8d2101d1e8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff92c12d0>]}
[0m08:38:49.024455 [info ] [MainThread]: Found 6 models, 1 seed, 10 tests, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m08:38:49.026586 [info ] [MainThread]: 
[0m08:38:49.027589 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:38:49.030472 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m08:38:49.031247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:38:49.031883 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m08:38:49.032742 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815'
[0m08:38:49.035505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:38:49.064117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:38:50.678167 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_de-zoomcamp-413815_dbt_staging'
[0m08:38:50.681184 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_production)
[0m08:38:50.683924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now list_de-zoomcamp-413815_dbt_abhishek_yadav)
[0m08:38:50.685568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:38:50.687045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:38:50.688468 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:38:51.389330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '293223b7-477e-4688-b9ae-8d2101d1e8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9418880>]}
[0m08:38:51.391838 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:38:51.392636 [info ] [MainThread]: 
[0m08:38:51.403805 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.my_first_dbt_model
[0m08:38:51.404395 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.stg_green_trip_data
[0m08:38:51.404845 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.stg_yellow_trip_data
[0m08:38:51.405324 [debug] [Thread-4 (]: Began running node seed.taxi_rides_ny.taxi_zone_lookup
[0m08:38:51.405836 [info ] [Thread-1 (]: 1 of 17 START sql table model dbt_staging.my_first_dbt_model ................... [RUN]
[0m08:38:51.406526 [info ] [Thread-2 (]: 2 of 17 START sql view model dbt_staging.stg_green_trip_data ................... [RUN]
[0m08:38:51.407395 [info ] [Thread-3 (]: 3 of 17 START sql view model dbt_abhishek_yadav.stg_yellow_trip_data ........... [RUN]
[0m08:38:51.408309 [info ] [Thread-4 (]: 4 of 17 START seed file dbt_staging.taxi_zone_lookup ........................... [RUN]
[0m08:38:51.409645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_abhishek_yadav, now model.taxi_rides_ny.my_first_dbt_model)
[0m08:38:51.410855 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_dbt_staging, now model.taxi_rides_ny.stg_green_trip_data)
[0m08:38:51.411837 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815_production, now model.taxi_rides_ny.stg_yellow_trip_data)
[0m08:38:51.412816 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_de-zoomcamp-413815, now seed.taxi_rides_ny.taxi_zone_lookup)
[0m08:38:51.413478 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.my_first_dbt_model
[0m08:38:51.414071 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.stg_green_trip_data
[0m08:38:51.414609 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.stg_yellow_trip_data
[0m08:38:51.415131 [debug] [Thread-4 (]: Began compiling node seed.taxi_rides_ny.taxi_zone_lookup
[0m08:38:51.424283 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.my_first_dbt_model"
[0m08:38:51.442558 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_trip_data"
[0m08:38:51.449022 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m08:38:51.450012 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (compile): 08:38:51.449697 => 08:38:51.449702
[0m08:38:51.453097 [debug] [Thread-4 (]: Began executing node seed.taxi_rides_ny.taxi_zone_lookup
[0m08:38:51.454045 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (compile): 08:38:51.415566 => 08:38:51.453780
[0m08:38:51.454467 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (compile): 08:38:51.424909 => 08:38:51.454237
[0m08:38:51.457426 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (compile): 08:38:51.442953 => 08:38:51.457162
[0m08:38:51.459228 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.my_first_dbt_model
[0m08:38:51.467298 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.stg_green_trip_data
[0m08:38:51.477751 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.stg_yellow_trip_data
[0m08:38:51.495537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:38:51.498700 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:38:51.520632 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_trip_data"
[0m08:38:51.523508 [debug] [Thread-3 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_yellow_trip_data"
[0m08:38:51.580980 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:38:51.581891 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:38:51.583322 [debug] [Thread-2 (]: On model.taxi_rides_ny.stg_green_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
  OPTIONS()
  as select
-- identifiers
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
cast(trip_type as integer) as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(ehail_fee as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`green_taxi_data_internal`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), lpep_pickup_datetime)=1
-- dbt-bq compile --select stg_green_trip_data --vars '{'is_test_run': 'false'}'

limit 100
;


[0m08:38:51.612158 [debug] [Thread-3 (]: On model.taxi_rides_ny.stg_yellow_trip_data: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_trip_data"} */


  create or replace view `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
  OPTIONS()
  as -- 

select
-- identifiers
to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
cast(vendorid as integer) as vendorid,
cast(ratecodeid as integer) as ratecodeid,
cast(pulocationid as integer) as pickup_locationid,
cast(dolocationid as integer) as dropoff_locationid,

-- timestamps
TIMESTAMP_SECONDS(CAST(CAST(tpep_pickup_datetime as INT64)/10000000 AS INT64)) as pickup_datetime,
TIMESTAMP_SECONDS(CAST(CAST(tpep_dropoff_datetime as INT64)/10000000 AS INT64)) as dropoff_datetime,

-- trip info
store_and_fwd_flag,
cast(passenger_count as integer) as passenger_count,
cast(trip_distance as numeric) as trip_distance,
1 as trip_type,

-- payment info
cast(fare_amount as numeric) as fare_amount,
cast(extra as numeric) as extra,
cast(mta_tax as numeric) as mta_tax,
cast(tip_amount as numeric) as tip_amount,
cast(tolls_amount as numeric) as tolls_amount,
cast(0 as numeric) as ehail_fee,
cast(improvement_surcharge as numeric) as improvement_surcharge,
cast(total_amount as numeric) as total_amount,
cast(payment_type as integer) as payment_type,
case cast( payment_type as integer )
        when 1 then 'Credit Card'
        when 2 then 'Cash'
        when 3 then 'No Charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided Trip'
        else 'Empty'
    end as payment_type_description,
cast(congestion_surcharge as numeric) as congestion_surcharge
from `de-zoomcamp-413815`.`trips_all_data`.`yello_trip_data`
where vendorid is not null
qualify row_number() over(partition by cast(VendorID as string), tpep_pickup_datetime)=1
-- dbt-bq run --select stg_green_tripdata  --var 'is_test_run: false'

limit 100
;


[0m08:38:52.202709 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.my_first_dbt_model"
[0m08:38:52.205690 [debug] [Thread-1 (]: On model.taxi_rides_ny.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_first_dbt_model"} */

  
    

    create or replace table `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m08:38:52.601031 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:955dd016-0378-42e3-97e0-07d6904881da&page=queryresults
[0m08:38:52.681656 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:c71f5a76-97ae-4045-bba2-b47c9eaf7e7d&page=queryresults
[0m08:38:52.683763 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:1404623a-24b8-4030-b066-54692f9ed8fe&page=queryresults
[0m08:38:52.854920 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.stg_yellow_trip_data (execute): 08:38:51.520886 => 08:38:52.854462
[0m08:38:52.857061 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '293223b7-477e-4688-b9ae-8d2101d1e8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91532e0>]}
[0m08:38:52.859277 [info ] [Thread-3 (]: 3 of 17 OK created sql view model dbt_abhishek_yadav.stg_yellow_trip_data ...... [[32mCREATE VIEW (0 processed)[0m in 1.45s]
[0m08:38:52.860860 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.stg_yellow_trip_data
[0m08:38:52.862425 [debug] [Thread-3 (]: Began running node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m08:38:52.863235 [info ] [Thread-3 (]: 5 of 17 START test accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_  [RUN]
[0m08:38:52.864518 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_yellow_trip_data, now test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad)
[0m08:38:52.865433 [debug] [Thread-3 (]: Began compiling node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m08:38:52.882543 [debug] [Thread-3 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad"
[0m08:38:52.887680 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad (compile): 08:38:52.865966 => 08:38:52.887279
[0m08:38:52.888308 [debug] [Thread-3 (]: Began executing node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m08:38:52.904438 [debug] [Thread-3 (]: Writing runtime sql for node "test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad"
[0m08:38:52.906875 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:38:52.908608 [debug] [Thread-3 (]: On test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_type as value_field,
        count(*) as n_records

    from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
    group by payment_type

)

select *
from all_values
where value_field not in (
    1,2,3,4,5,6
)



      
    ) dbt_internal_test
[0m08:38:53.176611 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.stg_green_trip_data (execute): 08:38:51.499098 => 08:38:53.176042
[0m08:38:53.179533 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '293223b7-477e-4688-b9ae-8d2101d1e8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff90f6f20>]}
[0m08:38:53.181435 [info ] [Thread-2 (]: 2 of 17 OK created sql view model dbt_staging.stg_green_trip_data .............. [[32mCREATE VIEW (0 processed)[0m in 1.77s]
[0m08:38:53.183817 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.stg_green_trip_data
[0m08:38:53.185388 [debug] [Thread-2 (]: Began running node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m08:38:53.186695 [info ] [Thread-2 (]: 6 of 17 START test not_null_stg_yellow_trip_data_tripid ........................ [RUN]
[0m08:38:53.188736 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_green_trip_data, now test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039)
[0m08:38:53.189856 [debug] [Thread-2 (]: Began compiling node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m08:38:53.213727 [debug] [Thread-2 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039"
[0m08:38:53.217141 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039 (compile): 08:38:53.190578 => 08:38:53.216764
[0m08:38:53.217946 [debug] [Thread-2 (]: Began executing node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m08:38:53.221136 [debug] [Thread-2 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039"
[0m08:38:53.222795 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:38:53.224556 [debug] [Thread-2 (]: On test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select tripid
from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
where tripid is null



      
    ) dbt_internal_test
[0m08:38:54.324748 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.my_first_dbt_model (execute): 08:38:51.479168 => 08:38:54.323764
[0m08:38:54.329987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '293223b7-477e-4688-b9ae-8d2101d1e8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff90e6cb0>]}
[0m08:38:54.333005 [info ] [Thread-1 (]: 1 of 17 OK created sql table model dbt_staging.my_first_dbt_model .............. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.92s]
[0m08:38:54.335419 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.my_first_dbt_model
[0m08:38:54.337020 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m08:38:54.338777 [info ] [Thread-1 (]: 7 of 17 START test unique_stg_yellow_trip_data_tripid .......................... [RUN]
[0m08:38:54.340938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.my_first_dbt_model, now test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de)
[0m08:38:54.342013 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m08:38:54.358180 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de"
[0m08:38:54.363222 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de (compile): 08:38:54.342723 => 08:38:54.362442
[0m08:38:54.364082 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m08:38:54.368961 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de"
[0m08:38:54.371268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:38:54.373514 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select tripid as unique_field
  from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
  where tripid is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m08:38:54.755326 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:6176463c-c58e-4958-a30b-41d97c87f462&page=queryresults
[0m08:38:54.963325 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:fd0ad406-2af6-4848-829e-50449eabe78b&page=queryresults
[0m08:38:55.197367 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad (execute): 08:38:52.888717 => 08:38:55.194501
[0m08:38:55.203281 [info ] [Thread-3 (]: 5 of 17 PASS accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_  [[32mPASS[0m in 2.34s]
[0m08:38:55.210716 [debug] [Thread-3 (]: Finished running node test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad
[0m08:38:55.212478 [debug] [Thread-3 (]: Began running node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m08:38:55.214245 [info ] [Thread-3 (]: 8 of 17 START test accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_  [RUN]
[0m08:38:55.216917 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_stg_yellow_trip_data_payment_type__False___var_payment_type_values_.c618b604ad, now test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9)
[0m08:38:55.218456 [debug] [Thread-3 (]: Began compiling node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m08:38:55.233769 [debug] [Thread-3 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9"
[0m08:38:55.243484 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9 (compile): 08:38:55.219384 => 08:38:55.242815
[0m08:38:55.244528 [debug] [Thread-3 (]: Began executing node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m08:38:55.249490 [debug] [Thread-3 (]: Writing runtime sql for node "test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9"
[0m08:38:55.251358 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:38:55.253940 [debug] [Thread-3 (]: On test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_type as value_field,
        count(*) as n_records

    from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
    group by payment_type

)

select *
from all_values
where value_field not in (
    1,2,3,4,5,6
)



      
    ) dbt_internal_test
[0m08:38:55.351483 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039 (execute): 08:38:53.218416 => 08:38:55.351115
[0m08:38:55.352883 [info ] [Thread-2 (]: 6 of 17 PASS not_null_stg_yellow_trip_data_tripid .............................. [[32mPASS[0m in 2.16s]
[0m08:38:55.353978 [debug] [Thread-2 (]: Finished running node test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039
[0m08:38:55.354644 [debug] [Thread-2 (]: Began running node test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2
[0m08:38:55.355206 [info ] [Thread-2 (]: 9 of 17 START test not_null_stg_green_trip_data_tripid ......................... [RUN]
[0m08:38:55.356164 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_stg_yellow_trip_data_tripid.d0f3796039, now test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2)
[0m08:38:55.356711 [debug] [Thread-2 (]: Began compiling node test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2
[0m08:38:55.407480 [debug] [Thread-2 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2"
[0m08:38:55.410521 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2 (compile): 08:38:55.357097 => 08:38:55.410287
[0m08:38:55.411004 [debug] [Thread-2 (]: Began executing node test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2
[0m08:38:55.413579 [debug] [Thread-2 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2"
[0m08:38:55.414993 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:38:55.416716 [debug] [Thread-2 (]: On test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select tripid
from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
where tripid is null



      
    ) dbt_internal_test
[0m08:38:55.510327 [debug] [Thread-4 (]: On seed.taxi_rides_ny.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "seed.taxi_rides_ny.taxi_zone_lookup"} */

    alter table `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup` set OPTIONS()
  
[0m08:38:55.990190 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:3235cdc5-504b-4951-bade-c556e3ec49bc&page=queryresults
[0m08:38:56.212920 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.taxi_rides_ny.taxi_zone_lookup"
[0m08:38:56.222960 [debug] [Thread-4 (]: Timing info for seed.taxi_rides_ny.taxi_zone_lookup (execute): 08:38:51.454664 => 08:38:56.222448
[0m08:38:56.225052 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '293223b7-477e-4688-b9ae-8d2101d1e8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff90d6170>]}
[0m08:38:56.226545 [info ] [Thread-4 (]: 4 of 17 OK loaded seed file dbt_staging.taxi_zone_lookup ....................... [[32mINSERT 265[0m in 4.81s]
[0m08:38:56.228279 [debug] [Thread-4 (]: Finished running node seed.taxi_rides_ny.taxi_zone_lookup
[0m08:38:56.229464 [debug] [Thread-4 (]: Began running node test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5
[0m08:38:56.231252 [info ] [Thread-4 (]: 10 of 17 START test unique_stg_green_trip_data_tripid .......................... [RUN]
[0m08:38:56.233194 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.taxi_rides_ny.taxi_zone_lookup, now test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5)
[0m08:38:56.234145 [debug] [Thread-4 (]: Began compiling node test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5
[0m08:38:56.242806 [debug] [Thread-4 (]: Writing injected SQL for node "test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5"
[0m08:38:56.245669 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5 (compile): 08:38:56.234780 => 08:38:56.245167
[0m08:38:56.246631 [debug] [Thread-4 (]: Began executing node test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5
[0m08:38:56.250544 [debug] [Thread-4 (]: Writing runtime sql for node "test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5"
[0m08:38:56.252541 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:38:56.254878 [debug] [Thread-4 (]: On test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select tripid as unique_field
  from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
  where tripid is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m08:38:57.110051 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:4791eff6-60d6-4e6f-9aa0-33d394180c56&page=queryresults
[0m08:38:57.283085 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:b1911384-1263-4dff-8f99-e2b7bbf6fd17&page=queryresults
[0m08:38:57.563743 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9 (execute): 08:38:55.244979 => 08:38:57.560751
[0m08:38:57.578017 [info ] [Thread-3 (]: 8 of 17 PASS accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_  [[32mPASS[0m in 2.36s]
[0m08:38:57.582566 [debug] [Thread-3 (]: Finished running node test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9
[0m08:38:57.584412 [debug] [Thread-3 (]: Began running node model.taxi_rides_ny.my_second_dbt_model
[0m08:38:57.586195 [info ] [Thread-3 (]: 11 of 17 START sql view model dbt_staging.my_second_dbt_model .................. [RUN]
[0m08:38:57.588350 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_stg_green_trip_data_payment_type__False___var_payment_type_values_.4f221cc1e9, now model.taxi_rides_ny.my_second_dbt_model)
[0m08:38:57.589557 [debug] [Thread-3 (]: Began compiling node model.taxi_rides_ny.my_second_dbt_model
[0m08:38:57.599456 [debug] [Thread-3 (]: Writing injected SQL for node "model.taxi_rides_ny.my_second_dbt_model"
[0m08:38:57.604885 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (compile): 08:38:57.590419 => 08:38:57.604162
[0m08:38:57.605987 [debug] [Thread-3 (]: Began executing node model.taxi_rides_ny.my_second_dbt_model
[0m08:38:57.612540 [debug] [Thread-3 (]: Writing runtime sql for node "model.taxi_rides_ny.my_second_dbt_model"
[0m08:38:57.615228 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:38:57.618486 [debug] [Thread-3 (]: On model.taxi_rides_ny.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.my_second_dbt_model"} */


  create or replace view `de-zoomcamp-413815`.`dbt_staging`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `de-zoomcamp-413815`.`dbt_staging`.`my_first_dbt_model`
where id = 1;


[0m08:38:57.678848 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2 (execute): 08:38:55.411350 => 08:38:57.678507
[0m08:38:57.679934 [info ] [Thread-2 (]: 9 of 17 PASS not_null_stg_green_trip_data_tripid ............................... [[32mPASS[0m in 2.32s]
[0m08:38:57.680739 [debug] [Thread-2 (]: Finished running node test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2
[0m08:38:57.681346 [debug] [Thread-2 (]: Began running node model.taxi_rides_ny.dim_zones
[0m08:38:57.681965 [info ] [Thread-2 (]: 12 of 17 START sql table model production.dim_zones ............................ [RUN]
[0m08:38:57.683030 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_stg_green_trip_data_tripid.902ff8e8b2, now model.taxi_rides_ny.dim_zones)
[0m08:38:57.683658 [debug] [Thread-2 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m08:38:57.687030 [debug] [Thread-2 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m08:38:57.689734 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.dim_zones (compile): 08:38:57.684061 => 08:38:57.689510
[0m08:38:57.690229 [debug] [Thread-2 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m08:38:57.693099 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:38:57.750548 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:389902d5-81d8-4cd7-8c80-f62804843d0d&page=queryresults
[0m08:38:58.107338 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de (execute): 08:38:54.364558 => 08:38:58.106204
[0m08:38:58.110766 [info ] [Thread-1 (]: 7 of 17 PASS unique_stg_yellow_trip_data_tripid ................................ [[32mPASS[0m in 3.77s]
[0m08:38:58.113523 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de
[0m08:38:58.115374 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m08:38:58.116780 [info ] [Thread-1 (]: 13 of 17 START test relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m08:38:58.119075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.unique_stg_yellow_trip_data_tripid.0fed72f2de, now test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f)
[0m08:38:58.122030 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m08:38:58.135770 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f"
[0m08:38:58.138548 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f (compile): 08:38:58.122786 => 08:38:58.138042
[0m08:38:58.139509 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m08:38:58.144097 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f"
[0m08:38:58.146365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:38:58.148739 [debug] [Thread-1 (]: On test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select dropoff_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
    where dropoff_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:38:58.237821 [debug] [Thread-2 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_zones"
[0m08:38:58.239678 [debug] [Thread-2 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */

  
    

    create or replace table `de-zoomcamp-413815`.`production`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      select 
locationid,
borough,
zone,
replace(service_zone, 'Boro', 'Green') as service_zone
from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
    );
  
[0m08:38:58.408285 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:7bebc9ab-39df-4782-89d1-b9343de0316f&page=queryresults
[0m08:38:58.489280 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:814dbbb8-5015-4e10-867e-d2b59f97eda7&page=queryresults
[0m08:38:58.543493 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:ee737845-ed31-406c-a872-36cccab18af7&page=queryresults
[0m08:38:58.641955 [debug] [Thread-3 (]: Timing info for model.taxi_rides_ny.my_second_dbt_model (execute): 08:38:57.606715 => 08:38:58.641324
[0m08:38:58.644856 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '293223b7-477e-4688-b9ae-8d2101d1e8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff0711180>]}
[0m08:38:58.646708 [info ] [Thread-3 (]: 11 of 17 OK created sql view model dbt_staging.my_second_dbt_model ............. [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m08:38:58.649739 [debug] [Thread-3 (]: Finished running node model.taxi_rides_ny.my_second_dbt_model
[0m08:38:58.651203 [debug] [Thread-3 (]: Began running node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m08:38:58.652467 [info ] [Thread-3 (]: 14 of 17 START test relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m08:38:58.654257 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.my_second_dbt_model, now test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989)
[0m08:38:58.655311 [debug] [Thread-3 (]: Began compiling node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m08:38:58.667947 [debug] [Thread-3 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989"
[0m08:38:58.672092 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989 (compile): 08:38:58.656042 => 08:38:58.671524
[0m08:38:58.672961 [debug] [Thread-3 (]: Began executing node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m08:38:58.677854 [debug] [Thread-3 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989"
[0m08:38:58.680771 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:38:58.683655 [debug] [Thread-3 (]: On test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select pickup_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
    where pickup_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:38:58.860139 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5 (execute): 08:38:56.247182 => 08:38:58.859520
[0m08:38:58.862029 [info ] [Thread-4 (]: 10 of 17 PASS unique_stg_green_trip_data_tripid ................................ [[32mPASS[0m in 2.63s]
[0m08:38:58.863504 [debug] [Thread-4 (]: Finished running node test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5
[0m08:38:58.864537 [debug] [Thread-4 (]: Began running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m08:38:58.865400 [info ] [Thread-4 (]: 15 of 17 START test relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m08:38:58.866897 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.unique_stg_green_trip_data_tripid.79b40e00d5, now test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3)
[0m08:38:58.867683 [debug] [Thread-4 (]: Began compiling node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m08:38:58.875510 [debug] [Thread-4 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3"
[0m08:38:58.878647 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3 (compile): 08:38:58.868265 => 08:38:58.878182
[0m08:38:58.879440 [debug] [Thread-4 (]: Began executing node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m08:38:58.882909 [debug] [Thread-4 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3"
[0m08:38:58.884789 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:38:58.888017 [debug] [Thread-4 (]: On test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select dropoff_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
    where dropoff_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:38:59.912887 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:227263c7-9ba9-4ad7-a704-3a046bba2808&page=queryresults
[0m08:38:59.926717 [debug] [Thread-2 (]: Timing info for model.taxi_rides_ny.dim_zones (execute): 08:38:57.690612 => 08:38:59.926066
[0m08:38:59.934284 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '293223b7-477e-4688-b9ae-8d2101d1e8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91e41f0>]}
[0m08:38:59.937370 [info ] [Thread-2 (]: 12 of 17 OK created sql table model production.dim_zones ....................... [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 2.25s]
[0m08:38:59.939814 [debug] [Thread-2 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m08:38:59.941319 [debug] [Thread-2 (]: Began running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m08:38:59.942725 [info ] [Thread-2 (]: 16 of 17 START test relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m08:38:59.944868 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.dim_zones, now test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739)
[0m08:38:59.945978 [debug] [Thread-2 (]: Began compiling node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m08:38:59.959729 [debug] [Thread-2 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739"
[0m08:38:59.964732 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739 (compile): 08:38:59.946720 => 08:38:59.964027
[0m08:38:59.965794 [debug] [Thread-2 (]: Began executing node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m08:38:59.970340 [debug] [Thread-2 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739"
[0m08:38:59.972479 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:38:59.975019 [debug] [Thread-2 (]: On test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select pickup_locationid as from_field
    from `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
    where pickup_locationid is not null
),

parent as (
    select locationid as to_field
    from `de-zoomcamp-413815`.`dbt_staging`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:39:00.085716 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:0bf6bade-2a7a-4ce6-a4a0-62d1144da1fc&page=queryresults
[0m08:39:00.288424 [debug] [Thread-1 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f (execute): 08:38:58.140174 => 08:39:00.287776
[0m08:39:00.295006 [info ] [Thread-1 (]: 13 of 17 PASS relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 2.18s]
[0m08:39:00.297016 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f
[0m08:39:00.412275 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:41cd3f96-6704-4094-9b03-13c58dff5f51&page=queryresults
[0m08:39:00.546598 [debug] [Thread-3 (]: Timing info for test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989 (execute): 08:38:58.673487 => 08:39:00.543578
[0m08:39:00.552314 [info ] [Thread-3 (]: 14 of 17 PASS relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 1.90s]
[0m08:39:00.555982 [debug] [Thread-3 (]: Finished running node test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989
[0m08:39:00.829717 [debug] [Thread-4 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3 (execute): 08:38:58.879936 => 08:39:00.825892
[0m08:39:00.836439 [info ] [Thread-4 (]: 15 of 17 PASS relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 1.97s]
[0m08:39:00.840845 [debug] [Thread-4 (]: Finished running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3
[0m08:39:01.516138 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:54131429-dea9-4cbe-b67a-482ba7917431&page=queryresults
[0m08:39:01.949620 [debug] [Thread-2 (]: Timing info for test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739 (execute): 08:38:59.966391 => 08:39:01.947267
[0m08:39:01.956807 [info ] [Thread-2 (]: 16 of 17 PASS relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 2.01s]
[0m08:39:01.961160 [debug] [Thread-2 (]: Finished running node test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739
[0m08:39:01.968233 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fact_trips
[0m08:39:01.970541 [info ] [Thread-1 (]: 17 of 17 START sql table model production.fact_trips ........................... [RUN]
[0m08:39:01.973477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.relationships_stg_green_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.7644f6670f, now model.taxi_rides_ny.fact_trips)
[0m08:39:01.974994 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fact_trips
[0m08:39:01.986244 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fact_trips"
[0m08:39:01.993257 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.fact_trips (compile): 08:39:01.976604 => 08:39:01.992447
[0m08:39:01.994365 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fact_trips
[0m08:39:01.999302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:39:02.618587 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fact_trips"
[0m08:39:02.627804 [debug] [Thread-1 (]: On model.taxi_rides_ny.fact_trips: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "bq-dbt-workshop", "target_name": "dev", "node_id": "model.taxi_rides_ny.fact_trips"} */

  
    

    create or replace table `de-zoomcamp-413815`.`production`.`fact_trips`
      
    
    

    OPTIONS()
    as (
      with green_trip_data as(
    select *,
        'Green' as service_type
    from 
    `de-zoomcamp-413815`.`dbt_staging`.`stg_green_trip_data`
),

yellow_trip_data as(
    select *,
        'Yellow' as service_type
    from 
    `de-zoomcamp-413815`.`dbt_abhishek_yadav`.`stg_yellow_trip_data`
),

trips_unioned as(
    select * from green_trip_data
    union all
    select * from yellow_trip_data
),
dim_zones as (
    select * from `de-zoomcamp-413815`.`production`.`dim_zones`
    where borough <> 'Unknown'
)

select trips_unioned.tripid, 
    trips_unioned.vendorid, 
    trips_unioned.service_type,
    trips_unioned.ratecodeid, 
    trips_unioned.pickup_locationid, 
    pickup_zone.borough as pickup_borough, 
    pickup_zone.zone as pickup_zone, 
    trips_unioned.dropoff_locationid,
    dropoff_zone.borough as dropoff_borough, 
    dropoff_zone.zone as dropoff_zone,  
    trips_unioned.pickup_datetime, 
    trips_unioned.dropoff_datetime, 
    trips_unioned.store_and_fwd_flag, 
    trips_unioned.passenger_count, 
    trips_unioned.trip_distance, 
    trips_unioned.trip_type, 
    trips_unioned.fare_amount, 
    trips_unioned.extra, 
    trips_unioned.mta_tax, 
    trips_unioned.tip_amount, 
    trips_unioned.tolls_amount, 
    trips_unioned.ehail_fee, 
    trips_unioned.improvement_surcharge, 
    trips_unioned.total_amount, 
    trips_unioned.payment_type, 
    trips_unioned.payment_type_description
from trips_unioned
inner join dim_zones as pickup_zone
on (trips_unioned.pickup_locationid = pickup_zone.locationid)
inner join dim_zones as dropoff_zone
on (trips_unioned.dropoff_locationid = dropoff_zone.locationid)
    );
  
[0m08:39:03.043354 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=de-zoomcamp-413815&j=bq:asia-south1:aec005de-2427-4e66-b23c-fac8316b50ed&page=queryresults
[0m08:39:07.451896 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.fact_trips (execute): 08:39:01.995068 => 08:39:07.450937
[0m08:39:07.456523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '293223b7-477e-4688-b9ae-8d2101d1e8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff0719990>]}
[0m08:39:07.459488 [info ] [Thread-1 (]: 17 of 17 OK created sql table model production.fact_trips ...................... [[32mCREATE TABLE (199.0 rows, 276.2 MiB processed)[0m in 5.48s]
[0m08:39:07.463994 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fact_trips
[0m08:39:07.471599 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:39:07.473412 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fact_trips' was properly closed.
[0m08:39:07.475126 [debug] [MainThread]: Connection 'test.taxi_rides_ny.relationships_stg_green_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.bbedac2989' was properly closed.
[0m08:39:07.476527 [debug] [MainThread]: Connection 'test.taxi_rides_ny.relationships_stg_yellow_trip_data_dropoff_locationid__locationid__ref_taxi_zone_lookup_.11b815b7b3' was properly closed.
[0m08:39:07.477965 [debug] [MainThread]: Connection 'test.taxi_rides_ny.relationships_stg_yellow_trip_data_pickup_locationid__locationid__ref_taxi_zone_lookup_.09324c6739' was properly closed.
[0m08:39:07.480696 [info ] [MainThread]: 
[0m08:39:07.482461 [info ] [MainThread]: Finished running 3 view models, 3 table models, 10 tests, 1 seed in 0 hours 0 minutes and 18.45 seconds (18.45s).
[0m08:39:07.488768 [debug] [MainThread]: Command end result
[0m08:39:07.511767 [info ] [MainThread]: 
[0m08:39:07.512479 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:39:07.513158 [info ] [MainThread]: 
[0m08:39:07.514214 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m08:39:07.516316 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 19.120695, "process_user_time": 5.228684, "process_kernel_time": 0.317776, "process_mem_max_rss": "170880", "process_in_blocks": "144", "process_out_blocks": "704"}
[0m08:39:07.517237 [debug] [MainThread]: Command `dbt build` succeeded at 08:39:07.517072 after 19.12 seconds
[0m08:39:07.517956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffccff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9127d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cc7eb0>]}
[0m08:39:07.518973 [debug] [MainThread]: Flushing usage events
